(()=>{"use strict";var e,t={5519:e=>{function t(e,t){t.stopPropagation(),t.preventDefault(),e(Array.prototype.slice.call(t.dataTransfer.files))}function s(e){return e.stopPropagation(),e.preventDefault(),!1}e.exports=function(e,r){e.addEventListener("dragenter",s,!1),e.addEventListener("dragover",s,!1),e.addEventListener("drop",t.bind(void 0,r),!1)}},8536:(e,t)=>{const s="bits",r="bytes",i="",o="iec",n="jedec",a="round",c="string",d={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function l(e,{bits:t=!1,pad:l=!1,base:p=-1,round:u=2,locale:h="",localeOptions:f={},separator:b="",spacer:m=" ",symbols:g={},standard:y="",output:v=c,fullform:_=!1,fullforms:B=[],exponent:w=-1,roundingMethod:C=a,precision:I=0}={}){let x=w,k=Number(e),$=[],N=0,M=i;-1===p&&0===y.length?(p=10,y=n):-1===p&&y.length>0?p=(y=y===o?o:n)===o?2:10:y=10===(p=2===p?2:10)||y===n?n:o;const P=10===p?1e3:1024,E=!0===_,D=k<0,O=Math[C];if("bigint"!=typeof e&&isNaN(e))throw new TypeError("Invalid number");if("function"!=typeof O)throw new TypeError("Invalid rounding method");if(D&&(k=-k),(-1===x||isNaN(x))&&(x=Math.floor(Math.log(k)/Math.log(P)),x<0&&(x=0)),x>8&&(I>0&&(I+=8-x),x=8),"exponent"===v)return x;if(0===k)$[0]=0,M=$[1]=d.symbol[y][t?s:r][x];else{N=k/(2===p?Math.pow(2,10*x):Math.pow(1e3,x)),t&&(N*=8,N>=P&&x<8&&(N/=P,x++));const e=Math.pow(10,x>0?u:0);$[0]=O(N*e)/e,$[0]===P&&x<8&&-1===w&&($[0]=1,x++),M=$[1]=10===p&&1===x?t?"kbit":"kB":d.symbol[y][t?s:r][x]}if(D&&($[0]=-$[0]),I>0&&($[0]=$[0].toPrecision(I)),$[1]=g[$[1]]||$[1],!0===h?$[0]=$[0].toLocaleString():h.length>0?$[0]=$[0].toLocaleString(h,f):b.length>0&&($[0]=$[0].toString().replace(".",b)),l&&!1===Number.isInteger($[0])&&u>0){const e=b||".",t=$[0].toString().split(e),s=t[1]||i,r=s.length,o=u-r;$[0]=`${t[0]}${e}${s.padEnd(r+o,"0")}`}return E&&($[1]=B[x]?B[x]:d.fullform[y][x]+(t?"bit":"byte")+(1===$[0]?i:"s")),"array"===v?$:"object"===v?{value:$[0],symbol:$[1],exponent:x,unit:M}:$.join(m)}t.Gw=l},6929:(e,t,s)=>{s(9670),s(4981),s(8531)},170:(e,t,s)=>{var r=s(3150),i=s(2490),o=s(6566),n=s(5623),a=s(1417),c=s(1227);s(8637),s(6929);const d=c("ipfs-companion:import");d.error=c("ipfs-companion:import:error");function l(e){e=(e=e.replace(/\/$|$/,"/")).replace(/(\/)\/+/g,"$1");const t=new Date,s=[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()].map((e=>String(e).padStart(2,"0")));return[/%Y/g,/%M/g,/%D/g,/%h/g,/%m/g,/%s/g].forEach(((t,r)=>{e=e.replace(t,s[r])})),e}var p=s(3686),u=s(5519),h=s(8536);document.title=r.i18n.getMessage("quickImport_page_title");const f=i();async function b(e,t,s){console.log("Processing files",s);const{ipfsCompanion:i}=await r.runtime.getBackgroundPage();try{if(console.log("importing files",s),!s.length)throw new Error("found no valid sources, try selecting a local file instead");const{copyImportResultsToFiles:o,copyShareLink:n,preloadFilesAtPublicGateway:c,openFilesAtGateway:d,openFilesAtWebUI:u}=i.ipfsImportHandler,f=await r.tabs.getCurrent(),b=l(e.importDir),m="external"===i.state.ipfsNodeType,g=[];let y=0;for(const e of s)g.push({path:e.name,content:m?e:e.stream()}),y+=e.size;const v=(0,h.Gw)(y,{round:2});e.progress=`Importing ${v}... (keep this page open)`,t.emit("render");const _={progress:s=>{const r=(s/y*100).toFixed(0);e.progress=`Importing... (${r}% of ${v})`,t.emit("render")},wrapWithDirectory:!0,pin:!1};let B;B=m?await a.S(r,i.state):i.ipfs;const w=await(0,p.Z)(B.addAll(g,_));await o(w,b),e.progress="Completed",t.emit("render"),console.log(`Successfully imported ${s.length} files`),n(w),c(w),e.userChangedImportDir&&t.emit("optionChange",{key:"importDir",value:e.importDir}),!e.openViaWebUI||e.ipfsNodeType.startsWith("embedded")?await d(b):await u(b),await r.tabs.remove(f.id)}catch(s){console.error("Failed to import files to IPFS",s),e.message="Unable to import to IPFS:",e.progress=`${s}`,t.emit("render"),i.notify("notify_importErrorTitle","notify_inlineErrorMsg",`${s.message}`)}}f.use((function(e,t){let s;e.message="",e.peerCount="",e.ipfsNodeType="external",e.expandOptions=!1,e.openViaWebUI=!0,e.userChangedOpenViaWebUI=!1,e.importDir="",e.userChangedImportDir=!1,t.on("DOMContentLoaded",(async()=>{r.runtime.sendMessage({telemetry:{trackView:"quick-import"}}),s=r.runtime.connect({name:"browser-action-port"}),s.onMessage.addListener((async s=>{s.statusUpdate&&(console.log("In browser action, received message from background:",s),function({ipfsNodeType:t,peerCount:s,importDir:r,openViaWebUI:i}){e.ipfsNodeType=t,e.peerCount=s,e.userChangedImportDir||(e.importDir=r),e.userChangedOpenViaWebUI||(e.openViaWebUI=i)}(s.statusUpdate),t.emit("render"))}))})),t.on("fileInputChange",(s=>b(e,t,s.target.files))),t.on("optionChange",(({key:e,value:t})=>{r.storage.local.set({[e]:t})})),u(document.body,(s=>b(e,t,s)))})),f.route("*",(function(e,t){const{peerCount:s}=e;return o`
    <div class="montserrat pt5" style="background: linear-gradient(to top, #041727 0%,#043b55 100%); height:100%;">
      <div class="mw8 center pa3 white">
        <header class="flex items-center no-user-select">
  ${(0,n.Z)({size:80,path:"../../icons",heartbeat:!1})}
          <div class="pl3">
            <h1 class="f2 fw5 ma0">
              ${r.i18n.getMessage("quickImport_head_peers")}
            </h1>
            <p class="f3 fw2 lh-copy ma0 light-gray">
              ${r.i18n.getMessage("quickImport_subhead_peers",[s])}
            </p>
          </div>
        </header>
        <label for="quickImportInput" class='db relative mt5 hover-inner-shadow pointer' style="border:solid 2px #6ACAD1">
          <input class="db pointer w-100 h-100 top-0 o-0" type="file" id="quickImportInput" multiple onchange=${e=>t("fileInputChange",e)} />
          <div class='dt dim' style='padding-left: 100px; height: 300px'>
            <div class='dtc v-mid'>
              <span class="f3 dim br1 ph4 pv3 dib navy" style="background: #6ACAD1">
                ${r.i18n.getMessage("quickImport_pick_file_button")}
              </span>
              <span class='f3'>
                <emph class='underline pl3 pr2 moon-gray'>
                  ${r.i18n.getMessage("quickImport_or")}
                </emph>
                ${r.i18n.getMessage("quickImport_drop_it_here")}
              </span>
              <p class='f4 db'>${e.message}<span class='code db absolute fr pv2'>${e.progress}</span></p>
            </div>
          </div>
        </label>
        ${function(e,t){const s=s=>{e.expandOptions=!0,t("render")},i=t=>{e.userChangedImportDir=!0,e.importDir=t.target.value},n=t=>{e.userChangedOpenViaWebUI=!0,e.openViaWebUI=t.target.checked},a="embedded"!==e.ipfsNodeType;if(e.expandOptions)return o`
      <div id='quickImportOptions' class='sans-serif mt3 f6 lh-copy light-gray no-user-select'>
        ${a?o`<label for='openViaWebUI' class='flex items-center db relative mt1 pointer'>
          <input id='openViaWebUI' type='checkbox' onchange=${n} checked=${e.openViaWebUI} />
          <span class='mark db flex items-center relative mr2 br2'></span>
          ${r.i18n.getMessage("quickImport_options_openViaWebUI")}
        </label>`:null}
        <label for='importDir' class='flex items-center db relative mt1 pointer'>
          ${r.i18n.getMessage("quickImport_options_importDir")}
          <span class='mark db flex items-center relative mr2 br2'></span>
          <input id='importDir' class='w-40 bg-transparent aqua monospace br1 ba b--aqua pa2' type='text' oninput=${i} value=${e.importDir} />
        </label>
      </div>
    `;return o`
    <button class='mt3 f6 lh-copy link bn bg-transparent moon-gray dib pa0 pointer' style='color: #6ACAD1' onclick=${s}>
      ${r.i18n.getMessage("quickImport_options_show")} Â»
    </button>
  `}(e,t)}
      </div>
    </div>
  `})),f.mount("#root")},619:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(3597);function i(e){return"function"==typeof e.stream?(0,r.Z)(e.stream()):(0,r.Z)(new Response(e).body)}},1392:(e,t,s)=>{s.d(t,{x:()=>i});const r=e=>Promise.reject(new Error(`No base found for "${e}"`));class i{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||r;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const t=await this._loadBase(e);return null==this._basesByName[t.name]&&null==this._basesByPrefix[t.prefix]&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}}},2890:(e,t,s)=>{s.d(t,{w:()=>i});const r=e=>Promise.reject(new Error(`No codec found for "${e}"`));class i{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||r;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const t="string"==typeof e?this._codecsByName:this._codecsByCode;if(t[e])return t[e];const s=await this._loadCodec(e);return null==t[e]&&this.addCodec(s),s}listCodecs(){return Object.values(this._codecsByName)}}},5101:(e,t,s)=>{s.d(t,{d:()=>i});const r=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class i{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||r;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const t="string"==typeof e?this._hashersByName:this._hashersByCode;if(t[e])return t[e];const s=await this._loadHasher(e);return null==t[e]&&this.addHasher(s),s}listHashers(){return Object.values(this._hashersByName)}}},1486:(e,t,s)=>{async function r(e){for await(const t of e)return t}s.d(t,{Z:()=>r})},8883:(e,t,s)=>{async function r(e){let t;for await(const s of e)t=s;return t}s.d(t,{Z:()=>r})},7258:(e,t,s)=>{function r(e){const t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function i(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:o(e.Stat)}}}function o(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:s,Queued:r,Failed:i}=e.PinCount;return{status:"valid",pinCount:{queued:r,pinning:t,pinned:s,failed:i}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}s.d(t,{hm:()=>r,iI:()=>i})},8568:(e,t,s)=>{s.d(t,{f:()=>r});class r{constructor(){this._subs=new Map}subscribe(e,t,s){const r=this._subs.get(e)||[];if(r.find((e=>e.handler===t)))throw new Error(`Already subscribed to ${e} with this handler`);const i=new AbortController;return this._subs.set(e,[{handler:t,controller:i}].concat(r)),s&&s.addEventListener("abort",(()=>this.unsubscribe(e,t))),i.signal}unsubscribe(e,t){const s=this._subs.get(e)||[];let r;t?(this._subs.set(e,s.filter((e=>e.handler!==t))),r=s.filter((e=>e.handler===t))):(this._subs.set(e,[]),r=s),(this._subs.get(e)||[]).length||this._subs.delete(e),r.forEach((e=>e.controller.abort()))}}},9144:(e,t,s)=>{s.d(t,{W:()=>r});const r=(e,t)=>async function(e,s){t.unsubscribe(e,s)}}},s={};function r(e){var i=s[e];if(void 0!==i)return i.exports;var o=s[e]={exports:{}};return t[e].call(o.exports,o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,s,i,o)=>{if(!s){var n=1/0;for(l=0;l<e.length;l++){for(var[s,i,o]=e[l],a=!0,c=0;c<s.length;c++)(!1&o||n>=o)&&Object.keys(r.O).every((e=>r.O[e](s[c])))?s.splice(c--,1):(a=!1,o<n&&(n=o));if(a){e.splice(l--,1);var d=i();void 0!==d&&(t=d)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[s,i,o]},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.j=743,(()=>{var e={743:0};r.O.j=t=>0===e[t];var t=(t,s)=>{var i,o,[n,a,c]=s,d=0;if(n.some((t=>0!==e[t]))){for(i in a)r.o(a,i)&&(r.m[i]=a[i]);if(c)var l=c(r)}for(t&&t(s);d<n.length;d++)o=n[d],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(l)},s=self.webpackChunkipfs_companion=self.webpackChunkipfs_companion||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var i=r.O(void 0,[297],(()=>r(170)));i=r.O(i)})();