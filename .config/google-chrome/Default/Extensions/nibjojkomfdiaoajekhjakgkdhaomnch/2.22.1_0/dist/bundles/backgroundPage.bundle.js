/*! For license information please see backgroundPage.bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={19824:(e,t)=>{"use strict";const r="undefined"!=typeof BigUint64Array,n=Symbol(),s=1024;function i(e,t){const r=new Uint32Array(e),n=new Uint16Array(e);var i=r[t+-4>>>2]>>>1,o=t>>>1;if(i<=s)return String.fromCharCode.apply(String,n.subarray(o,o+i));const a=[];do{const e=n[o+s-1],t=e>=55296&&e<56320?1023:s;a.push(String.fromCharCode.apply(String,n.subarray(o,o+=t))),i-=t}while(i>s);return a.join("")+String.fromCharCode.apply(String,n.subarray(o,o+i))}function o(e){const t={};function r(e,t){return e?i(e.buffer,t):"<yet unknown>"}const n=e.env=e.env||{};return n.abort=n.abort||function(e,s,i,o){const a=t.memory||n.memory;throw Error("abort: "+r(a,e)+" at "+r(a,s)+":"+i+":"+o)},n.trace=n.trace||function(e,s){const i=t.memory||n.memory;console.log("trace: "+r(i,e)+(s?" ":"")+Array.prototype.slice.call(arguments,2,2+s).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function a(e,t){const n=t.exports,s=n.memory,o=n.table,a=n.__alloc,c=n.__retain,h=n.__rtti_base||-1;function l(e){const t=new Uint32Array(s.buffer);if((e>>>=0)>=t[h>>>2])throw Error("invalid id: "+e);return t[(h+4>>>2)+2*e]}function d(e){const t=new Uint32Array(s.buffer);if((e>>>=0)>=t[h>>>2])throw Error("invalid id: "+e);return t[(h+4>>>2)+2*e+1]}function f(e){return 31-Math.clz32(e>>>5&31)}function p(e,t,r){const n=s.buffer;if(r)switch(e){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(n);case 1:return new(t?Int16Array:Uint16Array)(n);case 2:return new(t?Int32Array:Uint32Array)(n);case 3:return new(t?BigInt64Array:BigUint64Array)(n)}throw Error("unsupported align: "+e)}function y(e){const t=new Uint32Array(s.buffer),r=t[e+-8>>>2],n=l(r);if(!(1&n))throw Error("not an array: "+r);const i=f(n);var o=t[e+4>>>2];const a=2&n?t[e+12>>>2]:t[o+-4>>>2]>>>i;return p(i,1024&n,2048&n).subarray(o>>>=i,o+a)}function g(e,t,r){return new e(b(e,t,r))}function b(e,t,r){const n=s.buffer,i=new Uint32Array(n),o=i[r+4>>>2];return new e(n,o,i[o+-4>>>2]>>>t)}return e.__allocString=function(e){const t=e.length,r=a(t<<1,1),n=new Uint16Array(s.buffer);for(var i=0,o=r>>>1;i<t;++i)n[o+i]=e.charCodeAt(i);return r},e.__getString=function(e){const t=s.buffer;if(1!==new Uint32Array(t)[e+-8>>>2])throw Error("not a string: "+e);return i(t,e)},e.__allocArray=function(e,t){const r=l(e);if(!(3&r))throw Error("not an array: "+e+" @ "+r);const n=f(r),i=t.length,o=a(i<<n,0),h=a(2&r?16:12,e),u=new Uint32Array(s.buffer);u[h+0>>>2]=c(o),u[h+4>>>2]=o,u[h+8>>>2]=i<<n,2&r&&(u[h+12>>>2]=i);const d=p(n,1024&r,2048&r);if(8192&r)for(let e=0;e<i;++e)d[(o>>>n)+e]=c(t[e]);else d.set(t,o>>>n);return h},e.__getArrayView=y,e.__getArray=function(e){const t=y(e),r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n},e.__getArrayBuffer=function(e){const t=s.buffer,r=new Uint32Array(t)[e+-4>>>2];return t.slice(e,e+r)},e.__getInt8Array=g.bind(null,Int8Array,0),e.__getInt8ArrayView=b.bind(null,Int8Array,0),e.__getUint8Array=g.bind(null,Uint8Array,0),e.__getUint8ArrayView=b.bind(null,Uint8Array,0),e.__getUint8ClampedArray=g.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=b.bind(null,Uint8ClampedArray,0),e.__getInt16Array=g.bind(null,Int16Array,1),e.__getInt16ArrayView=b.bind(null,Int16Array,1),e.__getUint16Array=g.bind(null,Uint16Array,1),e.__getUint16ArrayView=b.bind(null,Uint16Array,1),e.__getInt32Array=g.bind(null,Int32Array,2),e.__getInt32ArrayView=b.bind(null,Int32Array,2),e.__getUint32Array=g.bind(null,Uint32Array,2),e.__getUint32ArrayView=b.bind(null,Uint32Array,2),r&&(e.__getInt64Array=g.bind(null,BigInt64Array,3),e.__getInt64ArrayView=b.bind(null,BigInt64Array,3),e.__getUint64Array=g.bind(null,BigUint64Array,3),e.__getUint64ArrayView=b.bind(null,BigUint64Array,3)),e.__getFloat32Array=g.bind(null,Float32Array,2),e.__getFloat32ArrayView=b.bind(null,Float32Array,2),e.__getFloat64Array=g.bind(null,Float64Array,3),e.__getFloat64ArrayView=b.bind(null,Float64Array,3),e.__instanceof=function(e,t){const r=new Uint32Array(s.buffer);var n=r[e+-8>>>2];if(n<=r[h>>>2])do{if(n==t)return!0}while(n=d(n));return!1},e.memory=e.memory||s,e.table=e.table||o,u(n,e)}function c(e){return"undefined"!=typeof Response&&e instanceof Response}async function h(e,t){return c(e=await e)?l(e,t):a(o(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}async function l(e,t){return WebAssembly.instantiateStreaming?a(o(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):h(c(e=await e)?e.arrayBuffer():e,t)}function u(e,t){var r=t?Object.create(t):{},s=e.__argumentsLength?function(t){e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||function(){};for(let t in e){if(!Object.prototype.hasOwnProperty.call(e,t))continue;const i=e[t];let o=t.split("."),a=r;for(;o.length>1;){let e=o.shift();Object.prototype.hasOwnProperty.call(a,e)||(a[e]={}),a=a[e]}let c=o[0],h=c.indexOf("#");if(h>=0){let r=c.substring(0,h),o=a[r];if(void 0===o||!o.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[n]}},e.wrap=function(t){return Object.create(e.prototype,{[n]:{value:t,writable:!1}})},o&&Object.getOwnPropertyNames(o).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t)))),a[r]=e}if(c=c.substring(h+1),a=a[r].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let r=e[t.replace("set:","get:")],s=e[t.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return r(this[n])},set:function(e){s(this[n],e)},enumerable:!0})}}else"constructor"===c?(a[c]=(...e)=>(s(e.length),i(...e))).original=i:(a[c]=function(...e){return s(e.length),i(this[n],...e)}).original=i}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:e[t.replace("set:","get:")],set:e[t.replace("get:","set:")],enumerable:!0}):"function"==typeof i&&i!==s?(a[c]=(...e)=>(s(e.length),i(...e))).original=i:a[c]=i}return r}t.instantiate=h,t.instantiateSync=function(e,t){return a(o(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))},t.instantiateStreaming=l,t.demangle=u},42450:(e,t,r)=>{"use strict";e.exports=r(10077)},10077:(e,t,r)=>{"use strict";var n=t;function s(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(88482),n.BufferWriter=r(95628),n.Reader=r(29958),n.BufferReader=r(73055),n.util=r(61436),n.rpc=r(13971),n.roots=r(59149),n.configure=s,s()},29958:(e,t,r)=>{"use strict";e.exports=c;var n,s=r(61436),i=s.LongBits,o=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var h,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return s.Buffer?function(e){return(c.create=function(e){return s.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function d(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,c.prototype.uint32=(h=4294967295,function(){if(h=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return h;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return h}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=u(),n._configure();var t=s.Long?"toLong":"toNumber";s.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},73055:(e,t,r)=>{"use strict";e.exports=i;var n=r(29958);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(61436);function i(e){n.call(this,e)}i._configure=function(){s.Buffer&&(i.prototype._slice=s.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},59149:e=>{"use strict";e.exports={}},13971:(e,t,r)=>{"use strict";t.Service=r(98295)},98295:(e,t,r)=>{"use strict";e.exports=s;var n=r(61436);function s(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(s.prototype=Object.create(n.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,r,s,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,s,i);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof s))try{r=s[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},19961:(e,t,r)=>{"use strict";e.exports=s;var n=r(61436);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=s.zero=new s(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new s(r,n)},s.from=function(e){if("number"==typeof e)return s.fromNumber(e);if(n.isString(e)){if(!n.Long)return s.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):i},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?i:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},61436:function(e,t,r){"use strict";var n=t;function s(e,t,r){for(var n=Object.keys(t),s=0;s<n.length;++s)void 0!==e[n[s]]&&r||(e[n[s]]=t[n[s]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&s(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=r(34537),n.base64=r(97419),n.EventEmitter=r(19211),n.float=r(10945),n.inquire=r(67199),n.utf8=r(94997),n.pool=r(76662),n.LongBits=r(19961),n.isNode=Boolean("undefined"!=typeof window&&window&&window.process&&window.process.versions&&window.process.versions.node),n.global=n.isNode&&window||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},88482:(e,t,r)=>{"use strict";e.exports=u;var n,s=r(61436),i=s.LongBits,o=s.base64,a=s.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function h(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new c(h,0,0),this.tail=this.head,this.states=null}var d=function(){return s.Buffer?function(){return(u.create=function(){return new n})()}:function(){return new u}};function f(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}u.create=d(),u.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(u.alloc=s.pool(u.alloc,s.Array.prototype.subarray)),u.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(y,10,i.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=i.from(e);return this._push(y,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(y,t.length(),t)},u.prototype.bool=function(e){return this._push(f,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var b=s.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(s.isString(e)){var r=u.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(b,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},u.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(h,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(h,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},u._configure=function(e){n=e,u.create=d(),n._configure()}},95628:(e,t,r)=>{"use strict";e.exports=i;var n=r(88482);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(61436);function i(){n.call(this)}function o(e,t,r){e.length<40?s.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=s._Buffer_allocUnsafe,i.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},15999:e=>{"use strict";e.exports=async e=>{for await(const t of e);}},72533:e=>{"use strict";e.exports=async e=>{for await(const t of e)return t}},28580:(e,t,r)=>{"use strict";const n=r(89261);e.exports=async function*(...e){const t=n();setTimeout((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(e){t.end(e)}}),0),yield*t}},89261:(e,t,r)=>{const n=r(91607);e.exports=e=>{let t;"function"==typeof(e=e||{})?(t=e,e={}):t=e.onEnd;let r,s,i,o=new n;const a=e=>s?s(e):(o.push(e),r),c=e=>i?r:a({done:!1,value:e}),h=e=>i?r:(i=!0,e?(e=>(o=new n,s?s({error:e}):(o.push({error:e}),r)))(e):a({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:()=>{if(!o.isEmpty()){if(e.writev){let e;const t=[];for(;!o.isEmpty();){if(e=o.shift(),e.error)throw e.error;t.push(e.value)}return{done:e.done,value:t}}const t=o.shift();if(t.error)throw t.error;return t}return i?{done:!0}:new Promise(((t,n)=>{s=i=>(s=null,i.error?n(i.error):e.writev&&!i.done?t({done:i.done,value:[i.value]}):t(i),r)}))},return:()=>(o=new n,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:c,end:h},!t)return r;const l=r;return r={[Symbol.asyncIterator](){return this},next:()=>l.next(),throw:e=>(l.throw(e),t&&(t(e),t=null),{done:!0}),return:()=>(l.return(),t&&(t(),t=null),{done:!0}),push:c,end:e=>(l.end(e),t&&(t(e),t=null),r)},r}},71783:e=>{"use strict";e.exports=async e=>{const t=[];for await(const r of e)t.push(r);return t}},2606:e=>{"use strict";e.exports=async function*(e,t){for await(const r of e)await t(r)&&(yield r)}},63192:e=>{"use strict";e.exports=async function*(e,t){for await(const r of e)await t(r),yield r}},48128:e=>{"use strict";e.exports=async function*(e,t){for await(const r of e)yield t(r)}},28820:e=>{"use strict";e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var s=e.charAt(n),i=s.charCodeAt(0);if(255!==t[i])throw new TypeError(s+" is ambiguous");t[i]=n}var o=e.length,a=e.charAt(0),c=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function l(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,s=0;e[r]===a;)n++,r++;for(var i=(e.length-r)*c+1>>>0,h=new Uint8Array(i);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=o*h[d]>>>0,h[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,r++}if(" "!==e[r]){for(var f=i-s;f!==i&&0===h[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=h[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var c=(i-s)*h+1>>>0,l=new Uint8Array(c);s!==i;){for(var u=t[s],d=0,f=c-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*l[f]>>>0,l[f]=u%o>>>0,u=u/o>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=c-n;p!==c&&0===l[p];)p++;for(var y=a.repeat(r);p<c;++p)y+=e.charAt(l[p]);return y},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw new Error("Non-base"+o+" character")}}}},34537:e=>{"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),n=0,s=2,i=!0;for(;s<arguments.length;)r[n++]=arguments[s++];return new Promise((function(s,o){r[n]=function(e){if(i)if(i=!1,e)o(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];s.apply(null,t)}};try{e.apply(t||null,r)}catch(e){i&&(i=!1,o(e))}}))}},97419:(e,t)=>{"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),s=new Array(123),i=0;i<64;)s[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;r.encode=function(e,t,r){for(var s,i=null,o=[],a=0,c=0;t<r;){var h=e[t++];switch(c){case 0:o[a++]=n[h>>2],s=(3&h)<<4,c=1;break;case 1:o[a++]=n[s|h>>4],s=(15&h)<<2,c=2;break;case 2:o[a++]=n[s|h>>6],o[a++]=n[63&h],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=n[s],o[a++]=61,1===c&&(o[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var o="invalid encoding";r.decode=function(e,t,r){for(var n,i=r,a=0,c=0;c<e.length;){var h=e.charCodeAt(c++);if(61===h&&a>1)break;if(void 0===(h=s[h]))throw Error(o);switch(a){case 0:n=h,a=1;break;case 1:t[r++]=n<<2|(48&h)>>4,n=h,a=2;break;case 2:t[r++]=(15&n)<<4|(60&h)>>2,n=h,a=3;break;case 3:t[r++]=(3&n)<<6|h,a=0}}if(1===a)throw Error(o);return r-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},19211:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},10945:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function s(e,n,s){t[0]=e,n[s]=r[0],n[s+1]=r[1],n[s+2]=r[2],n[s+3]=r[3]}function i(e,n,s){t[0]=e,n[s]=r[3],n[s+1]=r[2],n[s+2]=r[1],n[s+3]=r[0]}function o(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?s:i,e.writeFloatBE=n?i:s,e.readFloatLE=n?o:a,e.readFloatBE=n?a:o}():function(){function t(e,t,r,n){var s=t<0?1:0;if(s&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((s<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((s<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var i=Math.floor(Math.log(t)/Math.LN2);e((s<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,r,n)}}function o(e,t,r){var n=e(t,r),s=2*(n>>31)+1,i=n>>>23&255,o=8388607&n;return 255===i?o?NaN:s*(1/0):0===i?1401298464324817e-60*s*o:s*Math.pow(2,i-150)*(o+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=o.bind(null,s),e.readFloatBE=o.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function s(e,n,s){t[0]=e,n[s]=r[0],n[s+1]=r[1],n[s+2]=r[2],n[s+3]=r[3],n[s+4]=r[4],n[s+5]=r[5],n[s+6]=r[6],n[s+7]=r[7]}function i(e,n,s){t[0]=e,n[s]=r[7],n[s+1]=r[6],n[s+2]=r[5],n[s+3]=r[4],n[s+4]=r[3],n[s+5]=r[2],n[s+6]=r[1],n[s+7]=r[0]}function o(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?s:i,e.writeDoubleBE=n?i:s,e.readDoubleLE=n?o:a,e.readDoubleBE=n?a:o}():function(){function t(e,t,r,n,s,i){var o=n<0?1:0;if(o&&(n=-n),0===n)e(0,s,i+t),e(1/n>0?0:2147483648,s,i+r);else if(isNaN(n))e(0,s,i+t),e(2146959360,s,i+r);else if(n>17976931348623157e292)e(0,s,i+t),e((o<<31|2146435072)>>>0,s,i+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,s,i+t),e((o<<31|a/4294967296)>>>0,s,i+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,s,i+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,s,i+r)}}}function o(e,t,r,n,s){var i=e(n,s+t),o=e(n,s+r),a=2*(o>>31)+1,c=o>>>20&2047,h=4294967296*(1048575&o)+i;return 2047===c?h?NaN:a*(1/0):0===c?5e-324*a*h:a*Math.pow(2,c-1075)*(h+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=o.bind(null,s,0,4),e.readDoubleBE=o.bind(null,i,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},67199:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},76662:e=>{"use strict";e.exports=function(e,t,r){var n=r||8192,s=n>>>1,i=null,o=n;return function(r){if(r<1||r>s)return e(r);o+r>n&&(i=e(n),o=0);var a=t.call(i,o,o+=r);return 7&o&&(o=1+(7|o)),a}}},94997:(e,t)=>{"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,s=null,i=[],o=0;t<r;)(n=e[t++])<128?i[o++]=n:n>191&&n<224?i[o++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[o++]=55296+(n>>10),i[o++]=56320+(1023&n)):i[o++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,i)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))},r.write=function(e,t,r){for(var n,s,i=r,o=0;o<e.length;++o)(n=e.charCodeAt(o))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(s=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&s),++o,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-i}},43063:(e,t)=>{function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}t.Q=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var s=0;s<n.length;s++)if((r=n[s])===t||r.fn===t){n.splice(s,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var s=(r=r.slice(0)).length;n<s;++n)r[n].apply(this,t)}return this},r.prototype.emitReserved=r.prototype.emit,r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},98099:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(97117);function s(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function i(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function o(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function a(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function c(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function h(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function l(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function u(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function d(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),l(e/4294967296>>>0,t,r),l(e>>>0,t,r+4),t}function f(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),u(e>>>0,t,r),u(e/4294967296>>>0,t,r+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=s,t.writeInt16BE=s,t.writeUint16LE=i,t.writeInt16LE=i,t.readInt32BE=o,t.readUint32BE=a,t.readInt32LE=c,t.readUint32LE=h,t.writeUint32BE=l,t.writeInt32BE=l,t.writeUint32LE=u,t.writeInt32LE=u,t.readInt64BE=function(e,t){void 0===t&&(t=0);var r=o(e,t),n=o(e,t+4);return 4294967296*r+n-4294967296*(n>>31)},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*a(e,t)+a(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var r=c(e,t);return 4294967296*c(e,t+4)+r-4294967296*(r>>31)},t.readUint64LE=function(e,t){void 0===t&&(t=0);var r=h(e,t);return 4294967296*h(e,t+4)+r},t.writeUint64BE=d,t.writeInt64BE=d,t.writeUint64LE=f,t.writeInt64LE=f,t.readUintBE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,s=1,i=e/8+r-1;i>=r;i--)n+=t[i]*s,s*=256;return n},t.readUintLE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,s=1,i=r;i<r+e/8;i++)n+=t[i]*s,s*=256;return n},t.writeUintBE=function(e,t,r,s){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===s&&(s=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,o=e/8+s-1;o>=s;o--)r[o]=t/i&255,i*=256;return r},t.writeUintLE=function(e,t,r,s){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===s&&(s=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,o=s;o<s+e/8;o++)r[o]=t/i&255,i*=256;return r},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e),t},t.writeFloat32LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e,!0),t},t.writeFloat64BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e),t},t.writeFloat64LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e,!0),t}},25439:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(98099),s=r(17309);function i(e,t,r){for(var s=1634760805,i=857760878,o=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],d=r[19]<<24|r[18]<<16|r[17]<<8|r[16],f=r[23]<<24|r[22]<<16|r[21]<<8|r[20],p=r[27]<<24|r[26]<<16|r[25]<<8|r[24],y=r[31]<<24|r[30]<<16|r[29]<<8|r[28],g=t[3]<<24|t[2]<<16|t[1]<<8|t[0],b=t[7]<<24|t[6]<<16|t[5]<<8|t[4],m=t[11]<<24|t[10]<<16|t[9]<<8|t[8],w=t[15]<<24|t[14]<<16|t[13]<<8|t[12],v=s,E=i,A=o,S=a,_=c,C=h,k=l,I=u,T=d,x=f,R=p,P=y,D=g,O=b,N=m,L=w,U=0;U<20;U+=2)_=(_^=T=T+(D=(D^=v=v+_|0)>>>16|D<<16)|0)>>>20|_<<12,C=(C^=x=x+(O=(O^=E=E+C|0)>>>16|O<<16)|0)>>>20|C<<12,k=(k^=R=R+(N=(N^=A=A+k|0)>>>16|N<<16)|0)>>>20|k<<12,I=(I^=P=P+(L=(L^=S=S+I|0)>>>16|L<<16)|0)>>>20|I<<12,k=(k^=R=R+(N=(N^=A=A+k|0)>>>24|N<<8)|0)>>>25|k<<7,I=(I^=P=P+(L=(L^=S=S+I|0)>>>24|L<<8)|0)>>>25|I<<7,C=(C^=x=x+(O=(O^=E=E+C|0)>>>24|O<<8)|0)>>>25|C<<7,_=(_^=T=T+(D=(D^=v=v+_|0)>>>24|D<<8)|0)>>>25|_<<7,C=(C^=R=R+(L=(L^=v=v+C|0)>>>16|L<<16)|0)>>>20|C<<12,k=(k^=P=P+(D=(D^=E=E+k|0)>>>16|D<<16)|0)>>>20|k<<12,I=(I^=T=T+(O=(O^=A=A+I|0)>>>16|O<<16)|0)>>>20|I<<12,_=(_^=x=x+(N=(N^=S=S+_|0)>>>16|N<<16)|0)>>>20|_<<12,I=(I^=T=T+(O=(O^=A=A+I|0)>>>24|O<<8)|0)>>>25|I<<7,_=(_^=x=x+(N=(N^=S=S+_|0)>>>24|N<<8)|0)>>>25|_<<7,k=(k^=P=P+(D=(D^=E=E+k|0)>>>24|D<<8)|0)>>>25|k<<7,C=(C^=R=R+(L=(L^=v=v+C|0)>>>24|L<<8)|0)>>>25|C<<7;n.writeUint32LE(v+s|0,e,0),n.writeUint32LE(E+i|0,e,4),n.writeUint32LE(A+o|0,e,8),n.writeUint32LE(S+a|0,e,12),n.writeUint32LE(_+c|0,e,16),n.writeUint32LE(C+h|0,e,20),n.writeUint32LE(k+l|0,e,24),n.writeUint32LE(I+u|0,e,28),n.writeUint32LE(T+d|0,e,32),n.writeUint32LE(x+f|0,e,36),n.writeUint32LE(R+p|0,e,40),n.writeUint32LE(P+y|0,e,44),n.writeUint32LE(D+g|0,e,48),n.writeUint32LE(O+b|0,e,52),n.writeUint32LE(N+m|0,e,56),n.writeUint32LE(L+w|0,e,60)}function o(e,t,r,n,o){if(void 0===o&&(o=0),32!==e.length)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var c,h;if(0===o){if(8!==t.length&&12!==t.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");h=(c=new Uint8Array(16)).length-t.length,c.set(t,h)}else{if(16!==t.length)throw new Error("ChaCha nonce with counter must be 16 bytes");c=t,h=o}for(var l=new Uint8Array(64),u=0;u<r.length;u+=64){i(l,c,e);for(var d=u;d<u+64&&d<r.length;d++)n[d]=r[d]^l[d-u];a(c,0,h)}return s.wipe(l),0===o&&s.wipe(c),n}function a(e,t,r){for(var n=1;r--;)n=n+(255&e[t])|0,e[t]=255&n,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}t.streamXOR=o,t.stream=function(e,t,r,n){return void 0===n&&(n=0),s.wipe(r),o(e,t,r,r,n)}},15501:(e,t,r)=>{"use strict";var n=r(25439),s=r(63027),i=r(17309),o=r(98099),a=r(4153);t.Cv=32,t.WH=12,t.pg=16;var c=new Uint8Array(16),h=function(){function e(e){if(this.nonceLength=t.WH,this.tagLength=t.pg,e.length!==t.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,r,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var a=new Uint8Array(32);n.stream(this._key,o,a,4);var c,h=t.length+this.tagLength;if(s){if(s.length!==h)throw new Error("ChaCha20Poly1305: incorrect destination length");c=s}else c=new Uint8Array(h);return n.streamXOR(this._key,o,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),r),i.wipe(o),c},e.prototype.open=function(e,t,r,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var o=new Uint8Array(16);o.set(e,o.length-e.length);var c=new Uint8Array(32);n.stream(this._key,o,c,4);var h=new Uint8Array(this.tagLength);if(this._authenticate(h,c,t.subarray(0,t.length-this.tagLength),r),!a.equal(h,t.subarray(t.length-this.tagLength,t.length)))return null;var l,u=t.length-this.tagLength;if(s){if(s.length!==u)throw new Error("ChaCha20Poly1305: incorrect destination length");l=s}else l=new Uint8Array(u);return n.streamXOR(this._key,o,t.subarray(0,t.length-this.tagLength),l,4),i.wipe(o),l},e.prototype.clean=function(){return i.wipe(this._key),this},e.prototype._authenticate=function(e,t,r,n){var a=new s.Poly1305(t);n&&(a.update(n),n.length%16>0&&a.update(c.subarray(n.length%16))),a.update(r),r.length%16>0&&a.update(c.subarray(r.length%16));var h=new Uint8Array(8);n&&o.writeUint64LE(n.length,h),a.update(h),o.writeUint64LE(r.length,h),a.update(h);for(var l=a.digest(),u=0;u<l.length;u++)e[u]=l[u];a.clean(),i.wipe(l),i.wipe(h)},e}();t.OK=h},4153:(e,t)=>{"use strict";function r(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Object.defineProperty(t,"__esModule",{value:!0}),t.select=function(e,t,r){return~(e-1)&t|e-1&r},t.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},t.compare=r,t.equal=function(e,t){return 0!==e.length&&0!==t.length&&0!==r(e,t)}},79984:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableHash=function(e){return void 0!==e.saveState&&void 0!==e.restoreState&&void 0!==e.cleanSavedState}},512:(e,t,r)=>{"use strict";var n=r(25629),s=r(17309),i=function(){function e(e,t,r,s){void 0===r&&(r=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=s;var i=n.hmac(this._hash,r,t);this._hmac=new n.HMAC(e,i),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(e){for(var t=new Uint8Array(e),r=0;r<t.length;r++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[r]=this._buffer[this._bufpos++];return t},e.prototype.clean=function(){this._hmac.clean(),s.wipe(this._buffer),s.wipe(this._counter),this._bufpos=0},e}();t.t=i},25629:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(79984),s=r(4153),i=r(17309),o=function(){function e(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var r=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(r).clean():r.set(t);for(var s=0;s<r.length;s++)r[s]^=54;this._inner.update(r);for(s=0;s<r.length;s++)r[s]^=106;this._outer.update(r),n.isSerializableHash(this._inner)&&n.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),i.wipe(r)}return e.prototype.reset=function(){if(!n.isSerializableHash(this._inner)||!n.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){n.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),n.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(e){return this._inner.update(e),this},e.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(!n.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(e){if(!n.isSerializableHash(this._inner)||!n.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(e){if(!n.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},e}();t.HMAC=o,t.hmac=function(e,t,r){var n=new o(e,t);n.update(r);var s=n.digest();return n.clean(),s},t.equal=s.equal},97117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},63027:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4153),s=r(17309);t.DIGEST_LENGTH=16;var i=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=8191&r;var n=e[2]|e[3]<<8;this._r[1]=8191&(r>>>13|n<<3);var s=e[4]|e[5]<<8;this._r[2]=7939&(n>>>10|s<<6);var i=e[6]|e[7]<<8;this._r[3]=8191&(s>>>7|i<<9);var o=e[8]|e[9]<<8;this._r[4]=255&(i>>>4|o<<12),this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=8191&(o>>>14|a<<2);var c=e[12]|e[13]<<8;this._r[7]=8065&(a>>>11|c<<5);var h=e[14]|e[15]<<8;this._r[8]=8191&(c>>>8|h<<8),this._r[9]=h>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,r){for(var n=this._fin?0:2048,s=this._h[0],i=this._h[1],o=this._h[2],a=this._h[3],c=this._h[4],h=this._h[5],l=this._h[6],u=this._h[7],d=this._h[8],f=this._h[9],p=this._r[0],y=this._r[1],g=this._r[2],b=this._r[3],m=this._r[4],w=this._r[5],v=this._r[6],E=this._r[7],A=this._r[8],S=this._r[9];r>=16;){var _=e[t+0]|e[t+1]<<8;s+=8191&_;var C=e[t+2]|e[t+3]<<8;i+=8191&(_>>>13|C<<3);var k=e[t+4]|e[t+5]<<8;o+=8191&(C>>>10|k<<6);var I=e[t+6]|e[t+7]<<8;a+=8191&(k>>>7|I<<9);var T=e[t+8]|e[t+9]<<8;c+=8191&(I>>>4|T<<12),h+=T>>>1&8191;var x=e[t+10]|e[t+11]<<8;l+=8191&(T>>>14|x<<2);var R=e[t+12]|e[t+13]<<8;u+=8191&(x>>>11|R<<5);var P=e[t+14]|e[t+15]<<8,D=0,O=D;O+=s*p,O+=i*(5*S),O+=o*(5*A),O+=a*(5*E),D=(O+=c*(5*v))>>>13,O&=8191,O+=h*(5*w),O+=l*(5*m),O+=u*(5*b),O+=(d+=8191&(R>>>8|P<<8))*(5*g);var N=D+=(O+=(f+=P>>>5|n)*(5*y))>>>13;N+=s*y,N+=i*p,N+=o*(5*S),N+=a*(5*A),D=(N+=c*(5*E))>>>13,N&=8191,N+=h*(5*v),N+=l*(5*w),N+=u*(5*m),N+=d*(5*b),D+=(N+=f*(5*g))>>>13,N&=8191;var L=D;L+=s*g,L+=i*y,L+=o*p,L+=a*(5*S),D=(L+=c*(5*A))>>>13,L&=8191,L+=h*(5*E),L+=l*(5*v),L+=u*(5*w),L+=d*(5*m);var U=D+=(L+=f*(5*b))>>>13;U+=s*b,U+=i*g,U+=o*y,U+=a*p,D=(U+=c*(5*S))>>>13,U&=8191,U+=h*(5*A),U+=l*(5*E),U+=u*(5*v),U+=d*(5*w);var B=D+=(U+=f*(5*m))>>>13;B+=s*m,B+=i*b,B+=o*g,B+=a*y,D=(B+=c*p)>>>13,B&=8191,B+=h*(5*S),B+=l*(5*A),B+=u*(5*E),B+=d*(5*v);var M=D+=(B+=f*(5*w))>>>13;M+=s*w,M+=i*m,M+=o*b,M+=a*g,D=(M+=c*y)>>>13,M&=8191,M+=h*p,M+=l*(5*S),M+=u*(5*A),M+=d*(5*E);var V=D+=(M+=f*(5*v))>>>13;V+=s*v,V+=i*w,V+=o*m,V+=a*b,D=(V+=c*g)>>>13,V&=8191,V+=h*y,V+=l*p,V+=u*(5*S),V+=d*(5*A);var z=D+=(V+=f*(5*E))>>>13;z+=s*E,z+=i*v,z+=o*w,z+=a*m,D=(z+=c*b)>>>13,z&=8191,z+=h*g,z+=l*y,z+=u*p,z+=d*(5*S);var j=D+=(z+=f*(5*A))>>>13;j+=s*A,j+=i*E,j+=o*v,j+=a*w,D=(j+=c*m)>>>13,j&=8191,j+=h*b,j+=l*g,j+=u*y,j+=d*p;var F=D+=(j+=f*(5*S))>>>13;F+=s*S,F+=i*A,F+=o*E,F+=a*v,D=(F+=c*w)>>>13,F&=8191,F+=h*m,F+=l*b,F+=u*g,F+=d*y,s=O=8191&(D=(D=((D+=(F+=f*p)>>>13)<<2)+D|0)+(O&=8191)|0),i=N+=D>>>=13,o=L&=8191,a=U&=8191,c=B&=8191,h=M&=8191,l=V&=8191,u=z&=8191,d=j&=8191,f=F&=8191,t+=16,r-=16}this._h[0]=s,this._h[1]=i,this._h[2]=o,this._h[3]=a,this._h[4]=c,this._h[5]=h,this._h[6]=l,this._h[7]=u,this._h[8]=d,this._h[9]=f},e.prototype.finish=function(e,t){void 0===t&&(t=0);var r,n,s,i,o=new Uint16Array(10);if(this._leftover){for(i=this._leftover,this._buffer[i++]=1;i<16;i++)this._buffer[i]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,i=2;i<10;i++)this._h[i]+=r,r=this._h[i]>>>13,this._h[i]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,o[0]=this._h[0]+5,r=o[0]>>>13,o[0]&=8191,i=1;i<10;i++)o[i]=this._h[i]+r,r=o[i]>>>13,o[i]&=8191;for(o[9]-=8192,n=(1^r)-1,i=0;i<10;i++)o[i]&=n;for(n=~n,i=0;i<10;i++)this._h[i]=this._h[i]&n|o[i];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),s=this._h[0]+this._pad[0],this._h[0]=65535&s,i=1;i<8;i++)s=(this._h[i]+this._pad[i]|0)+(s>>>16)|0,this._h[i]=65535&s;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,r=0,n=e.length;if(this._leftover){(t=16-this._leftover)>n&&(t=n);for(var s=0;s<t;s++)this._buffer[this._leftover+s]=e[r+s];if(n-=t,r+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(t=n-n%16,this._blocks(e,r,t),r+=t,n-=t),n){for(s=0;s<n;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return s.wipe(this._buffer),s.wipe(this._r),s.wipe(this._h),s.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();t.Poly1305=i,t.oneTimeAuth=function(e,t){var r=new i(e);r.update(t);var n=r.digest();return r.clean(),n},t.equal=function(e,r){return e.length===t.DIGEST_LENGTH&&r.length===t.DIGEST_LENGTH&&n.equal(e,r)}},31416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const n=r(46008),s=r(98099),i=r(17309);function o(e,r=t.defaultRandomSource){return r.randomBytes(e)}t.defaultRandomSource=new n.SystemRandomSource,t.randomBytes=o,t.randomUint32=function(e=t.defaultRandomSource){const r=o(4,e),n=(0,s.readUint32LE)(r);return(0,i.wipe)(r),n};const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(e,r=a,n=t.defaultRandomSource){if(r.length<2)throw new Error("randomString charset is too short");if(r.length>256)throw new Error("randomString charset is too long");let s="";const c=r.length,h=256-256%c;for(;e>0;){const t=o(Math.ceil(256*e/h),n);for(let n=0;n<t.length&&e>0;n++){const i=t[n];i<h&&(s+=r.charAt(i%c),e--)}(0,i.wipe)(t)}return s}t.randomString=c,t.randomStringForEntropy=function(e,r=a,n=t.defaultRandomSource){return c(Math.ceil(e/(Math.log(r.length)/Math.LN2)),r,n)}},75455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0;t.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let e=0;e<t.length;e+=65536)this._crypto.getRandomValues(t.subarray(e,e+Math.min(t.length-e,65536)));return t}}},58871:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;const n=r(17309);t.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=r(35883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const r=new Uint8Array(e);for(let e=0;e<r.length;e++)r[e]=t[e];return(0,n.wipe)(t),r}}},46008:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;const n=r(75455),s=r(58871);t.SystemRandomSource=class{constructor(){return this.isAvailable=!1,this.name="",this._source=new n.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new s.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}},73294:(e,t,r)=>{"use strict";var n=r(98099),s=r(17309);t.k=32,t.cn=64;var i=function(){function e(){this.digestLength=t.k,this.blockSize=t.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){s.wipe(this._buffer),s.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var r=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[r++],t--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(r=a(this._temp,this._state,e,r,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[r++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,r=this._bufferLength,s=t/536870912|0,i=t<<3,o=t%64<56?64:128;this._buffer[r]=128;for(var c=r+1;c<o-8;c++)this._buffer[c]=0;n.writeUint32BE(s,this._buffer,o-8),n.writeUint32BE(i,this._buffer,o-4),a(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(c=0;c<this.digestLength/4;c++)n.writeUint32BE(this._state[c],e,4*c);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){s.wipe(e.state),e.buffer&&s.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.mE=i;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(e,t,r,s,i){for(;i>=64;){for(var a=t[0],c=t[1],h=t[2],l=t[3],u=t[4],d=t[5],f=t[6],p=t[7],y=0;y<16;y++){var g=s+4*y;e[y]=n.readUint32BE(r,g)}for(y=16;y<64;y++){var b=e[y-2],m=(b>>>17|b<<15)^(b>>>19|b<<13)^b>>>10,w=((b=e[y-15])>>>7|b<<25)^(b>>>18|b<<14)^b>>>3;e[y]=(m+e[y-7]|0)+(w+e[y-16]|0)}for(y=0;y<64;y++){m=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&d^~u&f)|0)+(p+(o[y]+e[y]|0)|0)|0,w=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&c^a&h^c&h)|0;p=f,f=d,d=u,u=l+m|0,l=h,h=c,c=a,a=m+w|0}t[0]+=a,t[1]+=c,t[2]+=h,t[3]+=l,t[4]+=u,t[5]+=d,t[6]+=f,t[7]+=p,s+=64,i-=64}return s}t.vp=function(e){var t=new i;t.update(e);var r=t.digest();return t.clean(),r}},17309:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},57664:(e,t,r)=>{"use strict";t.gi=t.Au=t._w=t.KS=t.kz=void 0;const n=r(31416),s=r(17309);function i(e){const t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}t.kz=32,t.KS=32;const o=new Uint8Array(32);o[0]=9;const a=i([56129,1]);function c(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-65536*t}e[0]+=t-1+37*(t-1)}function h(e,t,r){const n=~(r-1);for(let r=0;r<16;r++){const s=n&(e[r]^t[r]);e[r]^=s,t[r]^=s}}function l(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function u(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function d(e,t,r){let n,s,i=0,o=0,a=0,c=0,h=0,l=0,u=0,d=0,f=0,p=0,y=0,g=0,b=0,m=0,w=0,v=0,E=0,A=0,S=0,_=0,C=0,k=0,I=0,T=0,x=0,R=0,P=0,D=0,O=0,N=0,L=0,U=r[0],B=r[1],M=r[2],V=r[3],z=r[4],j=r[5],F=r[6],$=r[7],q=r[8],K=r[9],H=r[10],G=r[11],W=r[12],J=r[13],Y=r[14],Q=r[15];n=t[0],i+=n*U,o+=n*B,a+=n*M,c+=n*V,h+=n*z,l+=n*j,u+=n*F,d+=n*$,f+=n*q,p+=n*K,y+=n*H,g+=n*G,b+=n*W,m+=n*J,w+=n*Y,v+=n*Q,n=t[1],o+=n*U,a+=n*B,c+=n*M,h+=n*V,l+=n*z,u+=n*j,d+=n*F,f+=n*$,p+=n*q,y+=n*K,g+=n*H,b+=n*G,m+=n*W,w+=n*J,v+=n*Y,E+=n*Q,n=t[2],a+=n*U,c+=n*B,h+=n*M,l+=n*V,u+=n*z,d+=n*j,f+=n*F,p+=n*$,y+=n*q,g+=n*K,b+=n*H,m+=n*G,w+=n*W,v+=n*J,E+=n*Y,A+=n*Q,n=t[3],c+=n*U,h+=n*B,l+=n*M,u+=n*V,d+=n*z,f+=n*j,p+=n*F,y+=n*$,g+=n*q,b+=n*K,m+=n*H,w+=n*G,v+=n*W,E+=n*J,A+=n*Y,S+=n*Q,n=t[4],h+=n*U,l+=n*B,u+=n*M,d+=n*V,f+=n*z,p+=n*j,y+=n*F,g+=n*$,b+=n*q,m+=n*K,w+=n*H,v+=n*G,E+=n*W,A+=n*J,S+=n*Y,_+=n*Q,n=t[5],l+=n*U,u+=n*B,d+=n*M,f+=n*V,p+=n*z,y+=n*j,g+=n*F,b+=n*$,m+=n*q,w+=n*K,v+=n*H,E+=n*G,A+=n*W,S+=n*J,_+=n*Y,C+=n*Q,n=t[6],u+=n*U,d+=n*B,f+=n*M,p+=n*V,y+=n*z,g+=n*j,b+=n*F,m+=n*$,w+=n*q,v+=n*K,E+=n*H,A+=n*G,S+=n*W,_+=n*J,C+=n*Y,k+=n*Q,n=t[7],d+=n*U,f+=n*B,p+=n*M,y+=n*V,g+=n*z,b+=n*j,m+=n*F,w+=n*$,v+=n*q,E+=n*K,A+=n*H,S+=n*G,_+=n*W,C+=n*J,k+=n*Y,I+=n*Q,n=t[8],f+=n*U,p+=n*B,y+=n*M,g+=n*V,b+=n*z,m+=n*j,w+=n*F,v+=n*$,E+=n*q,A+=n*K,S+=n*H,_+=n*G,C+=n*W,k+=n*J,I+=n*Y,T+=n*Q,n=t[9],p+=n*U,y+=n*B,g+=n*M,b+=n*V,m+=n*z,w+=n*j,v+=n*F,E+=n*$,A+=n*q,S+=n*K,_+=n*H,C+=n*G,k+=n*W,I+=n*J,T+=n*Y,x+=n*Q,n=t[10],y+=n*U,g+=n*B,b+=n*M,m+=n*V,w+=n*z,v+=n*j,E+=n*F,A+=n*$,S+=n*q,_+=n*K,C+=n*H,k+=n*G,I+=n*W,T+=n*J,x+=n*Y,R+=n*Q,n=t[11],g+=n*U,b+=n*B,m+=n*M,w+=n*V,v+=n*z,E+=n*j,A+=n*F,S+=n*$,_+=n*q,C+=n*K,k+=n*H,I+=n*G,T+=n*W,x+=n*J,R+=n*Y,P+=n*Q,n=t[12],b+=n*U,m+=n*B,w+=n*M,v+=n*V,E+=n*z,A+=n*j,S+=n*F,_+=n*$,C+=n*q,k+=n*K,I+=n*H,T+=n*G,x+=n*W,R+=n*J,P+=n*Y,D+=n*Q,n=t[13],m+=n*U,w+=n*B,v+=n*M,E+=n*V,A+=n*z,S+=n*j,_+=n*F,C+=n*$,k+=n*q,I+=n*K,T+=n*H,x+=n*G,R+=n*W,P+=n*J,D+=n*Y,O+=n*Q,n=t[14],w+=n*U,v+=n*B,E+=n*M,A+=n*V,S+=n*z,_+=n*j,C+=n*F,k+=n*$,I+=n*q,T+=n*K,x+=n*H,R+=n*G,P+=n*W,D+=n*J,O+=n*Y,N+=n*Q,n=t[15],v+=n*U,E+=n*B,A+=n*M,S+=n*V,_+=n*z,C+=n*j,k+=n*F,I+=n*$,T+=n*q,x+=n*K,R+=n*H,P+=n*G,D+=n*W,O+=n*J,N+=n*Y,L+=n*Q,i+=38*E,o+=38*A,a+=38*S,c+=38*_,h+=38*C,l+=38*k,u+=38*I,d+=38*T,f+=38*x,p+=38*R,y+=38*P,g+=38*D,b+=38*O,m+=38*N,w+=38*L,s=1,n=i+s+65535,s=Math.floor(n/65536),i=n-65536*s,n=o+s+65535,s=Math.floor(n/65536),o=n-65536*s,n=a+s+65535,s=Math.floor(n/65536),a=n-65536*s,n=c+s+65535,s=Math.floor(n/65536),c=n-65536*s,n=h+s+65535,s=Math.floor(n/65536),h=n-65536*s,n=l+s+65535,s=Math.floor(n/65536),l=n-65536*s,n=u+s+65535,s=Math.floor(n/65536),u=n-65536*s,n=d+s+65535,s=Math.floor(n/65536),d=n-65536*s,n=f+s+65535,s=Math.floor(n/65536),f=n-65536*s,n=p+s+65535,s=Math.floor(n/65536),p=n-65536*s,n=y+s+65535,s=Math.floor(n/65536),y=n-65536*s,n=g+s+65535,s=Math.floor(n/65536),g=n-65536*s,n=b+s+65535,s=Math.floor(n/65536),b=n-65536*s,n=m+s+65535,s=Math.floor(n/65536),m=n-65536*s,n=w+s+65535,s=Math.floor(n/65536),w=n-65536*s,n=v+s+65535,s=Math.floor(n/65536),v=n-65536*s,i+=s-1+37*(s-1),s=1,n=i+s+65535,s=Math.floor(n/65536),i=n-65536*s,n=o+s+65535,s=Math.floor(n/65536),o=n-65536*s,n=a+s+65535,s=Math.floor(n/65536),a=n-65536*s,n=c+s+65535,s=Math.floor(n/65536),c=n-65536*s,n=h+s+65535,s=Math.floor(n/65536),h=n-65536*s,n=l+s+65535,s=Math.floor(n/65536),l=n-65536*s,n=u+s+65535,s=Math.floor(n/65536),u=n-65536*s,n=d+s+65535,s=Math.floor(n/65536),d=n-65536*s,n=f+s+65535,s=Math.floor(n/65536),f=n-65536*s,n=p+s+65535,s=Math.floor(n/65536),p=n-65536*s,n=y+s+65535,s=Math.floor(n/65536),y=n-65536*s,n=g+s+65535,s=Math.floor(n/65536),g=n-65536*s,n=b+s+65535,s=Math.floor(n/65536),b=n-65536*s,n=m+s+65535,s=Math.floor(n/65536),m=n-65536*s,n=w+s+65535,s=Math.floor(n/65536),w=n-65536*s,n=v+s+65535,s=Math.floor(n/65536),v=n-65536*s,i+=s-1+37*(s-1),e[0]=i,e[1]=o,e[2]=a,e[3]=c,e[4]=h,e[5]=l,e[6]=u,e[7]=d,e[8]=f,e[9]=p,e[10]=y,e[11]=g,e[12]=b,e[13]=m,e[14]=w,e[15]=v}function f(e,t){d(e,t,t)}function p(e,t){const r=new Uint8Array(32),n=new Float64Array(80),s=i(),o=i(),p=i(),y=i(),g=i(),b=i();for(let t=0;t<31;t++)r[t]=e[t];r[31]=127&e[31]|64,r[0]&=248,function(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(n,t);for(let e=0;e<16;e++)o[e]=n[e];s[0]=y[0]=1;for(let e=254;e>=0;--e){const t=r[e>>>3]>>>(7&e)&1;h(s,o,t),h(p,y,t),l(g,s,p),u(s,s,p),l(p,o,y),u(o,o,y),f(y,g),f(b,s),d(s,p,s),d(p,o,g),l(g,s,p),u(s,s,p),f(o,s),u(p,y,b),d(s,p,a),l(s,s,y),d(p,p,s),d(s,y,b),d(y,o,n),f(o,g),h(s,o,t),h(p,y,t)}for(let e=0;e<16;e++)n[e+16]=s[e],n[e+32]=p[e],n[e+48]=o[e],n[e+64]=y[e];const m=n.subarray(32),w=n.subarray(16);!function(e,t){const r=i();for(let e=0;e<16;e++)r[e]=t[e];for(let e=253;e>=0;e--)f(r,r),2!==e&&4!==e&&d(r,r,t);for(let t=0;t<16;t++)e[t]=r[t]}(m,m),d(w,w,m);const v=new Uint8Array(32);return function(e,t){const r=i(),n=i();for(let e=0;e<16;e++)n[e]=t[e];c(n),c(n),c(n);for(let e=0;e<2;e++){r[0]=n[0]-65517;for(let e=1;e<15;e++)r[e]=n[e]-65535-(r[e-1]>>16&1),r[e-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);const e=r[15]>>16&1;r[14]&=65535,h(n,r,1-e)}for(let t=0;t<16;t++)e[2*t]=255&n[t],e[2*t+1]=n[t]>>8}(v,w),v}function y(e){return p(e,o)}function g(e){if(e.length!==t.KS)throw new Error(`x25519: seed must be ${t.KS} bytes`);const r=new Uint8Array(e);return{publicKey:y(r),secretKey:r}}t._w=g,t.Au=function(e){const t=(0,n.randomBytes)(32,e),r=g(t);return(0,s.wipe)(t),r},t.gi=function(e,r,n=!1){if(e.length!==t.kz)throw new Error("X25519: incorrect secret key length");if(r.length!==t.kz)throw new Error("X25519: incorrect public key length");const s=p(e,r);if(n){let e=0;for(let t=0;t<s.length;t++)e|=s[t];if(0===e)throw new Error("X25519: invalid shared key")}return s}},63573:(e,t)=>{"use strict";const r=Math.exp;e.exports=function(e){if("number"!=typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,n,s=0,i=0,o=0,a={};return a.push=function(a,c){if(n){const h=1-r(-(a-n)/e),l=c-t;t=h*c+(1-h)*t,s=(1-h)*(s+l*(h*l)),i=Math.sqrt(s),o=t+h*l}else t=c;n=a},a.movingAverage=function(){return t},a.variance=function(){return s},a.deviation=function(){return i},a.forecast=function(){return o},a}},19464:(e,t,r)=>{"use strict";const{fromCallback:n}=r(16957),s=r(94473),{getCallback:i,getOptions:o}=r(92520),a=Symbol("promise"),c=Symbol("status"),h=Symbol("operations"),l=Symbol("finishClose"),u=Symbol("closeCallbacks");t.AbstractChainedBatch=class{constructor(e){if("object"!=typeof e||null===e){throw new TypeError(`The first argument must be an abstract-level database, received ${null===e?"null":typeof e}`)}this[h]=[],this[u]=[],this[c]="open",this[l]=this[l].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[h].length}put(e,t,r){if("open"!==this[c])throw new s("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e)||this.db._checkValue(t);if(n)throw n;const i=r&&null!=r.sublevel?r.sublevel:this.db,o=r,a=i.keyEncoding(r&&r.keyEncoding),l=i.valueEncoding(r&&r.valueEncoding),u=a.format;r={...r,keyEncoding:u,valueEncoding:l.format},i!==this.db&&(r.sublevel=null);const d=i.prefixKey(a.encode(e),u),f=l.encode(t);return this._put(d,f,r),this[h].push({...o,type:"put",key:e,value:t}),this}_put(e,t,r){}del(e,t){if("open"!==this[c])throw new s("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e);if(r)throw r;const n=t&&null!=t.sublevel?t.sublevel:this.db,i=t,o=n.keyEncoding(t&&t.keyEncoding),a=o.format;return t={...t,keyEncoding:a},n!==this.db&&(t.sublevel=null),this._del(n.prefixKey(o.encode(e),a),t),this[h].push({...i,type:"del",key:e}),this}_del(e,t){}clear(){if("open"!==this[c])throw new s("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[h]=[],this}_clear(){}write(e,t){return t=i(e,t),t=n(t,a),e=o(e),"open"!==this[c]?this.nextTick(t,new s("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(t):(this[c]="writing",this._write(e,(e=>{this[c]="closing",this[u].push((()=>t(e))),e||this.db.emit("batch",this[h]),this._close(this[l])}))),t[a]}_write(e,t){}close(e){return e=n(e,a),"closing"===this[c]?this[u].push(e):"closed"===this[c]?this.nextTick(e):(this[u].push(e),"writing"!==this[c]&&(this[c]="closing",this._close(this[l]))),e[a]}_close(e){this.nextTick(e)}[l](){this[c]="closed",this.db.detachResource(this);const e=this[u];this[u]=[];for(const t of e)t()}}},33961:(e,t,r)=>{"use strict";const{fromCallback:n}=r(16957),s=r(94473),{getOptions:i,getCallback:o}=r(92520),a=Symbol("promise"),c=Symbol("callback"),h=Symbol("working"),l=Symbol("handleOne"),u=Symbol("handleMany"),d=Symbol("autoClose"),f=Symbol("finishWork"),p=Symbol("returnMany"),y=Symbol("closing"),g=Symbol("handleClose"),b=Symbol("closed"),m=Symbol("closeCallbacks"),w=Symbol("keyEncoding"),v=Symbol("valueEncoding"),E=Symbol("abortOnClose"),A=Symbol("legacy"),S=Symbol("keys"),_=Symbol("values"),C=Symbol("limit"),k=Symbol("count"),I=Object.freeze({}),T=()=>{};let x=!1;class R{constructor(e,t,r){if("object"!=typeof e||null===e){throw new TypeError(`The first argument must be an abstract-level database, received ${null===e?"null":typeof e}`)}if("object"!=typeof t||null===t)throw new TypeError("The second argument must be an options object");this[b]=!1,this[m]=[],this[h]=!1,this[y]=!1,this[d]=!1,this[c]=null,this[l]=this[l].bind(this),this[u]=this[u].bind(this),this[g]=this[g].bind(this),this[w]=t[w],this[v]=t[v],this[A]=r,this[C]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[k]=0,this[E]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[k]}get limit(){return this[C]}next(e){let t;if(void 0===e)t=new Promise(((t,r)=>{e=(e,n,s)=>{e?r(e):this[A]?void 0===n&&void 0===s?t():t([n,s]):t(n)}}));else if("function"!=typeof e)throw new TypeError("Callback must be a function");return this[y]?this.nextTick(e,new s("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[h]?this.nextTick(e,new s("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[h]=!0,this[c]=e,this[k]>=this[C]?this.nextTick(this[l],null):this._next(this[l])),t}_next(e){this.nextTick(e)}nextv(e,t,r){return r=o(t,r),r=n(r,a),t=i(t,I),Number.isInteger(e)?(this[y]?this.nextTick(r,new s("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[h]?this.nextTick(r,new s("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[C]<1/0&&(e=Math.min(e,this[C]-this[k])),this[h]=!0,this[c]=r,e<=0?this.nextTick(this[u],null,[]):this._nextv(e,t,this[u])),r[a]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[a])}_nextv(e,t,r){const n=[],s=(t,i,o)=>t?r(t):(this[A]?void 0===i&&void 0===o:void 0===i)?r(null,n):(n.push(this[A]?[i,o]:i),void(n.length===e?r(null,n):this._next(s)));this._next(s)}all(e,t){return t=o(e,t),t=n(t,a),e=i(e,I),this[y]?this.nextTick(t,new s("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[h]?this.nextTick(t,new s("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[h]=!0,this[c]=t,this[d]=!0,this[k]>=this[C]?this.nextTick(this[u],null,[]):this._all(e,this[u])),t[a]}_all(e,t){let r=this[k];const n=[],s=()=>{const e=this[C]<1/0?Math.min(1e3,this[C]-r):1e3;e<=0?this.nextTick(t,null,n):this._nextv(e,I,i)},i=(e,i)=>{e?t(e):0===i.length?t(null,n):(n.push.apply(n,i),r+=i.length,s())};s()}[f](){const e=this[c];return this[E]&&null===e?T:(this[h]=!1,this[c]=null,this[y]&&this._close(this[g]),e)}[p](e,t,r){this[d]?this.close(e.bind(null,t,r)):e(t,r)}seek(e,t){if(t=i(t,I),this[y]);else{if(this[h])throw new s("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(t.keyEncoding||this[w]),n=r.format;t.keyEncoding!==n&&(t={...t,keyEncoding:n});const s=this.db.prefixKey(r.encode(e),n);this._seek(s,t)}}}_seek(e,t){throw new s("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){if(e=n(e,a),this[b])this.nextTick(e);else if(this[y])this[m].push(e);else if(this[y]=!0,this[m].push(e),this[h]){if(this[E]){this[f]()(new s("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[g]);return e[a]}_close(e){this.nextTick(e)}[g](){this[b]=!0,this.db.detachResource(this);const e=this[m];this[m]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;void 0!==(e=await this.next());)yield e}finally{this[b]||await this.close()}}}class P extends R{constructor(e,t){super(e,t,!0),this[S]=!1!==t.keys,this[_]=!1!==t.values}[l](e,t,r){const n=this[f]();if(e)return n(e);try{t=this[S]&&void 0!==t?this[w].decode(t):void 0,r=this[_]&&void 0!==r?this[v].decode(r):void 0}catch(e){return n(new D("entry",e))}void 0===t&&void 0===r||this[k]++,n(null,t,r)}[u](e,t){const r=this[f]();if(e)return this[p](r,e);try{for(const e of t){const t=e[0],r=e[1];e[0]=this[S]&&void 0!==t?this[w].decode(t):void 0,e[1]=this[_]&&void 0!==r?this[v].decode(r):void 0}}catch(e){return this[p](r,new D("entries",e))}this[k]+=t.length,this[p](r,null,t)}end(e){return x||"undefined"==typeof console||(x=!0,console.warn(new s("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}}class D extends s{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const e of["_ended property","_nexting property","_end method"])Object.defineProperty(P.prototype,e.split(" ")[0],{get(){throw new s(`The ${e} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new s(`The ${e} has been removed`,{code:"LEVEL_LEGACY"})}});P.keyEncoding=w,P.valueEncoding=v,t.AbstractIterator=P,t.AbstractKeyIterator=class extends R{constructor(e,t){super(e,t,!1)}[l](e,t){const r=this[f]();if(e)return r(e);try{t=void 0!==t?this[w].decode(t):void 0}catch(e){return r(new D("key",e))}void 0!==t&&this[k]++,r(null,t)}[u](e,t){const r=this[f]();if(e)return this[p](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[w].decode(r):void 0}}catch(e){return this[p](r,new D("keys",e))}this[k]+=t.length,this[p](r,null,t)}},t.AbstractValueIterator=class extends R{constructor(e,t){super(e,t,!1)}[l](e,t){const r=this[f]();if(e)return r(e);try{t=void 0!==t?this[v].decode(t):void 0}catch(e){return r(new D("value",e))}void 0!==t&&this[k]++,r(null,t)}[u](e,t){const r=this[f]();if(e)return this[p](r,e);try{for(let e=0;e<t.length;e++){const r=t[e];t[e]=void 0!==r?this[v].decode(r):void 0}}catch(e){return this[p](r,new D("values",e))}this[k]+=t.length,this[p](r,null,t)}}},69071:(e,t,r)=>{"use strict";const{supports:n}=r(51675),{Transcoder:s}=r(58499),{EventEmitter:i}=r(17187),{fromCallback:o}=r(16957),a=r(94473),{AbstractIterator:c}=r(33961),{DefaultKeyIterator:h,DefaultValueIterator:l}=r(95429),{DeferredIterator:u,DeferredKeyIterator:d,DeferredValueIterator:f}=r(30593),{DefaultChainedBatch:p}=r(4765),{getCallback:y,getOptions:g}=r(92520),b=r(70056),m=Symbol("promise"),w=Symbol("landed"),v=Symbol("resources"),E=Symbol("closeResources"),A=Symbol("operations"),S=Symbol("undefer"),_=Symbol("deferOpen"),C=Symbol("options"),k=Symbol("status"),I=Symbol("defaultOptions"),T=Symbol("transcoder"),x=Symbol("keyEncoding"),R=Symbol("valueEncoding"),P=()=>{};class D extends i{constructor(e,t){if(super(),"object"!=typeof e||null===e)throw new TypeError("The first argument 'manifest' must be an object");t=g(t);const{keyEncoding:r,valueEncoding:i,passive:o,...a}=t;this[v]=new Set,this[A]=[],this[_]=!0,this[C]=a,this[k]="opening",this.supports=n(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==e.snapshots,permanence:!1!==e.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[T]=new s(L(this)),this[x]=this[T].encoding(r||"utf8"),this[R]=this[T].encoding(i||"utf8");for(const e of this[T].encodings())this.supports.encodings[e.commonName]||(this.supports.encodings[e.commonName]=!0);this[I]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[x].commonName,valueEncoding:this[R].commonName}),key:Object.freeze({keyEncoding:this[x].commonName})},this.nextTick((()=>{this[_]&&this.open({passive:!1},P)}))}get status(){return this[k]}keyEncoding(e){return this[T].encoding(null!=e?e:this[x])}valueEncoding(e){return this[T].encoding(null!=e?e:this[R])}open(e,t){t=y(e,t),t=o(t,m),(e={...this[C],...g(e)}).createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists;const r=e=>{"closing"===this[k]||"opening"===this[k]?this.once(w,e?()=>r(e):r):"open"!==this[k]?t(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:e})):t()};return e.passive?"opening"===this[k]?this.once(w,r):this.nextTick(r):"closed"===this[k]||this[_]?(this[_]=!1,this[k]="opening",this.emit("opening"),this._open(e,(e=>{if(e)return this[k]="closed",this[E]((()=>{this.emit(w),r(e)})),void this[S]();this[k]="open",this[S](),this.emit(w),"open"===this[k]&&this.emit("open"),"open"===this[k]&&this.emit("ready"),r()}))):"open"===this[k]?this.nextTick(r):this.once(w,(()=>this.open(e,t))),t[m]}_open(e,t){this.nextTick(t)}close(e){e=o(e,m);const t=r=>{"opening"===this[k]||"closing"===this[k]?this.once(w,r?t(r):t):"closed"!==this[k]?e(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):e()};if("open"===this[k]){this[k]="closing",this.emit("closing");const e=e=>{this[k]="open",this[S](),this.emit(w),t(e)};this[E]((()=>{this._close((r=>{if(r)return e(r);this[k]="closed",this[S](),this.emit(w),"closed"===this[k]&&this.emit("closed"),t()}))}))}else"closed"===this[k]?this.nextTick(t):this.once(w,(()=>this.close(e)));return e[m]}[E](e){if(0===this[v].size)return this.nextTick(e);let t=this[v].size,r=!0;const n=()=>{0==--t&&(r?this.nextTick(e):e())};for(const e of this[v])e.close(n);r=!1,this[v].clear()}_close(e){this.nextTick(e)}get(e,t,r){if(r=y(t,r),r=o(r,m),t=g(t,this[I].entry),"opening"===this[k])return this.defer((()=>this.get(e,t,r))),r[m];if(N(this,r))return r[m];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[m];const s=this.keyEncoding(t.keyEncoding),i=this.valueEncoding(t.valueEncoding),c=s.format,h=i.format;return t.keyEncoding===c&&t.valueEncoding===h||(t=Object.assign({},t,{keyEncoding:c,valueEncoding:h})),this._get(this.prefixKey(s.encode(e),c),t,((e,t)=>{if(e)return("LEVEL_NOT_FOUND"===e.code||e.notFound||/NotFound/i.test(e))&&(e.code||(e.code="LEVEL_NOT_FOUND"),e.notFound||(e.notFound=!0),e.status||(e.status=404)),r(e);try{t=i.decode(t)}catch(e){return r(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[m]}_get(e,t,r){this.nextTick(r,new Error("NotFound"))}getMany(e,t,r){if(r=y(t,r),r=o(r,m),t=g(t,this[I].entry),"opening"===this[k])return this.defer((()=>this.getMany(e,t,r))),r[m];if(N(this,r))return r[m];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[m];if(0===e.length)return this.nextTick(r,null,[]),r[m];const n=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),i=n.format,c=s.format;t.keyEncoding===i&&t.valueEncoding===c||(t=Object.assign({},t,{keyEncoding:i,valueEncoding:c}));const h=new Array(e.length);for(let t=0;t<e.length;t++){const s=e[t],o=this._checkKey(s);if(o)return this.nextTick(r,o),r[m];h[t]=this.prefixKey(n.encode(s),i)}return this._getMany(h,t,((e,t)=>{if(e)return r(e);try{for(let e=0;e<t.length;e++)void 0!==t[e]&&(t[e]=s.decode(t[e]))}catch(e){return r(new a(`Could not decode one or more of ${t.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:e}))}r(null,t)})),r[m]}_getMany(e,t,r){this.nextTick(r,null,new Array(e.length).fill(void 0))}put(e,t,r,n){if(n=y(r,n),n=o(n,m),r=g(r,this[I].entry),"opening"===this[k])return this.defer((()=>this.put(e,t,r,n))),n[m];if(N(this,n))return n[m];const s=this._checkKey(e)||this._checkValue(t);if(s)return this.nextTick(n,s),n[m];const i=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),c=i.format,h=a.format;r.keyEncoding===c&&r.valueEncoding===h||(r=Object.assign({},r,{keyEncoding:c,valueEncoding:h}));const l=this.prefixKey(i.encode(e),c),u=a.encode(t);return this._put(l,u,r,(r=>{if(r)return n(r);this.emit("put",e,t),n()})),n[m]}_put(e,t,r,n){this.nextTick(n)}del(e,t,r){if(r=y(t,r),r=o(r,m),t=g(t,this[I].key),"opening"===this[k])return this.defer((()=>this.del(e,t,r))),r[m];if(N(this,r))return r[m];const n=this._checkKey(e);if(n)return this.nextTick(r,n),r[m];const s=this.keyEncoding(t.keyEncoding),i=s.format;return t.keyEncoding!==i&&(t=Object.assign({},t,{keyEncoding:i})),this._del(this.prefixKey(s.encode(e),i),t,(t=>{if(t)return r(t);this.emit("del",e),r()})),r[m]}_del(e,t,r){this.nextTick(r)}batch(e,t,r){if(!arguments.length){if("opening"===this[k])return new p(this);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(r="function"==typeof e?e:y(t,r),r=o(r,m),t=g(t,this[I].empty),"opening"===this[k])return this.defer((()=>this.batch(e,t,r))),r[m];if(N(this,r))return r[m];if(!Array.isArray(e))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[m];if(0===e.length)return this.nextTick(r),r[m];const n=new Array(e.length),{keyEncoding:s,valueEncoding:i,...c}=t;for(let t=0;t<e.length;t++){if("object"!=typeof e[t]||null===e[t])return this.nextTick(r,new TypeError("A batch operation must be an object")),r[m];const o=Object.assign({},e[t]);if("put"!==o.type&&"del"!==o.type)return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[m];const a=this._checkKey(o.key);if(a)return this.nextTick(r,a),r[m];const c=null!=o.sublevel?o.sublevel:this,h=c.keyEncoding(o.keyEncoding||s),l=h.format;if(o.key=c.prefixKey(h.encode(o.key),l),o.keyEncoding=l,"put"===o.type){const e=this._checkValue(o.value);if(e)return this.nextTick(r,e),r[m];const t=c.valueEncoding(o.valueEncoding||i);o.value=t.encode(o.value),o.valueEncoding=t.format}c!==this&&(o.sublevel=null),n[t]=o}return this._batch(n,c,(t=>{if(t)return r(t);this.emit("batch",e),r()})),r[m]}_batch(e,t,r){this.nextTick(r)}sublevel(e,t){return this._sublevel(e,O.defaults(t))}_sublevel(e,t){return new O(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=y(e,t),t=o(t,m),e=g(e,this[I].empty),"opening"===this[k])return this.defer((()=>this.clear(e,t))),t[m];if(N(this,t))return t[m];const r=e,n=this.keyEncoding(e.keyEncoding);return(e=b(e,n)).keyEncoding=n.format,0===e.limit?this.nextTick(t):this._clear(e,(e=>{if(e)return t(e);this.emit("clear",r),t()})),t[m]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=b(e,t)).keys=!1!==e.keys,e.values=!1!==e.values,e[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[k])return new u(this,e);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new c(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=b(e,t))[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[k])return new d(this,e);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new h(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),r=this.valueEncoding(e&&e.valueEncoding);if((e=b(e,t))[c.keyEncoding]=t,e[c.valueEncoding]=r,e.keyEncoding=t.format,e.valueEncoding=r.format,"opening"===this[k])return new f(this,e);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new l(this,e)}defer(e){if("function"!=typeof e)throw new TypeError("The first argument must be a function");this[A].push(e)}[S](){if(0===this[A].length)return;const e=this[A];this[A]=[];for(const t of e)t()}attachResource(e){if("object"!=typeof e||null===e||"function"!=typeof e.close)throw new TypeError("The first argument must be a resource object");this[v].add(e)}detachResource(e){this[v].delete(e)}_chainedBatch(){return new p(this)}_checkKey(e){if(null==e)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(null==e)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}D.prototype.nextTick=r(56909);const{AbstractSublevel:O}=r(59650)({AbstractLevel:D});t.AbstractLevel=D,t.AbstractSublevel=O;const N=function(e,t){return"open"!==e[k]&&(e.nextTick(t,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},L=function(e){return Object.keys(e.supports.encodings).filter((t=>!!e.supports.encodings[t]))}},50875:(e,t,r)=>{"use strict";t.AbstractLevel=r(69071).AbstractLevel,t.AbstractSublevel=r(69071).AbstractSublevel,t.AbstractIterator=r(33961).AbstractIterator,t.AbstractKeyIterator=r(33961).AbstractKeyIterator,t.AbstractValueIterator=r(33961).AbstractValueIterator,t.AbstractChainedBatch=r(19464).AbstractChainedBatch},82970:(e,t,r)=>{"use strict";const{AbstractIterator:n,AbstractKeyIterator:s,AbstractValueIterator:i}=r(33961),o=Symbol("unfix"),a=Symbol("iterator"),c=Symbol("handleOne"),h=Symbol("handleMany"),l=Symbol("callback");class u extends n{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[c]=this[c].bind(this),this[h]=this[h].bind(this),this[l]=null}[c](e,t,r){const n=this[l];if(e)return n(e);void 0!==t&&(t=this[o](t)),n(e,t,r)}[h](e,t){const r=this[l];if(e)return r(e);for(const e of t){const t=e[0];void 0!==t&&(e[0]=this[o](t))}r(e,t)}}class d extends s{constructor(e,t,r,n){super(e,t),this[a]=r,this[o]=n,this[c]=this[c].bind(this),this[h]=this[h].bind(this),this[l]=null}[c](e,t){const r=this[l];if(e)return r(e);void 0!==t&&(t=this[o](t)),r(e,t)}[h](e,t){const r=this[l];if(e)return r(e);for(let e=0;e<t.length;e++){const r=t[e];void 0!==r&&(t[e]=this[o](r))}r(e,t)}}class f extends i{constructor(e,t,r){super(e,t),this[a]=r}}for(const e of[u,d])e.prototype._next=function(e){this[l]=e,this[a].next(this[c])},e.prototype._nextv=function(e,t,r){this[l]=r,this[a].nextv(e,t,this[h])},e.prototype._all=function(e,t){this[l]=t,this[a].all(e,this[h])};for(const e of[f])e.prototype._next=function(e){this[a].next(e)},e.prototype._nextv=function(e,t,r){this[a].nextv(e,t,r)},e.prototype._all=function(e,t){this[a].all(e,t)};for(const e of[u,d,f])e.prototype._seek=function(e,t){this[a].seek(e,t)},e.prototype._close=function(e){this[a].close(e)};t.AbstractSublevelIterator=u,t.AbstractSublevelKeyIterator=d,t.AbstractSublevelValueIterator=f},59650:(e,t,r)=>{"use strict";const n=r(94473),{Buffer:s}=r(48764)||{},{AbstractSublevelIterator:i,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:a}=r(82970),c=Symbol("prefix"),h=Symbol("upperBound"),l=Symbol("prefixRange"),u=Symbol("parent"),d=Symbol("unfix"),f=new TextEncoder,p={separator:"!"};e.exports=function({AbstractLevel:e}){class t extends e{static defaults(e){if("string"==typeof e)throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?p:e.separator?e:{...e,separator:"!"}}constructor(e,r,s){const{separator:i,manifest:o,...a}=t.defaults(s);r=w(r,i);const l=i.charCodeAt(0)+1,p=e[u]||e;if(!f.encode(r).every((e=>e>l&&e<127)))throw new n(`Prefix must use bytes > ${l} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(y(p,o),a);const g=(e.prefix||"")+i+r+i,v=g.slice(0,-1)+String.fromCharCode(l);this[u]=p,this[c]=new b(g),this[h]=new b(v),this[d]=new m,this.nextTick=p.nextTick}prefixKey(e,t){if("utf8"===t)return this[c].utf8+e;if(0===e.byteLength)return this[c][t];if("view"===t){const t=this[c].view,r=new Uint8Array(t.byteLength+e.byteLength);return r.set(t,0),r.set(e,t.byteLength),r}{const t=this[c].buffer;return s.concat([t,e],t.byteLength+e.byteLength)}}[l](e,t){void 0!==e.gte?e.gte=this.prefixKey(e.gte,t):void 0!==e.gt?e.gt=this.prefixKey(e.gt,t):e.gte=this[c][t],void 0!==e.lte?e.lte=this.prefixKey(e.lte,t):void 0!==e.lt?e.lt=this.prefixKey(e.lt,t):e.lte=this[h][t]}get prefix(){return this[c].utf8}get db(){return this[u]}_open(e,t){this[u].open({passive:!0},t)}_put(e,t,r,n){this[u].put(e,t,r,n)}_get(e,t,r){this[u].get(e,t,r)}_getMany(e,t,r){this[u].getMany(e,t,r)}_del(e,t,r){this[u].del(e,t,r)}_batch(e,t,r){this[u].batch(e,t,r)}_clear(e,t){this[l](e,e.keyEncoding),this[u].clear(e,t)}_iterator(e){this[l](e,e.keyEncoding);const t=this[u].iterator(e),r=this[d].get(this[c].utf8.length,e.keyEncoding);return new i(this,e,t,r)}_keys(e){this[l](e,e.keyEncoding);const t=this[u].keys(e),r=this[d].get(this[c].utf8.length,e.keyEncoding);return new o(this,e,t,r)}_values(e){this[l](e,e.keyEncoding);const t=this[u].values(e);return new a(this,e,t)}}return{AbstractSublevel:t}};const y=function(e,t){return{...e.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...t,encodings:{utf8:g(e,"utf8"),buffer:g(e,"buffer"),view:g(e,"view")}}},g=function(e,t){return!!e.supports.encodings[t]&&e.keyEncoding(t).name===t};class b{constructor(e){this.utf8=e,this.view=f.encode(e),this.buffer=s?s.from(this.view.buffer,0,this.view.byteLength):{}}}class m{constructor(){this.cache=new Map}get(e,t){let r=this.cache.get(t);return void 0===r&&(r="view"===t?function(e,t){return t.subarray(e)}.bind(null,e):function(e,t){return t.slice(e)}.bind(null,e),this.cache.set(t,r)),r}}const w=function(e,t){let r=0,n=e.length;for(;r<n&&e[r]===t;)r++;for(;n>r&&e[n-1]===t;)n--;return e.slice(r,n)}},92520:(e,t)=>{"use strict";t.getCallback=function(e,t){return"function"==typeof e?e:t},t.getOptions=function(e,t){return"object"==typeof e&&null!==e?e:void 0!==t?t:{}}},4765:(e,t,r)=>{"use strict";const{AbstractChainedBatch:n}=r(19464),s=r(94473),i=Symbol("encoded");t.DefaultChainedBatch=class extends n{constructor(e){super(e),this[i]=[]}_put(e,t,r){this[i].push({...r,type:"put",key:e,value:t})}_del(e,t){this[i].push({...t,type:"del",key:e})}_clear(){this[i]=[]}_write(e,t){"opening"===this.db.status?this.db.defer((()=>this._write(e,t))):"open"===this.db.status?0===this[i].length?this.nextTick(t):this.db._batch(this[i],e,t):this.nextTick(t,new s("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}},95429:(e,t,r)=>{"use strict";const{AbstractKeyIterator:n,AbstractValueIterator:s}=r(33961),i=Symbol("iterator"),o=Symbol("callback"),a=Symbol("handleOne"),c=Symbol("handleMany");class h extends n{constructor(e,t){super(e,t),this[i]=e.iterator({...t,keys:!0,values:!1}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}class l extends s{constructor(e,t){super(e,t),this[i]=e.iterator({...t,keys:!1,values:!0}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}for(const e of[h,l]){const t=e===h,r=t?e=>e[0]:e=>e[1];e.prototype._next=function(e){this[o]=e,this[i].next(this[a])},e.prototype[a]=function(e,r,n){const s=this[o];e?s(e):s(null,t?r:n)},e.prototype._nextv=function(e,t,r){this[o]=r,this[i].nextv(e,t,this[c])},e.prototype._all=function(e,t){this[o]=t,this[i].all(e,this[c])},e.prototype[c]=function(e,t){const n=this[o];e?n(e):n(null,t.map(r))},e.prototype._seek=function(e,t){this[i].seek(e,t)},e.prototype._close=function(e){this[i].close(e)}}t.DefaultKeyIterator=h,t.DefaultValueIterator=l},30593:(e,t,r)=>{"use strict";const{AbstractIterator:n,AbstractKeyIterator:s,AbstractValueIterator:i}=r(33961),o=r(94473),a=Symbol("nut"),c=Symbol("undefer"),h=Symbol("factory");class l extends n{constructor(e,t){super(e,t),this[a]=null,this[h]=()=>e.iterator(t),this.db.defer((()=>this[c]()))}}class u extends s{constructor(e,t){super(e,t),this[a]=null,this[h]=()=>e.keys(t),this.db.defer((()=>this[c]()))}}class d extends i{constructor(e,t){super(e,t),this[a]=null,this[h]=()=>e.values(t),this.db.defer((()=>this[c]()))}}for(const e of[l,u,d])e.prototype[c]=function(){"open"===this.db.status&&(this[a]=this[h]())},e.prototype._next=function(e){null!==this[a]?this[a].next(e):"opening"===this.db.status?this.db.defer((()=>this._next(e))):this.nextTick(e,new o("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._nextv=function(e,t,r){null!==this[a]?this[a].nextv(e,t,r):"opening"===this.db.status?this.db.defer((()=>this._nextv(e,t,r))):this.nextTick(r,new o("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._all=function(e,t){null!==this[a]?this[a].all(t):"opening"===this.db.status?this.db.defer((()=>this._all(e,t))):this.nextTick(t,new o("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},e.prototype._seek=function(e,t){null!==this[a]?this[a]._seek(e,t):"opening"===this.db.status&&this.db.defer((()=>this._seek(e,t)))},e.prototype._close=function(e){null!==this[a]?this[a].close(e):"opening"===this.db.status?this.db.defer((()=>this._close(e))):this.nextTick(e)};t.DeferredIterator=l,t.DeferredKeyIterator=u,t.DeferredValueIterator=d},56909:(e,t,r)=>{"use strict";const n=r(54375);e.exports=function(e,...t){0===t.length?n(e):n((()=>e(...t)))}},70056:(e,t,r)=>{"use strict";const n=r(94473),s=Object.prototype.hasOwnProperty,i=new Set(["lt","lte","gt","gte"]);e.exports=function(e,t){const r={};for(const o in e)if(s.call(e,o)&&"keyEncoding"!==o&&"valueEncoding"!==o){if("start"===o||"end"===o)throw new n(`The legacy range option '${o}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===o)throw new n("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});i.has(o)?r[o]=t.encode(e[o]):r[o]=e[o]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}},32044:e=>{function t(e){const t=new globalThis.AbortController;function r(){t.abort();for(const t of e)t&&t.removeEventListener&&t.removeEventListener("abort",r)}for(const t of e)if(t&&t.addEventListener){if(t.aborted){r();break}t.addEventListener("abort",r)}return t.signal}e.exports=t,e.exports.anySignal=t},79742:(e,t)=>{"use strict";t.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,i=c(e),o=i[0],a=i[1],h=new s(function(e,t,r){return 3*(t+r)/4-r}(0,o,a)),l=0,u=a>0?o-4:o;for(r=0;r<u;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],h[l++]=t>>16&255,h[l++]=t>>8&255,h[l++]=255&t;2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,h[l++]=255&t);1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,h[l++]=t>>8&255,h[l++]=255&t);return h},t.fromByteArray=function(e){for(var t,n=e.length,s=n%3,i=[],o=16383,a=0,c=n-s;a<c;a+=o)i.push(h(e,a,a+o>c?c:a+o));1===s?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===s&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=i.length;o<a;++o)r[o]=i[o],n[i.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function h(e,t,n){for(var s,i,o=[],a=t;a<n;a+=3)s=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(r[(i=s)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},82672:e=>{"use strict";e.exports=async e=>{const t=[];for await(const r of e)t.push(r);return t}},95962:e=>{"use strict";e.exports=async e=>{for await(const t of e);}},92634:e=>{"use strict";e.exports=async function*(e,t){for await(const r of e)await t(r)&&(yield r)}},13033:e=>{"use strict";e.exports=async function*(e,t){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return}},11708:(e,t,r)=>{"use strict";const{AbstractLevel:n}=r(50875),s=r(94473),i=r(29967),{fromCallback:o}=r(16957),{Iterator:a}=r(8212),c=r(89687),h=r(89968),l=r(21217),u="level-js-",d=Symbol("idb"),f=Symbol("namePrefix"),p=Symbol("location"),y=Symbol("version"),g=Symbol("store"),b=Symbol("onComplete"),m=Symbol("promise");class w extends n{constructor(e,t,r){if("function"==typeof t||"function"==typeof r)throw new s("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:n,version:i,...o}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),"string"!=typeof e)throw new Error("constructor requires a location string argument");this[p]=e,this[f]=null==n?u:n,this[y]=parseInt(i||1,10),this[d]=null}get location(){return this[p]}get namePrefix(){return this[f]}get version(){return this[y]}get db(){return this[d]}get type(){return"browser-level"}_open(e,t){const r=indexedDB.open(this[f]+this[p],this[y]);r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[d]=r.result,t()},r.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this[p])||t.createObjectStore(this[p])}}[g](e){return this[d].transaction([this[p]],e).objectStore(this[p])}[b](e,t){const r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}}_get(e,t,r){const n=this[g]("readonly");let i;try{i=n.get(e)}catch(e){return this.nextTick(r,e)}this[b](i,(function(e,t){return e?r(e):void 0===t?r(new s("Entry not found",{code:"LEVEL_NOT_FOUND"})):void r(null,c(t))}))}_getMany(e,t,r){const n=this[g]("readonly"),s=e.map((e=>t=>{let r;try{r=n.get(e)}catch(e){return t(e)}r.onsuccess=()=>{const e=r.result;t(null,void 0===e?e:c(e))},r.onerror=e=>{e.stopPropagation(),t(r.error)}}));i(s,16,r)}_del(e,t,r){const n=this[g]("readwrite");let s;try{s=n.delete(e)}catch(e){return this.nextTick(r,e)}this[b](s,r)}_put(e,t,r,n){const s=this[g]("readwrite");let i;try{i=s.put(t,e)}catch(e){return this.nextTick(n,e)}this[b](i,n)}_iterator(e){return new a(this,this[p],e)}_batch(e,t,r){const n=this[g]("readwrite"),s=n.transaction;let i,o=0;s.onabort=function(){r(i||s.error||new Error("aborted by user"))},s.oncomplete=function(){r()},function t(){const r=e[o++],a=r.key;let c;try{c="del"===r.type?n.delete(a):n.put(r.value,a)}catch(e){return i=e,void s.abort()}o<e.length?c.onsuccess=t:"function"==typeof s.commit&&s.commit()}()}_clear(e,t){let r,n;try{r=l(e)}catch(e){return this.nextTick(t)}if(e.limit>=0)return h(this,this[p],r,e,t);try{const e=this[g]("readwrite");n=r?e.delete(r):e.clear()}catch(e){return this.nextTick(t,e)}this[b](n,t)}_close(e){this[d].close(),this.nextTick(e)}}w.destroy=function(e,t,r){"function"==typeof t&&(r=t,t=u),r=o(r,m);const n=indexedDB.deleteDatabase(t+e);return n.onsuccess=function(){r()},n.onerror=function(e){r(e)},r[m]},t.BrowserLevel=w},8212:(e,t,r)=>{"use strict";const{AbstractIterator:n}=r(50875),s=r(21217),i=r(89687),o=Symbol("cache"),a=Symbol("finished"),c=Symbol("options"),h=Symbol("currentOptions"),l=Symbol("position"),u=Symbol("location"),d=Symbol("first"),f={};function p(e){"function"==typeof e.commit&&e.commit()}t.Iterator=class extends n{constructor(e,t,r){super(e,r),this[o]=[],this[a]=0===this.limit,this[c]=r,this[h]={...r},this[l]=void 0,this[u]=t,this[d]=!0}_nextv(e,t,r){if(this[d]=!1,this[a])return this.nextTick(r,null,[]);if(this[o].length>0)return e=Math.min(e,this[o].length),this.nextTick(r,null,this[o].splice(0,e));let n;void 0!==this[l]&&(this[c].reverse?(this[h].lt=this[l],this[h].lte=void 0):(this[h].gt=this[l],this[h].gte=void 0));try{n=s(this[h])}catch(e){return this[a]=!0,this.nextTick(r,null,[])}const f=this.db.db.transaction([this[u]],"readonly"),y=f.objectStore(this[u]),g=[];if(this[c].reverse){y[!this[c].values&&y.openKeyCursor?"openKeyCursor":"openCursor"](n,"prev").onsuccess=t=>{const r=t.target.result;if(r){const{key:t,value:n}=r;this[l]=t,g.push([this[c].keys&&void 0!==t?i(t):void 0,this[c].values&&void 0!==n?i(n):void 0]),g.length<e?r.continue():p(f)}else this[a]=!0}}else{let t,r;const s=()=>{if(void 0===t||void 0===r)return;const n=Math.max(t.length,r.length);0===n||e===1/0?this[a]=!0:this[l]=t[n-1],g.length=n;for(let e=0;e<n;e++){const n=t[e],s=r[e];g[e]=[this[c].keys&&void 0!==n?i(n):void 0,this[c].values&&void 0!==s?i(s):void 0]}p(f)};this[c].keys||e<1/0?y.getAllKeys(n,e<1/0?e:void 0).onsuccess=e=>{t=e.target.result,s()}:(t=[],this.nextTick(s)),this[c].values?y.getAll(n,e<1/0?e:void 0).onsuccess=e=>{r=e.target.result,s()}:(r=[],this.nextTick(s))}f.onabort=()=>{r(f.error||new Error("aborted by user")),r=null},f.oncomplete=()=>{r(null,g),r=null}}_next(e){if(this[o].length>0){const[t,r]=this[o].shift();this.nextTick(e,null,t,r)}else if(this[a])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[d]&&(this[d]=!1,t=1),this._nextv(t,f,((t,r)=>{if(t)return e(t);this[o]=r,this._next(e)}))}}_all(e,t){this[d]=!1;const r=this[o].splice(0,this[o].length),n=this.limit-this.count-r.length;if(n<=0)return this.nextTick(t,null,r);this._nextv(n,f,((e,n)=>{if(e)return t(e);r.length>0&&(n=r.concat(n)),t(null,n)}))}_seek(e,t){let r;this[d]=!0,this[o]=[],this[a]=!1,this[l]=void 0,this[h]={...this[c]};try{r=s(this[c])}catch(e){return void(this[a]=!0)}null===r||r.includes(e)?this[c].reverse?this[h].lte=e:this[h].gte=e:this[a]=!0}}},89968:e=>{"use strict";e.exports=function(e,t,r,n,s){if(0===n.limit)return e.nextTick(s);const i=e.db.transaction([t],"readwrite"),o=i.objectStore(t);let a=0;i.oncomplete=function(){s()},i.onabort=function(){s(i.error||new Error("aborted by user"))};const c=o.openKeyCursor?"openKeyCursor":"openCursor",h=n.reverse?"prev":"next";o[c](r,h).onsuccess=function(e){const t=e.target.result;t&&(o.delete(t.key).onsuccess=function(){(n.limit<=0||++a<n.limit)&&t.continue()})}}},89687:e=>{"use strict";const t=new TextEncoder;e.exports=function(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):t.encode(e)}},21217:e=>{"use strict";e.exports=function(e){const t=void 0!==e.gte?e.gte:void 0!==e.gt?e.gt:void 0,r=void 0!==e.lte?e.lte:void 0!==e.lt?e.lt:void 0,n=void 0===e.gte,s=void 0===e.lte;return void 0!==t&&void 0!==r?IDBKeyRange.bound(t,r,n,s):void 0!==t?IDBKeyRange.lowerBound(t,n):void 0!==r?IDBKeyRange.upperBound(r,s):null}},48764:(e,t,r)=>{"use strict";const n=r(79742),s=r(80645),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return h(e,t,r)}function h(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|y(e,t);let n=a(r);const s=n.write(e,t);s!==r&&(n=n.slice(0,s));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(J(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(J(e,ArrayBuffer)||e&&J(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(J(e,SharedArrayBuffer)||e&&J(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const s=function(e){if(c.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Y(e.length)?a(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function y(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||J(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(s)return n?-1:H(e).length;t=(""+t).toLowerCase(),s=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return k(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return x(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,s){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,s);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,s){let i,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function h(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let n=-1;for(i=r;i<a;i++)if(h(e,i)===h(t,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===c)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){let r=!0;for(let n=0;n<c;n++)if(h(e,i+n)!==h(t,n)){r=!1;break}if(r)return i}return-1}function v(e,t,r,n){r=Number(r)||0;const s=e.length-r;n?(n=Number(n))>s&&(n=s):n=s;const i=t.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Y(n))return o;e[r+o]=n}return o}function E(e,t,r,n){return W(H(t,e.length-r),e,r,n)}function A(e,t,r,n){return W(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return W(G(t),e,r,n)}function _(e,t,r,n){return W(function(e,t){let r,n,s;const i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,s=r%256,i.push(s),i.push(n);return i}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function k(e,t,r){r=Math.min(e.length,r);const n=[];let s=t;for(;s<r;){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(i=t);break;case 2:r=e[s+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(i=c));break;case 3:r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[s+1],n=e[s+2],a=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),s+=o}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}t.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return h(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return u(e)},c.allocUnsafeSlow=function(e){return u(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),J(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let s=0,i=Math.min(r,n);s<i;++s)if(e[s]!==t[s]){r=e[s],n=t[s];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let s=0;for(r=0;r<e.length;++r){let t=e[r];if(J(t,Uint8Array))s+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,s)):Uint8Array.prototype.set.call(n,t,s);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,s)}s+=t.length}return n},c.byteLength=y,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)b(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?k(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(c.prototype[i]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,s){if(J(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),t<0||r>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=r)return 0;if(n>=s)return-1;if(t>=r)return 1;if(this===e)return 0;let i=(s>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(i,o),h=this.slice(n,s),l=e.slice(t,r);for(let e=0;e<a;++e)if(h[e]!==l[e]){i=h[e],o=l[e];break}return i<o?-1:o<i?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return A(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(127&e[s]);return n}function x(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(e[s]);return n}function R(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let s="";for(let n=t;n<r;++n)s+=Q[e[n]];return s}function P(e,t,r){const n=e.slice(t,r);let s="";for(let e=0;e<n.length-1;e+=2)s+=String.fromCharCode(n[e]+256*n[e+1]);return s}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,s,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,s){F(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function L(e,t,r,n,s){F(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r+7]=i,i>>=8,e[r+6]=i,i>>=8,e[r+5]=i,i>>=8,e[r+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function U(e,t,r,n,s,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,i){return t=+t,r>>>=0,i||U(e,0,r,4),s.write(e,t,r,n,23,4),r+4}function M(e,t,r,n,i){return t=+t,r>>>=0,i||U(e,0,r,8),s.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))})),c.prototype.readBigUInt64BE=Z((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(s)})),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,s=1,i=this[e+--n];for(;n>0&&(s*=256);)i+=this[e+--n]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Z((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),s.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),s.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){O(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=1,i=0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=e/s&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){O(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=r-1,i=1;for(this[t+s]=255&e;--s>=0&&(i*=256);)this[t+s]=e/i&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Z((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,e,t,r,n-1,-n)}let s=0,i=1,o=0;for(this[t]=255&e;++s<r&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,e,t,r,n-1,-n)}let s=r-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Z((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return M(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return M(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const s=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),s},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{const i=c.isBuffer(e)?e:c.from(e,n),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=i[s%o]}return this};const V={};function z(e,t,r){V[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function F(e,t,r,n,s,i){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let s;throw s=i>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new V.ERR_OUT_OF_RANGE("value",s,e)}!function(e,t,r){$(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(n,s,i)}function $(e,t){if("number"!=typeof e)throw new V.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw $(e,r),new V.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new V.ERR_BUFFER_OUT_OF_BOUNDS;throw new V.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}z("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),z("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),z("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,s=r;return Number.isInteger(r)&&Math.abs(r)>2**32?s=j(String(r)):"bigint"==typeof r&&(s=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(s=j(s)),s+="n"),n+=` It must be ${t}. Received ${s}`,n}),RangeError);const K=/[^+/0-9A-Za-z-_]/g;function H(e,t){let r;t=t||1/0;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(K,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,r,n){let s;for(s=0;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}function J(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let s=0;s<16;++s)t[n+s]=e[r]+e[s]}return t}();function Z(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},79830:e=>{"use strict";e.exports=function(e,t){if("string"==typeof e)return o(e);if("number"==typeof e)return i(e,t);return null},e.exports.format=i,e.exports.parse=o;var t=/\B(?=(\d{3})+(?!\d))/g,r=/(?:\.0*|(\.[^0]+)0+)$/,n={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},s=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function i(e,s){if(!Number.isFinite(e))return null;var i=Math.abs(e),o=s&&s.thousandsSeparator||"",a=s&&s.unitSeparator||"",c=s&&void 0!==s.decimalPlaces?s.decimalPlaces:2,h=Boolean(s&&s.fixedDecimals),l=s&&s.unit||"";l&&n[l.toLowerCase()]||(l=i>=n.pb?"PB":i>=n.tb?"TB":i>=n.gb?"GB":i>=n.mb?"MB":i>=n.kb?"KB":"B");var u=(e/n[l.toLowerCase()]).toFixed(c);return h||(u=u.replace(r,"$1")),o&&(u=u.split(".").map((function(e,r){return 0===r?e.replace(t,o):e})).join(".")),u+a+l}function o(e){if("number"==typeof e&&!isNaN(e))return e;if("string"!=typeof e)return null;var t,r=s.exec(e),i="b";return r?(t=parseFloat(r[1]),i=r[4].toLowerCase()):(t=parseInt(e,10),i="b"),isNaN(t)?null:Math.floor(n[i]*t)}},21924:(e,t,r)=>{"use strict";var n=r(40210),s=r(55559),i=s(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?s(r):r}},55559:(e,t,r)=>{"use strict";var n=r(58612),s=r(40210),i=s("%Function.prototype.apply%"),o=s("%Function.prototype.call%"),a=s("%Reflect.apply%",!0)||n.call(o,i),c=s("%Object.getOwnPropertyDescriptor%",!0),h=s("%Object.defineProperty%",!0),l=s("%Math.max%");if(h)try{h({},"a",{value:1})}catch(e){h=null}e.exports=function(e){var t=a(n,o,arguments);if(c&&h){var r=c(t,"length");r.configurable&&h(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var u=function(){return a(n,i,arguments)};h?h(e.exports,"apply",{value:u}):e.exports.apply=u},16957:(e,t,r)=>{"use strict";var n=r(90886);t.fromCallback=function(e,t){if(void 0===e){var r=new Promise((function(t,r){e=function(e,n){e?r(e):t(n)}}));e[void 0!==t?t:"promise"]=r}else if("function"!=typeof e)throw new TypeError("Callback must be a function");return e},t.fromPromise=function(e,t){if(void 0===t)return e;e.then((function(e){n((()=>t(null,e)))})).catch((function(e){n((()=>t(e)))}))}},90886:e=>{e.exports="function"==typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e)},31401:(e,t,r)=>{"use strict";const{encodeText:n}=r(94412);e.exports=class{constructor(e,t,r,s){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=s,this.codec=r(s)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}},10211:(e,t,r)=>{"use strict";const n=r(28820),s=r(31401),{rfc4648:i}=r(6021),{decodeText:o,encodeText:a}=r(94412),c=[["identity","\0",()=>({encode:o,decode:a}),""],["base2","0",i(1),"01"],["base8","7",i(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",i(4),"0123456789abcdef"],["base16upper","F",i(4),"0123456789ABCDEF"],["base32hex","v",i(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",i(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",i(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",i(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",i(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",i(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",i(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",i(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",i(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],h=c.reduce(((e,t)=>(e[t[0]]=new s(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=h[t[0]],e)),{});e.exports={names:h,codes:l}},94789:(e,t,r)=>{"use strict";const n=r(10211),{encodeText:s,decodeText:i,concat:o}=r(94412);function a(e){if(Object.prototype.hasOwnProperty.call(n.names,e))return n.names[e];if(Object.prototype.hasOwnProperty.call(n.codes,e))return n.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");const{name:r,codeBuf:n}=a(e);return function(e,t){a(e).decode(i(t))}(r,t),o([n,t],n.length+t.length)}).encode=function(e,t){const r=a(e),n=s(r.encode(t));return o([r.codeBuf,n],r.codeBuf.length+n.length)},t.decode=function(e){e instanceof Uint8Array&&(e=i(e));const t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),a(e[0]).decode(e.substring(1))},t.isEncoded=function(e){if(e instanceof Uint8Array&&(e=i(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(e){return!1}},t.encoding=a,t.encodingFromData=function(e){return e instanceof Uint8Array&&(e=i(e)),a(e[0])};const c=Object.freeze(n.names),h=Object.freeze(n.codes);t.names=c,t.codes=h},6021:e=>{"use strict";e.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const i=new Uint8Array(s*r/8|0);let o=0,a=0,c=0;for(let t=0;t<s;++t){const s=n[e[t]];if(void 0===s)throw new SyntaxError("Invalid character "+e[t]);a=a<<r|s,o+=r,o>=8&&(o-=8,i[c++]=255&a>>o)}if(o>=r||255&a<<8-o)throw new SyntaxError("Unexpected end of data");return i})(r,t,e)})}},94412:e=>{"use strict";const t=new TextDecoder,r=new TextEncoder;e.exports={decodeText:e=>t.decode(e),encodeText:e=>r.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}},14288:e=>{"use strict";const t=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:t}},21549:(e,t,r)=>{"use strict";const n=r(94789),s=r(89051),{names:i}=r(14288),{toString:o}=r(92263),{fromString:a}=r(52217),{concat:c}=r(20605),h={};for(const e in i){const t=e;h[i[t]]=t}function l(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=s.decode(e);if(!f(t))throw new Error(`multihash unknown function code: 0x${t.toString(16)}`);e=e.slice(s.decode.bytes);const r=s.decode(e);if(r<0)throw new Error(`multihash invalid length: ${r}`);if((e=e.slice(s.decode.bytes)).length!==r)throw new Error(`multihash length inconsistent: 0x${o(e,"base16")}`);return{code:t,name:h[t],length:r,digest:e}}function u(e){let t=e;if("string"==typeof e){if(void 0===i[e])throw new Error(`Unrecognized hash function named: ${e}`);t=i[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(void 0===h[t]&&!d(t))throw new Error(`Unrecognized function code: ${t}`);return t}function d(e){return e>0&&e<16}function f(e){return!!d(e)||!!h[e]}function p(e){l(e)}Object.freeze(h),e.exports={names:i,codes:h,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(e,"base16")},fromHexString:function(e){return a(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(n.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?o(e):e;return n.decode("z"+t)},decode:l,encode:function(e,t,r){if(!e||void 0===t)throw new Error("multihash encode requires at least two args: digest, code");const n=u(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==r&&(r=e.length),r&&e.length!==r)throw new Error("digest length should be equal to specified length.");const i=s.encode(n),o=s.encode(r);return c([i,o,e],i.length+o.length+e.length)},coerceCode:u,isAppCode:d,validate:p,prefix:function(e){return p(e),e.subarray(0,2)},isValidCode:f}},93919:e=>{e.exports=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s}},33811:e=>{e.exports=function e(r,n,s){n=n||[];var i=s=s||0;for(;r>=t;)n[s++]=255&r|128,r/=128;for(;-128&r;)n[s++]=255&r|128,r>>>=7;return n[s]=0|r,e.bytes=s-i+1,n};var t=Math.pow(2,31)},89051:(e,t,r)=>{e.exports={encode:r(33811),decode:r(93919),encodingLength:r(94518)}},94518:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),h=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<s?4:e<i?5:e<o?6:e<a?7:e<c?8:e<h?9:10}},8303:(e,t,r)=>{"use strict";const n=r(21549),s={checkCIDComponents:function(e){if(null==e)return"null values are not valid CIDs";if(0!==e.version&&1!==e.version)return"Invalid version, must be a number equal to 1 or 0";if("string"!=typeof e.codec)return"codec must be string";if(0===e.version){if("dag-pb"!==e.codec)return"codec must be 'dag-pb' for CIDv0";if("base58btc"!==e.multibaseName)return"multibaseName must be 'base58btc' for CIDv0"}if(!(e.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{n.validate(e.multihash)}catch(e){let t=e.message;return t||(t="Multihash validation failed"),t}}};e.exports=s},98878:(e,t,r)=>{"use strict";const n=r(21549),s=r(94789),i=r(76883),o=r(8303),{concat:a}=r(20605),{toString:c}=r(92263),{equals:h}=r(19588),l=i.nameToCode,u=Object.keys(l).reduce(((e,t)=>(e[l[t]]=t,e)),{}),d=Symbol.for("@ipld/js-cid/CID");class f{constructor(e,t,r,o){if(this.version,this.codec,this.multihash,Object.defineProperty(this,d,{value:!0}),f.isCID(e)){const t=e;return this.version=t.version,this.codec=t.codec,this.multihash=t.multihash,void(this.multibaseName=t.multibaseName||(0===t.version?"base58btc":"base32"))}if("string"==typeof e){const t=s.isEncoded(e);if(t){const r=s.decode(e);this.version=parseInt(r[0].toString(),16),this.codec=i.getCodec(r.slice(1)),this.multihash=i.rmPrefix(r.slice(1)),this.multibaseName=t}else this.version=0,this.codec="dag-pb",this.multihash=n.fromB58String(e),this.multibaseName="base58btc";return f.validateCID(this),void Object.defineProperty(this,"string",{value:e})}if(e instanceof Uint8Array){const t=parseInt(e[0].toString(),16);if(1===t){const r=e;this.version=t,this.codec=i.getCodec(r.slice(1)),this.multihash=i.rmPrefix(r.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";f.validateCID(this)}else this.version=e,"number"==typeof t&&(t=u[t]),this.codec=t,this.multihash=r,this.multibaseName=o||(0===e?"base58btc":"base32"),f.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");{const t=i.getCodeVarint(this.codec);e=a([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}}Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){const e=i.getCodeVarint(this.codec),t=n.prefix(this.multihash);return a([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return l[this.codec]}toV0(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:e,length:t}=n.decode(this.multihash);if("sha2-256"!==e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==t)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new f(0,this.codec,this.multihash)}toV1(){return new f(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&0!==this.string.length&&e===this.multibaseName)return this.string;let t;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=n.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=c(s.encode(e,this.bytes))}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&h(this.multihash,e.multihash)}static validateCID(e){const t=o.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof f||Boolean(e&&e[d])}}f.codecs=l,e.exports=f},98514:e=>{"use strict";e.exports=function(e,{className:t,symbolName:r}){const n=Symbol.for(r),s={[t]:class extends e{constructor(...e){super(...e),Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return t}}}[t];return s[`is${t}`]=e=>!(!e||!e[n]),s},e.exports.proto=function(e,{className:t,symbolName:r,withoutNew:n}){const s=Symbol.for(r),i={[t]:function(...t){if(n&&!(this instanceof i))return new i(...t);const r=e.call(this,...t)||this;return r&&!r[s]&&Object.defineProperty(r,s,{value:!0}),r}}[t];return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,Object.defineProperty(i.prototype,Symbol.toStringTag,{get:()=>t}),i[`is${t}`]=e=>!(!e||!e[s]),i}},74087:function(e,t){var r,n;n="undefined"!=typeof window?window:this,r=function(){return function(e){if("undefined"!=typeof window){var t={SESSIONS:"sessions",EVENTS:"events",VIEWS:"views",SCROLLS:"scrolls",CLICKS:"clicks",FORMS:"forms",CRASHES:"crashes",ATTRIBUTION:"attribution",USERS:"users",STAR_RATING:"star-rating",LOCATION:"location",APM:"apm",FEEDBACK:"feedback",REMOTE_CONFIG:"remote-config"};(e=e||{}).features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG];var r={NPS:"[CLY]_nps",SURVEY:"[CLY]_survey",STAR_RATING:"[CLY]_star_rating",VIEW:"[CLY]_view",ORIENTATION:"[CLY]_orientation",PUSH_ACTION:"[CLY]_push_action",ACTION:"[CLY]_action"},n={ERROR:"[ERROR] ",WARNING:"[WARNING] ",INFO:"[INFO] ",DEBUG:"[DEBUG] ",VERBOSE:"[VERBOSE] "},s={DEVELOPER_SUPPLIED:0,SDK_GENERATED:1,TEMPORARY_ID:2,URL_PROVIDED:3},i={BEAT_INTERVAL:500,QUEUE_SIZE:1e3,FAIL_TIMEOUT_AMOUNT:60,INACTIVITY_TIME:20,SESSION_UPDATE:60,MAX_EVENT_BATCH:100,SESSION_COOKIE_TIMEOUT:30,MAX_KEY_LENGTH:128,MAX_VALUE_SIZE:256,MAX_SEGMENTATION_VALUES:30,MAX_BREADCRUMB_COUNT:100,MAX_STACKTRACE_LINES_PER_THREAD:30,MAX_STACKTRACE_LINE_LENGTH:200};e.q=e.q||[],e.onload=e.onload||[];var o="22.06.4",a="javascript_native_web",c=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,h=function(h){var l,N=this,V=!e.i,z=!1,j="/i",F="/o/sdk",$=m("interval",h,i.BEAT_INTERVAL),q=m("queue_size",h,i.QUEUE_SIZE),K=[],H=[],G={},W=[],J={},Y=m("ignore_referrers",h,[]),Q=null,Z=!0,X=0,ee=null,te=0,re=0,ne=0,se=m("fail_timeout",h,i.FAIL_TIMEOUT_AMOUNT),ie=m("inactivity_time",h,i.INACTIVITY_TIME),oe=0,ae=m("session_update",h,i.SESSION_UPDATE),ce=m("max_events",h,i.MAX_EVENT_BATCH),he=m("max_logs",h,null),le=m("use_session_cookie",h,!0),ue=m("session_cookie_timeout",h,i.SESSION_COOKIE_TIMEOUT),de=!0,fe=!1,pe=m("offline_mode",h,!1),ye={},ge=!0,be=g(),me=!0,we=null,ve=s.SDK_GENERATED,Ee=!1,Ae=0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(e){qe(n.ERROR,"Local storage test failed, Halting local storage support: "+e),me=!1}for(var Se,_e={},Ce=0;Ce<e.features.length;Ce++)_e[e.features[Ce]]={};this.initialize=function(){if(this.serialize=m("serialize",h,e.serialize),this.deserialize=m("deserialize",h,e.deserialize),this.getViewName=m("getViewName",h,e.getViewName),this.getViewUrl=m("getViewUrl",h,e.getViewUrl),this.getSearchQuery=m("getSearchQuery",h,e.getSearchQuery),this.DeviceIdType=e.DeviceIdType,this.namespace=m("namespace",h,""),this.clearStoredId=m("clear_stored_id",h,!1),this.app_key=m("app_key",h,null),this.onload=m("onload",h,[]),this.utm=m("utm",h,{source:!0,medium:!0,campaign:!0,term:!0,content:!0}),this.ignore_prefetch=m("ignore_prefetch",h,!0),this.rcAutoOptinAb=m("rc_automatic_optin_for_ab",h,!0),this.useExplicitRcApi=m("use_explicit_rc_api",h,!1),this.debug=m("debug",h,!1),this.test_mode=m("test_mode",h,!1),this.metrics=m("metrics",h,{}),this.headers=m("headers",h,{}),this.url=E(m("url",h,"")),this.app_version=m("app_version",h,"0.0"),this.country_code=m("country_code",h,null),this.city=m("city",h,null),this.ip_address=m("ip_address",h,null),this.ignore_bots=m("ignore_bots",h,!0),this.force_post=m("force_post",h,!1),this.remote_config=m("remote_config",h,!1),this.ignore_visitor=m("ignore_visitor",h,!1),this.require_consent=m("require_consent",h,!1),this.track_domains=m("track_domains",h,!0),this.storage=m("storage",h,"default"),this.enableOrientationTracking=m("enable_orientation_tracking",h,!0),this.maxKeyLength=m("max_key_length",h,i.MAX_KEY_LENGTH),this.maxValueSize=m("max_value_size",h,i.MAX_VALUE_SIZE),this.maxSegmentationValues=m("max_segmentation_values",h,i.MAX_SEGMENTATION_VALUES),this.maxBreadcrumbCount=m("max_breadcrumb_count",h,null),this.maxStackTraceLinesPerThread=m("max_stack_trace_lines_per_thread",h,i.MAX_STACKTRACE_LINES_PER_THREAD),this.maxStackTraceLineLength=m("max_stack_trace_line_length",h,i.MAX_STACKTRACE_LINE_LENGTH),this.heatmapWhitelist=m("heatmap_whitelist",h,[]),he&&!this.maxBreadcrumbCount?(this.maxBreadcrumbCount=he,qe(n.WARNING,"initialize, 'maxCrashLogs' is deprecated. Use 'maxBreadcrumbCount' instead!")):he||this.maxBreadcrumbCount||(this.maxBreadcrumbCount=100),"cookie"===this.storage&&(me=!1),this.rcAutoOptinAb||this.useExplicitRcApi||(qe(n.WARNING,"initialize, Auto opting is disabled, switching to explicit RC API"),this.useExplicitRcApi=!0),Array.isArray(Y)||(Y=[]),""===this.url&&(qe(n.ERROR,"initialize, Please provide server URL"),this.ignore_visitor=!0),nt("cly_ignore")&&(this.ignore_visitor=!0),ot(),this.clearStoredId&&(qe(n.INFO,"initialize, Clearing the device ID storage"),localStorage.removeItem(this.app_key+"/cly_id"),localStorage.removeItem(this.app_key+"/cly_id_type")),K=nt("cly_queue")||[],H=nt("cly_event")||[],G=nt("cly_remote_configs")||{},Pe(),window.name&&0===window.name.indexOf("cly:"))try{this.passed_data=JSON.parse(window.name.replace("cly:",""))}catch(e){qe(n.ERROR,"initialize, Could not parse name: "+window.name+", error: "+e)}else if(location.hash&&0===location.hash.indexOf("#cly:"))try{this.passed_data=JSON.parse(location.hash.replace("#cly:",""))}catch(e){qe(n.ERROR,"initialize, Could not parse hash: "+location.hash+", error: "+e)}if((this.passed_data&&this.passed_data.app_key&&this.passed_data.app_key===this.app_key||this.passed_data&&!this.passed_data.app_key&&V)&&this.passed_data.token&&this.passed_data.purpose){this.passed_data.token!==nt("cly_old_token")&&(Qe(this.passed_data.token),st("cly_old_token",this.passed_data.token));var t=[];Array.isArray(this.heatmapWhitelist)?(this.heatmapWhitelist.push(this.url),t=this.heatmapWhitelist.map((function(e){return E(e)}))):t=[this.url],t.includes(this.passed_data.url)&&"heatmap"===this.passed_data.purpose&&(this.ignore_visitor=!0,B(),L(this.passed_data.url+"/views/heatmap.js",M))}if(this.ignore_visitor)qe(n.WARNING,"initialize, ignore_visitor:["+this.ignore_visitor+"], this user will not be tracked");else{qe(n.DEBUG,"initialize, app_key:["+this.app_key+"], url:["+this.url+"]"),qe(n.DEBUG,"initialize, device_id:["+m("device_id",h,void 0)+"]"),qe(n.DEBUG,"initialize, require_consent is enabled:["+this.require_consent+"]");try{qe(n.DEBUG,"initialize, metric override:["+JSON.stringify(this.metrics)+"]"),qe(n.DEBUG,"initialize, header override:["+JSON.stringify(this.headers)+"]"),qe(n.DEBUG,"initialize, number of onload callbacks provided:["+this.onload.length+"]"),qe(n.DEBUG,"initialize, utm tags:["+JSON.stringify(this.utm)+"]"),Y&&qe(n.DEBUG,"initialize, referrers to ignore :["+JSON.stringify(Y)+"]")}catch(e){qe(n.ERROR,"initialize, Could not stringify some config object values")}qe(n.DEBUG,"initialize, app_version:["+this.app_version+"]"),qe(n.DEBUG,"initialize, provided location info; country_code:["+this.country_code+"], city:["+this.city+"], ip_address:["+this.ip_address+"]"),""!==this.namespace&&qe(n.DEBUG,"initialize, namespace given:["+this.namespace+"]"),this.clearStoredId&&qe(n.DEBUG,"initialize, clearStoredId flag set to:["+this.clearStoredId+"]"),this.ignore_prefetch&&qe(n.DEBUG,"initialize, ignoring pre-fetching and pre-rendering from counting as real website visits :["+this.ignore_prefetch+"]"),this.test_mode&&qe(n.WARNING,"initialize, test_mode:["+this.test_mode+"], queues won't be processed"),this.heatmapWhitelist&&qe(n.DEBUG,"initialize, heatmap whitelist:["+JSON.stringify(this.heatmapWhitelist)+"], these domains will be whitelisted"),"default"!==this.storage&&qe(n.DEBUG,"initialize, storage is set to:["+this.storage+"]"),this.ignore_bots&&qe(n.DEBUG,"initialize, ignore traffic from bots :["+this.ignore_bots+"]"),this.force_post&&qe(n.DEBUG,"initialize, forced post method for all requests:["+this.force_post+"]"),this.remote_config&&qe(n.DEBUG,"initialize, remote_config callback provided:["+!!this.remote_config+"]"),"boolean"==typeof this.rcAutoOptinAb&&qe(n.DEBUG,"initialize, automatic RC optin is enabled:["+this.rcAutoOptinAb+"]"),this.useExplicitRcApi||qe(n.WARNING,"initialize, will use legacy RC API. Consider enabling new API during init with use_explicit_rc_api flag"),this.track_domains&&qe(n.DEBUG,"initialize, tracking domain info:["+this.track_domains+"]"),this.enableOrientationTracking&&qe(n.DEBUG,"initialize, enableOrientationTracking:["+this.enableOrientationTracking+"]"),le||qe(n.WARNING,"initialize, use_session_cookie is enabled:["+le+"]"),pe&&qe(n.DEBUG,"initialize, offline_mode:["+pe+"], user info won't be send to the servers"),pe&&qe(n.DEBUG,"initialize, stored remote configs:["+JSON.stringify(G)+"]"),qe(n.DEBUG,"initialize, 'getViewName' callback override provided:["+!!this.getViewName+"]"),qe(n.DEBUG,"initialize, 'getSearchQuery' callback override provided:["+!!this.getSearchQuery+"]"),this.maxKeyLength!==i.MAX_KEY_LENGTH&&qe(n.DEBUG,"initialize, maxKeyLength set to:["+this.maxKeyLength+"] characters"),this.maxValueSize!==i.MAX_VALUE_SIZE&&qe(n.DEBUG,"initialize, maxValueSize set to:["+this.maxValueSize+"] characters"),this.maxSegmentationValues!==i.MAX_SEGMENTATION_VALUES&&qe(n.DEBUG,"initialize, maxSegmentationValues set to:["+this.maxSegmentationValues+"] key/value pairs"),this.maxBreadcrumbCount!==i.MAX_BREADCRUMB_COUNT&&qe(n.DEBUG,"initialize, maxBreadcrumbCount for custom logs set to:["+this.maxBreadcrumbCount+"] entries"),this.maxStackTraceLinesPerThread!==i.MAX_STACKTRACE_LINES_PER_THREAD&&qe(n.DEBUG,"initialize, maxStackTraceLinesPerThread set to:["+this.maxStackTraceLinesPerThread+"] lines"),this.maxStackTraceLineLength!==i.MAX_STACKTRACE_LINE_LENGTH&&qe(n.DEBUG,"initialize, maxStackTraceLineLength set to:["+this.maxStackTraceLineLength+"] characters"),$!==i.BEAT_INTERVAL&&qe(n.DEBUG,"initialize, interval for heartbeats set to:["+$+"] milliseconds"),q!==i.QUEUE_SIZE&&qe(n.DEBUG,"initialize, queue_size set to:["+q+"] items max"),se!==i.FAIL_TIMEOUT_AMOUNT&&qe(n.DEBUG,"initialize, fail_timeout set to:["+se+"] seconds of wait time after a failed connection to server"),ie!==i.INACTIVITY_TIME&&qe(n.DEBUG,"initialize, inactivity_time set to:["+ie+"] minutes to consider a user as inactive after no observable action"),ae!==i.SESSION_UPDATE&&qe(n.DEBUG,"initialize, session_update set to:["+ae+"] seconds to check if extending a session is needed while the user is active"),ce!==i.MAX_EVENT_BATCH&&qe(n.DEBUG,"initialize, max_events set to:["+ce+"] events to send in one batch"),he&&qe(n.WARNING,"initialize, max_logs set to:["+he+"] breadcrumbs to store for crash logs max, deprecated "),ue!==i.SESSION_COOKIE_TIMEOUT&&qe(n.DEBUG,"initialize, session_cookie_timeout set to:["+ue+"] minutes to expire a cookies session"),qe(n.INFO,"initialize, Countly initialized");var r=null,o=N.getSearchQuery(),a=!1,c={};if(o)for(var l=o.substring(1).split("&"),u=0;u<l.length;u++){var d=l[u].split("=");"cly_id"===d[0]?st("cly_cmp_id",d[1]):"cly_uid"===d[0]?st("cly_cmp_uid",d[1]):"cly_device_id"===d[0]?r=d[1]:0===(d[0]+"").indexOf("utm_")&&this.utm[d[0].replace("utm_","")]&&(c[d[0].replace("utm_","")]=d[1],a=!0)}var f="[CLY]_temp_id"===nt("cly_id"),p=m("device_id",h,void 0);if(nt("cly_id")&&!f?(this.device_id=nt("cly_id"),qe(n.INFO,"initialize, Set the stored device ID"),(ve=nt("cly_id_type"))||(qe(n.INFO,"initialize, No device ID type info from the previous session, falling back to DEVELOPER_SUPPLIED"),ve=s.DEVELOPER_SUPPLIED)):null!==r?(qe(n.INFO,"initialize, Device ID set by URL"),this.device_id=r,ve=s.URL_PROVIDED):p?(qe(n.INFO,"initialize, Device ID set by developer"),this.device_id=p,h&&Object.keys(h).length?void 0!==h.device_id&&(ve=s.DEVELOPER_SUPPLIED):void 0!==e.device_id&&(ve=s.DEVELOPER_SUPPLIED)):pe||f?(this.device_id="[CLY]_temp_id",ve=s.TEMPORARY_ID,pe&&f?qe(n.INFO,"initialize, Temp ID set, continuing offline mode from previous app session"):pe&&!f?qe(n.INFO,"initialize, Temp ID set, entering offline mode"):(pe=!0,qe(n.INFO,"initialize, Temp ID set, enabling offline mode"))):(qe(n.INFO,"initialize, Generating the device ID"),this.device_id=m("device_id",h,je()),h&&Object.keys(h).length?void 0!==h.device_id&&(ve=s.DEVELOPER_SUPPLIED):void 0!==e.device_id&&(ve=s.DEVELOPER_SUPPLIED)),st("cly_id",this.device_id),st("cly_id_type",ve),a){for(var y in this.utm)c[y]?this.userData.set("utm_"+y,c[y]):this.userData.unset("utm_"+y);this.userData.save()}Ne(),setTimeout((function(){ze(),N.remote_config&&N.fetch_remote_config(N.remote_config)}),1),document.documentElement.setAttribute("data-countly-useragent",k())}},this.halt=function(){qe(n.WARNING,"halt, Resetting Countly"),e.i=void 0,V=!e.i,z=!1,j="/i",F="/o/sdk",$=500,q=1e3,K=[],H=[],G={},W=[],J={},Y=[],Q=null,Z=!0,X=0,ee=null,te=0,re=0,ne=0,se=60,ie=20,oe=0,ae=60,ce=100,he=null,le=!0,ue=30,de=!0,fe=!1,pe=!1,ye={},ge=!0,be=g(),me=!0,we=null,ve=s.SDK_GENERATED,Ee=!1,Ae=0;try{localStorage.setItem("cly_testLocal",!0),localStorage.removeItem("cly_testLocal")}catch(e){qe(n.ERROR,"halt, Local storage test failed, will fallback to cookies"),me=!1}e.features=[t.SESSIONS,t.EVENTS,t.VIEWS,t.SCROLLS,t.CLICKS,t.FORMS,t.CRASHES,t.ATTRIBUTION,t.USERS,t.STAR_RATING,t.LOCATION,t.APM,t.FEEDBACK,t.REMOTE_CONFIG],_e={};for(var r=0;r<e.features.length;r++)_e[e.features[r]]={};N.app_key=void 0,N.device_id=void 0,N.onload=void 0,N.utm=void 0,N.ignore_prefetch=void 0,N.debug=void 0,N.test_mode=void 0,N.metrics=void 0,N.headers=void 0,N.url=void 0,N.app_version=void 0,N.country_code=void 0,N.city=void 0,N.ip_address=void 0,N.ignore_bots=void 0,N.force_post=void 0,N.rcAutoOptinAb=void 0,N.useExplicitRcApi=void 0,N.remote_config=void 0,N.ignore_visitor=void 0,N.require_consent=void 0,N.track_domains=void 0,N.storage=void 0,N.enableOrientationTracking=void 0,N.maxKeyLength=void 0,N.maxValueSize=void 0,N.maxSegmentationValues=void 0,N.maxBreadcrumbCount=void 0,N.maxStackTraceLinesPerThread=void 0,N.maxStackTraceLineLength=void 0},this.group_features=function(e){if(qe(n.INFO,"group_features, Grouping features"),e)for(var t in e)_e[t]?qe(n.WARNING,"group_features, Feature name ["+t+"] is already reserved"):"string"==typeof e[t]?_e[t]={features:[e[t]]}:e[t]&&Array.isArray(e[t])&&e[t].length?_e[t]={features:e[t]}:qe(n.ERROR,"group_features, Incorrect feature list for ["+t+"] value: ["+e[t]+"]");else qe(n.ERROR,"group_features, Incorrect features:["+e+"]")},this.check_consent=function(e){return qe(n.INFO,"check_consent, Checking if consent is given for specific feature:["+e+"]"),this.require_consent?_e[e]?!(!_e[e]||!_e[e].optin):(qe(n.ERROR,"check_consent, No feature available for ["+e+"]"),!1):(qe(n.INFO,"check_consent, require_consent is off, no consent is necessary"),!0)},this.get_device_id_type=function(){var e;switch(qe(n.INFO,"check_device_id_type, Retrieving the current device id type.["+ve+"]"),ve){case s.SDK_GENERATED:e=N.DeviceIdType.SDK_GENERATED;break;case s.URL_PROVIDED:case s.DEVELOPER_SUPPLIED:e=N.DeviceIdType.DEVELOPER_SUPPLIED;break;case s.TEMPORARY_ID:e=N.DeviceIdType.TEMPORARY_ID;break;default:e=-1}return e},this.get_device_id=function(){return qe(n.INFO,"get_device_id, Retrieving the device id: ["+this.device_id+"]"),this.device_id},this.check_any_consent=function(){if(qe(n.INFO,"check_any_consent, Checking if any consent is given"),!this.require_consent)return qe(n.INFO,"check_any_consent, require_consent is off, no consent is necessary"),!0;for(var e in _e)if(_e[e]&&_e[e].optin)return!0;return qe(n.INFO,"check_any_consent, No consents given"),!1},this.add_consent=function(e){if(qe(n.INFO,"add_consent, Adding consent for ["+e+"]"),Array.isArray(e))for(var r=0;r<e.length;r++)this.add_consent(e[r]);else _e[e]?_e[e].features?(_e[e].optin=!0,this.add_consent(_e[e].features)):!0!==_e[e].optin&&(_e[e].optin=!0,ke(),setTimeout((function(){e===t.SESSIONS&&ye.begin_session?(N.begin_session.apply(N,ye.begin_session),ye.begin_session=null):e===t.VIEWS&&ye.track_pageview&&(ee=null,N.track_pageview.apply(N,ye.track_pageview),ye.track_pageview=null)}),1)):qe(n.ERROR,"add_consent, No feature available for ["+e+"]")},this.remove_consent=function(e){qe(n.INFO,"remove_consent, Removing consent for ["+e+"]"),this.remove_consent_internal(e,!0)},this.remove_consent_internal=function(e,t){if(t=t||!1,Array.isArray(e))for(var r=0;r<e.length;r++)this.remove_consent_internal(e[r],t);else _e[e]?_e[e].features?this.remove_consent_internal(_e[e].features,t):(_e[e].optin=!1,t&&!1!==_e[e].optin&&ke()):qe(n.ERROR,"remove_consent, No feature available for ["+e+"]")};var ke=function(){Se&&(clearTimeout(Se),Se=null),Se=setTimeout((function(){for(var t={},r=0;r<e.features.length;r++)!0===_e[e.features[r]].optin?t[e.features[r]]=!0:t[e.features[r]]=!1;Ve({consent:JSON.stringify(t)}),qe(n.DEBUG,"Consent update request has been sent to the queue.")}),1e3)};function Ie(e){if(N.ignore_visitor)qe(n.ERROR,"Adding event failed. Possible bot or user opt out");else if(e.key){e.count||(e.count=1),e.key=C(e.key,N.maxKeyLength,"add_cly_event",qe),e.segmentation=_(e.segmentation,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"add_cly_event",qe);var t=A(e,["key","count","sum","dur","segmentation"]);t.timestamp=b();var r=new Date;t.hour=r.getHours(),t.dow=r.getDay(),H.push(t),st("cly_event",H),qe(n.INFO,"Successfully adding event: ",e)}else qe(n.ERROR,"Adding event failed. Event must have a key property")}this.enable_offline_mode=function(){qe(n.INFO,"enable_offline_mode, Enabling offline mode"),this.remove_consent_internal(e.features,!1),pe=!0,this.device_id="[CLY]_temp_id",ve=s.TEMPORARY_ID},this.disable_offline_mode=function(e){qe(n.INFO,"disable_offline_mode, Disabling offline mode"),pe=!1,e&&this.device_id!==e?(this.device_id=e,ve=s.DEVELOPER_SUPPLIED,st("cly_id",this.device_id),st("cly_id_type",s.DEVELOPER_SUPPLIED),qe(n.INFO,"disable_offline_mode, Changing id to: "+this.device_id)):(this.device_id=je(),this.device_id!==nt("cly_id")&&(st("cly_id",this.device_id),st("cly_id_type",s.SDK_GENERATED)));var t=!1;if(K.length>0)for(var r=0;r<K.length;r++)"[CLY]_temp_id"===K[r].device_id&&(K[r].device_id=this.device_id,t=!0);t&&st("cly_queue",K,!0)},this.begin_session=function(e,r){if(qe(n.INFO,"begin_session, Starting the session"),e&&qe(n.INFO,"begin_session, Heartbeats are disabled"),r&&qe(n.INFO,"begin_session, Session starts irrespective of session cookie"),this.check_consent(t.SESSIONS)){if(!z){this.enableOrientationTracking&&(this.report_orientation(),d(window,"resize",(function(){N.report_orientation()}))),l=g(),z=!0,Z=!e;var s=nt("cly_session");if(r||!le||!s||parseInt(s)<=g()){qe(n.INFO,"begin_session, Session started"),null===we&&(we=!0);var i={begin_session:1};i.metrics=JSON.stringify($e()),Ve(i)}st("cly_session",g()+60*ue)}}else ye.begin_session=arguments},this.session_duration=function(e){qe(n.INFO,"session_duration, Reporting session duration"),this.check_consent(t.SESSIONS)&&z&&(qe(n.INFO,"session_duration, Session extended: ",e),Ve({session_duration:e}),Be())},this.end_session=function(e,r){qe(n.INFO,"end_session, Ending the current session"),this.check_consent(t.SESSIONS)&&z&&(e=e||g()-l,Le(),!le||r?(qe(n.INFO,"end_session, Session ended"),Ve({end_session:1,session_duration:e})):this.session_duration(e),z=!1)},this.change_id=function(t,r){if(qe(n.INFO,"change_id, Changing the ID"),r&&qe(n.INFO,"change_id, Will merge the IDs"),t&&"string"==typeof t&&0!==t.length){if(pe)return qe(n.WARNING,"change_id, Offline mode was on, initiating disabling sequence instead."),void this.disable_offline_mode(t);if(this.device_id!==t){r||(De(),this.end_session(null,!0),J={},this.remove_consent_internal(e.features,!1));var i=this.device_id;this.device_id=t,ve=s.DEVELOPER_SUPPLIED,st("cly_id",this.device_id),st("cly_id_type",s.DEVELOPER_SUPPLIED),qe(n.INFO,"change_id, Changing ID from:["+i+"] to ["+t+"]"),r?Ve({old_device_id:i}):this.begin_session(!Z,!0),this.remote_config&&(st("cly_remote_configs",G={}),this.fetch_remote_config(this.remote_config))}}else qe(n.ERROR,"change_id, The provided ID: ["+t+"] is not a valid ID")},this.add_event=function(e){qe(n.INFO,"add_event, Adding event: ",e);var t=!1;switch(e.key){case r.NPS:case r.SURVEY:t=this.check_consent("feedback");break;case r.STAR_RATING:t=this.check_consent("star-rating");break;case r.VIEW:t=this.check_consent("views");break;case r.ORIENTATION:t=this.check_consent("users");break;case r.PUSH_ACTION:t=this.check_consent("push");break;case r.ACTION:t=this.check_consent("clicks")||this.check_consent("scroll");break;default:t=this.check_consent("events")}t&&Ie(e)},this.start_event=function(e){qe(n.INFO,"start_event, Starting timed event with key: ["+e+"]"),e=C(e,N.maxKeyLength,"start_event",qe),J[e]?qe(n.WARNING,"start_event, Timed event with key ["+e+"] already started"):J[e]=g()},this.end_event=function(e){qe(n.INFO,"end_event, Ending timed event"),"string"==typeof e&&(e={key:e}),e.key?J[e.key]?(e.dur=g()-J[e.key],this.add_event(e),delete J[e.key]):qe(n.ERROR,"end_event, Timed event with key ["+e.key+"] was not started"):qe(n.ERROR,"end_event, Timed event must have a key property")},this.report_orientation=function(e){qe(n.INFO,"report_orientation, Reporting orientation"),this.check_consent(t.USERS)&&Ie({key:r.ORIENTATION,segmentation:{mode:e||O()}})},this.report_conversion=function(e,t){qe(n.WARNING,"report_conversion, Deprecated function call! Use 'recordDirectAttribution' in place of this call. Call will be redirected now!"),this.recordDirectAttribution(e,t)},this.recordDirectAttribution=function(e,r){qe(n.INFO,"recordDirectAttribution, Recording the attribution for campaign ID: ["+e+"] and the user ID: ["+r+"]"),this.check_consent(t.ATTRIBUTION)&&(e=e||nt("cly_cmp_id")||"cly_organic",Ve((r=r||nt("cly_cmp_uid"))?{campaign_id:e,campaign_user:r}:{campaign_id:e}))},this.user_details=function(e){if(qe(n.INFO,"user_details, Trying to add user details: ",e),this.check_consent(t.USERS)){e.name=C(e.name,N.maxValueSize,"user_details",qe),e.username=C(e.username,N.maxValueSize,"user_details",qe),e.email=C(e.email,N.maxValueSize,"user_details",qe),e.organization=C(e.organization,N.maxValueSize,"user_details",qe),e.phone=C(e.phone,N.maxValueSize,"user_details",qe),e.picture=C(e.picture,4096,"user_details",qe),e.gender=C(e.gender,N.maxValueSize,"user_details",qe),e.byear=C(e.byear,N.maxValueSize,"user_details",qe),e.custom=_(e.custom,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"user_details",qe);var r=["name","username","email","organization","phone","picture","gender","byear","custom"];Ve({user_details:JSON.stringify(A(e,r))})}};var Te={},xe=function(e,r,n){N.check_consent(t.USERS)&&(Te[e]||(Te[e]={}),"$push"===n||"$pull"===n||"$addToSet"===n?(Te[e][n]||(Te[e][n]=[]),Te[e][n].push(r)):Te[e][n]=r)};function Re(e,r,s,i,o){qe(n.INFO,"fetch_remote_config_explicit, Fetching sequence initiated");var a,c={method:"rc"};e&&(c.keys=JSON.stringify(e)),r&&(c.omit_keys=JSON.stringify(r)),"legacy"===i&&(c.method="fetch_remote_config"),0===s&&(c.oi=0),1===s&&(c.oi=1),"function"==typeof o&&(a=o),N.check_consent(t.SESSIONS)&&(c.metrics=JSON.stringify($e())),N.check_consent(t.REMOTE_CONFIG)?(Me(c),Ke("fetch_remote_config_explicit",N.url+F,c,(function(e,t,r){if(e)qe(n.ERROR,"fetch_remote_config_explicit, An error occurred: "+e);else{try{var s=JSON.parse(r);if(c.keys||c.omit_keys)for(var i in s)G[i]=s[i];else G=s;st("cly_remote_configs",G)}catch(e){qe(n.ERROR,"fetch_remote_config_explicit, Had an issue while parsing the response: "+e)}a&&(qe(n.INFO,"fetch_remote_config_explicit, Callback function is provided"),a(e,G))}}),!0)):(qe(n.ERROR,"fetch_remote_config_explicit, Remote config requires explicit consent"),a&&a(new Error("Remote config requires explicit consent"),G))}function Pe(){N.ignore_prefetch&&void 0!==document.visibilityState&&"prerender"===document.visibilityState&&(N.ignore_visitor=!0),N.ignore_bots&&T()&&(N.ignore_visitor=!0)}function De(){H.length>0&&(Ve({events:JSON.stringify(H)}),st("cly_event",H=[]))}function Oe(e,t){if(document.getElementById("countly-feedback-sticker-"+e._id))qe(n.ERROR,"Widget with same ID exists");else try{var r=document.createElement("div");r.className="countly-iframe-wrapper",r.id="countly-iframe-wrapper-"+e._id;var s=document.createElement("span");s.className="countly-feedback-close-icon",s.id="countly-feedback-close-icon-"+e._id,s.innerText="x";var i=document.createElement("iframe");if(i.name="countly-feedback-iframe",i.id="countly-feedback-iframe",i.src=N.url+"/feedback?widget_id="+e._id+"&app_key="+N.app_key+"&device_id="+N.device_id+"&sdk_version="+o,document.body.appendChild(r),r.appendChild(s),r.appendChild(i),d(document.getElementById("countly-feedback-close-icon-"+e._id),"click",(function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="none",document.getElementById("cfbg").style.display="none"})),t){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.id="feedback-sticker-svg",a.setAttribute("aria-hidden","true"),a.setAttribute("data-prefix","far"),a.setAttribute("data-icon","grin"),a.setAttribute("class","svg-inline--fa fa-grin fa-w-16"),a.setAttribute("role","img"),a.setAttribute("xmlns","http://www.w3.org/2000/svg"),a.setAttribute("viewBox","0 0 496 512");var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.id="smileyPathInStickerSvg",c.setAttribute("fill","white"),c.setAttribute("d","M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm105.6-151.4c-25.9 8.3-64.4 13.1-105.6 13.1s-79.6-4.8-105.6-13.1c-9.9-3.1-19.4 5.4-17.7 15.3 7.9 47.1 71.3 80 123.3 80s115.3-32.9 123.3-80c1.6-9.8-7.7-18.4-17.7-15.3zM168 240c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32z");var h=document.createElement("span");h.innerText=e.trigger_button_text;var l=document.createElement("div");l.style.color=e.trigger_font_color.length<7?"#"+e.trigger_font_color:e.trigger_font_color,l.style.backgroundColor=e.trigger_bg_color.length<7?"#"+e.trigger_bg_color:e.trigger_bg_color,l.className="countly-feedback-sticker  "+e.trigger_position+"-"+e.trigger_size,l.id="countly-feedback-sticker-"+e._id,a.appendChild(c),l.appendChild(a),l.appendChild(h),document.body.appendChild(l);var u=document.getElementById("smileyPathInStickerSvg");u&&(u.style.fill=e.trigger_font_color.length<7?"#"+e.trigger_font_color:e.trigger_font_color),d(document.getElementById("countly-feedback-sticker-"+e._id),"click",(function(){document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}))}else document.getElementById("countly-iframe-wrapper-"+e._id).style.display="block",document.getElementById("cfbg").style.display="block"}catch(e){qe(n.ERROR,"Somethings went wrong while element injecting process: "+e)}}function Ne(){var e;if(void 0!==N.onload&&N.onload.length>0){for(e=0;e<N.onload.length;e++)"function"==typeof N.onload[e]&&N.onload[e](N);N.onload=[]}}function Le(){if(ee){var e={name:ee};N.check_consent(t.VIEWS)&&Ie({key:r.VIEW,dur:ge?g()-te:re,segmentation:e}),ee=null}}function Ue(){return ee}function Be(){if(le){var e=nt("cly_session");(!e||parseInt(e)<=g())&&(z=!1,N.begin_session(!Z)),st("cly_session",g()+60*ue)}}function Me(e){e.app_key=N.app_key,e.device_id=N.device_id,e.sdk_name=a,e.sdk_version=o,e.t=ve,N.check_consent(t.LOCATION)?(N.country_code&&(e.country_code=N.country_code),N.city&&(e.city=N.city),null!==N.ip_address&&(e.ip_address=N.ip_address)):e.location="",e.timestamp=b();var r=new Date;e.hour=r.getHours(),e.dow=r.getDay()}function Ve(e){N.ignore_visitor?qe(n.WARNING,"User is opt_out will ignore the request: "+e):N.app_key&&N.device_id?(Me(e),K.length>q&&K.shift(),K.push(e),st("cly_queue",K,!0)):qe(n.ERROR,"app_key or device_id is missing ",N.app_key,N.device_id)}function ze(){if(Ne(),N.ignore_visitor)return fe=!1,void qe(n.WARNING,"User opt_out, no heartbeat");fe=!0;var t=0;if(V&&void 0!==e.q&&e.q.length>0){var r,s=e.q;for(e.q=[],t=0;t<s.length;t++)if(r=s[t],qe(n.DEBUG,"Processing queued call",r),"function"==typeof r)r();else if(Array.isArray(r)&&r.length>0){var i=N,o=0;if(e.i[r[o]]&&(i=e.i[r[o]],o++),"function"==typeof i[r[o]])i[r[o]].apply(i,r.slice(o+1));else if(0===r[o].indexOf("userData.")){var a=r[o].replace("userData.","");"function"==typeof i.userData[a]&&i.userData[a].apply(i,r.slice(o+1))}else"function"==typeof e[r[o]]&&e[r[o]].apply(e,r.slice(o+1))}}if(z&&Z&&ge){var c=g();c-l>ae&&(N.session_duration(c-l),l=c)}if(H.length>0){if(H.length<=ce)Ve({events:JSON.stringify(H)}),H=[];else{var h=H.splice(0,ce);Ve({events:JSON.stringify(h)})}st("cly_event",H)}if(!pe&&K.length>0&&de&&g()>ne){de=!1;var u=K[0];qe(n.DEBUG,"Processing request",u),st("cly_queue",K,!0),N.test_mode||Ke("send_request_queue",N.url+j,u,(function(e,t){qe(n.DEBUG,"Request Finished",t,e),e?(ne=g()+se,qe(n.ERROR,"Request error: ",e)):K.shift(),st("cly_queue",K,!0),de=!0}),!1)}setTimeout(ze,$)}function je(){var e=nt("cly_id");return e?(ve=nt("cly_id_type"),e):y()}function Fe(e){return/[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-4[0-9a-fA-F]{3}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}/.test(e)}function $e(){var e=JSON.parse(JSON.stringify(N.metrics||{}));if(e._app_version=e._app_version||N.app_version,e._ua=e._ua||k(),screen.width){var t=screen.width?parseInt(screen.width):0,r=screen.height?parseInt(screen.height):0;if(0!==t&&0!==r){if(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&window.devicePixelRatio)t=Math.round(t*window.devicePixelRatio),r=Math.round(r*window.devicePixelRatio);else if(90===Math.abs(window.orientation)){var s=t;t=r,r=s}e._resolution=e._resolution||t+"x"+r}}window.devicePixelRatio&&(e._density=e._density||window.devicePixelRatio);var i=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;if(void 0!==i&&(e._locale=e._locale||i),void 0!==document.referrer&&document.referrer.length){var o=c.exec(document.referrer);if(o&&o[11]&&o[11]!==window.location.hostname){var a=!1;if(Y&&Y.length)for(var h=0;h<Y.length;h++)try{if(new RegExp(Y[h]).test(document.referrer)){qe(n.DEBUG,"Ignored: "+document.referrer),a=!0;break}}catch(e){qe(n.ERROR,"Problem with ignoring: "+Y[h],", error: "+e)}a||(e._store=e._store||document.referrer)}}return qe(n.DEBUG,"Got metrics",e),e}function qe(e,t){if(N.debug&&"undefined"!=typeof console){arguments[2]&&"object"==typeof arguments[2]&&(arguments[2]=JSON.stringify(arguments[2])),V||(t="["+N.app_key+"] "+t),e||(e=n.DEBUG);for(var r="",s=2;s<arguments.length;s++)r+=arguments[s];var i=e+t+r;e===n.ERROR?console.error(i):e===n.WARNING?console.warn(i):e===n.INFO?console.info(i):e===n.VERBOSE?console.log(i):console.debug(i)}}function Ke(e,t,r,s,i){i=i||!1;try{qe(n.DEBUG,"Sending XML HTTP request");var o=null;window.XMLHttpRequest?o=new window.XMLHttpRequest:window.ActiveXObject&&(o=new window.ActiveXObject("Microsoft.XMLHTTP"));var a=v(r=r||{}),c="GET";for(var h in(N.force_post||a.length>=2e3)&&(c="POST"),"GET"===c?o.open("GET",t+"?"+a,!0):(o.open("POST",t,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded")),N.headers)o.setRequestHeader(h,N.headers[h]);o.onreadystatechange=function(){4===this.readyState&&(qe(n.DEBUG,e+" HTTP request completed ["+this.status+"]["+this.responseText+"]"),(i?Ge(this.status,this.responseText):He(this.status,this.responseText))?"function"==typeof s&&s(!1,r,this.responseText):(qe(n.ERROR,e+" Failed Server XML HTTP request, ",this.status),"function"==typeof s&&s(!0,r)))},"GET"===c?o.send():o.send(a)}catch(t){qe(n.ERROR,e+" Failed XML HTTP request: "+t),"function"==typeof s&&s(!0,r)}}function He(e,t){if(!(e>=200&&e<300))return qe(n.ERROR,"Http response status code is not within the expected range:["+e+"]"),!1;try{var r=JSON.parse(t);return"[object Object]"!==Object.prototype.toString.call(r)?(qe(n.ERROR,"Http response is not JSON Object"),!1):!!r.result}catch(e){return qe(n.ERROR,"Http response is not JSON: "+e),!1}}function Ge(e,t){if(!(e>=200&&e<300))return qe(n.ERROR,"Http response status code is not within the expected range: "+e),!1;try{var r=JSON.parse(t);return!("[object Object]"!==Object.prototype.toString.call(r)&&!Array.isArray(r)&&(qe(n.ERROR,"Http response is not JSON Object nor JSON Array"),1))}catch(e){return qe(n.ERROR,"Http response is not JSON: "+e),!1}}function We(){Ae=Math.max(Ae,window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)}function Je(){if(Ee){Ee=!1;var e=R(),n=P(),s=D();if(N.check_consent(t.SCROLLS)){var i={type:"scroll",y:Ae+s,width:n,height:e,view:N.getViewUrl()};i=_(i,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"processScrollView",qe),N.track_domains&&(i.domain=window.location.hostname),Ie({key:r.ACTION,segmentation:i})}}}function Ye(){return ve}function Qe(e){st("cly_token",e)}function Ze(){var e=nt("cly_token");return it("cly_token"),e}function Xe(){return H}function et(){return K}function tt(e){for(var t=e+"=",r=document.cookie.split(";"),n=0,s=r.length;n<s;n++){for(var i=r[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}function rt(e,t,r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);var s="; expires="+n.toGMTString();document.cookie=e+"="+t+s+"; path=/"}function nt(e,t,r){var s;if("none"!==N.storage)return r||(e=N.app_key+"/"+e,N.namespace&&(e=E(N.namespace)+"/"+e)),void 0===t&&(t=me),t?s=localStorage.getItem(e):"localstorage"!==N.storage&&(s=tt(e)),N.deserialize(s);qe(n.WARNING,"Storage is disabled. Value with key: "+e+" won't be retrieved")}function st(e,t,r,s){"none"!==N.storage?(s||(e=N.app_key+"/"+e,N.namespace&&(e=E(N.namespace)+"/"+e)),void 0===r&&(r=me),null!=t&&(t=N.serialize(t),r?localStorage.setItem(e,t):"localstorage"!==N.storage&&rt(e,t,30))):qe(n.WARNING,"Storage is disabled. Value with key: "+e+" won't be stored")}function it(e,t,r){"none"!==N.storage?(r||(e=N.app_key+"/"+e,N.namespace&&(e=E(N.namespace)+"/"+e)),void 0===t&&(t=me),t?localStorage.removeItem(e):"localstorage"!==N.storage&&rt(e,"",-1)):qe(n.WARNING,"Storage is disabled. Value with key: "+e+" won't be removed")}function ot(){if(nt(N.namespace+"cly_id",!1,!0)){st("cly_id",nt(N.namespace+"cly_id",!1,!0)),st("cly_id_type",nt(N.namespace+"cly_id_type",!1,!0)),st("cly_event",nt(N.namespace+"cly_event",!1,!0)),st("cly_session",nt(N.namespace+"cly_session",!1,!0));var e=nt(N.namespace+"cly_queue",!1,!0);Array.isArray(e)&&st("cly_queue",e=e.filter((function(e){return e.app_key===N.app_key}))),nt(N.namespace+"cly_cmp_id",!1,!0)&&(st("cly_cmp_id",nt(N.namespace+"cly_cmp_id",!1,!0)),st("cly_cmp_uid",nt(N.namespace+"cly_cmp_uid",!1,!0))),nt(N.namespace+"cly_ignore",!1,!0)&&st("cly_ignore",nt(N.namespace+"cly_ignore",!1,!0)),it("cly_id",!1,!0),it("cly_id_type",!1,!0),it("cly_event",!1,!0),it("cly_session",!1,!0),it("cly_queue",!1,!0),it("cly_cmp_id",!1,!0),it("cly_cmp_uid",!1,!0),it("cly_ignore",!1,!0)}}this.userData={set:function(e,t){qe(n.INFO,"set, Setting user's custom property value: ["+t+"] under the key: ["+e+"]"),e=C(e,N.maxKeyLength,"userData set",qe),t=C(t,N.maxValueSize,"userData set",qe),Te[e]=t},unset:function(e){qe(n.INFO,"unset, Resetting user's custom property with key: ["+e+"] "),Te[e]=""},set_once:function(e,t){qe(n.INFO,"set_once, Setting user's unique custom property value: ["+t+"] under the key: ["+e+"] "),e=C(e,N.maxKeyLength,"userData set_once",qe),t=C(t,N.maxValueSize,"userData set_once",qe),xe(e,t,"$setOnce")},increment:function(e){qe(n.INFO,"increment, Increasing user's custom property value under the key: ["+e+"] by one"),e=C(e,N.maxKeyLength,"userData increment",qe),xe(e,1,"$inc")},increment_by:function(e,t){qe(n.INFO,"increment_by, Increasing user's custom property value under the key: ["+e+"] by: ["+t+"]"),e=C(e,N.maxKeyLength,"userData increment_by",qe),t=C(t,N.maxValueSize,"userData increment_by",qe),xe(e,t,"$inc")},multiply:function(e,t){qe(n.INFO,"multiply, Multiplying user's custom property value under the key: ["+e+"] by: ["+t+"]"),e=C(e,N.maxKeyLength,"userData multiply",qe),t=C(t,N.maxValueSize,"userData multiply",qe),xe(e,t,"$mul")},max:function(e,t){qe(n.INFO,"max, Saving user's maximum custom property value compared to the value: ["+t+"] under the key: ["+e+"]"),e=C(e,N.maxKeyLength,"userData max",qe),t=C(t,N.maxValueSize,"userData max",qe),xe(e,t,"$max")},min:function(e,t){qe(n.INFO,"min, Saving user's minimum custom property value compared to the value: ["+t+"] under the key: ["+e+"]"),e=C(e,N.maxKeyLength,"userData min",qe),t=C(t,N.maxValueSize,"userData min",qe),xe(e,t,"$min")},push:function(e,t){qe(n.INFO,"push, Pushing a value: ["+t+"] under the key: ["+e+"] to user's custom property array"),e=C(e,N.maxKeyLength,"userData push",qe),t=C(t,N.maxValueSize,"userData push",qe),xe(e,t,"$push")},push_unique:function(e,t){qe(n.INFO,"push_unique, Pushing a unique value: ["+t+"] under the key: ["+e+"] to user's custom property array"),e=C(e,N.maxKeyLength,"userData push_unique",qe),t=C(t,N.maxValueSize,"userData push_unique",qe),xe(e,t,"$addToSet")},pull:function(e,t){qe(n.INFO,"pull, Removing the value: ["+t+"] under the key: ["+e+"] from user's custom property array"),xe(e,t,"$pull")},save:function(){qe(n.INFO,"save, Saving changes to user's custom property"),N.check_consent(t.USERS)&&Ve({user_details:JSON.stringify({custom:Te})}),Te={}}},this.report_trace=function(e){if(qe(n.INFO,"report_trace, Reporting performance trace"),this.check_consent(t.APM)){for(var r=["type","name","stz","etz","apm_metrics","apm_attr"],s=0;s<r.length;s++)if("apm_attr"!==r[s]&&void 0===e[r[s]])return void qe(n.WARNING,"report_trace, APM trace don't have the property: "+r[s]);e.name=C(e.name,N.maxKeyLength,"report_trace",qe),e.app_metrics=_(e.app_metrics,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"report_trace",qe);var i=A(e,r);i.timestamp=e.stz;var o=new Date;i.hour=o.getHours(),i.dow=o.getDay(),Ve({apm:JSON.stringify(i)}),qe(n.INFO,"report_trace, Successfully adding APM trace: ",i)}},this.track_errors=function(t){qe(n.INFO,"track_errors, Started tracking errors"),e.i[this.app_key].tracking_crashes=!0,window.cly_crashes||(window.cly_crashes=!0,Q=t,window.onerror=function e(t,r,s,i,o){if(null!=o)w(o,!1);else{var a="";void 0!==t&&(a+=t+"\n"),void 0!==r&&(a+="at "+r),void 0!==s&&(a+=":"+s),void 0!==(i=i||window.event&&window.event.errorCharacter)&&(a+=":"+i),a+="\n";try{for(var c=[],h=e.caller;h;)c.push(h.name),h=h.caller;a+=c.join("\n")}catch(e){qe(n.ERROR,"track_errors, Call stack generation experienced a problem: "+e)}w(a,!1)}},window.addEventListener("unhandledrejection",(function(e){w(new Error("Unhandled rejection (reason: "+(e.reason&&e.reason.stack?e.reason.stack:e.reason)+")."),!0)})))},this.log_error=function(e,t){qe(n.INFO,"log_error, Logging errors"),this.recordError(e,!0,t)},this.add_log=function(e){if(qe(n.INFO,"add_log, Adding a new log of breadcrumbs: [ "+e+" ]"),this.check_consent(t.CRASHES)){for(e=C(e,N.maxValueSize,"add_log",qe);W.length>=N.maxBreadcrumbCount;)W.shift(),qe(n.WARNING,"add_log, Reached maximum crashLogs size. Will erase the oldest one.");W.push(e)}},this.fetch_remote_config=function(e,t,r){var s=null,i=null,o=null;if(e&&(r||"function"!=typeof e?Array.isArray(e)&&(s=e):o=e),t&&(r||"function"!=typeof t?Array.isArray(t)&&(i=t):o=t),o||"function"!=typeof r||(o=r),this.useExplicitRcApi)return qe(n.INFO,"fetch_remote_config, Fetching remote config"),void Re(s,i,this.rcAutoOptinAb?1:0,null,o);qe(n.WARNING,"fetch_remote_config, Fetching remote config, with legacy API"),Re(s,i,null,"legacy",o)},this.enrollUserToAb=function(e){if(qe(n.INFO,"enrollUserToAb, Providing AB test keys to opt in for"),e&&Array.isArray(e)&&0!==e.length){var t={method:"ab",keys:JSON.stringify(e)};Me(t),Ke("enrollUserToAb",this.url+F,t,(function(e,t,r){if(e)qe(n.ERROR,"enrollUserToAb, An error occurred: "+e);else try{var s=JSON.parse(r);qe(n.DEBUG,"enrollUserToAb, Parsed the response's result: ["+s.result+"]")}catch(e){qe(n.ERROR,"enrollUserToAb, Had an issue while parsing the response: "+e)}}),!0)}else qe(n.ERROR,"enrollUserToAb, No keys provided")},this.get_remote_config=function(e){return qe(n.INFO,"get_remote_config, Getting remote config from storage"),void 0!==e?G[e]:G},this.stop_time=function(){qe(n.INFO,"stop_time, Stopping tracking duration"),ge&&(ge=!1,X=g()-l,re=g()-te)},this.start_time=function(){qe(n.INFO,"start_time, Starting tracking duration"),ge||(ge=!0,l=g()-X,te=g()-re,re=0,Be())},this.track_sessions=function(){qe(n.INFO,"track_session, Starting tracking user session"),this.begin_session(),this.start_time(),d(window,"beforeunload",(function(){De(),N.end_session()}));var e="hidden";function t(){document[e]||!document.hasFocus()?N.stop_time():N.start_time()}function r(){oe>=ie&&N.start_time(),oe=0}d(window,"focus",t),d(window,"blur",t),d(window,"pageshow",t),d(window,"pagehide",t),"onfocusin"in document&&(d(window,"focusin",t),d(window,"focusout",t)),e in document?document.addEventListener("visibilitychange",t):"mozHidden"in document?(e="mozHidden",document.addEventListener("mozvisibilitychange",t)):"webkitHidden"in document?(e="webkitHidden",document.addEventListener("webkitvisibilitychange",t)):"msHidden"in document&&(e="msHidden",document.addEventListener("msvisibilitychange",t)),d(window,"mousemove",r),d(window,"click",r),d(window,"keydown",r),d(window,"scroll",r),setInterval((function(){++oe>=ie&&N.stop_time()}),6e4)},this.track_pageview=function(e,s,i){if(qe(n.INFO,"track_pageview, Tracking page views"),qe(n.VERBOSE,"track_pageview, last view is:["+ee+"]"),ee&&(qe(n.DEBUG,"track_pageview, Scroll registry triggered"),Je(),Ee=!0,Ae=0),Le(),(e=C(e,N.maxKeyLength,"track_pageview",qe))&&Array.isArray(e)&&(s=e,e=null),e||(e=this.getViewName()),void 0!==e&&""!==e)if(null!==e){if(s&&s.length)for(var o=0;o<s.length;o++)try{if(new RegExp(s[o]).test(e))return void qe(n.INFO,"track_pageview, Ignoring the page: "+e)}catch(e){qe(n.ERROR,"track_pageview, Problem with finding ignore list item: "+s[o]+", error: "+e)}ee=e,te=g(),qe(n.VERBOSE,"track_pageview, last view is assigned:["+ee+"]");var a={name:e,visit:1,view:N.getViewUrl()};if(a=_(a,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"track_pageview",qe),this.track_domains&&(a.domain=window.location.hostname),le)if(z)we&&(we=!1,a.start=1);else{var h=nt("cly_session");(!h||parseInt(h)<=g())&&(we=!1,a.start=1)}else if(void 0!==document.referrer&&document.referrer.length){var l=c.exec(document.referrer);l&&l[11]&&l[11]!==window.location.hostname&&(a.start=1)}if(i)for(var u in i=_(i,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"track_pageview",qe))void 0===a[u]&&(a[u]=i[u]);this.check_consent(t.VIEWS)?Ie({key:r.VIEW,segmentation:a}):ye.track_pageview=arguments}else qe(n.ERROR,"track_pageview, View name returned as null. Page view will be ignored.");else qe(n.ERROR,"track_pageview, No page name to track (it is either undefined or empty string). No page view can be tracked.")},this.track_view=function(e,t,r){qe(n.INFO,"track_view, Initiating tracking page views"),this.track_pageview(e,t,r)},this.track_clicks=function(e){qe(n.INFO,"track_clicks, Starting to track clicks"),e&&qe(n.INFO,"track_clicks, Tracking the specified children:["+e+"]"),e=e||document;var s=!0;function i(e){if(s){if(s=!1,x(e),void 0!==e.pageX&&void 0!==e.pageY){var n=R(),i=P();if(N.check_consent(t.CLICKS)){var o={type:"click",x:e.pageX,y:e.pageY,width:i,height:n,view:N.getViewUrl()};o=_(o,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"processClick",qe),N.track_domains&&(o.domain=window.location.hostname),Ie({key:r.ACTION,segmentation:o})}}setTimeout((function(){s=!0}),1e3)}}d(e,"click",i)},this.track_scrolls=function(e){qe(n.INFO,"track_scrolls, Starting to track scrolls"),e&&qe(n.INFO,"track_scrolls, Tracking the specified children"),e=e||window,Ee=!0,d(e,"scroll",We),d(e,"beforeunload",Je)},this.track_links=function(e){function r(e){var r=u(f(e),"a");r&&(x(e),N.check_consent(t.CLICKS)&&Ie({key:"linkClick",segmentation:{href:r.href,text:r.innerText,id:r.id,view:N.getViewUrl()}}))}qe(n.INFO,"track_links, Starting to track clicks to links"),e&&qe(n.INFO,"track_links, Tracking the specified children"),e=e||document,d(e,"click",r)},this.track_forms=function(e,r){function s(e){return e.name||e.id||e.type||e.nodeName}function i(e){var n,i=f(e),o={id:i.attributes.id&&i.attributes.id.nodeValue,name:i.attributes.name&&i.attributes.name.nodeValue,action:i.attributes.action&&i.attributes.action.nodeValue,method:i.attributes.method&&i.attributes.method.nodeValue,view:N.getViewUrl()};if(void 0!==i.elements){for(var a=0;a<i.elements.length;a++)(n=i.elements[a])&&"password"!==n.type&&-1===n.className.indexOf("cly_user_ignore")&&(void 0===o["input:"+s(n)]&&(o["input:"+s(n)]=[]),"select"===n.nodeName.toLowerCase()?void 0!==n.multiple?o["input:"+s(n)].push(p(n)):o["input:"+s(n)].push(n.options[n.selectedIndex].value):"input"===n.nodeName.toLowerCase()?void 0!==n.type?"checkbox"===n.type.toLowerCase()||"radio"===n.type.toLowerCase()?n.checked&&o["input:"+s(n)].push(n.value):("hidden"!==n.type.toLowerCase()||r)&&o["input:"+s(n)].push(n.value):o["input:"+s(n)].push(n.value):("textarea"===n.nodeName.toLowerCase()||void 0!==n.value)&&o["input:"+s(n)].push(n.value));for(var c in o)o[c]&&"function"==typeof o[c].join&&(o[c]=o[c].join(", "))}N.check_consent(t.FORMS)&&Ie({key:"formSubmit",segmentation:o})}qe(n.INFO,"track_forms, Starting to track form submissions. DOM object provided:["+!!e+"] Tracking hidden inputs :["+!!r+"]"),e=e||document,d(e,"submit",i)},this.collect_from_forms=function(e,t){function r(r){var s,i=f(r),o={},a=!1;if(void 0!==i.elements){var c,h,l={},u=e.getElementsByTagName("LABEL");for(c=0;c<u.length;c++)u[c].htmlFor&&""!==u[c].htmlFor&&(l[u[c].htmlFor]=u[c].innerText||u[c].textContent||u[c].innerHTML);for(c=0;c<i.elements.length;c++)if((s=i.elements[c])&&"password"!==s.type&&-1===s.className.indexOf("cly_user_ignore")){var d="";if("select"===s.nodeName.toLowerCase()?d=void 0!==s.multiple?p(s):s.options[s.selectedIndex].value:"input"===s.nodeName.toLowerCase()?(void 0===s.type||"checkbox"!==s.type.toLowerCase()&&"radio"!==s.type.toLowerCase()||s.checked)&&(d=s.value):("textarea"===s.nodeName.toLowerCase()||void 0!==s.value)&&(d=s.value),s.className&&-1!==s.className.indexOf("cly_user_")){var y=s.className.split(" ");for(h=0;h<y.length;h++)if(0===y[h].indexOf("cly_user_")){o[y[h].replace("cly_user_","")]=d,a=!0;break}}else s.type&&"email"===s.type.toLowerCase()||s.name&&-1!==s.name.toLowerCase().indexOf("email")||s.id&&-1!==s.id.toLowerCase().indexOf("email")||s.id&&l[s.id]&&-1!==l[s.id].toLowerCase().indexOf("email")||/[^@\s]+@[^@\s]+\.[^@\s]+/.test(d)?(o.email||(o.email=d),a=!0):s.name&&-1!==s.name.toLowerCase().indexOf("username")||s.id&&-1!==s.id.toLowerCase().indexOf("username")||s.id&&l[s.id]&&-1!==l[s.id].toLowerCase().indexOf("username")?(o.username||(o.username=d),a=!0):s.name&&(-1!==s.name.toLowerCase().indexOf("tel")||-1!==s.name.toLowerCase().indexOf("phone")||-1!==s.name.toLowerCase().indexOf("number"))||s.id&&(-1!==s.id.toLowerCase().indexOf("tel")||-1!==s.id.toLowerCase().indexOf("phone")||-1!==s.id.toLowerCase().indexOf("number"))||s.id&&l[s.id]&&(-1!==l[s.id].toLowerCase().indexOf("tel")||-1!==l[s.id].toLowerCase().indexOf("phone")||-1!==l[s.id].toLowerCase().indexOf("number"))?(o.phone||(o.phone=d),a=!0):s.name&&(-1!==s.name.toLowerCase().indexOf("org")||-1!==s.name.toLowerCase().indexOf("company"))||s.id&&(-1!==s.id.toLowerCase().indexOf("org")||-1!==s.id.toLowerCase().indexOf("company"))||s.id&&l[s.id]&&(-1!==l[s.id].toLowerCase().indexOf("org")||-1!==l[s.id].toLowerCase().indexOf("company"))?(o.organization||(o.organization=d),a=!0):(s.name&&-1!==s.name.toLowerCase().indexOf("name")||s.id&&-1!==s.id.toLowerCase().indexOf("name")||s.id&&l[s.id]&&-1!==l[s.id].toLowerCase().indexOf("name"))&&(o.name||(o.name=""),o.name+=d+" ",a=!0)}}a&&(qe(n.INFO,"collect_from_forms, Gathered user data",o),t?N.user_details({custom:o}):N.user_details(o))}qe(n.INFO,"collect_from_forms, Starting to collect possible user data. DOM object provided:["+!!e+"] Submitting custom user property:["+!!t+"]"),e=e||document,d(e,"submit",r)},this.collect_from_facebook=function(e){qe(n.INFO,"collect_from_facebook, Starting to collect possible user data"),FB&&FB.api&&FB.api("/me",(function(t){var r={};if(t.name&&(r.name=t.name),t.email&&(r.email=t.email),"male"===t.gender?r.gender="M":"female"===t.gender&&(r.gender="F"),t.birthday){var n=t.birthday.split("/").pop();n&&4===n.length&&(r.byear=n)}if(t.work&&t.work[0]&&t.work[0].employer&&t.work[0].employer.name&&(r.organization=t.work[0].employer.name),e)for(var s in r.custom={},e){for(var i=e[s].split("."),o=t,a=0;a<i.length&&void 0!==(o=o[i[a]]);a++);void 0!==o&&(r.custom[s]=o)}N.user_details(r)}))},this.opt_out=function(){qe(n.INFO,"opt_out, Opting out the user"),this.ignore_visitor=!0,st("cly_ignore",!0)},this.opt_in=function(){qe(n.INFO,"opt_in, Opting in the user"),st("cly_ignore",!1),this.ignore_visitor=!1,Pe(),this.ignore_visitor||fe||ze()},this.report_feedback=function(e){qe(n.WARNING,"report_feedback, Deprecated function call! Use 'recordRatingWidgetWithID' or 'reportFeedbackWidgetManually' in place of this call. Call will be redirected to 'recordRatingWidgetWithID' now!"),this.recordRatingWidgetWithID(e)},this.recordRatingWidgetWithID=function(e){if(qe(n.INFO,"recordRatingWidgetWithID, Providing information about user with ID: [ "+e.widget_id+" ]"),this.check_consent(t.STAR_RATING))if(e.widget_id)if(e.rating){var s=["widget_id","contactMe","platform","app_version","rating","email","comment"],i={key:r.STAR_RATING,count:1,segmentation:{}};i.segmentation=A(e,s),i.segmentation.app_version||(i.segmentation.app_version=this.metrics._app_version||this.app_version),i.segmentation.rating>5?(qe(n.WARNING,"recordRatingWidgetWithID, You have entered a rating higher than 5. Changing it back to 5 now."),i.segmentation.rating=5):i.segmentation.rating<1&&(qe(n.WARNING,"recordRatingWidgetWithID, You have entered a rating lower than 1. Changing it back to 1 now."),i.segmentation.rating=1),qe(n.INFO,"recordRatingWidgetWithID, Reporting Rating Widget: ",i),Ie(i)}else qe(n.ERROR,"recordRatingWidgetWithID, Rating Widget must contain rating property");else qe(n.ERROR,"recordRatingWidgetWithID, Rating Widget must contain widget_id property")},this.reportFeedbackWidgetManually=function(e,s,i){if(this.check_consent(t.FEEDBACK))if(e&&s)if(e._id)if(pe)qe(n.ERROR,"reportFeedbackWidgetManually, Feedback Widgets can not be reported in offline mode");else{qe(n.INFO,"reportFeedbackWidgetManually, Providing information about user with, provided result of the widget with  ID: [ "+e._id+" ] and type: ["+e.type+"]");var o,a=[],c=e.type;if("nps"===c){if(i){if(!i.rating)return void qe(n.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");i.rating=Math.round(i.rating),i.rating>10?(qe(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 10. Changing it back to 10 now."),i.rating=10):i.rating<0&&(qe(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 0. Changing it back to 0 now."),i.rating=0),a=["rating","comment"]}o=r.NPS}else if("survey"===c){if(i){if(Object.keys(i).length<1)return void qe(n.ERROR,"reportFeedbackWidgetManually, Widget should have answers to be reported");a=Object.keys(i)}o=r.SURVEY}else{if("rating"!==c)return void qe(n.ERROR,"reportFeedbackWidgetManually, Widget has an unacceptable type");if(i){if(!i.rating)return void qe(n.ERROR,"reportFeedbackWidgetManually, Widget must contain rating property");i.rating=Math.round(i.rating),i.rating>5?(qe(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating higher than 5. Changing it back to 5 now."),i.rating=5):i.rating<1&&(qe(n.WARNING,"reportFeedbackWidgetManually, You have entered a rating lower than 1. Changing it back to 1 now."),i.rating=1),a=["rating","comment","email","contactMe"]}o=r.STAR_RATING}var h={key:o,count:1,segmentation:{widget_id:e._id,platform:this.platform,app_version:this.metrics._app_version||this.app_version}};null===i?h.segmentation.closed=1:h.segmentation=S(h.segmentation,i,a),qe(n.INFO,"reportFeedbackWidgetManually, Reporting "+c+": ",h),Ie(h)}else qe(n.ERROR,"reportFeedbackWidgetManually, Feedback Widgets must contain _id property");else qe(n.ERROR,"reportFeedbackWidgetManually, Widget data and/or Widget object not provided. Aborting.")},this.show_feedback_popup=function(e){qe(n.WARNING,"show_feedback_popup, Deprecated function call! Use 'presentRatingWidgetWithID' in place of this call. Call will be redirected now!"),this.presentRatingWidgetWithID(e)},this.presentRatingWidgetWithID=function(e){qe(n.INFO,"presentRatingWidgetWithID, Showing rating widget popup for the widget with ID: [ "+e+" ]"),this.check_consent(t.STAR_RATING)&&(pe?qe(n.ERROR,"presentRatingWidgetWithID, Cannot show ratingWidget popup in offline mode"):Ke("presentRatingWidgetWithID",this.url+"/o/feedback/widget",{widget_id:e},(function(e,t,r){if(e)qe(n.ERROR,"presentRatingWidgetWithID, An error occurred: "+e);else try{Oe(JSON.parse(r),!1)}catch(e){qe(n.ERROR,"presentRatingWidgetWithID, JSON parse failed: "+e)}}),!0))},this.initialize_feedback_popups=function(e){qe(n.WARNING,"initialize_feedback_popups, Deprecated function call! Use 'initializeRatingWidgets' in place of this call. Call will be redirected now!"),this.initializeRatingWidgets(e)},this.initializeRatingWidgets=function(e){if(qe(n.INFO,"initializeRatingWidgets, Initializing rating widget with provided widget IDs:[ "+e+"]"),this.check_consent(t.STAR_RATING)){e||(e=nt("cly_fb_widgets"));for(var r=document.getElementsByClassName("countly-feedback-sticker");r.length>0;)r[0].remove();Ke("initializeRatingWidgets",this.url+"/o/feedback/multiple-widgets-by-id",{widgets:JSON.stringify(e)},(function(e,t,r){if(e)qe(n.ERROR,"initializeRatingWidgets, An error occurred: "+e);else try{for(var s=JSON.parse(r),i=0;i<s.length;i++)if("true"===s[i].is_active&&s[i].target_devices[I()])if("string"==typeof s[i].hide_sticker&&(s[i].hide_sticker="true"===s[i].hide_sticker),"all"!==s[i].target_page||s[i].hide_sticker)for(var o=s[i].target_pages,a=0;a<o.length;a++){var c=o[a].substr(0,o[a].length-1)===window.location.pathname.substr(0,o[a].length-1),h=o[a]===window.location.pathname;(o[a].includes("*")&&c||h)&&!s[i].hide_sticker&&Oe(s[i],!0)}else Oe(s[i],!0)}catch(e){qe(n.ERROR,"initializeRatingWidgets, JSON parse error: "+e)}}),!0)}},this.enable_feedback=function(e){qe(n.WARNING,"enable_feedback, Deprecated function call! Use 'enableRatingWidgets' in place of this call. Call will be redirected now!"),this.enableRatingWidgets(e)},this.enableRatingWidgets=function(e){if(qe(n.INFO,"enableRatingWidgets, Enabling rating widget with params:",e),this.check_consent(t.STAR_RATING))if(pe)qe(n.ERROR,"enableRatingWidgets, Cannot enable rating widgets in offline mode");else{st("cly_fb_widgets",e.popups||e.widgets),U(this.url+"/star-rating/stylesheets/countly-feedback-web.css");var r=e.popups||e.widgets;r.length>0?(document.body.insertAdjacentHTML("beforeend",'<div id="cfbg"></div>'),this.initializeRatingWidgets(r)):qe(n.ERROR,"enableRatingWidgets, You should provide at least one widget id as param. Read documentation for more detail. https://resources.count.ly/plugins/feedback")}},this.get_available_feedback_widgets=function(e){qe(n.INFO,"get_available_feedback_widgets, Getting the feedback list, callback function is provided:["+!!e+"]"),this.check_consent(t.FEEDBACK)?pe?qe(n.ERROR,"get_available_feedback_widgets, Cannot enable feedback widgets in offline mode."):Ke("get_available_feedback_widgets",this.url+F,{method:t.FEEDBACK,device_id:this.device_id,app_key:this.app_key},(function(t,r,s){if(t)return qe(n.ERROR,"get_available_feedback_widgets, Error occurred while fetching feedbacks: "+t),void(e&&e(null,t));try{var i=JSON.parse(s).result||[];return void(e&&e(i,null))}catch(t){qe(n.ERROR,"get_available_feedback_widgets, Error while parsing feedback widgets list: "+t),e&&e(null,t)}}),!1):e&&e(null,new Error("Consent for feedback not provided."))},this.getFeedbackWidgetData=function(e,r){if(e.type)if(qe(n.INFO,"getFeedbackWidgetData, Retrieving data for: ["+JSON.stringify(e)+"], callback function is provided:["+!!r+"]"),this.check_consent(t.FEEDBACK))if(pe)qe(n.ERROR,"getFeedbackWidgetData, Cannot enable feedback widgets in offline mode.");else{var s=this.url,i={widget_id:e._id,shown:1,sdk_version:o,sdk_name:a,platform:this.platform,app_version:this.app_version};if("nps"===e.type)s+="/o/surveys/nps/widget";else if("survey"===e.type)s+="/o/surveys/survey/widget";else{if("rating"!==e.type)return void qe(n.ERROR,"getFeedbackWidgetData, Unknown type info: ["+e.type+"]");s+="/o/surveys/rating/widget"}Ke("getFeedbackWidgetData",s,i,c,!0)}else r&&r(null,new Error("Consent for feedback not provided."));else qe(n.ERROR,"getFeedbackWidgetData, Expected the provided widget object to have a type but got: ["+JSON.stringify(e)+"], aborting.");function c(e,t,s){if(e)return qe(n.ERROR,"getFeedbackWidgetData, Error occurred while fetching feedbacks: "+e),void(r&&r(null,e));try{var i=JSON.parse(s);return void(r&&r(i,null))}catch(e){qe(n.ERROR,"getFeedbackWidgetData, Error while parsing feedback widgets list: "+e),r&&r(null,e)}}},this.present_feedback_widget=function(e,r,s){if(qe(n.INFO,"present_feedback_widget, Presenting the feedback widget by appending to the element with ID: [ "+r+" ] and className: [ "+s+" ]"),this.check_consent(t.FEEDBACK))if(e&&"object"==typeof e&&!Array.isArray(e))try{var i=this.url;if("nps"===e.type)qe(n.DEBUG,"present_feedback_widget, Widget type: nps."),i+="/feedback/nps";else if("survey"===e.type)qe(n.DEBUG,"present_feedback_widget, Widget type: survey."),i+="/feedback/survey";else{if("rating"!==e.type)return void qe(n.ERROR,"present_feedback_widget, Feedback widget only accepts nps, rating and survey types.");qe(n.DEBUG,"present_feedback_widget, Widget type: rating."),i+="/feedback/rating"}var c,h=window.origin||window.location.origin;"rating"===e.type?(qe(n.DEBUG,"present_feedback_widget, Loading css for rating widget."),c="ratings",U(this.url+"/star-rating/stylesheets/countly-feedback-web.css")):(qe(n.DEBUG,"present_feedback_widget, Loading css for survey or nps."),U(this.url+"/surveys/stylesheets/countly-surveys.css"),c="surveys"),i+="?widget_id="+e._id,i+="&app_key="+this.app_key,i+="&device_id="+this.device_id,i+="&sdk_name="+a,i+="&platform="+this.platform,i+="&app_version="+this.app_version,i+="&sdk_version="+o,i+="&origin="+h,i+="&widget_v=web";var l=document.createElement("iframe");l.src=i,l.name="countly-"+c+"-iframe",l.id="countly-"+c+"-iframe";var u=!1;l.onload=function(){u&&(document.getElementById("countly-"+c+"-wrapper-"+e._id).style.display="none",document.getElementById("csbg").style.display="none"),u=!0,qe(n.DEBUG,"present_feedback_widget, Loaded iframe.")};for(var f=document.getElementById("csbg");f;)f.remove(),f=document.getElementById("csbg"),qe(n.DEBUG,"present_feedback_widget, Removing past overlay.");for(var p=document.getElementsByClassName("countly-"+c+"-wrapper"),y=0;y<p.length;y++)p[y].remove(),qe(n.DEBUG,"present_feedback_widget, Removed a wrapper.");(p=document.createElement("div")).className="countly-"+c+"-wrapper",p.id="countly-"+c+"-wrapper-"+e._id,"survey"===e.type&&(p.className=p.className+" "+e.appearance.position);var g=document.body,b=!1;if(r&&(document.getElementById(r)?(g=document.getElementById(r),b=!0):qe(n.ERROR,"present_feedback_widget, Provided ID not found.")),b||s&&(document.getElementsByClassName(s)[0]?g=document.getElementsByClassName(s)[0]:qe(n.ERROR,"present_feedback_widget, Provided class not found.")),g.insertAdjacentHTML("beforeend",'<div id="csbg"></div>'),g.appendChild(p),"rating"===e.type){var m=document.createElement("div");m.className="countly-ratings-overlay",m.id="countly-ratings-overlay-"+e._id,p.appendChild(m),qe(n.DEBUG,"present_feedback_widget, appended the rating overlay to wrapper"),d(document.getElementById("countly-ratings-overlay-"+e._id),"click",(function(){document.getElementById("countly-ratings-wrapper-"+e._id).style.display="none"}))}if(p.appendChild(l),qe(n.DEBUG,"present_feedback_widget, Appended the iframe"),d(window,"message",(function(t){var r={};try{r=JSON.parse(t.data),qe(n.DEBUG,"present_feedback_widget, Parsed response message "+r)}catch(e){qe(n.ERROR,"present_feedback_widget, Error while parsing message body "+e)}r.close?(document.getElementById("countly-"+c+"-wrapper-"+e._id).style.display="none",document.getElementById("csbg").style.display="none"):qe(n.DEBUG,"present_feedback_widget, Closing signal not sent yet")})),"survey"===e.type){var w=!1;switch(e.showPolicy){case"afterPageLoad":"complete"===document.readyState?w||(w=!0,E(e)):d(document,"readystatechange",(function(t){"complete"===t.target.readyState&&(w||(w=!0,E(e)))}));break;case"afterConstantDelay":setTimeout((function(){w||(w=!0,E(e))}),1e4);break;case"onAbandon":"complete"===document.readyState?d(document,"mouseleave",(function(){w||(w=!0,E(e))})):d(document,"readystatechange",(function(t){"complete"===t.target.readyState&&d(document,"mouseleave",(function(){w||(w=!0,E(e))}))}));break;case"onScrollHalfwayDown":d(window,"scroll",(function(){w||Math.max(window.scrollY,document.body.scrollTop,document.documentElement.scrollTop)>=R()/2&&(w=!0,E(e))}));break;default:w||(w=!0,E(e))}}else if("nps"===e.type)document.getElementById("countly-"+c+"-wrapper-"+e._id).style.display="block",document.getElementById("csbg").style.display="block";else if("rating"===e.type){var v=!1;"complete"===document.readyState?v||(v=!0,A(e)):d(document,"readystatechange",(function(t){"complete"===t.target.readyState&&(v||(v=!0,A(e)))}))}}catch(e){qe(n.ERROR,"present_feedback_widget, Something went wrong while presenting the widget: "+e)}else qe(n.ERROR,"present_feedback_widget, Please provide at least one feedback widget object.");function E(e){document.getElementById("countly-surveys-wrapper-"+e._id).style.display="block",document.getElementById("csbg").style.display="block"}function A(e){if(!e.appearance.hideS){qe(n.DEBUG,"present_feedback_widget, handling the sticker as it was not set to hidden");var t=document.createElement("div");t.innerText=e.appearance.text,t.style.color=e.appearance.text_color.length<7?"#"+e.appearance.text_color:e.appearance.text_color,t.style.backgroundColor=e.appearance.bg_color.length<7?"#"+e.appearance.bg_color:e.appearance.bg_color,t.className="countly-feedback-sticker  "+e.appearance.position+"-"+e.appearance.size,t.id="countly-feedback-sticker-"+e._id,document.body.appendChild(t),d(document.getElementById("countly-feedback-sticker-"+e._id),"click",(function(){document.getElementById("countly-ratings-wrapper-"+e._id).style.display="flex",document.getElementById("csbg").style.display="block"}))}d(document.getElementById("countly-feedback-close-icon-"+e._id),"click",(function(){document.getElementById("countly-ratings-wrapper-"+e._id).style.display="none",document.getElementById("csbg").style.display="none"}))}},this.recordError=function(e,r,s){if(qe(n.INFO,"recordError, Recording error"),this.check_consent(t.CRASHES)&&e){s=s||Q;var i="";if("object"==typeof e?void 0!==e.stack?i=e.stack:(void 0!==e.name&&(i+=e.name+":"),void 0!==e.message&&(i+=e.message+"\n"),void 0!==e.fileName&&(i+="in "+e.fileName+"\n"),void 0!==e.lineNumber&&(i+="on "+e.lineNumber),void 0!==e.columnNumber&&(i+=":"+e.columnNumber)):i=e+"",i.length>N.maxStackTraceLineLength*N.maxStackTraceLinesPerThread){qe(n.DEBUG,"record_error, Error stack is too long will be truncated");var o=i.split("\n");o.length>N.maxStackTraceLinesPerThread&&(o=o.splice(0,N.maxStackTraceLinesPerThread));for(var a=0,c=o.length;a<c;a++)o[a].length>N.maxStackTraceLineLength&&(o[a]=o[a].substring(0,N.maxStackTraceLineLength));i=o.join("\n")}r=!!r;var h=$e(),l={_resolution:h._resolution,_error:i,_app_version:h._app_version,_run:g()-be,_not_os_specific:!0,_javascript:!0},u=navigator.battery||navigator.webkitBattery||navigator.mozBattery||navigator.msBattery;u&&(l._bat=Math.floor(100*u.level)),void 0!==navigator.onLine&&(l._online=!!navigator.onLine),l._background=!document.hasFocus(),W.length>0&&(l._logs=W.join("\n")),W=[],l._nonfatal=r,l._view=this.getViewName(),void 0!==s&&(s=_(s,N.maxKeyLength,N.maxValueSize,N.maxSegmentationValues,"record_error",qe),l._custom=s);try{var d=document.createElement("canvas").getContext("experimental-webgl");l._opengl=d.getParameter(d.VERSION)}catch(e){qe(n.ERROR,"Could not get the experimental-webgl context: "+e)}var f={};f.crash=JSON.stringify(l),f.metrics=JSON.stringify({_ua:h._ua}),Ve(f)}},this.onStorageChange=function(e,t){switch(qe(n.INFO,"onStorageChange, Applying storage changes"),e){case"cly_queue":K=N.deserialize(t||"[]");break;case"cly_event":H=N.deserialize(t||"[]");break;case"cly_remote_configs":G=N.deserialize(t||"{}");break;case"cly_ignore":N.ignore_visitor=N.deserialize(t);break;case"cly_id":N.device_id=N.deserialize(t);break;case"cly_id_type":ve=N.deserialize(t)}},this._internals={store:st,getDocWidth:P,getDocHeight:R,getViewportHeight:D,get_page_coord:x,get_event_target:f,add_event:d,createNewObjectFromProperties:A,truncateObject:_,truncateSingleValue:C,stripTrailingSlash:E,prepareParams:v,sendXmlHttpRequest:Ke,isResponseValid:He,getInternalDeviceIdType:Ye,getMsTimestamp:b,getTimestamp:g,isResponseValidBroad:Ge,log:qe,getMetrics:$e,generateUUID:y,sendEventsForced:De,isUUID:Fe,getId:je,heartBeat:ze,toRequestQueue:Ve,reportViewDuration:Le,loadJS:L,loadCSS:U,getLastView:Ue,setToken:Qe,getToken:Ze,showLoader:B,hideLoader:M,setValueInStorage:st,getValueFromStorage:nt,removeValueFromStorage:it,add_cly_events:Ie,processScrollView:Je,processScroll:We,currentUserAgentString:k,userAgentDeviceDetection:I,userAgentSearchBotDetection:T,getRequestQueue:et,getEventQueue:Xe,clearQueue:function(){K=[],st("cly_queue",[]),H=[],st("cly_event",[])}},this.initialize()};e.CountlyClass=h,e.init=function(t){var r=(t=t||{}).app_key||e.app_key;if(!e.i||!e.i[r]){var n=new e.CountlyClass(t);if(!e.i)for(var s in e.i={},n)e[s]=n[s];e.i[r]=n}return e.i[r]};var l=0,u=function(e,t){for(t=t.toUpperCase();e;){if(e.nodeName.toUpperCase()===t)return e;e=e.parentElement}},d=function(e,t,r){void 0!==e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)},f=function(e){return e?void 0!==e.target?e.target:e.srcElement:window.event.srcElement};return window.addEventListener("storage",(function(t){var r=(t.key+"").split("/"),n=r.pop(),s=r.pop();e.i&&e.i[s]&&e.i[s].onStorageChange(n,t.newValue)})),e.serialize=function(e){return"object"==typeof e&&(e=JSON.stringify(e)),e},e.deserialize=function(e){try{e=JSON.parse(e)}catch(e){}return e},e.getViewName=function(){return window.location.pathname},e.getViewUrl=function(){return window.location.pathname},e.getSearchQuery=function(){return window.location.search},e.DeviceIdType={DEVELOPER_SUPPLIED:s.DEVELOPER_SUPPLIED,SDK_GENERATED:s.SDK_GENERATED,TEMPORARY_ID:s.TEMPORARY_ID},e}function p(e){var t=[];if(void 0!==e.options)for(var r=0;r<e.options.length;r++)e.options[r].selected&&t.push(e.options[r].value);return t.join(", ")}function y(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))}function g(){return Math.floor((new Date).getTime()/1e3)}function b(){var e=(new Date).getTime();return l>=e?l++:l=e,l}function m(t,r,n){if(r&&Object.keys(r).length){if(void 0!==r[t])return r[t]}else if(void 0!==e[t])return e[t];return n}function w(t,r,n){for(var s in e.i)e.i[s].tracking_crashes&&e.i[s].recordError(t,r,n)}function v(e){var t=[];for(var r in e)t.push(r+"="+encodeURIComponent(e[r]));return t.join("&")}function E(e){return"string"==typeof e&&"/"===e.substring(e.length-1)?e.substring(0,e.length-1):e}function A(e,t){for(var r,n={},s=0,i=t.length;s<i;s++)void 0!==e[r=t[s]]&&(n[r]=e[r]);return n}function S(e,t,r){if(r){for(var n,s=0,i=r.length;s<i;s++)void 0!==t[n=r[s]]&&(e[n]=t[n]);return e}}function _(e,t,r,n,s,i){var o={};if(e){if(Object.keys(e).length>n){var a={},c=0;for(var h in e)c<n&&(a[h]=e[h],c++);e=a}for(var l in e){var u=C(l,t,s,i),d=C(e[l],r,s,i);o[u]=d}}return o}function C(e,t,r,s){var i=e;return"number"==typeof e&&(e=e.toString()),"string"==typeof e&&e.length>t&&(i=e.substring(0,t),s(n.DEBUG,r+", Key: [ "+e+" ] is longer than accepted length. It will be truncated.")),i}function k(e){if(e)return e;var t=navigator.userAgent;return t||navigator.userAgentData&&(t=navigator.userAgentData.brands.map((function(e){return e.brand+":"+e.version})).join(),t+=navigator.userAgentData.mobile?" mobi ":" ",t+=navigator.userAgentData.platform),t}function I(e){var t;if(e)t=e;else{if(navigator.userAgentData.mobile)return"phone";t=k()}t=t.toLowerCase();var r="desktop",n=/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/;return/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(t)?r="tablet":n.test(t)&&(r="phone"),r}function T(e){return/(CountlySiteBot|nuhk|Googlebot|GoogleSecurityScanner|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver|bingbot|Google Web Preview|Mediapartners-Google|AdsBot-Google|Baiduspider|Ezooms|YahooSeeker|AltaVista|AVSearch|Mercator|Scooter|InfoSeek|Ultraseek|Lycos|Wget|YandexBot|Yandex|YaDirectFetcher|SiteBot|Exabot|AhrefsBot|MJ12bot|TurnitinBot|magpie-crawler|Nutch Crawler|CMS Crawler|rogerbot|Domnutch|ssearch_bot|XoviBot|netseer|digincore|fr-crawler|wesee|AliasIO|contxbot|PingdomBot|BingPreview|HeadlessChrome)/.test(e||k())}function x(e){return void 0===e.pageY&&"number"==typeof e.clientX&&document.documentElement&&(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e}function R(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function P(){var e=document;return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function D(){var e=document;return Math.min(Math.min(e.body.clientHeight,e.documentElement.clientHeight),Math.min(e.body.offsetHeight,e.documentElement.offsetHeight),window.innerHeight)}function O(){return window.innerWidth>window.innerHeight?"landscape":"portrait"}function N(e,t,r,n,s,i){var o,a=document.createElement(e);a.setAttribute(t,r),a.setAttribute(n,s);var c=function(){o||i(),o=!0};i&&(a.onreadystatechange=c,a.onload=c),document.getElementsByTagName("head")[0].appendChild(a)}function L(e,t){N("script","type","text/javascript","src",e,t)}function U(e,t){N("link","rel","stylesheet","href",e,t)}function B(){var t=document.getElementById("cly-loader");if(!t){var r="#cly-loader {height: 4px; width: 100%; position: absolute; z-index: 99999; overflow: hidden; background-color: #fff; top:0px; left:0px;}#cly-loader:before{display: block; position: absolute; content: ''; left: -200px; width: 200px; height: 4px; background-color: #2EB52B; animation: cly-loading 2s linear infinite;}@keyframes cly-loading { from {left: -200px; width: 30%;} 50% {width: 30%;} 70% {width: 70%;} 80% { left: 50%;} 95% {left: 120%;} to {left: 100%;}}",n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r)),n.appendChild(s),(t=document.createElement("div")).setAttribute("id","cly-loader"),document.body.onload=function(){if(!e.showLoaderProtection)try{document.body.appendChild(t)}catch(e){}}}t.style.display="block"}function M(){e.showLoaderProtection=!0;var t=document.getElementById("cly-loader");t&&(t.style.display="none")}}(n.Countly)}.apply(t,[]),void 0===r||(e.exports=r)},56090:e=>{"use strict";e.exports=async e=>{const t=[];for await(const r of e)t.push(r);return t}},9756:e=>{"use strict";e.exports=async e=>{for await(const t of e);}},24162:e=>{"use strict";e.exports=async function*(e,t){for await(const r of e)await t(r)&&(yield r)}},9673:e=>{"use strict";e.exports=async function*(e,t){for await(const r of e)yield t(r)}},65612:(e,t,r)=>{"use strict";const n=r(93586);e.exports=async function*(...e){const t=n();setTimeout((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(e){t.end(e)}}),0),yield*t}},93586:(e,t,r)=>{const n=r(91607);e.exports=e=>{let t;"function"==typeof(e=e||{})?(t=e,e={}):t=e.onEnd;let r,s,i,o=new n;const a=e=>s?s(e):(o.push(e),r),c=e=>i?r:a({done:!1,value:e}),h=e=>i?r:(i=!0,e?(e=>(o=new n,s?s({error:e}):(o.push({error:e}),r)))(e):a({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:()=>{if(!o.isEmpty()){if(e.writev){let e;const t=[];for(;!o.isEmpty();){if(e=o.shift(),e.error)throw e.error;t.push(e.value)}return{done:e.done,value:t}}const t=o.shift();if(t.error)throw t.error;return t}return i?{done:!0}:new Promise(((t,n)=>{s=i=>(s=null,i.error?n(i.error):e.writev&&!i.done?t({done:i.done,value:[i.value]}):t(i),r)}))},return:()=>(o=new n,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:c,end:h},!t)return r;const l=r;return r={[Symbol.asyncIterator](){return this},next:()=>l.next(),throw:e=>(l.throw(e),t&&(t(e),t=null),{done:!0}),return:()=>(l.return(),t&&(t(),t=null),{done:!0}),push:c,end:e=>(l.end(e),t&&(t(e),t=null),r)},r}},59481:e=>{"use strict";e.exports=async function*(e,t){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return}},11227:(e,t,r)=>{var n=r(34155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==n&&"env"in n&&(e=!1);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(82447)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},82447:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(57824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},65780:e=>{"use strict";const t=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},r=({clearTimeout:e,setTimeout:r,willResolve:n})=>(s,{value:i,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(t());let a,c,h;const l=e||clearTimeout,u=()=>{l(a),h(t())},d=new Promise(((e,t)=>{c=()=>{o&&o.removeEventListener("abort",u),n?e(i):t(i)},h=t,a=(r||setTimeout)(c,s)}));return o&&o.addEventListener("abort",u,{once:!0}),d.clear=()=>{l(a),a=null,c()},d},n=e=>{const t=r({...e,willResolve:!0});return t.reject=r({...e,willResolve:!1}),t.range=(e,r,n)=>t(((e,t)=>Math.floor(Math.random()*(t-e+1)+e))(e,r),n),t},s=n();s.createWithTimers=n,e.exports=s,e.exports.default=s},45001:e=>{"use strict";function t(e,t){t=t||{};this._head=0,this._tail=0,this._capacity=t.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(e)&&this._fromArray(e)}t.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},t.prototype.get=function(e){return this.peekAt(e)},t.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},t.prototype.peekFront=function(){return this.peek()},t.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(t.prototype,"length",{get:function(){return this.size()}}),t.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.unshift=function(e){if(void 0===e)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},t.prototype.push=function(e){if(void 0===e)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},t.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var r=this.size(),n=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var s,i=this._list[t];if(e<r/2){for(s=e;s>0;s--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(s=r-1-e;s>0;s--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return i}}},t.prototype.remove=function(e,t){var r,n=e,s=t;if(n===(0|n)&&this._head!==this._tail){var i=this.size(),o=this._list.length;if(!(n>=i||n<-i||t<1)){if(n<0&&(n+=i),1===t||!t)return(r=new Array(1))[0]=this.removeOne(n),r;if(0===n&&n+t>=i)return r=this.toArray(),this.clear(),r;var a;for(n+t>i&&(t=i-n),r=new Array(t),a=0;a<t;a++)r[a]=this._list[this._head+n+a&this._capacityMask];if(n=this._head+n&this._capacityMask,e+t===i){for(this._tail=this._tail-t+o&this._capacityMask,a=t;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+o&this._capacityMask,a=t-1;a>0;a--)this._list[n=n+1+o&this._capacityMask]=void 0;return r}if(n<i/2){for(this._head=this._head+e+t+o&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[n=n-1+o&this._capacityMask]);for(n=this._head-1+o&this._capacityMask;s>0;)this._list[n=n-1+o&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+t+o&this._capacityMask,a=i-(t+e);a>0;a--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+o&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),r}}},t.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var n=this.size();if(r<0&&(r+=n),!(r>n)){if(arguments.length>2){var s,i,o,a=arguments.length,c=this._list.length,h=2;if(!n||r<n/2){for(i=new Array(r),s=0;s<r;s++)i[s]=this._list[this._head+s&this._capacityMask];for(0===t?(o=[],r>0&&(this._head=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._head=this._head+r+c&this._capacityMask);a>h;)this.unshift(arguments[--a]);for(s=r;s>0;s--)this.unshift(i[s-1])}else{var l=(i=new Array(n-(r+t))).length;for(s=0;s<l;s++)i[s]=this._list[this._head+r+t+s&this._capacityMask];for(0===t?(o=[],r!=n&&(this._tail=this._head+r+c&this._capacityMask)):(o=this.remove(r,t),this._tail=this._tail-l+c&this._capacityMask);h<a;)this.push(arguments[h++]);for(s=0;s<l;s++)this.push(i[s])}return o}return this.remove(r,t)}}},t.prototype.clear=function(){this._head=0,this._tail=0},t.prototype.isEmpty=function(){return this._head===this._tail},t.prototype.toArray=function(){return this._copyArray(!1)},t.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])},t.prototype._copyArray=function(e){var t,r=[],n=this._list,s=n.length;if(e||this._head>this._tail){for(t=this._head;t<s;t++)r.push(n[t]);for(t=0;t<this._tail;t++)r.push(n[t])}else for(t=this._head;t<this._tail;t++)r.push(n[t]);return r},t.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},t.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},e.exports=t},26905:function(e){e.exports=function(e,t,r,n,s){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:s;return e===s?r:e}},32114:e=>{"use strict";function t(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,r,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof r&&(n=r,r=""),r&&(n.code=r);try{return t(e,n)}catch(r){n.message=e.message,n.stack=e.stack;const s=function(){};s.prototype=Object.create(Object.getPrototypeOf(e));return t(new s,n)}}},90507:(e,t,r)=>{"use strict";const n=r(8231);t.zN=n.EventIterator,n.EventIterator},8231:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class n{constructor(e,{highWaterMark:t=100,lowWaterMark:n=1}={}){const s=new r;s.highWaterMark=t,s.lowWaterMark=n,s.removeCallback=e({push:e=>s.push(e),stop:()=>s.stop(),fail:e=>s.fail(e),on:(e,t)=>{s.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>s[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=n,t.default=n},26729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function i(e,t,n,i,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,s=[];if(0===this._eventsCount)return s;for(n in e=this._events)t.call(e,n)&&s.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,i=n.length,o=new Array(i);s<i;s++)o[s]=n[s].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,s,i,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,h,l=this._events[a],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,s),!0;case 5:return l.fn.call(l.context,t,n,s,i),!0;case 6:return l.fn.call(l.context,t,n,s,i,o),!0}for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];l.fn.apply(l.context,c)}else{var d,f=l.length;for(h=0;h<f;h++)switch(l[h].once&&this.removeListener(e,l[h].fn,void 0,!0),u){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,t);break;case 3:l[h].fn.call(l[h].context,t,n);break;case 4:l[h].fn.call(l[h].context,t,n,s);break;default:if(!c)for(d=1,c=new Array(u-1);d<u;d++)c[d-1]=arguments[d];l[h].fn.apply(l[h].context,c)}}return!0},a.prototype.on=function(e,t,r){return i(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return i(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,s){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return o(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||s&&!a.once||n&&a.context!==n||o(this,i);else{for(var c=0,h=[],l=a.length;c<l;c++)(a[c].fn!==t||s&&!a[c].once||n&&a[c].context!==n)&&h.push(a[c]);h.length?this._events[i]=1===h.length?h[0]:h:o(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},17187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function s(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",s),r([].slice.call(arguments))}y(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,r)}(e,s,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function h(e,t,r,n){var s,i,o,h;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),void 0===o)o=i[t]=r,++e._eventsCount;else if("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(s=c(e))>0&&o.length>s&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,h=l,console&&console.warn&&console.warn(h)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=l.bind(n);return s.listener=r,n.wrapFn=s,s}function d(e,t,r){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):p(s,s.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(i){n.once&&e.removeEventListener(t,s),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var s="error"===e,i=this._events;if(void 0!==i)s=s&&void 0===i.error;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var h=c.length,l=p(c,h);for(r=0;r<h;++r)n(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return h(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return h(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,s,i,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,s=i;break}if(s<0)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var s,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(s=i[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return d(this,e,!0)},i.prototype.rawListeners=function(e){return d(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},3975:e=>{e.exports=class{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},91607:(e,t,r)=>{const n=r(3975);e.exports=class{constructor(e){this.hwm=e||16,this.head=new n(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const t=this.head;this.head=t.next=new n(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(void 0===e&&this.tail.next){const e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},96132:(e,t)=>{"use strict";function r(e,t=r.BASE){const n=e.length;for(let r=0;r<n;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}Object.defineProperty(t,"__esModule",{value:!0}),r.BASE=2166136261,t.default=r,e.exports=r},94029:(e,t,r)=>{"use strict";var n=r(95320),s=Object.prototype.toString,i=Object.prototype.hasOwnProperty,o=function(e,t,r){for(var n=0,s=e.length;n<s;n++)i.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))},a=function(e,t,r){for(var n=0,s=e.length;n<s;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},c=function(e,t,r){for(var n in e)i.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))};e.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");var i;arguments.length>=3&&(i=r),"[object Array]"===s.call(e)?o(e,t,i):"string"==typeof e?a(e,t,i):c(e,t,i)}},17648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,s="[object Function]";e.exports=function(e){var i=this;if("function"!=typeof i||n.call(i)!==s)throw new TypeError(t+i);for(var o,a=r.call(arguments,1),c=function(){if(this instanceof o){var t=i.apply(this,a.concat(r.call(arguments)));return Object(t)===t?t:this}return i.apply(e,a.concat(r.call(arguments)))},h=Math.max(0,i.length-a.length),l=[],u=0;u<h;u++)l.push("$"+u);if(o=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(c),i.prototype){var d=function(){};d.prototype=i.prototype,o.prototype=new d,d.prototype=null}return o}},58612:(e,t,r)=>{"use strict";var n=r(17648);e.exports=Function.prototype.bind||n},40210:(e,t,r)=>{"use strict";var n,s=SyntaxError,i=Function,o=TypeError,a=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(e){c=null}var h=function(){throw new o},l=c?function(){try{return h}catch(e){try{return c(arguments,"callee").get}catch(e){return h}}}():h,u=r(41405)(),d=Object.getPrototypeOf||function(e){return e.__proto__},f={},p="undefined"==typeof Uint8Array?n:d(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":u?d([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?d(d([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?d((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?d((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?d(""[Symbol.iterator]()):n,"%Symbol%":u?Symbol:n,"%SyntaxError%":s,"%ThrowTypeError%":l,"%TypedArray%":p,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},g=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var s=e("%AsyncGenerator%");s&&(r=d(s.prototype))}return y[t]=r,r},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},m=r(58612),w=r(17642),v=m.call(Function.call,Array.prototype.concat),E=m.call(Function.apply,Array.prototype.splice),A=m.call(Function.call,String.prototype.replace),S=m.call(Function.call,String.prototype.slice),_=m.call(Function.call,RegExp.prototype.exec),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g,I=function(e){var t=S(e,0,1),r=S(e,-1);if("%"===t&&"%"!==r)throw new s("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new s("invalid intrinsic syntax, expected opening `%`");var n=[];return A(e,C,(function(e,t,r,s){n[n.length]=r?A(s,k,"$1"):t||e})),n},T=function(e,t){var r,n=e;if(w(b,n)&&(n="%"+(r=b[n])[0]+"%"),w(y,n)){var i=y[n];if(i===f&&(i=g(n)),void 0===i&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new s("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');if(null===_(/^%?[^%]*%?$/,e))throw new s("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=I(e),n=r.length>0?r[0]:"",i=T("%"+n+"%",t),a=i.name,h=i.value,l=!1,u=i.alias;u&&(n=u[0],E(r,v([0,1],u)));for(var d=1,f=!0;d<r.length;d+=1){var p=r[d],g=S(p,0,1),b=S(p,-1);if(('"'===g||"'"===g||"`"===g||'"'===b||"'"===b||"`"===b)&&g!==b)throw new s("property names with quotes must have matching quotes");if("constructor"!==p&&f||(l=!0),w(y,a="%"+(n+="."+p)+"%"))h=y[a];else if(null!=h){if(!(p in h)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&d+1>=r.length){var m=c(h,p);h=(f=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:h[p]}else f=w(h,p),h=h[p];f&&!l&&(y[a]=h)}}return h}},27296:(e,t,r)=>{"use strict";var n=r(40210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},41405:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,s=r(55419);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&s())))}},55419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(e,t);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},96410:(e,t,r)=>{"use strict";var n=r(55419);e.exports=function(){return n()&&!!Symbol.toStringTag}},17642:(e,t,r)=>{"use strict";var n=r(58612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},70248:e=>{e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),n=Object.create(null);function s(s,i){r[s]=i,++t>=e&&(t=0,n=r,r=Object.create(null))}return{has:function(e){return void 0!==r[e]||void 0!==n[e]},remove:function(e){void 0!==r[e]&&(r[e]=void 0),void 0!==n[e]&&(n[e]=void 0)},get:function(e){var t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(s(e,t),t):void 0},set:function(e,t){void 0!==r[e]?r[e]=t:s(e,t)},clear:function(){r=Object.create(null),n=Object.create(null)}}}},80645:(e,t)=>{t.read=function(e,t,r,n,s){var i,o,a=8*s-n-1,c=(1<<a)-1,h=c>>1,l=-7,u=r?s-1:0,d=r?-1:1,f=e[t+u];for(u+=d,i=f&(1<<-l)-1,f>>=-l,l+=a;l>0;i=256*i+e[t+u],u+=d,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=256*o+e[t+u],u+=d,l-=8);if(0===i)i=1-h;else{if(i===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),i-=h}return(f?-1:1)*o*Math.pow(2,i-n)},t.write=function(e,t,r,n,s,i){var o,a,c,h=8*i-s-1,l=(1<<h)-1,u=l>>1,d=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+u>=1?d/c:d*Math.pow(2,1-u))*c>=2&&(o++,c/=2),o+u>=l?(a=0,o=l):o+u>=1?(a=(t*c-1)*Math.pow(2,s),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,s),o=0));s>=8;e[r+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,h+=s;h>0;e[r+f]=255&o,f+=p,o/=256,h-=8);e[r+f-p]|=128*y}},35717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},56512:function(e){!function(t){"use strict";const r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},s=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",c={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${o})?$`,"i")};function h(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,s=0,i=-1,o=(e.match(c.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(i=e.indexOf(":",i+1))>=0;)s++;if("::"===e.substr(0,2)&&s--,"::"===e.substr(-2,2)&&s--,s>t)return null;for(n=t-s,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:o}}function l(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let s,i=0;for(;n>0;){if(s=r-n,s<0&&(s=0),e[i]>>s!=t[i]>>s)return!1;n-=r,i+=1}return!0}function u(e){if(i.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(s.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function d(e,t){for(;e.length<t;)e=`0${e}`;return e}const f={};f.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return l(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,s,i;for(n=3;n>=0;n-=1){if(s=this.octets[n],!(s in r))return null;if(i=r[s],t&&0!==i)return null;8!==i&&(t=!0),e+=i}return 32-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return f.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),f.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[];let i=0;for(;i<4;)s.push(parseInt(r[i],10)|255^parseInt(n[i],10)),i++;return new this(s)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.isIPv4=function(e){return null!==this.parser(e)},f.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},f.IPv4.isValidFourPartDecimal=function(e){return!(!f.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},f.IPv4.networkAddressFromCIDR=function(e){let t,r,n,s,i;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[],r=0;r<4;)s.push(parseInt(n[r],10)&parseInt(i[r],10)),r++;return new this(s)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},f.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},f.IPv4.parser=function(e){let t,r,s;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)r=e[t],n.push(u(r));return n}();if(t=e.match(n.longValue)){if(s=u(t[1]),s>4294967295||s<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(s>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),r=[];if(s=u(e[1]),s>16777215||s<0)throw new Error("ipaddr: address outside defined range");return r.push(u(e[0])),r.push(s>>16&255),r.push(s>>8&255),r.push(255&s),r}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),r=[];if(s=u(e[2]),s>65535||s<0)throw new Error("ipaddr: address outside defined range");return r.push(u(e[0])),r.push(u(e[1])),r.push(s>>8&255),r.push(255&s),r}():null},f.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return l(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,s;for(let i=7;i>=0;i-=1){if(n=this.parts[i],!(n in r))return null;if(s=r[n],t&&0!==s)return null;16!==s&&(t=!0),e+=s}return 128-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(d(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new f.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,s=-1;for(;r=e.exec(t);)r[0].length>s&&(n=r.index,s=r[0].length);return s<0?t:`${t.substring(0,n)}::${t.substring(n+s)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),f.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[];let i=0;for(;i<16;)s.push(parseInt(r[i],10)|255^parseInt(n[i],10)),i++;return new this(s)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},f.IPv6.isIPv6=function(e){return null!==this.parser(e)},f.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},f.IPv6.networkAddressFromCIDR=function(e){let t,r,n,s,i;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[],r=0;r<16;)s.push(parseInt(n[r],10)&parseInt(i[r],10)),r++;return new this(s)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},f.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},f.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},f.IPv6.parser=function(e){let t,r,n,s,i,o;if(n=e.match(c.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(c.native.test(e))return h(e,8);if((n=e.match(c.transitional))&&(o=n[6]||"",t=h(n[1].slice(0,-1)+o,6),t.parts)){for(i=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<i.length;r++)if(s=i[r],!(0<=s&&s<=255))return null;return t.parts.push(i[0]<<8|i[1]),t.parts.push(i[2]<<8|i[3]),{parts:t.parts,zoneId:t.zoneId}}return null},f.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.fromByteArray=function(e){const t=e.length;if(4===t)return new f.IPv4(e);if(16===t)return new f.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},f.isValid=function(e){return f.IPv6.isValid(e)||f.IPv4.isValid(e)},f.parse=function(e){if(f.IPv6.isValid(e))return f.IPv6.parse(e);if(f.IPv4.isValid(e))return f.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},f.parseCIDR=function(e){try{return f.IPv6.parseCIDR(e)}catch(t){try{return f.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},f.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},f.subnetMatch=function(e,t,r){let n,s,i,o;for(s in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,s))for(i=t[s],!i[0]||i[0]instanceof Array||(i=[i]),n=0;n<i.length;n++)if(o=i[n],e.kind()===o[0].kind()&&e.match.apply(e,o))return s;return r},e.exports?e.exports=f:t.ipaddr=f}(this)},106:(e,t,r)=>{"use strict";var n=r(34155);const s=r(59134),i="object"==typeof window&&"object"==typeof document&&9===document.nodeType,o=s(),a=i&&!o,c=o&&!i,h=o&&i,l=void 0!==n&&void 0!==n.release&&"node"===n.release.name&&!o,u="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,d=void 0!==n&&!1,f="undefined"!=typeof navigator&&"ReactNative"===navigator.product;e.exports={isTest:d,isElectron:o,isElectronMain:c,isElectronRenderer:h,isNode:l,isBrowser:a,isWebWorker:u,isEnvWithDom:i,isReactNative:f}},38688:(e,t,r)=>{"use strict";e.exports=r(30700)},46953:(e,t,r)=>{"use strict";const n=r(67137);async function*s(e,t){const r=new n,s=await r.get(e,t);yield*s.iterator()}e.exports=(e,t)=>({path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:s(e,t)})},67137:(e,t,r)=>{"use strict";const{fetch:n,Request:s,Headers:i}=r(50730),{TimeoutError:o,HTTPError:a}=r(44171),c=r(70942).bind({ignoreUndefined:!0}),{URL:h,URLSearchParams:l}=r(17745),u=r(32044),d={throwHttpErrors:!0,credentials:"same-origin"};class f{constructor(e={}){this.opts=c(d,e)}async fetch(e,t={}){const r=c(this.opts,t),d=new i(r.headers);if("string"!=typeof e&&!(e instanceof h||e instanceof s))throw new TypeError("`resource` must be a string, URL, or Request");const f=new h(e.toString(),r.base),{searchParams:g,transformSearchParams:b,json:m}=r;g&&(f.search="function"==typeof b?b(new l(r.searchParams)):new l(r.searchParams)),m&&(r.body=JSON.stringify(r.json),d.set("content-type","application/json"));const w=new AbortController,v=u([w.signal,r.signal]),E=await((e,t,r)=>{if(void 0===t)return e;const n=Date.now(),s=()=>Date.now()-n>=t;return new Promise(((n,i)=>{const a=setTimeout((()=>{s()&&(i(new o),r.abort())}),t),c=e=>t=>{clearTimeout(a),s()?i(new o):e(t)};e.then(c(n),c(i))}))})(n(f.toString(),{...r,signal:v,timeout:void 0,headers:d}),r.timeout,w);if(!E.ok&&r.throwHttpErrors)throw r.handleError&&await r.handleError(E),new a(E);return E.iterator=async function*(){yield*y(E.body)},E.ndjson=async function*(){for await(const e of p(E.iterator()))t.transform?yield t.transform(e):yield e},E}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}}const p=async function*(e){const t=new TextDecoder;let r="";for await(const n of e){r+=t.decode(n,{stream:!0});const e=r.split(/\r?\n/);for(let t=0;t<e.length-1;t++){const r=e[t].trim();r.length>0&&(yield JSON.parse(r))}r=e[e.length-1]}r+=t.decode(),r=r.trim(),0!==r.length&&(yield JSON.parse(r))},y=e=>{if(m(e)){const t=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:t.next.bind(t),return:r=>(e.destroy(),"function"==typeof t.return?t.return():Promise.resolve({done:!0,value:r}))})}}if(b(e)){const t=e.getReader();return async function*(){try{for(;;){const{done:e,value:r}=await t.read();if(e)return;r&&(yield r)}}finally{t.releaseLock()}}()}if(g(e))return e;throw new TypeError("Body can't be converted to AsyncIterable")},g=e=>"object"==typeof e&&null!==e&&"function"==typeof e[Symbol.asyncIterator],b=e=>e&&"function"==typeof e.getReader,m=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");f.HTTPError=a,f.TimeoutError=o,f.streamToAsyncIterator=y,f.post=(e,t)=>new f(t).post(e,t),f.get=(e,t)=>new f(t).get(e,t),f.put=(e,t)=>new f(t).put(e,t),f.delete=(e,t)=>new f(t).delete(e,t),f.options=(e,t)=>new f(t).options(e,t),e.exports=f},44171:(e,t)=>{"use strict";class r extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}t.TimeoutError=r;class n extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}t.AbortError=n;class s extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}t.HTTPError=s},50730:(e,t,r)=>{"use strict";const{TimeoutError:n,AbortError:s}=r(44171),{Response:i,Request:o,Headers:a,default:c}=r(38688),h=c,l=e=>{const t=new a;for(const r of e.trim().split(/[\r\n]+/)){const e=r.indexOf(": ");e>0&&t.set(r.slice(0,e),r.slice(e+1))}return t};class u extends i{constructor(e,t,r){super(t,r),Object.defineProperty(this,"url",{value:e})}}e.exports={fetch:(e,t={})=>null!=t.onUploadProgress?((e,t={})=>{const r=new XMLHttpRequest;r.open(t.method||"GET",e.toString(),!0);const{timeout:o,headers:c}=t;if(o&&o>0&&o<1/0&&(r.timeout=o),null!=t.overrideMimeType&&r.overrideMimeType(t.overrideMimeType),c)for(const[e,t]of new a(c))r.setRequestHeader(e,t);return t.signal&&(t.signal.onabort=()=>r.abort()),t.onUploadProgress&&(r.upload.onprogress=t.onUploadProgress),r.responseType="arraybuffer",new Promise(((e,o)=>{const a=t=>{switch(t.type){case"error":e(i.error());break;case"load":e(new u(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:l(r.getAllResponseHeaders())}));break;case"timeout":o(new n);break;case"abort":o(new s)}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(t.body)}))})(e,t):h(e,t),Request:o,Headers:a}},82584:(e,t,r)=>{"use strict";var n=r(96410)(),s=r(21924)("Object.prototype.toString"),i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===s(e)},o=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==s(e)&&"[object Function]"===s(e.callee)},a=function(){return i(arguments)}();i.isLegacyArguments=o,e.exports=a?i:o},95320:e=>{"use strict";var t,r,n=Function.prototype.toString,s="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof s&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},s((function(){throw 42}),null,t)}catch(e){e!==r&&(s=null)}else s=null;var i=/^\s*class\b/,o=function(e){try{var t=n.call(e);return i.test(t)}catch(e){return!1}},a=function(e){try{return!o(e)&&(n.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,h="function"==typeof Symbol&&!!Symbol.toStringTag,l=!(0 in[,]),u=function(){return!1};if("object"==typeof document){var d=document.all;c.call(d)===c.call(document.all)&&(u=function(e){if((l||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=s?function(e){if(u(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{s(e,null,t)}catch(e){if(e!==r)return!1}return!o(e)&&a(e)}:function(e){if(u(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(h)return a(e);if(o(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}},82734:e=>{"use strict";var t=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;e.exports=function(e,r){if(null==r&&(r=!1),e.length<2)return!1;if(e.length>255)return!1;var n=e[e.length-1];if(r){if("."!==n)return!1}else if("."===n)return!1;return t.test(e)}},59134:(e,t,r)=>{var n=r(34155);e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!(void 0===n||"object"!=typeof n.versions||!n.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},18531:e=>{"use strict";e.exports=function(e,{requireTld:t=!0,allowUnderscores:r=!1,allowTrailingDot:n=!1}={}){if("string"!=typeof e)return!1;const s=function(e,t){return t&&"."===e[e.length-1]?e.substring(0,e.length-1):e}(e,n),i=s.split(".");if(t){const e=i.pop();if(!i.length||!/^([a-z\u00a1-\uffff]{2,}|xn[a-z0-9-]{2,})$/i.test(e))return!1}for(let e,t=0;t<i.length;t++){if(e=i[t],r){if(e.indexOf("__")>=0)return!1;e=e.replace(/_/g,"")}if(!/^[a-z\u00a1-\uffff0-9-]+$/i.test(e))return!1;if(/[\uff01-\uff5e]/.test(e))return!1;if("-"===e[0]||"-"===e[e.length-1])return!1}return!0}},48662:(e,t,r)=>{"use strict";var n,s=Object.prototype.toString,i=Function.prototype.toString,o=/^\s*(?:function)?\*/,a=r(96410)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(o.test(i.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===s.call(e);if(!c)return!1;if(void 0===n){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&c(t)}return c(e)===n}},19231:e=>{"use strict";function t(e,t){for(const r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,r,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof r&&(n=r,r=void 0),null!=r&&(n.code=r);try{return t(e,n)}catch(r){n.message=e.message,n.stack=e.stack;const s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(e)),t(new s,n)}}},3748:e=>{"use strict";const t="[a-fA-F\\d:]",r=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${t})|(?<=${t})(?=\\s|$))`:"",n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",i=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${n}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${n}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${n}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${n}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${n}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${n}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${n}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${n}$)|(?:^${i}$)`),a=new RegExp(`^${n}$`),c=new RegExp(`^${i}$`),h=e=>e&&e.exact?o:new RegExp(`(?:${r(e)}${n}${r(e)})|(?:${r(e)}${i}${r(e)})`,"g");h.v4=e=>e&&e.exact?a:new RegExp(`${r(e)}${n}${r(e)}`,"g"),h.v6=e=>e&&e.exact?c:new RegExp(`${r(e)}${i}${r(e)}`,"g"),e.exports=h},10536:(e,t,r)=>{"use strict";const n=r(3748),s=e=>n({exact:!0}).test(e);s.v4=e=>n.v4({exact:!0}).test(e),s.v6=e=>n.v6({exact:!0}).test(e),s.version=e=>s(e)?s.v4(e)?4:6:void 0,e.exports=s},11746:(e,t,r)=>{"use strict";const{URLWithLegacySupport:n,format:s,URLSearchParams:i,defaultBase:o}=r(18265),a=r(92366);e.exports={URL:n,URLSearchParams:i,format:s,relative:a,defaultBase:o}},92366:(e,t,r)=>{"use strict";const{URLWithLegacySupport:n,format:s}=r(18265);e.exports=(e,t={},r={},i)=>{let o,a=t.protocol?t.protocol.replace(":",""):"http";a=(r[a]||i||a)+":";try{o=new n(e)}catch(e){o={}}const c=Object.assign({},t,{protocol:a||o.protocol,host:t.host||o.host});return new n(e,s(c)).toString()}},18265:e=>{"use strict";const t=self.location?self.location.protocol+"//"+self.location.host:"",r=self.URL;e.exports={URLWithLegacySupport:class{constructor(e="",n=t){this.super=new r(e,n),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:t,format:function(e){if("string"==typeof e){return new r(e).toString()}if(!(e instanceof r)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",s=e.protocol?e.protocol+"//":"",i=e.host||"",o=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",h=e.pathname||"";return`${s}${t||r}${i||o+n}${e.path||h+a}${c}`}}}},56815:(e,t,r)=>{"use strict";const n=r(52104),s=R("dns4"),i=R("dns6"),o=R("dnsaddr"),a=x(R("dns"),o,s,i),c=x(R("ip4"),R("ip6")),h=x(T(c,R("tcp")),T(a,R("tcp"))),l=T(c,R("udp")),u=T(l,R("utp")),d=T(l,R("quic")),f=x(T(h,R("ws")),T(a,R("ws"))),p=x(T(h,R("wss")),T(a,R("wss"))),y=x(T(h,R("http")),T(c,R("http")),T(a,R("http"))),g=x(T(h,R("https")),T(c,R("https")),T(a,R("https"))),b=x(T(f,R("p2p-webrtc-star"),R("p2p")),T(p,R("p2p-webrtc-star"),R("p2p")),T(f,R("p2p-webrtc-star")),T(p,R("p2p-webrtc-star"))),m=x(T(f,R("p2p-websocket-star"),R("p2p")),T(p,R("p2p-websocket-star"),R("p2p")),T(f,R("p2p-websocket-star")),T(p,R("p2p-websocket-star"))),w=x(T(y,R("p2p-webrtc-direct"),R("p2p")),T(g,R("p2p-webrtc-direct"),R("p2p")),T(y,R("p2p-webrtc-direct")),T(g,R("p2p-webrtc-direct"))),v=x(f,p,y,g,b,w,h,u,d,a),E=x(T(v,R("p2p-stardust"),R("p2p")),T(v,R("p2p-stardust"))),A=x(T(v,R("p2p")),b,w,R("p2p")),S=x(T(A,R("p2p-circuit"),A),T(A,R("p2p-circuit")),T(R("p2p-circuit"),A),T(v,R("p2p-circuit")),T(R("p2p-circuit"),v),R("p2p-circuit")),_=()=>x(T(S,_),S),C=_(),k=x(T(C,A,C),T(A,C),T(C,A),C,A);function I(e){return function(t){if(!n.isMultiaddr(t))try{t=n(t)}catch(e){return!1}const r=e(t.protoNames());return null!==r&&0===r.length}}function T(){const e=Array.from(arguments);function t(t){return t.length<e.length?null:(e.some((e=>{if(null===(t="function"==typeof e?e().partialMatch(t):e.partialMatch(t)))return!0})),t)}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:I(t),partialMatch:t}}function x(){const e=Array.from(arguments);function t(t){let r=null;return e.some((e=>{const n="function"==typeof e?e().partialMatch(t):e.partialMatch(t);if(n)return r=n,!0})),r}const r={toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:I(t),partialMatch:t};return r}function R(e){const t=e;return{toString:function(){return t},matches:function(e){if("string"==typeof e)try{e=n(e)}catch(e){return!1}const r=e.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}t.DNS=a,t.DNS4=s,t.DNS6=i,t.DNSADDR=o,t.IP=c,t.TCP=h,t.UDP=l,t.QUIC=d,t.UTP=u,t.HTTP=y,t.HTTPS=g,t.WebSockets=f,t.WebSocketsSecure=p,t.WebSocketStar=m,t.WebRTCStar=b,t.WebRTCDirect=w,t.Reliable=v,t.Stardust=E,t.Circuit=C,t.P2P=k,t.IPFS=k},66816:(e,t,r)=>{"use strict";const n=r(67871),s=r(84502),i=r(38971),o=r(18781),a=r(24997);function c(e){const t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(let n=0;n<r.length;n++){const i=r[n],o=s(i);if(0!==o.size){if(n++,n>=r.length)throw w("invalid address: "+e);if(o.path){t.push([i,m(r.slice(n).join("/"))]);break}t.push([i,r[n]])}else t.push([i])}return t}function h(e){const t=[];return e.map((e=>{const r=v(e);t.push(r.name),e.length>1&&t.push(e[1])})),m(t.join("/"))}function l(e){return e.map((e=>{Array.isArray(e)||(e=[e]);const t=v(e);return e.length>1?[t.code,n.toBytes(t.code,e[1])]:[t.code]}))}function u(e){return e.map((e=>{const t=v(e);return e.length>1?[t.code,n.toString(t.code,e[1])]:[t.code]}))}function d(e){return g(o(e.map((e=>{const t=v(e);let r=Uint8Array.from(i.encode(t.code));return e.length>1&&(r=o([r,e[1]])),r}))))}function f(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return i.decode(t)+i.decode.bytes}function p(e){const t=[];let r=0;for(;r<e.length;){const n=i.decode(e,r),o=i.decode.bytes,c=f(s(n),e.slice(r+o));if(0===c){t.push([n]),r+=o;continue}const h=e.slice(r+o,r+o+c);if(r+=c+o,r>e.length)throw w("Invalid address Uint8Array: "+a(e,"base16"));t.push([n,h])}return t}function y(e){return d(l(c(e=m(e))))}function g(e){const t=b(e);if(t)throw t;return Uint8Array.from(e)}function b(e){try{p(e)}catch(e){return e}}function m(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function w(e){return new Error("Error parsing address: "+e)}function v(e){return s(e[0])}e.exports={stringToStringTuples:c,stringTuplesToString:h,tuplesToStringTuples:u,stringTuplesToTuples:l,bytesToTuples:p,tuplesToBytes:d,bytesToString:function(e){const t=p(e);return h(u(t))},stringToBytes:y,fromString:function(e){return y(e)},fromBytes:g,validateBytes:b,isValidBytes:function(e){return void 0===b(e)},cleanPath:m,ParseError:w,protoFromTuple:v,sizeForAddr:f}},67871:(e,t,r)=>{"use strict";const n=r(12747),s=r(84502),i=r(98878),o=r(36957),a=r(38971),c=r(24997),h=r(46042),l=r(18781);function u(e,t){return t instanceof Uint8Array?u.toString(e,t):u.toBytes(e,t)}function d(e){if(!n.isIP(e))throw new Error("invalid ip address");return n.toBytes(e)}function f(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function p(e){return new DataView(e.buffer).getUint16(0)}function y(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2);return c(t,"base32")+":"+p(r)}e.exports=u,u.toString=function(e,t){switch((e=s(e)).code){case 4:case 41:return function(e){const t=n.toString(e);if(!t||!n.isIP(t))throw new Error("invalid ip address");return t}(t);case 6:case 273:case 33:case 132:return p(t);case 53:case 54:case 55:case 56:case 400:case 777:return function(e){const t=a.decode(e);if((e=e.slice(a.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return c(e)}(t);case 421:return function(e){const t=a.decode(e),r=e.slice(a.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return c(r,"base58btc")}(t);case 444:case 445:return y(t);default:return c(t,"base16")}},u.toBytes=function(e,t){switch((e=s(e)).code){case 4:case 41:return d(t);case 6:case 273:case 33:case 132:return f(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return function(e){const t=h(e),r=Uint8Array.from(a.encode(t.length));return l([r,t],r.length+t.length)}(t);case 421:return function(e){const t=new i(e).multihash,r=Uint8Array.from(a.encode(t.length));return l([r,t],r.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(16!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion address.");const r=o.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=f(n);return l([r,s],r.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(56!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion3 address.");const r=o.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=f(n);return l([r,s],r.length+s.length)}(t);default:return h(t,"base16")}}},52104:(e,t,r)=>{"use strict";const n=r(66816),s=r(84502),i=r(38971),o=r(98878),a=r(98514),c=r(19231),h=Symbol.for("nodejs.util.inspect.custom"),l=r(24997),u=r(86219),d=new Map,f=a.proto((function(e){if(!(this instanceof f))return new f(e);if(null==e&&(e=""),e instanceof Uint8Array)this.bytes=n.fromBytes(e);else if("string"==typeof e||e instanceof String){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=n.fromString(e)}else{if(!(e.bytes&&e.protos&&e.protoCodes))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=n.fromBytes(e.bytes)}}),{className:"Multiaddr",symbolName:"@multiformats/js-multiaddr/multiaddr"});f.prototype.toString=function(){return n.bytesToString(this.bytes)},f.prototype.toJSON=f.prototype.toString,f.prototype.toOptions=function(){const e={},t=this.toString().split("/");return e.family="ip4"===t[1]?"ipv4":"ipv6",e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e},f.prototype[h]=function(){return"<Multiaddr "+l(this.bytes,"base16")+" - "+n.bytesToString(this.bytes)+">"},f.prototype.inspect=function(){return"<Multiaddr "+l(this.bytes,"base16")+" - "+n.bytesToString(this.bytes)+">"},f.prototype.protos=function(){return this.protoCodes().map((e=>Object.assign({},s(e))))},f.prototype.protoCodes=function(){const e=[],t=this.bytes;let r=0;for(;r<t.length;){const o=i.decode(t,r),a=i.decode.bytes,c=s(o);r+=n.sizeForAddr(c,t.slice(r+a))+a,e.push(o)}return e},f.prototype.protoNames=function(){return this.protos().map((e=>e.name))},f.prototype.tuples=function(){return n.bytesToTuples(this.bytes)},f.prototype.stringTuples=function(){const e=n.bytesToTuples(this.bytes);return n.tuplesToStringTuples(e)},f.prototype.encapsulate=function(e){return e=f(e),f(this.toString()+e.toString())},f.prototype.decapsulate=function(e){e=e.toString();const t=this.toString(),r=t.lastIndexOf(e);if(r<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return f(t.slice(0,r))},f.prototype.decapsulateCode=function(e){const t=this.tuples();for(let r=t.length-1;r>=0;r--)if(t[r][0]===e)return f(n.tuplesToBytes(t.slice(0,r)));return this},f.prototype.getPeerId=function(){let e=null;try{e=this.stringTuples().filter((e=>{if(e[0]===s.names.ipfs.code)return!0})).pop()[1],e=l(new o(e).multihash,"base58btc")}catch(t){e=null}return e},f.prototype.getPath=function(){let e=null;try{e=this.stringTuples().filter((e=>{if(s(e[0]).path)return!0}))[0][1]}catch(t){e=null}return e},f.prototype.equals=function(e){return u(this.bytes,e.bytes)},f.prototype.resolve=async function(){const e=this.protos().find((e=>e.resolvable));if(!e)return[this];const t=d.get(e.name);if(!t)throw c(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map((e=>f(e)))},f.prototype.nodeAddress=function(){const e=this.protoCodes(),t=this.protoNames(),r=this.toString().split("/").slice(1);if(r.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(4!==e[0]&&41!==e[0]&&54!==e[0]&&55!==e[0])throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if("tcp"!==r[2]&&"udp"!==r[2])throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:41===e[0]||55===e[0]?6:4,address:r[1],port:parseInt(r[3])}},f.fromNodeAddress=function(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let r;switch(e.family){case"IPv4":r="ip4";break;case"IPv6":r="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 'IPv4' or 'IPv6'`)}return f("/"+[r,e.address,t,e.port].join("/"))},f.prototype.isThinWaistAddress=function(e){const t=(e||this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))},f.protocols=s,f.isName=function(e){return!!f.isMultiaddr(e)&&e.protos().some((e=>e.resolvable))},f.resolve=function(e){return f.isMultiaddr(e)&&f.isName(e)?Promise.reject(new Error("not implemented yet")):Promise.reject(Error("not a valid name"))},f.resolvers=d,e.exports=f},12747:(e,t,r)=>{"use strict";const n=r(10536),s=r(24997),i=n,o=n.v4,a=n.v6,c=function(e,t,r){var n;if(r=~~r,o(e))n=t||new Uint8Array(r+4),e.split(/\./g).map((function(e){n[r++]=255&parseInt(e,10)}));else if(a(e)){var i,h=e.split(":",8);for(i=0;i<h.length;i++){var l;o(h[i])&&(l=c(h[i]),h[i]=s(l.slice(0,2),"base16")),l&&++i<8&&h.splice(i,0,s(l.slice(2,4),"base16"))}if(""===h[0])for(;h.length<8;)h.unshift("0");else if(""===h[h.length-1])for(;h.length<8;)h.push("0");else if(h.length<8){for(i=0;i<h.length&&""!==h[i];i++);var u=[i,"1"];for(i=9-h.length;i>0;i--)u.push("0");h.splice.apply(h,u)}for(n=t||new Uint8Array(r+16),i=0;i<h.length;i++){var d=parseInt(h[i],16);n[r++]=d>>8&255,n[r++]=255&d}}if(!n)throw Error("Invalid ip address: "+e);return n};e.exports={isIP:i,isV4:o,isV6:a,toBytes:c,toString:function(e,t,r){t=~~t,r=r||e.length-t;var n,s=[];const i=new DataView(e.buffer);if(4===r){for(let n=0;n<r;n++)s.push(e[t+n]);n=s.join(".")}else if(16===r){for(let e=0;e<r;e+=2)s.push(i.getUint16(t+e).toString(16));n=(n=(n=s.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return n}}},84502:e=>{"use strict";function t(e){if("number"==typeof e){if(t.codes[e])return t.codes[e];throw new Error("no protocol with code: "+e)}if("string"==typeof e||e instanceof String){if(t.names[e])return t.names[e];throw new Error("no protocol with name: "+e)}throw new Error("invalid protocol id type: "+e)}const r=-1;function n(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(s)}}t.lengthPrefixedVarSize=r,t.V=r,t.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[53,r,"dns","resolvable"],[54,r,"dns4","resolvable"],[55,r,"dns6","resolvable"],[56,r,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,"path"],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]],t.names={},t.codes={},t.table.map((e=>{const r=n.apply(null,e);t.codes[r.code]=r,t.names[r.name]=r})),t.object=n,e.exports=t},18781:e=>{"use strict";e.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}},86219:e=>{"use strict";e.exports=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}},46042:(e,t,r)=>{"use strict";const{names:n}=r(25077),{TextEncoder:s}=r(47259),i=new s;e.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return i.encode(e);if("ascii"===t)return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.decode(e)}},24997:(e,t,r)=>{"use strict";const{names:n}=r(25077),{TextDecoder:s}=r(47259),i=new s("utf8");e.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return i.decode(e);if("ascii"===t)return function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.encode(e)}},10356:e=>{e.exports=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s}},27698:e=>{e.exports=function e(r,n,s){n=n||[];var i=s=s||0;for(;r>=t;)n[s++]=255&r|128,r/=128;for(;-128&r;)n[s++]=255&r|128,r>>>=7;return n[s]=0|r,e.bytes=s-i+1,n};var t=Math.pow(2,31)},38971:(e,t,r)=>{e.exports={encode:r(27698),decode:r(10356),encodingLength:r(23753)}},23753:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),h=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<s?4:e<i?5:e<o?6:e<a?7:e<c?8:e<h?9:10}},24981:(e,t,r)=>{"use strict";const n=r(18370),s=r(36957),i=r(52104),o=r(56815),a=r(98878),{URL:c}=r(11746),h=r(24997),l=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,u=/^\/(ip[fn]s)\/([^/?#]+)/,d=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,f=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function p(e){try{return new a(e),!0}catch(e){return!1}}function y(e){if(!e)return!1;if(i.isMultiaddr(e))return!0;try{return new i(e),!0}catch(e){return!1}}function g(e,t,r=1,n=2){const s=w(e);if(!s)return!1;const i=s.match(t);if(!i)return!1;if("ipfs"!==i[r])return!1;let o=i[n];return o&&t===d&&(o=o.toLowerCase()),p(o)}function b(e,t,r=1,n){const s=w(e);if(!s)return!1;const i=s.match(t);if(!i)return!1;if("ipns"!==i[r])return!1;let o=i[n];if(o&&t===d){if(o=o.toLowerCase(),p(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:e}=new c(`http://${o}`);return f.test(e)}catch(e){return!1}}return!0}function m(e){return"string"==typeof e}function w(e){return e instanceof Uint8Array?h(e,"base58btc"):!!m(e)&&e}const v=e=>g(e,d,2,1),E=e=>b(e,d,2,1),A=e=>v(e)||E(e),S=e=>g(e,l)||v(e),_=e=>b(e,l)||E(e),C=e=>S(e)||_(e)||A(e),k=e=>g(e,u)||b(e,u);e.exports={multihash:function(e){const t=w(e);try{return n.decode(s.decode("z"+t)),!0}catch(e){return!1}},multiaddr:y,peerMultiaddr:function(e){return y(e)&&o.IPFS.matches(e)},cid:p,base32cid:e=>"base32"===function(e){try{return s.isEncoded(e)}catch(e){return!1}}(e)&&p(e),ipfsSubdomain:v,ipnsSubdomain:E,subdomain:A,subdomainGatewayPattern:d,ipfsUrl:S,ipnsUrl:_,url:C,pathGatewayPattern:l,ipfsPath:e=>g(e,u),ipnsPath:e=>b(e,u),path:k,pathPattern:u,urlOrPath:e=>C(e)||k(e),cidPath:e=>m(e)&&!p(e)&&g(`/ipfs/${e}`,u)}},85692:(e,t,r)=>{"use strict";var n=r(94029),s=r(63083),i=r(21924),o=i("Object.prototype.toString"),a=r(96410)(),c=r(27296),h="undefined"==typeof globalThis?window:globalThis,l=s(),u=i("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},d=i("String.prototype.slice"),f={},p=Object.getPrototypeOf;a&&c&&p&&n(l,(function(e){var t=new h[e];if(Symbol.toStringTag in t){var r=p(t),n=c(r,Symbol.toStringTag);if(!n){var s=p(r);n=c(s,Symbol.toStringTag)}f[e]=n.get}}));e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!a||!(Symbol.toStringTag in e)){var t=d(o(e),8,-1);return u(l,t)>-1}return!!c&&function(e){var t=!1;return n(f,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}},71993:e=>{"use strict";e.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:805306480,SSL_OP_ALL:2147485776,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,defaultCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA"}},1914:e=>{"use strict";const t=65536;e.exports=function(e){const r=new Uint8Array(e);let n=0;if(e>0)if(e>t)for(;n<e;)n+t>e?(crypto.getRandomValues(r.subarray(n,n+(e-n))),n+=e-n):(crypto.getRandomValues(r.subarray(n,n+t)),n+=t);else crypto.getRandomValues(r);return r}},17745:(e,t,r)=>{"use strict";const{URLWithLegacySupport:n,format:s,URLSearchParams:i,defaultBase:o}=r(82049),a=r(15939);e.exports={URL:n,URLSearchParams:i,format:s,relative:a,defaultBase:o}},15939:(e,t,r)=>{"use strict";const{URLWithLegacySupport:n,format:s}=r(82049);e.exports=(e,t={},r={},i)=>{let o,a=t.protocol?t.protocol.replace(":",""):"http";a=(r[a]||i||a)+":";try{o=new n(e)}catch(e){o={}}const c=Object.assign({},t,{protocol:a||o.protocol,host:t.host||o.host});return new n(e,s(c)).toString()}},82049:e=>{"use strict";const t="undefined"!=typeof navigator&&"ReactNative"===navigator.product;const r=self.URL,n=t?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:"";e.exports={URLWithLegacySupport:class{constructor(e="",t=n){this.super=new r(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return r.createObjectURL(e)}static revokeObjectURL(e){r.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:n,format:function(e){if("string"==typeof e){return new r(e).toString()}if(!(e instanceof r)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",s=e.protocol?e.protocol+"//":"",i=e.host||"",o=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",h=e.pathname||"";return`${s}${t||r}${i||o+n}${e.path||h+a}${c}`}}}},46884:(e,t,r)=>{"use strict";const n=r(37864);e.exports=async function*(...e){const t=n();setTimeout((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(e){t.end(e)}}),0),yield*t}},37864:(e,t,r)=>{const n=r(91607);e.exports=e=>{let t;"function"==typeof(e=e||{})?(t=e,e={}):t=e.onEnd;let r,s,i,o=new n;const a=e=>s?s(e):(o.push(e),r),c=e=>i?r:a({done:!1,value:e}),h=e=>i?r:(i=!0,e?(e=>(o=new n,s?s({error:e}):(o.push({error:e}),r)))(e):a({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:()=>{if(!o.isEmpty()){if(e.writev){let e;const t=[];for(;!o.isEmpty();){if(e=o.shift(),e.error)throw e.error;t.push(e.value)}return{done:e.done,value:t}}const t=o.shift();if(t.error)throw t.error;return t}return i?{done:!0}:new Promise(((t,n)=>{s=i=>(s=null,i.error?n(i.error):e.writev&&!i.done?t({done:i.done,value:[i.value]}):t(i),r)}))},return:()=>(o=new n,h(),{done:!0}),throw:e=>(h(e),{done:!0}),push:c,end:h},!t)return r;const l=r;return r={[Symbol.asyncIterator](){return this},next:()=>l.next(),throw:e=>(l.throw(e),t&&(t(e),t=null),{done:!0}),return:()=>(l.return(),t&&(t(),t=null),{done:!0}),push:c,end:e=>(l.end(e),t&&(t(e),t=null),r)},r}},99507:(e,t,r)=>{"use strict";const n=r(61798),{EventEmitter:s}=r(17187);function i(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;++r)if(e[r]!==t[r])return!1;return!0}function o(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class a extends s{constructor(e={}){super(),this.localNodeId=e.localNodeId||n(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||a.distance,this.arbiter=e.arbiter||a.arbiter,this.metadata=Object.assign({},e.metadata),o("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let r=0,n=0;const s=Math.min(e.length,t.length),i=Math.max(e.length,t.length);for(;n<s;++n)r=256*r+(e[n]^t[n]);for(;n<i;++n)r=256*r+255;return r}add(e){o("contact.id",(e||{}).id);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e.id,t++);const n=this._indexOf(r,e.id);return n>=0?(this._update(r,n,e),this):r.contacts.length<this.numberOfNodesPerKBucket?(r.contacts.push(e),this.emit("added",e),this):r.dontSplit?(this.emit("ping",r.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(r,t),this.add(e))}closest(e,t=1/0){if(o("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let r=[];for(let n=[this.root],s=0;n.length>0&&r.length<t;){const t=n.pop();if(null===t.contacts){const r=this._determineNode(t,e,s++);n.push(t.left===r?t.right:t.left),n.push(r)}else r=r.concat(t.contacts)}return r.map((t=>[this.distance(t.id,e),t])).sort(((e,t)=>e[0]-t[0])).slice(0,t).map((e=>e[1]))}count(){let e=0;for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e+=r.contacts.length}return e}_determineNode(e,t,r){const n=r>>3,s=r%8;if(t.length<=n&&0!==s)return e.left;return t[n]&1<<7-s?e.right:e.left}get(e){o("id",e);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);return n>=0?r.contacts[n]:null}_indexOf(e,t){for(let r=0;r<e.contacts.length;++r)if(i(e.contacts[r].id,t))return r;return-1}remove(e){o("the id as parameter 1",e);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);if(n>=0){const e=r.contacts.splice(n,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const r of e.contacts)this._determineNode(e,r.id,t).contacts.push(r);e.contacts=null;const r=this._determineNode(e,this.localNodeId,t);(e.left===r?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e=e.concat(r.contacts)}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null===t.contacts?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,r){if(!i(e.contacts[t].id,r.id))throw new Error("wrong index for _update");const n=e.contacts[t],s=this.arbiter(n,r);s===n&&n!==r||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}}e.exports=a},51675:(e,t)=>{"use strict";t.supports=function(...e){const t=e.reduce(((e,t)=>Object.assign(e,t)),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}},58499:(e,t,r)=>{"use strict";const n=r(94473),s=r(8002),{Encoding:i}=r(8266),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=r(82376),h=Symbol("formats"),l=Symbol("encodings"),u=new Set(["buffer","view","utf8"]);t.Transcoder=class{constructor(e){if(!Array.isArray(e))throw new TypeError("The first argument 'formats' must be an array");if(!e.every((e=>u.has(e))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[l]=new Map,this[h]=new Set(e);for(const e in s)try{this.encoding(e)}catch(e){if("LEVEL_ENCODING_NOT_SUPPORTED"!==e.code)throw e}}encodings(){return Array.from(new Set(this[l].values()))}encoding(e){let t=this[l].get(e);if(void 0===t){if("string"==typeof e&&""!==e){if(t=f[e],!t)throw new n(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof e||null===e)throw new TypeError("First argument 'encoding' must be a string or object");t=function(e){if(e instanceof i)return e;const t="type"in e&&"string"==typeof e.type?e.type:void 0,r=e.name||t||"anonymous-"+p++;switch(function(e){return"format"in e&&void 0!==e.format?e.format:"buffer"in e&&"boolean"==typeof e.buffer?e.buffer?"buffer":"utf8":"code"in e&&Number.isInteger(e.code)?"view":"buffer"}(e)){case"view":return new a({...e,name:r});case"utf8":return new c({...e,name:r});case"buffer":return new o({...e,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(e)}const{name:r,format:s}=t;if(!this[h].has(s))if(this[h].has("view"))t=t.createViewTranscoder();else if(this[h].has("buffer"))t=t.createBufferTranscoder();else{if(!this[h].has("utf8"))throw new n(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});t=t.createUTF8Transcoder()}for(const n of[e,r,t.name,t.commonName])this[l].set(n,t)}return t}};const d={binary:s.buffer,"utf-8":s.utf8},f={...s,...d};let p=0},8266:(e,t,r)=>{"use strict";const n=r(94473),s=new Set(["buffer","view","utf8"]);t.Encoding=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!s.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}},8002:(e,t,r)=>{"use strict";const{Buffer:n}=r(48764)||{Buffer:{isBuffer:()=>!1}},{textEncoder:s,textDecoder:i}=r(85850)(),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=r(82376),h=e=>e;t.utf8=new c({encode:function(e){return n.isBuffer(e)?e.toString("utf8"):ArrayBuffer.isView(e)?i.decode(e):String(e)},decode:h,name:"utf8",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:s.encode(e)},decode:function(e){return i.decode(e)},name:`${this.name}+view`})},createBufferTranscoder(){return new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:function(e){return e.toString("utf8")},name:`${this.name}+buffer`})}}),t.json=new c({encode:JSON.stringify,decode:JSON.parse,name:"json"}),t.buffer=new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:h,name:"buffer",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:n.from(String(e),"utf8")},decode:function(e){return n.from(e.buffer,e.byteOffset,e.byteLength)},name:`${this.name}+view`})}}),t.view=new a({encode:function(e){return ArrayBuffer.isView(e)?e:s.encode(e)},decode:h,name:"view",createBufferTranscoder(){return new o({encode:function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):n.from(String(e),"utf8")},decode:h,name:`${this.name}+buffer`})}}),t.hex=new o({encode:function(e){return n.isBuffer(e)?e:n.from(String(e),"hex")},decode:function(e){return e.toString("hex")},name:"hex"}),t.base64=new o({encode:function(e){return n.isBuffer(e)?e:n.from(String(e),"base64")},decode:function(e){return e.toString("base64")},name:"base64"})},82376:(e,t,r)=>{"use strict";const{Buffer:n}=r(48764)||{},{Encoding:s}=r(8266),i=r(85850);class o extends s{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:e=>this.decode(n.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends s{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new o({encode:e=>{const t=this.encode(e);return n.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}t.BufferFormat=o,t.ViewFormat=a,t.UTF8Format=class extends s{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new o({encode:e=>n.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=i();return new a({encode:t=>e.encode(this.encode(t)),decode:e=>this.decode(t.decode(e)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}},85850:e=>{"use strict";let t=null;e.exports=function(){return null===t&&(t={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),t}},21301:(e,t,r)=>{t.Level=r(11708).BrowserLevel},39593:(e,t,r)=>{var n=r(34155);const s="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,i="function"==typeof AbortController?AbortController:class{constructor(){this.signal=new c}abort(){this.signal.dispatchEvent("abort")}},o="function"==typeof AbortSignal,a="function"==typeof i.AbortSignal,c=o?AbortSignal:a?i.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if("abort"===e){this.aborted=!0;const t={type:e,target:this};this.onabort(t),this._listeners.forEach((e=>e(t)),this)}}onabort(){}addEventListener(e,t){"abort"===e&&this._listeners.push(t)}removeEventListener(e,t){"abort"===e&&(this._listeners=this._listeners.filter((e=>e!==t)))}},h=new Set,l=(e,t)=>{const r=`LRU_CACHE_OPTION_${e}`;f(r)&&p(r,`${e} option`,`options.${t}`,w)},u=(e,t)=>{const r=`LRU_CACHE_METHOD_${e}`;if(f(r)){const{prototype:n}=w,{get:s}=Object.getOwnPropertyDescriptor(n,e);p(r,`${e} method`,`cache.${t}()`,s)}},d=(...e)=>{"object"==typeof n&&n?n.emitWarning(...e):console.error(...e)},f=e=>!h.has(e),p=(e,t,r,n)=>{h.add(e);d(`The ${t} is deprecated. Please use ${r} instead.`,"DeprecationWarning",e,n)},y=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),g=e=>y(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?b:null:null;class b extends Array{constructor(e){super(e),this.fill(0)}}class m{constructor(e){if(0===e)return[];const t=g(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class w{constructor(e={}){const{max:t=0,ttl:r,ttlResolution:n=1,ttlAutopurge:s,updateAgeOnGet:i,updateAgeOnHas:o,allowStale:a,dispose:c,disposeAfter:u,noDisposeOnSet:p,noUpdateTTL:b,maxSize:v=0,maxEntrySize:E=0,sizeCalculation:A,fetchMethod:S,fetchContext:_,noDeleteOnFetchRejection:C,noDeleteOnStaleGet:k}=e,{length:I,maxAge:T,stale:x}=e instanceof w?{}:e;if(0!==t&&!y(t))throw new TypeError("max option must be a nonnegative integer");const R=t?g(t):Array;if(!R)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=v,this.maxEntrySize=E||this.maxSize,this.sizeCalculation=A||I,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=S||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=_,!this.fetchMethod&&void 0!==_)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new R(t),this.prev=new R(t),this.head=0,this.tail=0,this.free=new m(t),this.initialFill=1,this.size=0,"function"==typeof c&&(this.dispose=c),"function"==typeof u?(this.disposeAfter=u,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!b,this.noDeleteOnFetchRejection=!!C,0!==this.maxEntrySize){if(0!==this.maxSize&&!y(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!y(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!a||!!x,this.noDeleteOnStaleGet=!!k,this.updateAgeOnGet=!!i,this.updateAgeOnHas=!!o,this.ttlResolution=y(n)||0===n?n:1,this.ttlAutopurge=!!s,this.ttl=r||T||0,this.ttl){if(!y(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";if(f(e)){h.add(e);d("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,w)}}x&&l("stale","allowStale"),T&&l("maxAge","ttl"),I&&l("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new b(this.max),this.starts=new b(this.max),this.setItemTTL=(e,t,r=s.now())=>{if(this.starts[e]=0!==t?r:0,this.ttls[e]=t,0!==t&&this.ttlAutopurge){const r=setTimeout((()=>{this.isStale(e)&&this.delete(this.keyList[e])}),t+1);r.unref&&r.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?s.now():0};let e=0;const t=()=>{const t=s.now();if(this.ttlResolution>0){e=t;const r=setTimeout((()=>e=0),this.ttlResolution);r.unref&&r.unref()}return t};this.getRemainingTTL=r=>{const n=this.keyMap.get(r);return void 0===n?0:0===this.ttls[n]||0===this.starts[n]?1/0:this.starts[n]+this.ttls[n]-(e||t())},this.isStale=r=>0!==this.ttls[r]&&0!==this.starts[r]&&(e||t())-this.starts[r]>this.ttls[r]}updateItemAge(e){}setItemTTL(e,t,r){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new b(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,r,n)=>{if(this.isBackgroundFetch(t))return 0;if(!y(r)){if(!n)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(r=n(t,e),!y(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return r},this.addItemSize=(e,t)=>{if(this.sizes[e]=t,this.maxSize){const t=this.maxSize-this.sizes[e];for(;this.calculatedSize>t;)this.evict(!0)}this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,r,n){if(r||n)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const r of this.indexes())if(e(this.valList[r],this.keyList[r],this))return this.get(this.keyList[r],t)}forEach(e,t=this){for(const r of this.indexes())e.call(t,this.valList[r],this.keyList[r],this)}rforEach(e,t=this){for(const r of this.rindexes())e.call(t,this.valList[r],this.keyList[r],this)}get prune(){return u("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const t of this.indexes({allowStale:!0})){const r=this.keyList[t],n=this.valList[t],i={value:this.isBackgroundFetch(n)?n.__staleWhileFetching:n};if(this.ttls){i.ttl=this.ttls[t];const e=s.now()-this.starts[t];i.start=Math.floor(Date.now()-e)}this.sizes&&(i.size=this.sizes[t]),e.unshift([r,i])}return e}load(e){this.clear();for(const[t,r]of e){if(r.start){const e=Date.now()-r.start;r.start=s.now()-e}this.set(t,r.value,r)}}dispose(e,t,r){}set(e,t,{ttl:r=this.ttl,start:n,noDisposeOnSet:s=this.noDisposeOnSet,size:i=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:a=this.noUpdateTTL}={}){if(i=this.requireSize(e,t,i,o),this.maxEntrySize&&i>this.maxEntrySize)return this.delete(e),this;let c=0===this.size?void 0:this.keyMap.get(e);if(void 0===c)c=this.newIndex(),this.keyList[c]=e,this.valList[c]=t,this.keyMap.set(e,c),this.next[this.tail]=c,this.prev[c]=this.tail,this.tail=c,this.size++,this.addItemSize(c,i),a=!1;else{const r=this.valList[c];t!==r&&(this.isBackgroundFetch(r)?r.__abortController.abort():s||(this.dispose(r,e,"set"),this.disposeAfter&&this.disposed.push([r,e,"set"])),this.removeItemSize(c),this.valList[c]=t,this.addItemSize(c,i)),this.moveToTail(c)}if(0===r||0!==this.ttl||this.ttls||this.initializeTTLTracking(),a||this.setItemTTL(c,r,n),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,r=this.keyList[t],n=this.valList[t];return this.isBackgroundFetch(n)?n.__abortController.abort():(this.dispose(n,r,"evict"),this.disposeAfter&&this.disposed.push([n,r,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(r),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const r=this.keyMap.get(e);return void 0!==r&&!this.isStale(r)&&(t&&this.updateItemAge(r),!0)}peek(e,{allowStale:t=this.allowStale}={}){const r=this.keyMap.get(e);if(void 0!==r&&(t||!this.isStale(r))){const e=this.valList[r];return this.isBackgroundFetch(e)?e.__staleWhileFetching:e}}backgroundFetch(e,t,r,n){const s=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(s))return s;const o=new i,a={signal:o.signal,options:r,context:n},c=new Promise((t=>t(this.fetchMethod(e,s,a)))).then((t=>(o.signal.aborted||this.set(e,t,a.options),t)),(n=>{if(this.valList[t]===c){!r.noDeleteOnFetchRejection||void 0===c.__staleWhileFetching?this.delete(e):this.valList[t]=c.__staleWhileFetching}if(c.__returned===c)throw n}));return c.__abortController=o,c.__staleWhileFetching=s,c.__returned=null,void 0===t?(this.set(e,c,a.options),t=this.keyMap.get(e)):this.valList[t]=c,c}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||null===e.__returned)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:i=this.noDisposeOnSet,size:o=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,fetchContext:l=this.fetchContext,forceRefresh:u=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:n});const d={allowStale:t,updateAgeOnGet:r,noDeleteOnStaleGet:n,ttl:s,noDisposeOnSet:i,size:o,sizeCalculation:a,noUpdateTTL:c,noDeleteOnFetchRejection:h};let f=this.keyMap.get(e);if(void 0===f){const t=this.backgroundFetch(e,f,d,l);return t.__returned=t}{const n=this.valList[f];if(this.isBackgroundFetch(n))return t&&void 0!==n.__staleWhileFetching?n.__staleWhileFetching:n.__returned=n;if(!u&&!this.isStale(f))return this.moveToTail(f),r&&this.updateItemAge(f),n;const s=this.backgroundFetch(e,f,d,l);return t&&void 0!==s.__staleWhileFetching?s.__staleWhileFetching:s.__returned=s}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet}={}){const s=this.keyMap.get(e);if(void 0!==s){const i=this.valList[s],o=this.isBackgroundFetch(i);if(this.isStale(s))return o?t?i.__staleWhileFetching:void 0:(n||this.delete(e),t?i:void 0);if(o)return;return this.moveToTail(s),r&&this.updateItemAge(s),i}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return u("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const r=this.keyMap.get(e);if(void 0!==r)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(r);const t=this.valList[r];this.isBackgroundFetch(t)?t.__abortController.abort():(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const r=this.keyList[e];this.dispose(t,r,"delete"),this.disposeAfter&&this.disposed.push([t,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return u("reset","clear"),this.clear}get length(){return((e,t)=>{const r=`LRU_CACHE_PROPERTY_${e}`;if(f(r)){const{prototype:n}=w,{get:s}=Object.getOwnPropertyDescriptor(n,e);p(r,`${e} property`,`cache.${t}`,s)}})("length","size"),this.size}static get AbortController(){return i}static get AbortSignal(){return c}}e.exports=w},70942:function(e,t,r){"use strict";const n=r(49727),{hasOwnProperty:s}=Object.prototype,{propertyIsEnumerable:i}=Object,o=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},h=e=>{const t=[];for(const r in e)s.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(const n of r)i.call(e,n)&&t.push(n)}return t};function l(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return h(e).forEach((r=>{o(t,r,l(e[r]))})),t}(e):n(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return h(e).forEach((r=>{o(t,r,l(e[r]))})),t}(e):e}const u=(e,t,r,n)=>(r.forEach((r=>{void 0===t[r]&&n.ignoreUndefined||(r in e&&e[r]!==Object.getPrototypeOf(e)?o(e,r,d(e[r],t[r],n)):o(e,r,l(t[r])))})),e);function d(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?((e,t,r)=>{let n=e.slice(0,0),i=0;return[e,t].forEach((t=>{const a=[];for(let r=0;r<t.length;r++)s.call(t,r)&&(a.push(String(r)),o(n,i++,t===e?t[r]:l(t[r])));n=u(n,t,h(t).filter((e=>!a.includes(e))),r)})),n})(e,t,r):n(t)&&n(e)?u(e,t,h(t),r):l(t)}e.exports=function(...e){const t=d(l(c),this!==a&&this||{},c);let r={_:{}};for(const s of e)if(void 0!==s){if(!n(s))throw new TypeError("`"+s+"` is not an Option Object");r=d(r,{_:s},t)}return r._}},49727:e=>{"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},94473:e=>{"use strict";e.exports=class extends Error{constructor(e,t){super(e||""),"object"==typeof t&&null!==t&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},57824:e=>{var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s,o=365.25*s;function a(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,c){c=c||{};var h=typeof e;if("string"===h&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*s;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===h&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=s)return a(e,i,s,"day");if(i>=n)return a(e,i,n,"hour");if(i>=r)return a(e,i,r,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=s)return Math.round(e/s)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},95700:(e,t,r)=>{const{Multiaddr:n}=r(46584),s=(e,t)=>t,i={ip4:s,ip6:(e,t,r,n)=>1===n.length&&"ip6"===n[0].protocol?t:`[${t}]`,tcp:(e,t,r,n,s)=>n.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:((e,t,r,n)=>{if(n&&!1===n.assumeHttp)return`tcp://${e}:${t}`;let s="tcp",i=`:${t}`;return"tcp"===r[r.length-1].protocol&&(s="443"===t?"https":"http",i="443"===t||"80"===t?"":i),`${s}://${e}${i}`})(e,t,n,s),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:s,dns4:s,dns6:s,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};e.exports=(e,t)=>{const r=new n(e),s=e.toString().split("/").slice(1);return r.tuples().map((e=>({protocol:s.shift(),content:e[1]?s.shift():null}))).reduce(((e,r,n,s)=>{const o=i[r.protocol];if(!o)throw new Error(`Unsupported protocol ${r.protocol}`);return o(e,r.content,n,s,t)}),"")}},65381:e=>{"use strict";const t="[a-fA-F\\d:]",r=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${t})|(?<=${t})(?=\\s|$))`:"",n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",i=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${n}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${n}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${n}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${n}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${n}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${n}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${n}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${n}$)|(?:^${i}$)`),a=new RegExp(`^${n}$`),c=new RegExp(`^${i}$`),h=e=>e&&e.exact?o:new RegExp(`(?:${r(e)}${n}${r(e)})|(?:${r(e)}${i}${r(e)})`,"g");h.v4=e=>e&&e.exact?a:new RegExp(`${r(e)}${n}${r(e)}`,"g"),h.v6=e=>e&&e.exact?c:new RegExp(`${r(e)}${i}${r(e)}`,"g"),e.exports=h},87602:(e,t,r)=>{"use strict";const n=r(65381),s=e=>n({exact:!0}).test(e);s.v4=e=>n.v4({exact:!0}).test(e),s.v6=e=>n.v6({exact:!0}).test(e),s.version=e=>s(e)?s.v4(e)?4:6:void 0,e.exports=s},18190:(e,t,r)=>{"use strict";const n=r(99918),s=r(89768),i=r(94676),{concat:o}=r(20605),{toString:a}=r(92263);function c(e){const t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(let n=0;n<r.length;n++){const i=r[n],o=s(i);if(0!==o.size){if(n++,n>=r.length)throw w("invalid address: "+e);if(o.path){t.push([i,m(r.slice(n).join("/"))]);break}t.push([i,r[n]])}else t.push([i])}return t}function h(e){const t=[];return e.map((e=>{const r=v(e);return t.push(r.name),e.length>1&&t.push(e[1]),null})),m(t.join("/"))}function l(e){return e.map((e=>{Array.isArray(e)||(e=[e]);const t=v(e);return e.length>1?[t.code,n.toBytes(t.code,e[1])]:[t.code]}))}function u(e){return e.map((e=>{const t=v(e);return e[1]?[t.code,n.toString(t.code,e[1])]:[t.code]}))}function d(e){return g(o(e.map((e=>{const t=v(e);let r=Uint8Array.from(i.encode(t.code));return e.length>1&&(r=o([r,e[1]])),r}))))}function f(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return i.decode(t)+i.decode.bytes}function p(e){const t=[];let r=0;for(;r<e.length;){const n=i.decode(e,r),o=i.decode.bytes,c=f(s(n),e.slice(r+o));if(0===c){t.push([n]),r+=o;continue}const h=e.slice(r+o,r+o+c);if(r+=c+o,r>e.length)throw w("Invalid address Uint8Array: "+a(e,"base16"));t.push([n,h])}return t}function y(e){return d(l(c(e=m(e))))}function g(e){const t=b(e);if(t)throw t;return Uint8Array.from(e)}function b(e){try{p(e)}catch(e){return e}}function m(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function w(e){return new Error("Error parsing address: "+e)}function v(e){return s(e[0])}e.exports={stringToStringTuples:c,stringTuplesToString:h,tuplesToStringTuples:u,stringTuplesToTuples:l,bytesToTuples:p,tuplesToBytes:d,bytesToString:function(e){const t=p(e);return h(u(t))},stringToBytes:y,fromString:function(e){return y(e)},fromBytes:g,validateBytes:b,isValidBytes:function(e){return void 0===b(e)},cleanPath:m,ParseError:w,protoFromTuple:v,sizeForAddr:f}},99918:(e,t,r)=>{"use strict";const n=r(33692),s=r(89768),{CID:i}=r(81362),{base32:o}=r(22817),{base58btc:a}=r(99086),c=r(28924),h=r(94676),{toString:l}=r(92263),{fromString:u}=r(52217),{concat:d}=r(20605);function f(e,t){return t instanceof Uint8Array?f.toString(e,t):f.toBytes(e,t)}function p(e){if(!n.isIP(e))throw new Error("invalid ip address");return n.toBytes(e)}function y(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function g(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function b(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2);return l(t,"base32")+":"+g(r)}e.exports=f,f.toString=function(e,t){switch(s(e).code){case 4:case 41:return function(e){const t=n.toString(e);if(!t||!n.isIP(t))throw new Error("invalid ip address");return t}(t);case 6:case 273:case 33:case 132:return g(t).toString();case 53:case 54:case 55:case 56:case 400:case 466:case 777:return function(e){const t=h.decode(e);if((e=e.slice(h.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return l(e)}(t);case 421:return function(e){const t=h.decode(e),r=e.slice(h.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return l(r,"base58btc")}(t);case 444:case 445:return b(t);default:return l(t,"base16")}},f.toBytes=function(e,t){switch(s(e).code){case 4:case 41:return p(t);case 6:case 273:case 33:case 132:return y(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 466:case 777:return function(e){const t=u(e),r=Uint8Array.from(h.encode(t.length));return d([r,t],r.length+t.length)}(t);case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?c.decode(a.decode(`z${e}`)).bytes:i.parse(e).multihash.bytes;const r=Uint8Array.from(h.encode(t.length));return d([r,t],r.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(16!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion address.");const r=o.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=y(n);return d([r,s],r.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(56!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion3 address.");const r=o.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=y(n);return d([r,s],r.length+s.length)}(t);default:return u(t,"base16")}}},46584:(e,t,r)=>{"use strict";const n=r(18190),s=r(89768),i=r(94676),{CID:o}=r(81362),{base58btc:a}=r(99086),c=r(32114),h=Symbol.for("nodejs.util.inspect.custom"),{toString:l}=r(92263),{equals:u}=r(19588),d=new Map,f=Symbol.for("@multiformats/js-multiaddr/multiaddr");class p{constructor(e){if(null==e&&(e=""),Object.defineProperty(this,f,{value:!0}),e instanceof Uint8Array)this.bytes=n.fromBytes(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=n.fromString(e)}else{if(!p.isMultiaddr(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=n.fromBytes(e.bytes)}}toString(){return n.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){const e={},t=this.toString().split("/");return e.family="ip4"===t[1]?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map((e=>Object.assign({},s(e))))}protoCodes(){const e=[],t=this.bytes;let r=0;for(;r<t.length;){const o=i.decode(t,r),a=i.decode.bytes,c=s(o);r+=n.sizeForAddr(c,t.slice(r+a))+a,e.push(o)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return n.bytesToTuples(this.bytes)}stringTuples(){const e=n.bytesToTuples(this.bytes);return n.tuplesToStringTuples(e)}encapsulate(e){return e=new p(e),new p(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),r=this.toString(),n=r.lastIndexOf(t);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new p(r.slice(0,n))}decapsulateCode(e){const t=this.tuples();for(let r=t.length-1;r>=0;r--)if(t[r][0]===e)return new p(n.tuplesToBytes(t.slice(0,r)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===s.names.ipfs.code)),t=e.pop();if(t&&t[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?l(a.decode(`z${e}`),"base58btc"):l(o.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!!s(e[0]).path))[0][1],e||(e=null)}catch(t){e=null}return e}equals(e){return u(this.bytes,e.bytes)}async resolve(){const e=this.protos().find((e=>e.resolvable));if(!e)return[this];const t=d.get(e.name);if(!t)throw c(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map((e=>new p(e)))}nodeAddress(){const e=this.protoCodes(),t=this.protoNames(),r=this.toString().split("/").slice(1);if(r.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(4!==e[0]&&41!==e[0]&&54!==e[0]&&55!==e[0])throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if("tcp"!==r[2]&&"udp"!==r[2])throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:41===e[0]||55===e[0]?6:4,address:r[1],port:parseInt(r[3])}}isThinWaistAddress(e){const t=(e||this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let r;switch(e.family){case 4:r="ip4";break;case 6:r="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new p("/"+[r,e.address,t,e.port].join("/"))}static isName(e){return!!p.isMultiaddr(e)&&e.protos().some((e=>e.resolvable))}static isMultiaddr(e){return e instanceof p||Boolean(e&&e[f])}[h](){return"<Multiaddr "+l(this.bytes,"base16")+" - "+n.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+l(this.bytes,"base16")+" - "+n.bytesToString(this.bytes)+">"}}p.protocols=s,p.resolvers=d,e.exports={Multiaddr:p,multiaddr:function(e){return new p(e)},protocols:s,resolvers:d}},33692:(e,t,r)=>{"use strict";const n=r(87602),{toString:s}=r(92263),i=n,o=n.v4,a=n.v6,c=function(e,t,r){let n;if(r=~~r,o(e))n=t||new Uint8Array(r+4),e.split(/\./g).map((function(e){n[r++]=255&parseInt(e,10)}));else if(a(e)){const i=e.split(":",8);let a;for(a=0;a<i.length;a++){let e;o(i[a])&&(e=c(i[a]),i[a]=s(e.slice(0,2),"base16")),e&&++a<8&&i.splice(a,0,s(e.slice(2,4),"base16"))}if(""===i[0])for(;i.length<8;)i.unshift("0");else if(""===i[i.length-1])for(;i.length<8;)i.push("0");else if(i.length<8){for(a=0;a<i.length&&""!==i[a];a++);const e=[a,"1"];for(a=9-i.length;a>0;a--)e.push("0");i.splice.apply(i,e)}for(n=t||new Uint8Array(r+16),a=0;a<i.length;a++){const e=parseInt(i[a],16);n[r++]=e>>8&255,n[r++]=255&e}}if(!n)throw Error("Invalid ip address: "+e);return n};e.exports={isIP:i,isV4:o,isV6:a,toBytes:c,toString:function(e,t,r){t=~~t,r=r||e.length-t;const n=[];let s;const i=new DataView(e.buffer);if(4===r){for(let s=0;s<r;s++)n.push(e[t+s]);s=n.join(".")}else if(16===r){for(let e=0;e<r;e+=2)n.push(i.getUint16(t+e).toString(16));s=n.join(":"),s=s.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),s=s.replace(/:{3,4}/,"::")}return s}}},89768:e=>{"use strict";function t(e){if("number"==typeof e){if(t.codes[e])return t.codes[e];throw new Error("no protocol with code: "+e)}if("string"==typeof e){if(t.names[e])return t.names[e];throw new Error("no protocol with name: "+e)}throw new Error("invalid protocol id type: "+e)}const r=-1;function n(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(s)}}t.lengthPrefixedVarSize=r,t.V=r,t.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,r,"ip6zone"],[53,r,"dns","resolvable"],[54,r,"dns4","resolvable"],[55,r,"dns6","resolvable"],[56,r,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,r,"unix",!1,"path"],[421,r,"ipfs"],[421,r,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,r,"garlic64"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,r,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,r,"memory"]],t.names={},t.codes={},t.table.map((e=>{const r=n.apply(null,e);return t.codes[r.code]=r,t.names[r.name]=r,null})),t.object=n,e.exports=t},80556:(e,t,r)=>{"use strict";const{encodeText:n}=r(82413);e.exports=class{constructor(e,t,r,s){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=s,this.codec=r(s)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}},25077:(e,t,r)=>{"use strict";const n=r(28820),s=r(80556),{rfc4648:i}=r(36727),{decodeText:o,encodeText:a}=r(82413),c=[["identity","\0",()=>({encode:o,decode:a}),""],["base2","0",i(1),"01"],["base8","7",i(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",i(4),"0123456789abcdef"],["base16upper","F",i(4),"0123456789ABCDEF"],["base32hex","v",i(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",i(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",i(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",i(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",i(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",i(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",i(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",i(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",i(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",i(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],h=c.reduce(((e,t)=>(e[t[0]]=new s(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=h[t[0]],e)),{});e.exports={names:h,codes:l}},36957:(e,t,r)=>{"use strict";const n=r(25077),{encodeText:s,decodeText:i,concat:o}=r(82413);function a(e){if(Object.prototype.hasOwnProperty.call(n.names,e))return n.names[e];if(Object.prototype.hasOwnProperty.call(n.codes,e))return n.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");const{name:r,codeBuf:n}=a(e);return function(e,t){a(e).decode(i(t))}(r,t),o([n,t],n.length+t.length)}).encode=function(e,t){const r=a(e),n=s(r.encode(t));return o([r.codeBuf,n],r.codeBuf.length+n.length)},t.decode=function(e){e instanceof Uint8Array&&(e=i(e));const t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),a(e[0]).decode(e.substring(1))},t.isEncoded=function(e){if(e instanceof Uint8Array&&(e=i(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(e){return!1}},t.encoding=a,t.encodingFromData=function(e){return e instanceof Uint8Array&&(e=i(e)),a(e[0])},t.names=Object.freeze(n.names),t.codes=Object.freeze(n.codes)},36727:e=>{"use strict";e.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const i=new Uint8Array(s*r/8|0);let o=0,a=0,c=0;for(let t=0;t<s;++t){const s=n[e[t]];if(void 0===s)throw new SyntaxError("Invalid character "+e[t]);a=a<<r|s,o+=r,o>=8&&(o-=8,i[c++]=255&a>>o)}if(o>=r||255&a<<8-o)throw new SyntaxError("Unexpected end of data");return i})(r,t,e)})}},82413:(e,t,r)=>{"use strict";const{TextEncoder:n,TextDecoder:s}=r(47259),i=new s,o=new n;e.exports={decodeText:e=>i.decode(e),encodeText:e=>o.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}},58636:e=>{"use strict";const t=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"eth-receipt-log-trie":153,"eth-reciept-log":154,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,"caip-50":202,streamid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,thread:406,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,noise:454,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,"swhid-1-snp":496,json:512,messagepack:513,"libp2p-peer-record":769,"libp2p-relay-rsvp":770,"car-index-sorted":1024,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,"secp256k1-priv":4865,"x25519-priv":4866,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056,"arweave-ns":11704592});e.exports={baseTable:t}},76883:(e,t,r)=>{"use strict";const n=r(94676),{concat:s}=r(20605),i=r(55945),{nameToVarint:o,constantToCode:a,nameToCode:c,codeToName:h}=r(21843);function l(e){const t=n.decode(e),r=h[t];if(void 0===r)throw new Error(`Code "${t}" not found`);return r}function u(e){return h[e]}function d(e){const t=c[e];if(void 0===t)throw new Error(`Codec "${e}" not found`);return t}function f(e){return n.decode(e)}function p(e){const t=o[e];if(void 0===t)throw new Error(`Codec "${e}" not found`);return t}function y(e){return i.varintEncode(e)}e.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=i.varintUint8ArrayEncode(e);else{if(!o[e])throw new Error("multicodec not recognized");r=o[e]}return s([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getNameFromData:l,getNameFromCode:u,getCodeFromName:d,getCodeFromData:f,getVarintFromName:p,getVarintFromCode:y,getCodec:function(e){return l(e)},getName:function(e){return u(e)},getNumber:function(e){return d(e)},getCode:function(e){return f(e)},getCodeVarint:function(e){return p(e)},getVarint:function(e){return Array.from(y(e))},...a,nameToVarint:o,nameToCode:c,codeToName:h}},21843:(e,t,r)=>{"use strict";const{baseTable:n}=r(58636),s=r(55945).varintEncode,i={},o={},a={};for(const e in n){const t=e,r=n[t];i[t]=s(r);o[t.toUpperCase().replace(/-/g,"_")]=r,a[r]||(a[r]=t)}Object.freeze(i),Object.freeze(o),Object.freeze(a);const c=Object.freeze(n);e.exports={nameToVarint:i,constantToCode:o,nameToCode:c,codeToName:a}},55945:(e,t,r)=>{"use strict";const n=r(94676),{toString:s}=r(92263),{fromString:i}=r(52217);function o(e){return parseInt(s(e,"base16"),16)}e.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return i(t,"base16")},uint8ArrayToNumber:o,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(o(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}},20400:e=>{"use strict";e.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}},34586:(e,t,r)=>{"use strict";const n=r(92654);e.exports=function(e,t="utf8"){const r=n[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}},50799:(e,t,r)=>{"use strict";const n=r(92654);e.exports=function(e,t="utf8"){const r=n[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}},92654:(e,t,r)=>{"use strict";const{bases:n}=r(23256);function s(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const i=s("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),o=s("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),a={utf8:i,"utf-8":i,hex:n.base16,latin1:o,ascii:o,binary:o,...n};e.exports=a},71291:e=>{"use strict";const t=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:t}},18370:(e,t,r)=>{"use strict";const n=r(36957),s=r(94676),{names:i}=r(71291),o=r(50799),a=r(34586),c=r(20400),h={};for(const e in i){const t=e;h[i[t]]=t}function l(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=s.decode(e);if(!f(t))throw new Error(`multihash unknown function code: 0x${t.toString(16)}`);e=e.slice(s.decode.bytes);const r=s.decode(e);if(r<0)throw new Error(`multihash invalid length: ${r}`);if((e=e.slice(s.decode.bytes)).length!==r)throw new Error(`multihash length inconsistent: 0x${o(e,"base16")}`);return{code:t,name:h[t],length:r,digest:e}}function u(e){let t=e;if("string"==typeof e){if(void 0===i[e])throw new Error(`Unrecognized hash function named: ${e}`);t=i[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(void 0===h[t]&&!d(t))throw new Error(`Unrecognized function code: ${t}`);return t}function d(e){return e>0&&e<16}function f(e){return!!d(e)||!!h[e]}function p(e){l(e)}e.exports={names:i,codes:Object.freeze(h),toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(e,"base16")},fromHexString:function(e){return a(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return o(n.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?o(e):e;return n.decode("z"+t)},decode:l,encode:function(e,t,r){if(!e||void 0===t)throw new Error("multihash encode requires at least two args: digest, code");const n=u(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==r&&(r=e.length),r&&e.length!==r)throw new Error("digest length should be equal to specified length.");const i=s.encode(n),o=s.encode(r);return c([i,o,e],i.length+o.length+e.length)},coerceCode:u,isAppCode:d,validate:p,prefix:function(e){return p(e),e.subarray(0,2)},isValidCode:f}},40469:(e,t,r)=>{e.exports=r(18027)},18027:function(e,t){!function(r,n){"use strict";var s={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e=o(e^=e>>>16,2246822507),e=o(e^=e>>>13,3266489909),e^=e>>>16}function h(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function u(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function d(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=f(e,[0,e[0]>>>1]),e=f(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=f(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}s.x86.hash32=function(e,t){if(s.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%4,h=e.length-r,l=t,u=0,d=3432918353,f=461845907,p=0;p<h;p+=4)u=o(u=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,d),u=o(u=a(u,15),f),l=o(l=a(l^=u,13),5)+3864292196;switch(u=0,r){case 3:u^=e[p+2]<<16;case 2:u^=e[p+1]<<8;case 1:u=o(u^=e[p],d),l^=u=o(u=a(u,15),f)}return(l=c(l^=e.length))>>>0},s.x86.hash128=function(e,t){if(s.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%16,h=e.length-r,l=t,u=t,d=t,f=t,p=0,y=0,g=0,b=0,m=597399067,w=2869860233,v=951274213,E=2716044179,A=0;A<h;A+=16)p=e[A]|e[A+1]<<8|e[A+2]<<16|e[A+3]<<24,y=e[A+4]|e[A+5]<<8|e[A+6]<<16|e[A+7]<<24,g=e[A+8]|e[A+9]<<8|e[A+10]<<16|e[A+11]<<24,b=e[A+12]|e[A+13]<<8|e[A+14]<<16|e[A+15]<<24,p=a(p=o(p,m),15),l=a(l^=p=o(p,w),19),l=o(l+=u,5)+1444728091,y=a(y=o(y,w),16),u=a(u^=y=o(y,v),17),u=o(u+=d,5)+197830471,g=a(g=o(g,v),17),d=a(d^=g=o(g,E),15),d=o(d+=f,5)+2530024501,b=a(b=o(b,E),18),f=a(f^=b=o(b,m),13),f=o(f+=l,5)+850148119;switch(p=0,y=0,g=0,b=0,r){case 15:b^=e[A+14]<<16;case 14:b^=e[A+13]<<8;case 13:b=o(b^=e[A+12],E),f^=b=o(b=a(b,18),m);case 12:g^=e[A+11]<<24;case 11:g^=e[A+10]<<16;case 10:g^=e[A+9]<<8;case 9:g=o(g^=e[A+8],v),d^=g=o(g=a(g,17),E);case 8:y^=e[A+7]<<24;case 7:y^=e[A+6]<<16;case 6:y^=e[A+5]<<8;case 5:y=o(y^=e[A+4],w),u^=y=o(y=a(y,16),v);case 4:p^=e[A+3]<<24;case 3:p^=e[A+2]<<16;case 2:p^=e[A+1]<<8;case 1:p=o(p^=e[A],m),l^=p=o(p=a(p,15),w)}return l^=e.length,l+=u^=e.length,l+=d^=e.length,u+=l+=f^=e.length,d+=l,f+=l,l=c(l),l+=u=c(u),l+=d=c(d),u+=l+=f=c(f),d+=l,f+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},s.x64.hash128=function(e,t){if(s.inputValidation&&!i(e))return n;t=t||0;for(var r=e.length%16,o=e.length-r,a=[0,t],c=[0,t],y=[0,0],g=[0,0],b=[2277735313,289559509],m=[1291169091,658871167],w=0;w<o;w+=16)y=[e[w+4]|e[w+5]<<8|e[w+6]<<16|e[w+7]<<24,e[w]|e[w+1]<<8|e[w+2]<<16|e[w+3]<<24],g=[e[w+12]|e[w+13]<<8|e[w+14]<<16|e[w+15]<<24,e[w+8]|e[w+9]<<8|e[w+10]<<16|e[w+11]<<24],y=u(y=l(y,b),31),a=h(a=u(a=f(a,y=l(y,m)),27),c),a=h(l(a,[0,5]),[0,1390208809]),g=u(g=l(g,m),33),c=h(c=u(c=f(c,g=l(g,b)),31),a),c=h(l(c,[0,5]),[0,944331445]);switch(y=[0,0],g=[0,0],r){case 15:g=f(g,d([0,e[w+14]],48));case 14:g=f(g,d([0,e[w+13]],40));case 13:g=f(g,d([0,e[w+12]],32));case 12:g=f(g,d([0,e[w+11]],24));case 11:g=f(g,d([0,e[w+10]],16));case 10:g=f(g,d([0,e[w+9]],8));case 9:g=l(g=f(g,[0,e[w+8]]),m),c=f(c,g=l(g=u(g,33),b));case 8:y=f(y,d([0,e[w+7]],56));case 7:y=f(y,d([0,e[w+6]],48));case 6:y=f(y,d([0,e[w+5]],40));case 5:y=f(y,d([0,e[w+4]],32));case 4:y=f(y,d([0,e[w+3]],24));case 3:y=f(y,d([0,e[w+2]],16));case 2:y=f(y,d([0,e[w+1]],8));case 1:y=l(y=f(y,[0,e[w]]),b),a=f(a,y=l(y=u(y,31),m))}return a=h(a=f(a,[0,e.length]),c=f(c,[0,e.length])),c=h(c,a),a=h(a=p(a),c=p(c)),c=h(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=s),t.murmurHash3=s}()},99633:e=>{"use strict";function t(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}e.exports=function(e){var r=void 0,n=void 0;function s(e){if(!(e instanceof Object))throw new Error('Target "'+e+'" is not an object');n=e}function i(e){Object.keys(e).forEach((function(t){var r=e[t];if("function"!=typeof r)throw new Error('Trap "'+t+": "+r+'" is not a function');if(!Reflect[t])throw new Error('Trap "'+t+": "+r+'" is not a valid trap')})),r=e}s((function(){})),e&&s(e),i(Reflect);var o=new Proxy({},{get:function(e,s){return function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return r[s].apply(null,[n].concat(t(i.slice(1))))}}});return{setTarget:s,setHandler:i,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,o)}}},30700:(e,t,r)=>{"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:r(83300).default,Headers:r(83300).Headers,Request:r(83300).Request,Response:r(83300).Response}},28951:function(e,t){(function(){var e,r,n,s,i,o,a,c;c=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(".")},a=function(e){var t,n,s,i,o,a;for(t=[],s=i=0;i<=3&&0!==e.length;s=++i){if(s>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}o=(a=r(e))[0],n=a[1],e=e.substring(n),t.push(o)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},s=(n=function(e){return e.charCodeAt(0)})("0"),o=n("a"),i=n("A"),r=function(e){var t,r,a,c,h;for(c=0,t=10,r="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,r="7")),h=a;a<e.length;){if("0"<=e[a]&&e[a]<=r)c=c*t+(n(e[a])-s)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")c=c*t+(10+n(e[a])-o)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;c=c*t+(10+n(e[a])-i)>>>0}}if(c>4294967295)throw new Error("too large");a++}if(a===h)throw new Error("empty octet");return[c,a]},e=function(){function e(e,t){var r,n,s;if("string"!=typeof e)throw new Error("Missing `net' parameter");if(t||(s=e.split("/",2),e=s[0],t=s[1]),t||(t=32),"string"==typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(e){throw e,new Error("Invalid mask: "+t)}for(r=n=32;n>=0;r=--n)if(this.maskLong===4294967295<<32-r>>>0){this.bitmask=r;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(t){throw t,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"==typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(c(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,r,n;for(n=a(this.first),r=a(this.last),t=0;n<=r;)e(c(n),n,t),t++,n++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=c,t.Netmask=e}).call(this)},83300:(e,t)=>{"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r)return r;throw new Error("unable to locate global object")}();e.exports=t=r.fetch,r.fetch&&(t.default=r.fetch.bind(r)),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response},8925:(e,t,r)=>{var n=r(3832);function s(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}r(85649),r(61967),r(97116),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var s=p({key:e,output:r,decrypt:!1,mode:n});return s.start(t),s},n.aes.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var s=p({key:e,output:r,decrypt:!0,mode:n});return s.start(t),s},n.aes.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||u();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return f(r._w,e,t,!1)},decrypt:function(e,t){return f(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var s=0;s<t.length;++s)r.putByte(t[s])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var i=t.length();if(16===i||24===i||32===i){i>>>=2;for(s=0;s<i;++s)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var o=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=d(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return l||u(),d(e,t)},n.aes._updateBlock=f,s("AES-ECB",n.cipher.modes.ecb),s("AES-CBC",n.cipher.modes.cbc),s("AES-CFB",n.cipher.modes.cfb),s("AES-OFB",n.cipher.modes.ofb),s("AES-CTR",n.cipher.modes.ctr),s("AES-GCM",n.cipher.modes.gcm);var i,o,a,c,h,l=!1;function u(){l=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;i=new Array(256),o=new Array(256),c=new Array(4),h=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),h[t]=new Array(256);var r,n,s,u,d,f,p,y=0,g=0;for(t=0;t<256;++t){u=(u=g^g<<1^g<<2^g<<3^g<<4)>>8^255&u^99,i[y]=u,o[u]=y,f=(d=e[u])<<24^u<<16^u<<8^u^d,p=((r=e[y])^(n=e[r])^(s=e[n]))<<24^(y^s)<<16^(y^n^s)<<8^y^r^s;for(var b=0;b<4;++b)c[b][y]=f,h[b][u]=p,f=f<<24|f>>>8,p=p<<24|p>>>8;0===y?y=g=1:(y=r^e[e[e[r^s]]],g^=e[e[g]])}}function d(e,t){for(var r,n=e.slice(0),s=1,o=n.length,c=4*(o+6+1),l=o;l<c;++l)r=n[l-1],l%o==0?(r=i[r>>>16&255]<<24^i[r>>>8&255]<<16^i[255&r]<<8^i[r>>>24]^a[s]<<24,s++):o>6&&l%o==4&&(r=i[r>>>24]<<24^i[r>>>16&255]<<16^i[r>>>8&255]<<8^i[255&r]),n[l]=n[l-o]^r;if(t){for(var u,d=h[0],f=h[1],p=h[2],y=h[3],g=n.slice(0),b=(l=0,(c=n.length)-4);l<c;l+=4,b-=4)if(0===l||l===c-4)g[l]=n[b],g[l+1]=n[b+3],g[l+2]=n[b+2],g[l+3]=n[b+1];else for(var m=0;m<4;++m)u=n[b+m],g[l+(3&-m)]=d[i[u>>>24]]^f[i[u>>>16&255]]^p[i[u>>>8&255]]^y[i[255&u]];n=g}return n}function f(e,t,r,n){var s,a,l,u,d,f,p,y,g,b,m,w,v=e.length/4-1;n?(s=h[0],a=h[1],l=h[2],u=h[3],d=o):(s=c[0],a=c[1],l=c[2],u=c[3],d=i),f=t[0]^e[0],p=t[n?3:1]^e[1],y=t[2]^e[2],g=t[n?1:3]^e[3];for(var E=3,A=1;A<v;++A)b=s[f>>>24]^a[p>>>16&255]^l[y>>>8&255]^u[255&g]^e[++E],m=s[p>>>24]^a[y>>>16&255]^l[g>>>8&255]^u[255&f]^e[++E],w=s[y>>>24]^a[g>>>16&255]^l[f>>>8&255]^u[255&p]^e[++E],g=s[g>>>24]^a[f>>>16&255]^l[p>>>8&255]^u[255&y]^e[++E],f=b,p=m,y=w;r[0]=d[f>>>24]<<24^d[p>>>16&255]<<16^d[y>>>8&255]<<8^d[255&g]^e[++E],r[n?3:1]=d[p>>>24]<<24^d[y>>>16&255]<<16^d[g>>>8&255]<<8^d[255&f]^e[++E],r[2]=d[y>>>24]<<24^d[g>>>16&255]<<16^d[f>>>8&255]<<8^d[255&p]^e[++E],r[n?1:3]=d[g>>>24]<<24^d[f>>>16&255]<<16^d[p>>>8&255]<<8^d[255&y]^e[++E]}function p(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),s=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var i=null;r instanceof n.util.ByteBuffer&&(i=r,r={}),(r=r||{}).output=i,r.iv=e,s.call(t,r)},t}},3068:(e,t,r)=>{var n=r(3832);r(97116),r(66270);var s=e.exports=n.asn1=n.asn1||{};function i(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}s.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},s.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},s.create=function(e,t,r,i,o){if(n.util.isArray(i)){for(var a=[],c=0;c<i.length;++c)void 0!==i[c]&&a.push(i[c]);i=a}var h={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(i),value:i};return o&&"bitStringContents"in o&&(h.bitStringContents=o.bitStringContents,h.original=s.copy(h)),h},s.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var i=0;i<e.length;++i)r.push(s.copy(e[i],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:s.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},s.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!s.equals(e[i],t[i]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var o=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&s.equals(e.value,t.value);return r&&r.includeBitStringContents&&(o=o&&e.bitStringContents===t.bitStringContents),o},s.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function o(e,t,r,n){var a;i(e,t,2);var c=e.getByte();t--;var h=192&c,l=31&c;a=e.length();var u,d,f=function(e,t){var r=e.getByte();if(t--,128!==r){var n;if(128&r){var s=127&r;i(e,t,s),n=e.getInt(s<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(e,t);if(t-=a-e.length(),void 0!==f&&f>t){if(n.strict){var p=new Error("Too few bytes to read ASN.1 value.");throw p.available=e.length(),p.remaining=t,p.requested=f,p}f=t}var y=32==(32&c);if(y)if(u=[],void 0===f)for(;;){if(i(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}a=e.length(),u.push(o(e,t,r+1,n)),t-=a-e.length()}else for(;f>0;)a=e.length(),u.push(o(e,f,r+1,n)),t-=a-e.length(),f-=a-e.length();if(void 0===u&&h===s.Class.UNIVERSAL&&l===s.Type.BITSTRING&&(d=e.bytes(f)),void 0===u&&n.decodeBitStrings&&h===s.Class.UNIVERSAL&&l===s.Type.BITSTRING&&f>1){var g=e.read,b=t,m=0;if(l===s.Type.BITSTRING&&(i(e,t,1),m=e.getByte(),t--),0===m)try{a=e.length();var w=o(e,t,r+1,{strict:!0,decodeBitStrings:!0}),v=a-e.length();t-=v,l==s.Type.BITSTRING&&v++;var E=w.tagClass;v!==f||E!==s.Class.UNIVERSAL&&E!==s.Class.CONTEXT_SPECIFIC||(u=[w])}catch(e){}void 0===u&&(e.read=g,t=b)}if(void 0===u){if(void 0===f){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(l===s.Type.BMPSTRING)for(u="";f>0;f-=2)i(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(f),t-=f}var A=void 0===d?null:{bitStringContents:d};return s.create(h,l,y,u,A)}s.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.length(),s=o(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return s},s.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,i=n.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=s.equals(e,e.original))),o)i.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:i.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&i.putBuffer(s.toDer(e.value[a]))}else if(e.type===s.Type.BMPSTRING)for(a=0;a<e.value.length;++a)i.putInt16(e.value.charCodeAt(a));else e.type===s.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?i.putBytes(e.value.substr(1)):i.putBytes(e.value);if(t.putByte(r),i.length()<=127)t.putByte(127&i.length());else{var c=i.length(),h="";do{h+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|h.length);for(a=h.length-1;a>=0;--a)t.putByte(h.charCodeAt(a))}return t.putBuffer(i),t},s.oidToDer=function(e){var t,r,s,i,o=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var c=2;c<o.length;++c){t=!0,r=[],s=parseInt(o[c],10);do{i=127&s,s>>>=7,t||(i|=128),r.push(i),t=!1}while(s>0);for(var h=r.length-1;h>=0;--h)a.putByte(r[h])}return a},s.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var s=0;e.length()>0;)s<<=7,128&(r=e.getByte())?s+=127&r:(t+="."+(s+r),s=0);return t},s.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,s=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),h=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),h+=2)}if(t.setUTCFullYear(r,n,s),t.setUTCHours(i,o,a,0),h&&("+"===(c=e.charAt(h))||"-"===c)){var l=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10);l*=6e4,"+"===c?t.setTime(+t-l):t.setTime(+t+l)}return t},s.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,s=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,h=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var u=e.length-5,d=e.charAt(u);"+"!==d&&"-"!==d||(h=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10),h*=6e4,"+"===d&&(h*=-1),l=!0);return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,s),t.setUTCHours(i,o,a,c),t.setTime(+t+h)):(t.setFullYear(r,n,s),t.setHours(i,o,a,c)),t},s.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},s.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},s.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},s.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},s.validate=function(e,t,r,i){var o=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)i&&(e.tagClass!==t.tagClass&&i.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&i.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(o=!0,t.value&&n.util.isArray(t.value))for(var a=0,c=0;o&&c<t.value.length;++c)o=t.value[c].optional||!1,e.value[a]&&((o=s.validate(e.value[a],t.value[c],r,i))?++a:t.value[c].optional&&(o=!0)),!o&&i&&i.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(o&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else i&&i.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return o};var a=/[^\\u0000-\\u00ff]/;s.prettyPrint=function(e,t,r){var i="";r=r||2,(t=t||0)>0&&(i+="\n");for(var o="",c=0;c<t*r;++c)o+=" ";switch(i+=o+"Tag: ",e.tagClass){case s.Class.UNIVERSAL:i+="Universal:";break;case s.Class.APPLICATION:i+="Application:";break;case s.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case s.Class.PRIVATE:i+="Private:"}if(e.tagClass===s.Class.UNIVERSAL)switch(i+=e.type,e.type){case s.Type.NONE:i+=" (None)";break;case s.Type.BOOLEAN:i+=" (Boolean)";break;case s.Type.INTEGER:i+=" (Integer)";break;case s.Type.BITSTRING:i+=" (Bit string)";break;case s.Type.OCTETSTRING:i+=" (Octet string)";break;case s.Type.NULL:i+=" (Null)";break;case s.Type.OID:i+=" (Object Identifier)";break;case s.Type.ODESC:i+=" (Object Descriptor)";break;case s.Type.EXTERNAL:i+=" (External or Instance of)";break;case s.Type.REAL:i+=" (Real)";break;case s.Type.ENUMERATED:i+=" (Enumerated)";break;case s.Type.EMBEDDED:i+=" (Embedded PDV)";break;case s.Type.UTF8:i+=" (UTF8)";break;case s.Type.ROID:i+=" (Relative Object Identifier)";break;case s.Type.SEQUENCE:i+=" (Sequence)";break;case s.Type.SET:i+=" (Set)";break;case s.Type.PRINTABLESTRING:i+=" (Printable String)";break;case s.Type.IA5String:i+=" (IA5String (ASCII))";break;case s.Type.UTCTIME:i+=" (UTC time)";break;case s.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case s.Type.BMPSTRING:i+=" (BMP String)"}else i+=e.type;if(i+="\n",i+=o+"Constructed: "+e.constructed+"\n",e.composed){var h=0,l="";for(c=0;c<e.value.length;++c)void 0!==e.value[c]&&(h+=1,l+=s.prettyPrint(e.value[c],t+1,r),c+1<e.value.length&&(l+=","));i+=o+"Sub values: "+h+l}else{if(i+=o+"Value: ",e.type===s.Type.OID){var u=s.derToOid(e.value);i+=u,n.pki&&n.pki.oids&&u in n.pki.oids&&(i+=" ("+n.pki.oids[u]+") ")}if(e.type===s.Type.INTEGER)try{i+=s.derToInteger(e.value)}catch(t){i+="0x"+n.util.bytesToHex(e.value)}else if(e.type===s.Type.BITSTRING){if(e.value.length>1?i+="0x"+n.util.bytesToHex(e.value.slice(1)):i+="(none)",e.value.length>0){var d=e.value.charCodeAt(0);1==d?i+=" (1 unused bit shown)":d>1&&(i+=" ("+d+" unused bits shown)")}}else if(e.type===s.Type.OCTETSTRING)a.test(e.value)||(i+="("+e.value+") "),i+="0x"+n.util.bytesToHex(e.value);else if(e.type===s.Type.UTF8)try{i+=n.util.decodeUtf8(e.value)}catch(t){if("URI malformed"!==t.message)throw t;i+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===s.Type.PRINTABLESTRING||e.type===s.Type.IA5String?i+=e.value:a.test(e.value)?i+="0x"+n.util.bytesToHex(e.value):0===e.value.length?i+="[null]":i+=e.value}return i}},78807:(e,t,r)=>{var n=r(48764).Buffer,s={};e.exports=s;var i={};s.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var s=0,i=t.length,o=t.charAt(0),a=[0];for(s=0;s<e.length;++s){for(var c=0,h=e[s];c<a.length;++c)h+=a[c]<<8,a[c]=h%i,h=h/i|0;for(;h>0;)a.push(h%i),h=h/i|0}for(s=0;0===e[s]&&s<e.length-1;++s)n+=o;for(s=a.length-1;s>=0;--s)n+=t[a[s]]}else n=function(e,t){var r=0,n=t.length,s=t.charAt(0),i=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<i.length;++o)a+=i[o]<<8,i[o]=a%n,a=a/n|0;for(;a>0;)i.push(a%n),a=a/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=s;for(r=i.length-1;r>=0;--r)c+=t[i[r]];return c}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},s.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var r=i[t];if(!r){r=i[t]=[];for(var s=0;s<t.length;++s)r[t.charCodeAt(s)]=s}e=e.replace(/\s/g,"");var o=t.length,a=t.charAt(0),c=[0];for(s=0;s<e.length;s++){var h=r[e.charCodeAt(s)];if(void 0===h)return;for(var l=0,u=h;l<c.length;++l)u+=c[l]*o,c[l]=255&u,u>>=8;for(;u>0;)c.push(255&u),u>>=8}for(var d=0;e[d]===a&&d<e.length-1;++d)c.push(0);return void 0!==n?n.from(c.reverse()):new Uint8Array(c.reverse())}},85649:(e,t,r)=>{var n=r(3832);r(97116),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var s=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};s.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},s.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},s.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},61967:(e,t,r)=>{var n=r(3832);r(97116),n.cipher=n.cipher||{};var s=e.exports=n.cipher.modes=n.cipher.modes||{};function i(e,t){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var s=0;s<r.length;++s)e.putByte(r[s])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var i=[],o=t/4;for(s=0;s<o;++s)i.push(e.getInt32());e=i}return e}function o(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}s.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},s.ecb.prototype.start=function(e){},s.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},s.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},s.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},s.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},s.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},s.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},s.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},s.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},s.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},s.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},s.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},s.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32()^this._outBlock[s],t.putInt32(this._inBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32()^this._outBlock[s],this._partialOutput.putInt32(this._partialBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},s.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32(),t.putInt32(this._inBlock[s]^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[s]^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},s.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},s.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]),this._inBlock[s]=this._outBlock[s];else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._outBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},s.ofb.prototype.decrypt=s.ofb.prototype.encrypt,s.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},s.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}o(this._inBlock)},s.ctr.prototype.decrypt=s.ctr.prototype.encrypt,s.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},s.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var s=r.length();if(12===s)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*s)))}this._inBlock=this._j0.slice(0),o(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var i=t.length()%this.blockSize;for(i&&t.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},s.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),o(this._inBlock)},s.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),o(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^this._hashBlock[s]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},s.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var s=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,s);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},s.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),s=0;s<128;++s){e[s/32|0]&1<<31-s%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},s.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},s.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,s=this._m[r][n];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t},s.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},s.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,s=16*r,i=new Array(s),o=0;o<s;++o){var a=[0,0,0,0],c=(n-1-o%n)*t;a[o/n|0]=1<<t-1<<c,i[o]=this.generateSubHashTable(this.multiply(a,e),t)}return i},s.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,s=new Array(r);s[n]=e.slice(0);for(var i=n>>>1;i>0;)this.pow(s[2*i],s[i]=[]),i>>=1;for(i=2;i<n;){for(var o=1;o<i;++o){var a=s[i],c=s[o];s[i+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}i*=2}for(s[0]=[0,0,0,0],i=n+1;i<r;++i){var h=s[i^n];s[i]=[e[0]^h[0],e[1]^h[1],e[2]^h[2],e[3]^h[3]]}return s}},33480:(e,t,r)=>{var n=r(3832);function s(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}r(85649),r(61967),r(97116),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var s=p({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return s.start(t),s},n.des.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var s=p({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return s.start(t),s},n.des.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return f(r._keys,e,t,!1)},decrypt:function(e,t){return f(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],s=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],h=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,b=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,v=0;v<g;v++){var E=e.getInt32(),A=e.getInt32();E^=(t=252645135&(E>>>4^A))<<4,E^=t=65535&((A^=t)>>>-16^E),E^=(t=858993459&(E>>>2^(A^=t<<-16)))<<2,E^=t=65535&((A^=t)>>>-16^E),E^=(t=1431655765&(E>>>1^(A^=t<<-16)))<<1,E^=t=16711935&((A^=t)>>>8^E),t=(E^=(t=1431655765&(E>>>1^(A^=t<<8)))<<1)<<8|(A^=t)>>>20&240,E=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=t;for(var S=0;S<m.length;++S){m[S]?(E=E<<2|E>>>26,A=A<<2|A>>>26):(E=E<<1|E>>>27,A=A<<1|A>>>27),A&=-15;var _=r[(E&=-15)>>>28]|n[E>>>24&15]|s[E>>>20&15]|i[E>>>16&15]|o[E>>>12&15]|a[E>>>8&15]|c[E>>>4&15],C=h[A>>>28]|l[A>>>24&15]|u[A>>>20&15]|d[A>>>16&15]|f[A>>>12&15]|p[A>>>8&15]|y[A>>>4&15];t=65535&(C>>>16^_),b[w++]=_^t,b[w++]=C^t<<16}}return b}(t),this._init=!0}},s("DES-ECB",n.cipher.modes.ecb),s("DES-CBC",n.cipher.modes.cbc),s("DES-CFB",n.cipher.modes.cfb),s("DES-OFB",n.cipher.modes.ofb),s("DES-CTR",n.cipher.modes.ctr),s("3DES-ECB",n.cipher.modes.ecb),s("3DES-CBC",n.cipher.modes.cbc),s("3DES-CFB",n.cipher.modes.cfb),s("3DES-OFB",n.cipher.modes.ofb),s("3DES-CTR",n.cipher.modes.ctr);var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e,t,r,n){var s,f,p=32===e.length?3:9;s=3===p?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var y=t[0],g=t[1];y^=(f=252645135&(y>>>4^g))<<4,y^=(f=65535&(y>>>16^(g^=f)))<<16,y^=f=858993459&((g^=f)>>>2^y),y^=f=16711935&((g^=f<<2)>>>8^y),y=(y^=(f=1431655765&(y>>>1^(g^=f<<8)))<<1)<<1|y>>>31,g=(g^=f)<<1|g>>>31;for(var b=0;b<p;b+=3){for(var m=s[b+1],w=s[b+2],v=s[b];v!=m;v+=w){var E=g^e[v],A=(g>>>4|g<<28)^e[v+1];f=y,y=g,g=f^(o[E>>>24&63]|c[E>>>16&63]|l[E>>>8&63]|d[63&E]|i[A>>>24&63]|a[A>>>16&63]|h[A>>>8&63]|u[63&A])}f=y,y=g,g=f}g=g>>>1|g<<31,g^=f=1431655765&((y=y>>>1|y<<31)>>>1^g),g^=(f=16711935&(g>>>8^(y^=f<<1)))<<8,g^=(f=858993459&(g>>>2^(y^=f)))<<2,g^=f=65535&((y^=f)>>>16^g),g^=f=252645135&((y^=f<<16)>>>4^g),y^=f<<4,r[0]=y,r[1]=g}function p(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),s=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var i=null;r instanceof n.util.ByteBuffer&&(i=r,r={}),(r=r||{}).output=i,r.iv=e,s.call(t,r)},t}},3832:e=>{e.exports={options:{usePureJavaScript:!1}}},36607:(e,t,r)=>{var n=r(3832);r(28991),r(97116),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,s=null,i={start:function(i,o){if(null!==i)if("string"==typeof i){if(!((i=i.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+i+'"');t=n.md.algorithms[i].create()}else t=i;if(null===o)o=e;else{if("string"==typeof o)o=n.util.createBuffer(o);else if(n.util.isArray(o)){var a=o;o=n.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var h=o.length();h>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=n.util.createBuffer(),s=n.util.createBuffer(),h=o.length();for(c=0;c<h;++c){a=o.at(c);r.putByte(54^a),s.putByte(92^a)}if(h<t.blockLength)for(a=t.blockLength-h,c=0;c<a;++c)r.putByte(54),s.putByte(92);e=o,r=r.bytes(),s=s.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(s),t.update(e),t.digest()}};return i.digest=i.getMac,i}},15764:(e,t,r)=>{var n,s=r(3832);e.exports=s.jsbn=s.jsbn||{};function i(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function o(){return new i(null)}function a(e,t,r,n,s,i){for(var o=16383&t,a=t>>14;--i>=0;){var c=16383&this.data[e],h=this.data[e++]>>14,l=a*c+h*o;s=((c=o*c+((16383&l)<<14)+r.data[n]+s)>>28)+(l>>14)+a*h,r.data[n++]=268435455&c}return s}s.jsbn.BigInteger=i,"undefined"==typeof navigator?(i.prototype.am=a,n=28):"Microsoft Internet Explorer"==navigator.appName?(i.prototype.am=function(e,t,r,n,s,i){for(var o=32767&t,a=t>>15;--i>=0;){var c=32767&this.data[e],h=this.data[e++]>>15,l=a*c+h*o;s=((c=o*c+((32767&l)<<15)+r.data[n]+(1073741823&s))>>>30)+(l>>>15)+a*h+(s>>>30),r.data[n++]=1073741823&c}return s},n=30):"Netscape"!=navigator.appName?(i.prototype.am=function(e,t,r,n,s,i){for(;--i>=0;){var o=t*this.data[e++]+r.data[n]+s;s=Math.floor(o/67108864),r.data[n++]=67108863&o}return s},n=26):(i.prototype.am=a,n=28),i.prototype.DB=n,i.prototype.DM=(1<<n)-1,i.prototype.DV=1<<n;i.prototype.FV=Math.pow(2,52),i.prototype.F1=52-n,i.prototype.F2=2*n-52;var c,h,l=new Array;for(c="0".charCodeAt(0),h=0;h<=9;++h)l[c++]=h;for(c="a".charCodeAt(0),h=10;h<36;++h)l[c++]=h;for(c="A".charCodeAt(0),h=10;h<36;++h)l[c++]=h;function u(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function d(e,t){var r=l[e.charCodeAt(t)];return null==r?-1:r}function f(e){var t=o();return t.fromInt(e),t}function p(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function y(e){this.m=e}function g(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function b(e,t){return e&t}function m(e,t){return e|t}function w(e,t){return e^t}function v(e,t){return e&~t}function E(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function A(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function S(){}function _(e){return e}function C(e){this.r2=o(),this.q3=o(),i.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}y.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},y.prototype.revert=function(e){return e},y.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},y.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},g.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(i.ZERO)>0&&this.m.subTo(t,t),t},g.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},g.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},i.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},i.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},i.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,s=!1,o=0;--n>=0;){var a=8==r?255&e[n]:d(e,n);a<0?"-"==e.charAt(n)&&(s=!0):(s=!1,0==o?this.data[this.t++]=a:o+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),s&&i.ZERO.subTo(this,this)},i.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},i.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},i.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},i.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,s=this.DB-n,i=(1<<s)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+o+1]=this.data[r]>>s|a,a=(this.data[r]&i)<<n;for(r=o-1;r>=0;--r)t.data[r]=0;t.data[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},i.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,s=this.DB-n,i=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&i)<<s,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&i)<<s),t.t=this.t-r,t.clamp()}},i.prototype.subTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},i.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t.data[s]=0;for(s=0;s<n.t;++s)t.data[s+r.t]=r.am(0,n.data[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&i.ZERO.subTo(t,t)},i.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},i.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var a=o(),c=this.s,h=e.s,l=this.DB-p(n.data[n.t-1]);l>0?(n.lShiftTo(l,a),s.lShiftTo(l,r)):(n.copyTo(a),s.copyTo(r));var u=a.t,d=a.data[u-1];if(0!=d){var f=d*(1<<this.F1)+(u>1?a.data[u-2]>>this.F2:0),y=this.FV/f,g=(1<<this.F1)/f,b=1<<this.F2,m=r.t,w=m-u,v=null==t?o():t;for(a.dlShiftTo(w,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),i.ONE.dlShiftTo(u,v),v.subTo(a,a);a.t<u;)a.data[a.t++]=0;for(;--w>=0;){var E=r.data[--m]==d?this.DM:Math.floor(r.data[m]*y+(r.data[m-1]+b)*g);if((r.data[m]+=a.am(0,E,r,w,0,u))<E)for(a.dlShiftTo(w,v),r.subTo(v,r);r.data[m]<--E;)r.subTo(v,r)}null!=t&&(r.drShiftTo(u,t),c!=h&&i.ZERO.subTo(t,t)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&i.ZERO.subTo(r,r)}}},i.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},i.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},i.prototype.exp=function(e,t){if(e>4294967295||e<1)return i.ONE;var r=o(),n=o(),s=t.convert(this),a=p(e)-1;for(s.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,s,r);else{var c=r;r=n,n=c}return t.revert(r)},i.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,s=!1,i="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this.data[o]>>a)>0&&(s=!0,i=u(r));o>=0;)a<t?(r=(this.data[o]&(1<<a)-1)<<t-a,r|=this.data[--o]>>(a+=this.DB-t)):(r=this.data[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(s=!0),s&&(i+=u(r));return s?i:"0"},i.prototype.negate=function(){var e=o();return i.ZERO.subTo(this,e),e},i.prototype.abs=function(){return this.s<0?this.negate():this},i.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},i.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this.data[this.t-1]^this.s&this.DM)},i.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(i.ZERO)>0&&e.subTo(t,t),t},i.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new y(t):new g(t),this.exp(e,r)},i.ZERO=f(0),i.ONE=f(1),S.prototype.convert=_,S.prototype.revert=_,S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},S.prototype.sqrTo=function(e,t){e.squareTo(t)},C.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},C.prototype.revert=function(e){return e},C.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},C.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},C.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var k=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],I=(1<<26)/k[k.length-1];i.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},i.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=f(r),s=o(),i=o(),a="";for(this.divRemTo(n,s,i);s.signum()>0;)a=(r+i.intValue()).toString(e).substr(1)+a,s.divRemTo(n,s,i);return i.intValue().toString(e)+a},i.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,o=0,a=0,c=0;c<e.length;++c){var h=d(e,c);h<0?"-"==e.charAt(c)&&0==this.signum()&&(s=!0):(a=t*a+h,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),s&&i.ZERO.subTo(this,this)},i.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(i.ONE.shiftLeft(e-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(i.ONE.shiftLeft(e-1),this);else{var n=new Array,s=7&e;n.length=1+(e>>3),t.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}},i.prototype.bitwiseTo=function(e,t,r){var n,s,i=Math.min(e.t,this.t);for(n=0;n<i;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(s=e.s&this.DM,n=i;n<this.t;++n)r.data[n]=t(this.data[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<e.t;++n)r.data[n]=t(s,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},i.prototype.changeBit=function(e,t){var r=i.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},i.prototype.addTo=function(e,t){for(var r=0,n=0,s=Math.min(e.t,this.t);r<s;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},i.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},i.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},i.prototype.multiplyLowerTo=function(e,t,r){var n,s=Math.min(this.t+e.t,t);for(r.s=0,r.t=s;s>0;)r.data[--s]=0;for(n=r.t-this.t;s<n;++s)r.data[s+this.t]=this.am(0,e.data[s],r,s,0,this.t);for(n=Math.min(e.t,t);s<n;++s)this.am(0,e.data[s],r,s,0,t-s);r.clamp()},i.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},i.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},i.prototype.millerRabin=function(e){var t=this.subtract(i.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,s=t.shiftRight(r),o={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{n=new i(this.bitLength(),o)}while(n.compareTo(i.ONE)<=0||n.compareTo(t)>=0);var c=n.modPow(s,this);if(0!=c.compareTo(i.ONE)&&0!=c.compareTo(t)){for(var h=1;h++<r&&0!=c.compareTo(t);)if(0==(c=c.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},i.prototype.clone=function(){var e=o();return this.copyTo(e),e},i.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},i.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},i.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},i.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},i.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,s=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[s++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==s&&(128&this.s)!=(128&r)&&++s,(s>0||r!=this.s)&&(t[s++]=r);return t},i.prototype.equals=function(e){return 0==this.compareTo(e)},i.prototype.min=function(e){return this.compareTo(e)<0?this:e},i.prototype.max=function(e){return this.compareTo(e)>0?this:e},i.prototype.and=function(e){var t=o();return this.bitwiseTo(e,b,t),t},i.prototype.or=function(e){var t=o();return this.bitwiseTo(e,m,t),t},i.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,w,t),t},i.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,v,t),t},i.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},i.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},i.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},i.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+E(this.data[e]);return this.s<0?this.t*this.DB:-1},i.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=A(this.data[r]^t);return e},i.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},i.prototype.setBit=function(e){return this.changeBit(e,m)},i.prototype.clearBit=function(e){return this.changeBit(e,v)},i.prototype.flipBit=function(e){return this.changeBit(e,w)},i.prototype.add=function(e){var t=o();return this.addTo(e,t),t},i.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},i.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},i.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},i.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},i.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},i.prototype.modPow=function(e,t){var r,n,s=e.bitLength(),i=f(1);if(s<=0)return i;r=s<18?1:s<48?3:s<144?4:s<768?5:6,n=s<8?new y(t):t.isEven()?new C(t):new g(t);var a=new Array,c=3,h=r-1,l=(1<<r)-1;if(a[1]=n.convert(this),r>1){var u=o();for(n.sqrTo(a[1],u);c<=l;)a[c]=o(),n.mulTo(u,a[c-2],a[c]),c+=2}var d,b,m=e.t-1,w=!0,v=o();for(s=p(e.data[m])-1;m>=0;){for(s>=h?d=e.data[m]>>s-h&l:(d=(e.data[m]&(1<<s+1)-1)<<h-s,m>0&&(d|=e.data[m-1]>>this.DB+s-h)),c=r;0==(1&d);)d>>=1,--c;if((s-=c)<0&&(s+=this.DB,--m),w)a[d].copyTo(i),w=!1;else{for(;c>1;)n.sqrTo(i,v),n.sqrTo(v,i),c-=2;c>0?n.sqrTo(i,v):(b=i,i=v,v=b),n.mulTo(v,a[d],i)}for(;m>=0&&0==(e.data[m]&1<<s);)n.sqrTo(i,v),b=i,i=v,v=b,--s<0&&(s=this.DB-1,--m)}return n.revert(i)},i.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return i.ZERO;for(var r=e.clone(),n=this.clone(),s=f(1),o=f(0),a=f(0),c=f(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(a,s),o.subTo(c,o)):(n.subTo(r,n),t&&a.subTo(s,a),c.subTo(o,c))}return 0!=n.compareTo(i.ONE)?i.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},i.prototype.pow=function(e){return this.exp(e,new S)},i.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var s=t.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return t;for(s<i&&(i=s),i>0&&(t.rShiftTo(i,t),r.rShiftTo(i,r));t.signum()>0;)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r},i.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=k[k.length-1]){for(t=0;t<k.length;++t)if(r.data[0]==k[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<k.length;){for(var n=k[t],s=t+1;s<k.length&&n<I;)n*=k[s++];for(n=r.modInt(n);t<s;)if(n%k[t++]==0)return!1}return r.millerRabin(e)}},28991:(e,t,r)=>{var n=r(3832);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},86971:(e,t,r)=>{var n=r(3832);r(83453),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},83453:(e,t,r)=>{var n=r(3832);r(97116),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var s=new n.util.ByteBuffer,i=Math.ceil(r/e.digestLength),o=0;o<i;o++){var a=new n.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),s.putBuffer(e.digest())}return s.truncate(s.length()-r),s.getBytes()}}}},66270:(e,t,r)=>{var n=r(3832);n.pki=n.pki||{};var s=e.exports=n.pki.oids=n.oids=n.oids||{};function i(e,t){s[e]=t,s[t]=e}function o(e,t){s[e]=t}i("1.2.840.113549.1.1.1","rsaEncryption"),i("1.2.840.113549.1.1.4","md5WithRSAEncryption"),i("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),i("1.2.840.113549.1.1.7","RSAES-OAEP"),i("1.2.840.113549.1.1.8","mgf1"),i("1.2.840.113549.1.1.9","pSpecified"),i("1.2.840.113549.1.1.10","RSASSA-PSS"),i("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),i("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),i("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),i("1.3.101.112","EdDSA25519"),i("1.2.840.10040.4.3","dsa-with-sha1"),i("1.3.14.3.2.7","desCBC"),i("1.3.14.3.2.26","sha1"),i("1.3.14.3.2.29","sha1WithRSASignature"),i("2.16.840.1.101.3.4.2.1","sha256"),i("2.16.840.1.101.3.4.2.2","sha384"),i("2.16.840.1.101.3.4.2.3","sha512"),i("2.16.840.1.101.3.4.2.4","sha224"),i("2.16.840.1.101.3.4.2.5","sha512-224"),i("2.16.840.1.101.3.4.2.6","sha512-256"),i("1.2.840.113549.2.2","md2"),i("1.2.840.113549.2.5","md5"),i("1.2.840.113549.1.7.1","data"),i("1.2.840.113549.1.7.2","signedData"),i("1.2.840.113549.1.7.3","envelopedData"),i("1.2.840.113549.1.7.4","signedAndEnvelopedData"),i("1.2.840.113549.1.7.5","digestedData"),i("1.2.840.113549.1.7.6","encryptedData"),i("1.2.840.113549.1.9.1","emailAddress"),i("1.2.840.113549.1.9.2","unstructuredName"),i("1.2.840.113549.1.9.3","contentType"),i("1.2.840.113549.1.9.4","messageDigest"),i("1.2.840.113549.1.9.5","signingTime"),i("1.2.840.113549.1.9.6","counterSignature"),i("1.2.840.113549.1.9.7","challengePassword"),i("1.2.840.113549.1.9.8","unstructuredAddress"),i("1.2.840.113549.1.9.14","extensionRequest"),i("1.2.840.113549.1.9.20","friendlyName"),i("1.2.840.113549.1.9.21","localKeyId"),i("1.2.840.113549.1.9.22.1","x509Certificate"),i("1.2.840.113549.1.12.10.1.1","keyBag"),i("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),i("1.2.840.113549.1.12.10.1.3","certBag"),i("1.2.840.113549.1.12.10.1.4","crlBag"),i("1.2.840.113549.1.12.10.1.5","secretBag"),i("1.2.840.113549.1.12.10.1.6","safeContentsBag"),i("1.2.840.113549.1.5.13","pkcs5PBES2"),i("1.2.840.113549.1.5.12","pkcs5PBKDF2"),i("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),i("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),i("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),i("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),i("1.2.840.113549.2.7","hmacWithSHA1"),i("1.2.840.113549.2.8","hmacWithSHA224"),i("1.2.840.113549.2.9","hmacWithSHA256"),i("1.2.840.113549.2.10","hmacWithSHA384"),i("1.2.840.113549.2.11","hmacWithSHA512"),i("1.2.840.113549.3.7","des-EDE3-CBC"),i("2.16.840.1.101.3.4.1.2","aes128-CBC"),i("2.16.840.1.101.3.4.1.22","aes192-CBC"),i("2.16.840.1.101.3.4.1.42","aes256-CBC"),i("2.5.4.3","commonName"),i("2.5.4.4","surname"),i("2.5.4.5","serialNumber"),i("2.5.4.6","countryName"),i("2.5.4.7","localityName"),i("2.5.4.8","stateOrProvinceName"),i("2.5.4.9","streetAddress"),i("2.5.4.10","organizationName"),i("2.5.4.11","organizationalUnitName"),i("2.5.4.12","title"),i("2.5.4.13","description"),i("2.5.4.15","businessCategory"),i("2.5.4.17","postalCode"),i("2.5.4.42","givenName"),i("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),i("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),i("2.16.840.1.113730.1.1","nsCertType"),i("2.16.840.1.113730.1.13","nsComment"),o("2.5.29.1","authorityKeyIdentifier"),o("2.5.29.2","keyAttributes"),o("2.5.29.3","certificatePolicies"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.5","policyMapping"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.7","subjectAltName"),o("2.5.29.8","issuerAltName"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.10","basicConstraints"),o("2.5.29.11","nameConstraints"),o("2.5.29.12","policyConstraints"),o("2.5.29.13","basicConstraints"),i("2.5.29.14","subjectKeyIdentifier"),i("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),i("2.5.29.17","subjectAltName"),i("2.5.29.18","issuerAltName"),i("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.25","cRLDistributionPoints"),o("2.5.29.26","issuingDistributionPoint"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),i("2.5.29.31","cRLDistributionPoints"),i("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.34","policyConstraints"),i("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),i("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),i("1.3.6.1.4.1.11129.2.4.2","timestampList"),i("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),i("1.3.6.1.5.5.7.3.1","serverAuth"),i("1.3.6.1.5.5.7.3.2","clientAuth"),i("1.3.6.1.5.5.7.3.3","codeSigning"),i("1.3.6.1.5.5.7.3.4","emailProtection"),i("1.3.6.1.5.5.7.3.8","timeStamping")},97450:(e,t,r)=>{var n=r(3832);if(r(8925),r(3068),r(33480),r(28991),r(66270),r(98960),r(26953),r(49563),r(69372),r(28095),r(97116),void 0===s)var s=n.jsbn.BigInteger;var i=n.asn1,o=n.pki=n.pki||{};e.exports=o.pbe=n.pbe=n.pbe||{};var a=o.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"iterations"}]};function u(e,t){return e.start().update(t).digest().getBytes()}function d(e){var t;if(e){if(!(t=o.oids[i.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return f(t)}function f(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}o.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var s,c,h,l=n.random.getBytesSync(r.saltSize),u=r.count,d=i.integerToDer(u);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var p,y,g;switch(r.algorithm){case"aes128":s=16,p=16,y=a["aes128-CBC"],g=n.aes.createEncryptionCipher;break;case"aes192":s=24,p=16,y=a["aes192-CBC"],g=n.aes.createEncryptionCipher;break;case"aes256":s=32,p=16,y=a["aes256-CBC"],g=n.aes.createEncryptionCipher;break;case"des":s=8,p=8,y=a.desCBC,g=n.des.createEncryptionCipher;break;default:throw(A=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,A}var b="hmacWith"+r.prfAlgorithm.toUpperCase(),m=f(b),w=n.pkcs5.pbkdf2(t,l,u,s,m),v=n.random.getBytesSync(p);(S=g(w)).start(v),S.update(i.toDer(e)),S.finish(),h=S.output.getBytes();var E=function(e,t,r,s){var a=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==s&&a.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids[s]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]));return a}(l,d,s,b);c=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.pkcs5PBES2).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.pkcs5PBKDF2).getBytes()),E]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(y).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,v)])])])}else{var A;if("3des"!==r.algorithm)throw(A=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,A;s=24;var S,_=new n.util.ByteBuffer(l);w=o.pbe.generatePkcs12Key(t,_,1,u,s),v=o.pbe.generatePkcs12Key(t,_,2,u,s);(S=n.des.createEncryptionCipher(w)).start(v),S.update(i.toDer(e)),S.finish(),h=S.output.getBytes(),c=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,l),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,d.getBytes())])])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[c,i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,h)])},o.decryptPrivateKeyInfo=function(e,t){var r=null,s={},a=[];if(!i.validate(e,c,s,a)){var h=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw h.errors=a,h}var l=i.derToOid(s.encryptionOid),u=o.pbe.getCipher(l,s.encryptionParams,t),d=n.util.createBuffer(s.encryptedData);return u.update(d),u.finish()&&(r=i.fromDer(u.output)),r},o.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},o.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return i.fromDer(t.body)},o.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var s=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));return s=o.encryptPrivateKeyInfo(s,t,r),o.encryptedPrivateKeyToPem(s)}var a,c,h,l;switch(r.algorithm){case"aes128":a="AES-128-CBC",h=16,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",h=24,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",h=32,c=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",h=24,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":a="DES-CBC",h=8,c=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var d=l(n.pbe.opensslDeriveBytes(t,c.substr(0,8),h));d.start(c),d.update(i.toDer(o.privateKeyToAsn1(e))),d.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:n.util.bytesToHex(c).toUpperCase()},body:d.output.getBytes()};return n.pem.encode(f)},o.decryptRsaPrivateKey=function(e,t){var r=null,s=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==s.type&&"PRIVATE KEY"!==s.type&&"RSA PRIVATE KEY"!==s.type)throw(h=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=h,h;if(s.procType&&"ENCRYPTED"===s.procType.type){var a,c;switch(s.dekInfo.algorithm){case"DES-CBC":a=8,c=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,c=n.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,c=n.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,c=n.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,c=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,c=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":a=8,c=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":a=16,c=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var h;throw(h=new Error('Could not decrypt private key; unsupported encryption algorithm "'+s.dekInfo.algorithm+'".')).algorithm=s.dekInfo.algorithm,h}var l=n.util.hexToBytes(s.dekInfo.parameters),u=c(n.pbe.opensslDeriveBytes(t,l.substr(0,8),a));if(u.start(l),u.update(n.util.createBuffer(s.body)),!u.finish())return r;r=u.output.getBytes()}else r=s.body;return null!==(r="ENCRYPTED PRIVATE KEY"===s.type?o.decryptPrivateKeyInfo(i.fromDer(r),t):i.fromDer(r))&&(r=o.privateKeyFromAsn1(r)),r},o.pbe.generatePkcs12Key=function(e,t,r,s,i,o){var a,c;if(null==o){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');o=n.md.sha1.create()}var h=o.digestLength,l=o.blockLength,u=new n.util.ByteBuffer,d=new n.util.ByteBuffer;if(null!=e){for(c=0;c<e.length;c++)d.putInt16(e.charCodeAt(c));d.putInt16(0)}var f=d.length(),p=t.length(),y=new n.util.ByteBuffer;y.fillWithByte(r,l);var g=l*Math.ceil(p/l),b=new n.util.ByteBuffer;for(c=0;c<g;c++)b.putByte(t.at(c%p));var m=l*Math.ceil(f/l),w=new n.util.ByteBuffer;for(c=0;c<m;c++)w.putByte(d.at(c%f));var v=b;v.putBuffer(w);for(var E=Math.ceil(i/h),A=1;A<=E;A++){var S=new n.util.ByteBuffer;S.putBytes(y.bytes()),S.putBytes(v.bytes());for(var _=0;_<s;_++)o.start(),o.update(S.getBytes()),S=o.digest();var C=new n.util.ByteBuffer;for(c=0;c<l;c++)C.putByte(S.at(c%h));var k=Math.ceil(p/l)+Math.ceil(f/l),I=new n.util.ByteBuffer;for(a=0;a<k;a++){var T=new n.util.ByteBuffer(v.getBytes(l)),x=511;for(c=C.length()-1;c>=0;c--)x>>=8,x+=C.at(c)+T.at(c),T.setAt(c,255&x);I.putBuffer(T)}v=I,u.putBuffer(S)}return u.truncate(u.length()-i),u},o.pbe.getCipher=function(e,t,r){switch(e){case o.oids.pkcs5PBES2:return o.pbe.getCipherForPBES2(e,t,r);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},o.pbe.getCipherForPBES2=function(e,t,r){var s,a={},c=[];if(!i.validate(t,h,a,c))throw(s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=c,s;if((e=i.derToOid(a.kdfOid))!==o.oids.pkcs5PBKDF2)throw(s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,s.supportedOids=["pkcs5PBKDF2"],s;if((e=i.derToOid(a.encOid))!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids.desCBC)throw(s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s;var l,u,f=a.kdfSalt,p=n.util.createBuffer(a.kdfIterationCount);switch(p=p.getInt(p.length()<<3),o.oids[e]){case"aes128-CBC":l=16,u=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=n.des.createDecryptionCipher;break;case"desCBC":l=8,u=n.des.createDecryptionCipher}var y=d(a.prfOid),g=n.pkcs5.pbkdf2(r,f,p,l,y),b=a.encIv,m=u(g);return m.start(b),m},o.pbe.getCipherForPKCS12PBE=function(e,t,r){var s={},a=[];if(!i.validate(t,l,s,a))throw(y=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=a,y;var c,h,u,f=n.util.createBuffer(s.salt),p=n.util.createBuffer(s.iterations);switch(p=p.getInt(p.length()<<3),e){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,h=8,u=n.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,h=8,u=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var y;throw(y=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,y}var g=d(s.prfOid),b=o.pbe.generatePkcs12Key(r,f,1,p,c,g);return g.start(),u(b,o.pbe.generatePkcs12Key(r,f,2,p,h,g))},o.pbe.opensslDeriveBytes=function(e,t,r,s){if(null==s){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');s=n.md.md5.create()}null===t&&(t="");for(var i=[u(s,e+t)],o=16,a=1;o<r;++a,o+=16)i.push(u(s,i[a-1]+e+t));return i.join("").substr(0,r)}},98960:(e,t,r)=>{var n=r(48764).Buffer,s=r(3832);r(36607),r(28991),r(97116);var i,o=s.pkcs5=s.pkcs5||{};s.util.isNodejs&&!s.options.usePureJavaScript&&(i=r(25819)),e.exports=s.pbkdf2=o.pbkdf2=function(e,t,r,o,a,c){if("function"==typeof a&&(c=a,a=null),s.util.isNodejs&&!s.options.usePureJavaScript&&i.pbkdf2&&(null===a||"object"!=typeof a)&&(i.pbkdf2Sync.length>4||!a||"sha1"===a))return"string"!=typeof a&&(a="sha1"),e=n.from(e,"binary"),t=n.from(t,"binary"),c?4===i.pbkdf2Sync.length?i.pbkdf2(e,t,r,o,(function(e,t){if(e)return c(e);c(null,t.toString("binary"))})):i.pbkdf2(e,t,r,o,a,(function(e,t){if(e)return c(e);c(null,t.toString("binary"))})):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,t,r,o).toString("binary"):i.pbkdf2Sync(e,t,r,o,a).toString("binary");if(null==a&&(a="sha1"),"string"==typeof a){if(!(a in s.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=s.md[a].create()}var h=a.digestLength;if(o>4294967295*h){var l=new Error("Derived key is too long.");if(c)return c(l);throw l}var u=Math.ceil(o/h),d=o-(u-1)*h,f=s.hmac.create();f.start(a,e);var p,y,g,b="";if(!c){for(var m=1;m<=u;++m){f.start(null,null),f.update(t),f.update(s.util.int32ToBytes(m)),p=g=f.digest().getBytes();for(var w=2;w<=r;++w)f.start(null,null),f.update(g),y=f.digest().getBytes(),p=s.util.xorBytes(p,y,h),g=y;b+=m<u?p:p.substr(0,d)}return b}m=1;function v(){if(m>u)return c(null,b);f.start(null,null),f.update(t),f.update(s.util.int32ToBytes(m)),p=g=f.digest().getBytes(),w=2,E()}function E(){if(w<=r)return f.start(null,null),f.update(g),y=f.digest().getBytes(),p=s.util.xorBytes(p,y,h),g=y,++w,s.util.setImmediate(E);b+=m<u?p:p.substr(0,d),++m,v()}v()}},26953:(e,t,r)=>{var n=r(3832);r(97116);var s=e.exports=n.pem=n.pem||{};function i(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},s=0;s<e.values.length;++s)r.push(e.values[s].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var i=0,o=-1;for(s=0;s<t.length;++s,++i)if(i>65&&-1!==o){var a=t[o];","===a?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+a+t.substr(o+1),i=s-o-1,o=-1,++s}else" "!==t[s]&&"\t"!==t[s]&&","!==t[s]||(o=s);return t}function o(e){return e.replace(/^\s+/,"")}s.encode=function(e,t){t=t||{};var r,s="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(s+=i(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(s+=i(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),s+=i(r)),e.headers)for(var o=0;o<e.headers.length;++o)s+=i(e.headers[o]);return e.procType&&(s+="\r\n"),s+=n.util.encode64(e.body,t.maxline||64)+"\r\n",s+="-----END "+e.type+"-----\r\n"},s.decode=function(e){for(var t,r=[],s=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=s.exec(e);){var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var h={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(h),t[2]){for(var l=t[2].split(a),u=0;t&&u<l.length;){for(var d=l[u].replace(/\s+$/,""),f=u+1;f<l.length;++f){var p=l[f];if(!/\s/.test(p[0]))break;d+=p,u=f}if(t=d.match(i)){for(var y={name:t[1],values:[]},g=t[2].split(","),b=0;b<g.length;++b)y.values.push(o(g[b]));if(h.procType)if(h.contentDomain||"Content-Domain"!==y.name)if(h.dekInfo||"DEK-Info"!==y.name)h.headers.push(y);else{if(0===y.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');h.dekInfo={algorithm:g[0],parameters:g[1]||null}}else h.contentDomain=g[0]||"";else{if("Proc-Type"!==y.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==y.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');h.procType={version:g[0],type:g[1]}}}++u}if("ENCRYPTED"===h.procType&&!h.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},18936:(e,t,r)=>{var n=r(3832);r(97116),r(49563),r(137);var s=e.exports=n.pkcs1=n.pkcs1||{};function i(e,t,r){r||(r=n.md.sha1.create());for(var s="",i=Math.ceil(t/r.digestLength),o=0;o<i;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(e+a),s+=r.digest().getBytes()}return s.substring(0,t)}s.encode_rsa_oaep=function(e,t,r){var s,o,a,c;"string"==typeof r?(s=r,o=arguments[3]||void 0,a=arguments[4]||void 0):r&&(s=r.label||void 0,o=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),a?a.start():a=n.md.sha1.create(),c||(c=a);var h=Math.ceil(e.n.bitLength()/8),l=h-2*a.digestLength-2;if(t.length>l)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=l,g;s||(s=""),a.update(s,"raw");for(var u=a.digest(),d="",f=l-t.length,p=0;p<f;p++)d+="\0";var y=u.getBytes()+d+""+t;if(o){if(o.length!==a.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=o.length,g.digestLength=a.digestLength,g}}else o=n.random.getBytes(a.digestLength);var b=i(o,h-a.digestLength-1,c),m=n.util.xorBytes(y,b,y.length),w=i(m,a.digestLength,c),v=n.util.xorBytes(o,w,o.length);return"\0"+v+m},s.decode_rsa_oaep=function(e,t,r){var s,o,a;"string"==typeof r?(s=r,o=arguments[3]||void 0):r&&(s=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(m=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,m.expectedLength=c,m;if(void 0===o?o=n.md.sha1.create():o.start(),a||(a=o),c<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");s||(s=""),o.update(s,"raw");for(var h=o.digest().getBytes(),l=t.charAt(0),u=t.substring(1,o.digestLength+1),d=t.substring(1+o.digestLength),f=i(d,o.digestLength,a),p=n.util.xorBytes(u,f,u.length),y=i(p,c-o.digestLength-1,a),g=n.util.xorBytes(d,y,d.length),b=g.substring(0,o.digestLength),m="\0"!==l,w=0;w<o.digestLength;++w)m|=h.charAt(w)!==b.charAt(w);for(var v=1,E=o.digestLength,A=o.digestLength;A<g.length;A++){var S=g.charCodeAt(A),_=1&S^1,C=v?65534:0;m|=S&C,E+=v&=_}if(m||1!==g.charCodeAt(E))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(E+1)}},79437:(e,t,r)=>{var n=r(3832);r(8925),r(3068),r(33480),r(66270),r(26953),r(95496),r(49563),r(97116),r(25414);var s=n.asn1,i=e.exports=n.pkcs7=n.pkcs7||{};function o(e){var t={},r=[];if(!s.validate(e,i.asn1.recipientInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=r,o}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:s.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function a(e){for(var t,r=[],i=0;i<e.length;++i)r.push((t=e[i],s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:t.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(t.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.encryptedContent.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function c(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.digestAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<e.unauthenticatedAttributes.length;++i){var o=e.unauthenticatedAttributes[i];r.values.push(h(o))}t.value.push(r)}return t}function h(e){var t;if(e.type===n.pki.oids.contentType)t=s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"==typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?s.utcTimeToDate(o):s.generalizedTimeToDate(o):new Date(a)}t=o>=r&&o<i?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(o)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(o))}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[t])])}function l(e,t,r){var i={};if(!s.validate(t,r,i,[])){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}if(s.derToOid(i.contentType)!==n.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(n.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;e.encryptedContent={algorithm:s.derToOid(i.encAlgorithm),parameter:n.util.createBuffer(i.encParameter.value),content:n.util.createBuffer(a)}}if(i.content){a="";if(n.util.isArray(i.content))for(c=0;c<i.content.length;++c){if(i.content[c].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;e.content=n.util.createBuffer(a)}return e.version=i.version.charCodeAt(0),e.rawCapture=i,i}function u(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids["aes128-CBC"]:case n.pki.oids["aes192-CBC"]:case n.pki.oids["aes256-CBC"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids["des-EDE3-CBC"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}i.messageFromPem=function(e){var t=n.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=s.fromDer(t.body);return i.messageFromAsn1(o)},i.messageToPem=function(e,t){var r={type:"PKCS7",body:s.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},i.messageFromAsn1=function(e){var t={},r=[];if(!s.validate(e,i.asn1.contentInfoValidator,t,r)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=r,o}var a,c=s.derToOid(t.contentType);switch(c){case n.pki.oids.envelopedData:a=i.createEnvelopedData();break;case n.pki.oids.encryptedData:a=i.createEncryptedData();break;case n.pki.oids.signedData:a=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},i.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(l(e,t,i.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,s=0;s<r.length;++s)e.certificates.push(n.pki.certificateFromAsn1(r[s]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var i=[],o=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,t)),i.length>0&&o.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,i)),o.value[0].value.push(s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.signerInfos)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,s=t.serialNumber;if(t.certificate){var i=t.certificate;"string"==typeof i&&(i=n.pki.certificateFromPem(i)),r=i.issuer.attributes,s=i.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof o&&(o=n.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var h=!1,l=!1,u=0;u<c.length;++u){var d=c[u];if(h||d.type!==n.pki.oids.contentType){if(l||d.type!==n.pki.oids.messageDigest);else if(l=!0,h)break}else if(h=!0,l)break}if(!h||!l)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:r,serialNumber:s,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(n.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof n.util.ByteBuffer?r=e.content.bytes():"string"==typeof e.content&&(r=n.util.encodeUtf8(e.content)),t.detached?e.detachedContent=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=s.derToOid(e.contentInfo.value[0].value),o=s.toDer(r);for(var a in o.getByte(),s.getBerValueLength(o),o=o.getBytes(),t)t[a].start().update(o);for(var l=new Date,u=0;u<e.signers.length;++u){var d=e.signers[u];if(0===d.authenticatedAttributes.length){if(i!==n.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[]),p=0;p<d.authenticatedAttributes.length;++p){var y=d.authenticatedAttributes[p];y.type===n.pki.oids.messageDigest?y.value=t[d.digestAlgorithm].digest():y.type===n.pki.oids.signingTime&&(y.value||(y.value=l)),f.value.push(h(y)),d.authenticatedAttributesAsn1.value.push(h(y))}o=s.toDer(f).getBytes(),d.md.start().update(o)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(c(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var i=e.signers[r];(o=i.digestAlgorithm)in t||(t[o]=n.md[n.pki.oids[o]].create()),0===i.authenticatedAttributes.length?i.md=t[o]:i.md=n.md[n.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},i.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){l(e,t,i.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),u(e)}}},i.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=l(e,t,i.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,a(e.recipients)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,(t=e.encryptedContent,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(n.pki.oids.data).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.algorithm).getBytes()),t.parameter?s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var s=e.recipients[n],i=s.issuer;if(s.serialNumber===t.serialNumber&&i.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(i[a].type!==r[a].type||i[a].value!==r[a].value){o=!1;break}if(o)return s}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var s=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(s);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}u(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var s,i,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids["aes128-CBC"]:s=16,i=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes192-CBC"]:s=24,i=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["aes256-CBC"]:s=32,i=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids["des-EDE3-CBC"]:s=24,i=8,o=n.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(s));else if(t.length()!=s)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+s+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(i));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var h=e.recipients[c];if(void 0===h.encryptedContent.content){if(h.encryptedContent.algorithm!==n.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+h.encryptedContent.algorithm);h.encryptedContent.content=h.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},95496:(e,t,r)=>{var n=r(3832);r(3068),r(97116);var s=n.asn1,i=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=i;var o={name:"ContentInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=o;var a={name:"EncryptedContentInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},i.encryptedDataValidator={name:"EncryptedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};i.signedDataValidator={name:"SignedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},29654:(e,t,r)=>{var n=r(3832);r(97116),r(15764),r(49563),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],i=new r(null);i.fromInt(30);var o=function(e,t){return e|t};t.generateProbablePrime=function(e,t,s){"function"==typeof t&&(s=t,t={});var i=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof i&&(i={name:i}),i.options=i.options||{};var o=t.prng||n.random,c={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===i.name)return function(e,t,s,i){if("workers"in s)return function(e,t,s,i){if("undefined"==typeof Worker)return a(e,t,s,i);var o=h(e,t),c=s.workers,l=s.workLoad||100,u=30*l/8,d=s.workerScript||"forge/prime.worker.js";if(-1===c)return n.util.estimateCores((function(e,t){e&&(t=2),c=t-1,f()}));function f(){c=Math.max(1,c);for(var n=[],s=0;s<c;++s)n[s]=new Worker(d);for(s=0;s<c;++s)n[s].addEventListener("message",f);var a=!1;function f(s){if(!a){0;var c=s.data;if(c.found){for(var d=0;d<n.length;++d)n[d].terminate();return a=!0,i(null,new r(c.prime,16))}o.bitLength()>e&&(o=h(e,t));var f=o.toString(16);s.target.postMessage({hex:f,workLoad:l}),o.dAddOffset(u,0)}}}f()}(e,t,s,i);return a(e,t,s,i)}(e,c,i.options,s);throw new Error("Invalid prime generation algorithm: "+i.name)}}function a(e,t,r,n){var s=h(e,t),i=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(s.bitLength());"millerRabinTests"in r&&(i=r.millerRabinTests);var o=10;"maxBlockTime"in r&&(o=r.maxBlockTime),c(s,e,t,0,i,o,n)}function c(e,t,r,i,o,a,l){var u=+new Date;do{if(e.bitLength()>t&&(e=h(t,r)),e.isProbablePrime(o))return l(null,e);e.dAddOffset(s[i++%8],0)}while(a<0||+new Date-u<a);n.util.setImmediate((function(){c(e,t,r,i,o,a,l)}))}function h(e,t){var n=new r(e,t),s=e-1;return n.testBit(s)||n.bitwiseTo(r.ONE.shiftLeft(s),o,n),n.dAddOffset(31-n.mod(i).byteValue(),0),n}}()},74933:(e,t,r)=>{var n=r(34155),s=r(3832);r(97116);var i=null;!s.util.isNodejs||s.options.usePureJavaScript||n.versions["node-webkit"]||(i=r(25819)),(e.exports=s.prng=s.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),o=0;o<32;++o)n[o]=r.create();function a(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r==0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var s=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(s),t.generated=0}function h(e){var t=null,r=s.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var i=s.util.createBuffer();if(t)for(;i.length()<e;){var o=Math.max(1,Math.min(e-i.length(),65536)/4),a=new Uint32Array(Math.floor(o));try{t(a);for(var c=0;c<a.length;++c)i.putInt32(a[c])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(i.length()<e)for(var h,l,u,d=Math.floor(65536*Math.random());i.length()<e;){l=16807*(65535&d),l+=(32767&(h=16807*(d>>16)))<<16,d=4294967295&(l=(2147483647&(l+=h>>15))+(l>>31));for(c=0;c<3;++c)u=d>>>(c<<3),u^=Math.floor(256*Math.random()),i.putByte(255&u)}return i.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,i=t.plugin.increment,o=t.plugin.formatKey,a=t.plugin.formatSeed,h=s.util.createBuffer();t.key=null,function l(u){if(u)return r(u);if(h.length()>=e)return r(null,h.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return s.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),c(),e()}))}(l)}));var d=n(t.key,t.seed);t.generated+=d.length,h.putBytes(d),t.key=o(n(t.key,i(t.seed))),t.seed=a(n(t.key,t.seed)),s.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,i=t.plugin.formatKey,o=t.plugin.formatSeed;t.key=null;for(var c=s.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&a();var h=r(t.key,t.seed);t.generated+=h.length,c.putBytes(h),t.key=i(r(t.key,n(t.seed))),t.seed=o(r(t.key,t.seed))}return c.getBytes(e)},i?(t.seedFile=function(e,t){i.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return i.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,h(e))}catch(e){t(e)}},t.seedFileSync=h),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",s=0;s<r;s+=8)n+=String.fromCharCode(e>>s&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}},96007:(e,t,r)=>{var n=r(3832);r(49563),r(97116),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,s=e.mgf,i=r.digestLength,o=e.salt||null;if("string"==typeof o&&(o=n.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||n.random,c={encode:function(e,c){var h,l,u=c-1,d=Math.ceil(u/8),f=e.digest().getBytes();if(d<i+t+2)throw new Error("Message is too long to encrypt.");l=null===o?a.getBytesSync(t):o.bytes();var p=new n.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(f),p.putBytes(l),r.start(),r.update(p.getBytes());var y=r.digest().getBytes(),g=new n.util.ByteBuffer;g.fillWithByte(0,d-t-i-2),g.putByte(1),g.putBytes(l);var b=g.getBytes(),m=d-i-1,w=s.generate(y,m),v="";for(h=0;h<m;h++)v+=String.fromCharCode(b.charCodeAt(h)^w.charCodeAt(h));var E=65280>>8*d-u&255;return(v=String.fromCharCode(v.charCodeAt(0)&~E)+v.substr(1))+y+String.fromCharCode(188)},verify:function(e,o,a){var c,h=a-1,l=Math.ceil(h/8);if(o=o.substr(-l),l<i+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(l-1))throw new Error("Encoded message does not end in 0xBC.");var u=l-i-1,d=o.substr(0,u),f=o.substr(u,i),p=65280>>8*l-h&255;if(0!=(d.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var y=s.generate(f,u),g="";for(c=0;c<u;c++)g+=String.fromCharCode(d.charCodeAt(c)^y.charCodeAt(c));g=String.fromCharCode(g.charCodeAt(0)&~p)+g.substr(1);var b=l-i-t-2;for(c=0;c<b;c++)if(0!==g.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(b))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var m=g.substr(-t),w=new n.util.ByteBuffer;return w.fillWithByte(0,8),w.putBytes(e),w.putBytes(m),r.start(),r.update(w.getBytes()),f===r.digest().getBytes()}};return c}},49563:(e,t,r)=>{var n=r(3832);r(8925),r(41668),r(74933),r(97116),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},s=new Array(4),i=n.util.createBuffer();function o(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,s,!1),i.putInt32(s[0]),i.putInt32(s[1]),i.putInt32(s[2]),i.putInt32(s[3]),i.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var a=o(),c=null,h=n.util.globalScope,l=h.crypto||h.msCrypto;if(l&&l.getRandomValues&&(c=function(e){return l.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!c){if("undefined"==typeof window||window.document,a.collectInt(+new Date,32),"undefined"!=typeof navigator){var u="";for(var d in navigator)try{"string"==typeof navigator[d]&&(u+=navigator[d])}catch(e){}a.collect(u),u=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(n.random)for(var d in a)n.random[d]=a[d];else n.random=a;n.random.createInstance=o,e.exports=n.random}("undefined"!=typeof jQuery?jQuery:null)},69372:(e,t,r)=>{var n=r(3832);r(97116);var s=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],i=[1,2,3,5],o=function(e,t){return e<<t&65535|(65535&e)>>16-t},a=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"==typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,i=e,o=e.length(),a=t,c=Math.ceil(a/8),h=255>>(7&a);for(r=o;r<128;r++)i.putByte(s[i.at(r-1)+i.at(r-o)&255]);for(i.setAt(128-c,s[i.at(128-c)&h]),r=127-c;r>=0;r--)i.setAt(r,s[i.at(r+1)^i.at(r+c)]);return i};var c=function(e,t,r){var s,c,h,l,u=!1,d=null,f=null,p=null,y=[];for(e=n.rc2.expandKey(e,t),h=0;h<64;h++)y.push(e.getInt16Le());r?(s=function(e){for(h=0;h<4;h++)e[h]+=y[l]+(e[(h+3)%4]&e[(h+2)%4])+(~e[(h+3)%4]&e[(h+1)%4]),e[h]=o(e[h],i[h]),l++},c=function(e){for(h=0;h<4;h++)e[h]+=y[63&e[(h+3)%4]]}):(s=function(e){for(h=3;h>=0;h--)e[h]=a(e[h],i[h]),e[h]-=y[l]+(e[(h+3)%4]&e[(h+2)%4])+(~e[(h+3)%4]&e[(h+1)%4]),l--},c=function(e){for(h=3;h>=0;h--)e[h]-=y[63&e[(h+3)%4]]});var g=function(e){var t=[];for(h=0;h<4;h++){var n=d.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}l=r?0:63;for(var s=0;s<e.length;s++)for(var i=0;i<e[s][0];i++)e[s][1](t);for(h=0;h<4;h++)null!==p&&(r?p.putInt16Le(t[h]):t[h]^=p.getInt16Le()),f.putInt16Le(t[h])},b=null;return b={start:function(e,t){e&&"string"==typeof e&&(e=n.util.createBuffer(e)),u=!1,d=n.util.createBuffer(),f=t||new n.util.createBuffer,p=e,b.output=f},update:function(e){for(u||d.putBuffer(e);d.length()>=8;)g([[5,s],[1,c],[6,s],[1,c],[5,s]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,d,!r);else{var n=8===d.length()?8:8-d.length();d.fillWithByte(n,n)}if(t&&(u=!0,b.update()),!r&&(t=0===d.length()))if(e)t=e(8,f,!r);else{var s=f.length(),i=f.at(s-1);i>s?t=!1:f.truncate(i)}return t}}};n.rc2.startEncrypting=function(e,t,r){var s=n.rc2.createEncryptionCipher(e,128);return s.start(t,r),s},n.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var s=n.rc2.createDecryptionCipher(e,128);return s.start(t,r),s},n.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},28095:(e,t,r)=>{var n=r(3832);if(r(3068),r(15764),r(66270),r(18936),r(29654),r(49563),r(97116),void 0===s)var s=n.jsbn.BigInteger;var i=n.util.isNodejs?r(25819):null,o=n.asn1,a=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var c=n.pki,h=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},u={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},d={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},f=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},y=function(e){var t;if(!(e.algorithm in c.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=c.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),s=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);i.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),i.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var a=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return s.value.push(i),s.value.push(a),o.toDer(s).getBytes()},g=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var i;t.dP||(t.dP=t.d.mod(t.p.subtract(s.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(s.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{i=new s(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(i.compareTo(t.n)>=0||!i.gcd(t.n).equals(s.ONE));for(var o=(e=e.multiply(i.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);o.compareTo(a)<0;)o=o.add(t.p);var c=o.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(i.modInverse(t.n)).mod(t.n)};function b(e,t,r){var s=n.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=i-11,o}s.putByte(0),s.putByte(r);var a,c=i-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var h=0;h<c;++h)s.putByte(a)}else for(;c>0;){var l=0,u=n.random.getBytes(c);for(h=0;h<c;++h)0===(a=u.charCodeAt(h))?++l:s.putByte(a);c=l}return s.putByte(0),s.putBytes(e),s}function m(e,t,r,s){var i=Math.ceil(t.n.bitLength()/8),o=n.util.createBuffer(e),a=o.getByte(),c=o.getByte();if(0!==a||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&void 0===s)throw new Error("Encryption block is invalid.");var h=0;if(0===c){h=i-3-s;for(var l=0;l<h;++l)if(0!==o.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(h=0;o.length()>1;){if(255!==o.getByte()){--o.read;break}++h}else if(2===c)for(h=0;o.length()>1;){if(0===o.getByte()){--o.read;break}++h}if(0!==o.getByte()||h!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function w(e,t,r){"function"==typeof t&&(r=t,t={});var i={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function o(){a(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?h(t,e.q):void a(e.qBits,h))}))}function a(e,t){n.prime.generateProbablePrime(e,i,t)}function h(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var i=e.p;e.p=e.q,e.q=i}if(0!==e.p.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.p=null,void o();if(0!==e.q.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.q=null,void a(e.qBits,h);if(e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(s.ONE))return e.p=e.q=null,void o();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,h);var l=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(i.prng=t.prng),o()}function v(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function E(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function A(e){return n.util.isNodejs&&"function"==typeof i[e]}function S(e){return void 0!==a.globalScope&&"object"==typeof a.globalScope.crypto&&"object"==typeof a.globalScope.crypto.subtle&&"function"==typeof a.globalScope.crypto.subtle[e]}function _(e){return void 0!==a.globalScope&&"object"==typeof a.globalScope.msCrypto&&"object"==typeof a.globalScope.msCrypto.subtle&&"function"==typeof a.globalScope.msCrypto.subtle[e]}function C(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r}c.rsa.encrypt=function(e,t,r){var i,o=r,a=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(o=2===r,i=b(e,t,r)):(i=n.util.createBuffer()).putBytes(e);for(var c=new s(i.toHex(),16),h=g(c,t,o).toString(16),l=n.util.createBuffer(),u=a-Math.ceil(h.length/2);u>0;)l.putByte(0),--u;return l.putBytes(n.util.hexToBytes(h)),l.getBytes()},c.rsa.decrypt=function(e,t,r,i){var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=o,a}var c=new s(n.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var h=g(c,t,r).toString(16),l=n.util.createBuffer(),u=o-Math.ceil(h.length/2);u>0;)l.putByte(0),--u;return l.putBytes(n.util.hexToBytes(h)),!1!==i?m(l.getBytes(),t,r):l.getBytes()},c.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var i,o=(r=r||{}).prng||n.random,a={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(i={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new s(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(i.eInt),i},c.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new s(null);r.fromInt(30);for(var n,i=0,o=function(e,t){return e|t},a=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var u=null===e.p?e.pBits:e.qBits,d=u-1;0===e.pqState?(e.num=new s(u,e.rng),e.num.testBit(d)||e.num.bitwiseTo(s.ONE.shiftLeft(d),o,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),i=0,++e.pqState):1===e.pqState?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(E(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(h[i++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(s.ONE).gcd(e.e).compareTo(s.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(s.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-a,a=n}return null!==e.keys},c.rsa.generateKeyPair=function(e,t,r,s){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(s=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(s=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,s=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(s=r,r=void 0):(s=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(s){if(A("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return s(e);s(null,{privateKey:c.privateKeyFromPem(r),publicKey:c.publicKeyFromPem(t)})}));if(S("generateKey")&&S("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:C(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return a.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){s(e)})).then((function(e){if(e){var t=c.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(e)));s(null,{privateKey:t,publicKey:c.setRsaPublicKey(t.n,t.e)})}}));if(_("generateKey")&&_("exportKey")){var h=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:C(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return h.oncomplete=function(e){var t=e.target.result,r=a.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=c.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(t)));s(null,{privateKey:r,publicKey:c.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){s(e)}},void(h.onerror=function(e){s(e)})}}else if(A("generateKeyPairSync")){var l=i.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(l.privateKey),publicKey:c.publicKeyFromPem(l.publicKey)}}var u=c.rsa.createKeyPairGenerationState(e,t,r);if(!s)return c.rsa.stepKeyPairGenerationState(u,0),u.keys;w(u,r,s)},c.setRsaPublicKey=c.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,s){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return b(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,s)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var i=t.encode(e,r,!0);return c.rsa.encrypt(i,r,!0)},verify:function(e,t,s,i){"string"==typeof s?s=s.toUpperCase():void 0===s&&(s="RSASSA-PKCS1-V1_5"),void 0===i&&(i={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in i||(i._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===s?s={verify:function(e,t){t=m(t,r,!0);var s=o.fromDer(t,{parseAllBytes:i._parseAllDigestBytes}),a={},c=[];if(!o.validate(s,p,a,c))throw(h=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=c,h;var h,l=o.derToOid(a.algorithmIdentifier);if(l!==n.oids.md2&&l!==n.oids.md5&&l!==n.oids.sha1&&l!==n.oids.sha224&&l!==n.oids.sha256&&l!==n.oids.sha384&&l!==n.oids.sha512&&l!==n.oids["sha512-224"]&&l!==n.oids["sha512-256"])throw(h=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=l,h;if((l===n.oids.md2||l===n.oids.md5)&&!("parameters"in a))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===a.digest}}:"NONE"!==s&&"NULL"!==s&&null!==s||(s={verify:function(e,t){return e===(t=m(t,r,!0))}});var a=c.rsa.decrypt(t,r,!0,!1);return s.verify(e,a,r.n.bitLength())}};return r},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(e,t,r,s,i,o,a,h){var l={n:e,e:t,d:r,p:s,q:i,dP:o,dQ:a,qInv:h,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var s=c.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:m};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(s,l,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:y},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return c.rsa.encrypt(n,l,r)}};return l},c.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},c.privateKeyFromAsn1=function(e){var t,r,i,a,h,d,f,p,y={},g=[];if(o.validate(e,l,y,g)&&(e=o.fromDer(n.util.createBuffer(y.privateKey))),y={},g=[],!o.validate(e,u,y,g)){var b=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw b.errors=g,b}return t=n.util.createBuffer(y.privateKeyModulus).toHex(),r=n.util.createBuffer(y.privateKeyPublicExponent).toHex(),i=n.util.createBuffer(y.privateKeyPrivateExponent).toHex(),a=n.util.createBuffer(y.privateKeyPrime1).toHex(),h=n.util.createBuffer(y.privateKeyPrime2).toHex(),d=n.util.createBuffer(y.privateKeyExponent1).toHex(),f=n.util.createBuffer(y.privateKeyExponent2).toHex(),p=n.util.createBuffer(y.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new s(t,16),new s(r,16),new s(i,16),new s(a,16),new s(h,16),new s(d,16),new s(f,16),new s(p,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.qInv))])},c.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,f,t,r)){var i,a=o.derToOid(t.publicKeyOid);if(a!==c.oids.rsaEncryption)throw(i=new Error("Cannot read public key. Unknown OID.")).oid=a,i;e=t.rsaPublicKey}if(r=[],!o.validate(e,d,t,r))throw(i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,i;var h=n.util.createBuffer(t.publicKeyModulus).toHex(),l=n.util.createBuffer(t.publicKeyExponent).toHex();return c.setRsaPublicKey(new s(h,16),new s(l,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(e)])])},c.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.e))])}},137:(e,t,r)=>{var n=r(3832);r(28991),r(97116);var s=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=s,s.create=function(){o||(i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),o=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),s={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var r=s.messageLengthSize/4,i=0;i<r;++i)s.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},s}};return s.start(),s.update=function(i,o){"utf8"===o&&(i=n.util.encodeUtf8(i));var c=i.length;s.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var h=s.fullMessageLength.length-1;h>=0;--h)s.fullMessageLength[h]+=c[1],c[1]=c[0]+(s.fullMessageLength[h]/4294967296>>>0),s.fullMessageLength[h]=s.fullMessageLength[h]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(i),a(e,r,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var c,h=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize&s.blockLength-1;o.putBytes(i.substr(0,s.blockLength-h));for(var l=8*s.fullMessageLength[0],u=0;u<s.fullMessageLength.length-1;++u)l+=(c=8*s.fullMessageLength[u+1])/4294967296>>>0,o.putInt32(l>>>0),l=c>>>0;o.putInt32(l);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};a(d,r,o);var f=n.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f},s};var i=null,o=!1;function a(e,t,r){for(var n,s,i,o,a,c,h,l=r.length();l>=64;){for(s=e.h0,i=e.h1,o=e.h2,a=e.h3,c=e.h4,h=0;h<16;++h)n=r.getInt32(),t[h]=n,n=(s<<5|s>>>27)+(a^i&(o^a))+c+1518500249+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;h<20;++h)n=(n=t[h-3]^t[h-8]^t[h-14]^t[h-16])<<1|n>>>31,t[h]=n,n=(s<<5|s>>>27)+(a^i&(o^a))+c+1518500249+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;h<32;++h)n=(n=t[h-3]^t[h-8]^t[h-14]^t[h-16])<<1|n>>>31,t[h]=n,n=(s<<5|s>>>27)+(i^o^a)+c+1859775393+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;h<40;++h)n=(n=t[h-6]^t[h-16]^t[h-28]^t[h-32])<<2|n>>>30,t[h]=n,n=(s<<5|s>>>27)+(i^o^a)+c+1859775393+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;h<60;++h)n=(n=t[h-6]^t[h-16]^t[h-28]^t[h-32])<<2|n>>>30,t[h]=n,n=(s<<5|s>>>27)+(i&o|a&(i^o))+c+2400959708+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;h<80;++h)n=(n=t[h-6]^t[h-16]^t[h-28]^t[h-32])<<2|n>>>30,t[h]=n,n=(s<<5|s>>>27)+(i^o^a)+c+3395469782+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;e.h0=e.h0+s|0,e.h1=e.h1+i|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,l-=64}}},41668:(e,t,r)=>{var n=r(3832);r(28991),r(97116);var s=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=s,s.create=function(){o||(i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),s={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var r=s.messageLengthSize/4,i=0;i<r;++i)s.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},s}};return s.start(),s.update=function(i,o){"utf8"===o&&(i=n.util.encodeUtf8(i));var a=i.length;s.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var h=s.fullMessageLength.length-1;h>=0;--h)s.fullMessageLength[h]+=a[1],a[1]=a[0]+(s.fullMessageLength[h]/4294967296>>>0),s.fullMessageLength[h]=s.fullMessageLength[h]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var a,h=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize&s.blockLength-1;o.putBytes(i.substr(0,s.blockLength-h));for(var l=8*s.fullMessageLength[0],u=0;u<s.fullMessageLength.length-1;++u)l+=(a=8*s.fullMessageLength[u+1])/4294967296>>>0,o.putInt32(l>>>0),l=a>>>0;o.putInt32(l);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(d,r,o);var f=n.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f.putInt32(d.h5),f.putInt32(d.h6),f.putInt32(d.h7),f},s};var i=null,o=!1,a=null;function c(e,t,r){for(var n,s,i,o,c,h,l,u,d,f,p,y,g,b=r.length();b>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,s=((s=t[c-15])>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,t[c]=n+t[c-7]+s+t[c-16]|0;for(h=e.h0,l=e.h1,u=e.h2,d=e.h3,f=e.h4,p=e.h5,y=e.h6,g=e.h7,c=0;c<64;++c)i=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),o=h&l|u&(h^l),n=g+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(y^f&(p^y))+a[c]+t[c],g=y,y=p,p=f,f=d+n>>>0,d=u,u=l,l=h,h=n+(s=i+o)>>>0;e.h0=e.h0+h|0,e.h1=e.h1+l|0,e.h2=e.h2+u|0,e.h3=e.h3+d|0,e.h4=e.h4+f|0,e.h5=e.h5+p|0,e.h6=e.h6+y|0,e.h7=e.h7+g|0,b-=64}}},63219:(e,t,r)=>{var n=r(3832);r(28991),r(97116);var s=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=s;var i=n.sha384=n.sha512.sha384=n.sha512.sha384||{};i.create=function(){return s.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=i,n.sha512.sha256=n.sha512.sha256||{create:function(){return s.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return s.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,s.create=function(e){if(a||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(h={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],h["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],h["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],h["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0),void 0===e&&(e="SHA-512"),!(e in h))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=h[e],r=null,s=n.util.createBuffer(),i=new Array(80),u=0;u<80;++u)i[u]=new Array(2);var d=64;switch(e){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,i=0;i<e;++i)f.fullMessageLength.push(0);s=n.util.createBuffer(),r=new Array(t.length);for(i=0;i<t.length;++i)r[i]=t[i].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var o=e.length;f.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=o[1],o[1]=o[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return s.putBytes(e),l(r,i,s),(s.read>2048||0===s.length())&&s.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(s.bytes());var a,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(o.substr(0,f.blockLength-c));for(var h=8*f.fullMessageLength[0],u=0;u<f.fullMessageLength.length-1;++u)h+=(a=8*f.fullMessageLength[u+1])/4294967296>>>0,t.putInt32(h>>>0),h=a>>>0;t.putInt32(h);var d=new Array(r.length);for(u=0;u<r.length;++u)d[u]=r[u].slice(0);l(d,i,t);var p,y=n.util.createBuffer();p="SHA-512"===e?d.length:"SHA-384"===e?d.length-2:d.length-4;for(u=0;u<p;++u)y.putInt32(d[u][0]),u===p-1&&"SHA-512/224"===e||y.putInt32(d[u][1]);return y},f};var o=null,a=!1,c=null,h=null;function l(e,t,r){for(var n,s,i,o,a,h,l,u,d,f,p,y,g,b,m,w,v,E,A,S,_,C,k,I,T,x,R,P,D,O,N,L,U,B=r.length();B>=128;){for(R=0;R<16;++R)t[R][0]=r.getInt32()>>>0,t[R][1]=r.getInt32()>>>0;for(;R<80;++R)n=(((P=(O=t[R-2])[0])>>>19|(D=O[1])<<13)^(D>>>29|P<<3)^P>>>6)>>>0,s=((P<<13|D>>>19)^(D<<3|P>>>29)^(P<<26|D>>>6))>>>0,i=(((P=(L=t[R-15])[0])>>>1|(D=L[1])<<31)^(P>>>8|D<<24)^P>>>7)>>>0,o=((P<<31|D>>>1)^(P<<24|D>>>8)^(P<<25|D>>>7))>>>0,N=t[R-7],U=t[R-16],D=s+N[1]+o+U[1],t[R][0]=n+N[0]+i+U[0]+(D/4294967296>>>0)>>>0,t[R][1]=D>>>0;for(p=e[0][0],y=e[0][1],g=e[1][0],b=e[1][1],m=e[2][0],w=e[2][1],v=e[3][0],E=e[3][1],A=e[4][0],S=e[4][1],_=e[5][0],C=e[5][1],k=e[6][0],I=e[6][1],T=e[7][0],x=e[7][1],R=0;R<80;++R)l=((A>>>14|S<<18)^(A>>>18|S<<14)^(S>>>9|A<<23))>>>0,u=(k^A&(_^k))>>>0,a=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,h=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,d=(p&g|m&(p^g))>>>0,f=(y&b|w&(y^b))>>>0,D=x+(((A<<18|S>>>14)^(A<<14|S>>>18)^(S<<23|A>>>9))>>>0)+((I^S&(C^I))>>>0)+c[R][1]+t[R][1],n=T+l+u+c[R][0]+t[R][0]+(D/4294967296>>>0)>>>0,s=D>>>0,i=a+d+((D=h+f)/4294967296>>>0)>>>0,o=D>>>0,T=k,x=I,k=_,I=C,_=A,C=S,A=v+n+((D=E+s)/4294967296>>>0)>>>0,S=D>>>0,v=m,E=w,m=g,w=b,g=p,b=y,p=n+i+((D=s+o)/4294967296>>>0)>>>0,y=D>>>0;D=e[0][1]+y,e[0][0]=e[0][0]+p+(D/4294967296>>>0)>>>0,e[0][1]=D>>>0,D=e[1][1]+b,e[1][0]=e[1][0]+g+(D/4294967296>>>0)>>>0,e[1][1]=D>>>0,D=e[2][1]+w,e[2][0]=e[2][0]+m+(D/4294967296>>>0)>>>0,e[2][1]=D>>>0,D=e[3][1]+E,e[3][0]=e[3][0]+v+(D/4294967296>>>0)>>>0,e[3][1]=D>>>0,D=e[4][1]+S,e[4][0]=e[4][0]+A+(D/4294967296>>>0)>>>0,e[4][1]=D>>>0,D=e[5][1]+C,e[5][0]=e[5][0]+_+(D/4294967296>>>0)>>>0,e[5][1]=D>>>0,D=e[6][1]+I,e[6][0]=e[6][0]+k+(D/4294967296>>>0)>>>0,e[6][1]=D>>>0,D=e[7][1]+x,e[7][0]=e[7][0]+T+(D/4294967296>>>0)>>>0,e[7][1]=D>>>0,B-=128}}},97116:(e,t,r)=>{var n=r(34155),s=r(48764).Buffer,i=r(3832),o=r(78807),a=e.exports=i.util=i.util||{};function c(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function h(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(a.isArrayBuffer(e)||a.isArrayBufferView(e))if(void 0!==s&&e instanceof s)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof h||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==n&&n.nextTick&&!n.browser)return a.nextTick=n.nextTick,void("function"==typeof setImmediate?a.setImmediate=setImmediate:a.setImmediate=a.nextTick);if("function"==typeof setImmediate)return a.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(a.nextTick=function(e){return setImmediate(e)});if(a.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",t=[];a.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach((function(e){e()}))}}),!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),s=!0,i=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(i,{attributes:!0});var o=a.setImmediate;a.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),o(e)):(t.push(e),1===t.length&&i.setAttribute("a",s=!s))}}a.nextTick=a.setImmediate}(),a.isNodejs=void 0!==n&&n.versions&&n.versions.node,a.globalScope=a.isNodejs||"undefined"==typeof self?window:self,a.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},a.isArrayBufferView=function(e){return e&&a.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},a.ByteBuffer=h,a.ByteStringBuffer=h;a.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},a.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},a.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},a.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},a.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(a.encodeUtf8(e))},a.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},a.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},a.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},a.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},a.ByteStringBuffer.prototype.putInt=function(e,t){c(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},a.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},a.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},a.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},a.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},a.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},a.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},a.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},a.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},a.ByteStringBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},a.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},a.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},a.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},a.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},a.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},a.ByteStringBuffer.prototype.copy=function(){var e=a.createBuffer(this.data);return e.read=this.read,e},a.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},a.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},a.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},a.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())},a.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=a.isArrayBuffer(e),n=a.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},a.DataBuffer.prototype.length=function(){return this.write-this.read},a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},a.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},a.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},a.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},a.DataBuffer.prototype.putBytes=function(e,t){if(a.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(a.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof a.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&a.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof a.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var s;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.hex.decode(e,s,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),s=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.base64.decode(e,s,this.write),this;if("utf8"===t&&(e=a.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.raw.decode(s),this;if("utf16"===t)return this.accommodate(2*e.length),s=new Uint16Array(this.data.buffer,this.write),this.write+=a.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},a.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},a.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},a.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},a.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},a.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},a.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},a.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},a.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},a.DataBuffer.prototype.putInt=function(e,t){c(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},a.DataBuffer.prototype.putSignedInt=function(e,t){return c(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},a.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},a.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},a.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},a.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},a.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},a.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},a.DataBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},a.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},a.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},a.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},a.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},a.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)},a.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},a.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},a.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},a.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},a.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return a.binary.raw.encode(t);if("hex"===e)return a.binary.hex.encode(t);if("base64"===e)return a.binary.base64.encode(t);if("utf8"===e)return a.text.utf8.decode(t);if("utf16"===e)return a.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},a.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=a.encodeUtf8(e)),new a.ByteBuffer(e)},a.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},a.xorBytes=function(e,t,r){for(var n="",s="",i="",o=0,a=0;r>0;--r,++o)s=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(n+=i,i="",a=0),i+=String.fromCharCode(s),++a;return n+=i},a.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},a.bytesToHex=function(e){return a.createBuffer(e).toHex()},a.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(e,t){for(var r,n,s,i="",o="",a=0;a<e.length;)r=e.charCodeAt(a++),n=e.charCodeAt(a++),s=e.charCodeAt(a++),i+=l.charAt(r>>2),i+=l.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=l.charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":l.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},a.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,s,i="",o=0;o<e.length;)t=u[e.charCodeAt(o++)-43],r=u[e.charCodeAt(o++)-43],n=u[e.charCodeAt(o++)-43],s=u[e.charCodeAt(o++)-43],i+=String.fromCharCode(t<<2|r>>4),64!==n&&(i+=String.fromCharCode((15&r)<<4|n>>2),64!==s&&(i+=String.fromCharCode((3&n)<<6|s)));return i},a.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},a.decodeUtf8=function(e){return decodeURIComponent(escape(e))},a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:o.encode,decode:o.decode}},a.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},a.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var s=r=r||0,i=0;i<e.length;++i)n[s++]=e.charCodeAt(i);return t?s-r:n},a.binary.hex.encode=a.bytesToHex,a.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var s=0,i=r=r||0;for(1&e.length&&(s=1,n[i++]=parseInt(e[0],16));s<e.length;s+=2)n[i++]=parseInt(e.substr(s,2),16);return t?i-r:n},a.binary.base64.encode=function(e,t){for(var r,n,s,i="",o="",a=0;a<e.byteLength;)r=e[a++],n=e[a++],s=e[a++],i+=l.charAt(r>>2),i+=l.charAt((3&r)<<4|n>>4),isNaN(n)?i+="==":(i+=l.charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":l.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i},a.binary.base64.decode=function(e,t,r){var n,s,i,o,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,h=r=r||0;c<e.length;)n=u[e.charCodeAt(c++)-43],s=u[e.charCodeAt(c++)-43],i=u[e.charCodeAt(c++)-43],o=u[e.charCodeAt(c++)-43],a[h++]=n<<2|s>>4,64!==i&&(a[h++]=(15&s)<<4|i>>2,64!==o&&(a[h++]=(3&i)<<6|o));return t?h-r:a.subarray(0,h)},a.binary.base58.encode=function(e,t){return a.binary.baseN.encode(e,d,t)},a.binary.base58.decode=function(e,t){return a.binary.baseN.decode(e,d,t)},a.text={utf8:{},utf16:{}},a.text.utf8.encode=function(e,t,r){e=a.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var s=r=r||0,i=0;i<e.length;++i)n[s++]=e.charCodeAt(i);return t?s-r:n},a.text.utf8.decode=function(e){return a.decodeUtf8(String.fromCharCode.apply(null,e))},a.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var s=new Uint16Array(n.buffer),i=r=r||0,o=r,a=0;a<e.length;++a)s[o++]=e.charCodeAt(a),i+=2;return t?i-r:n},a.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},a.deflate=function(e,t,r){if(t=a.decode64(e.deflate(a.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},a.inflate=function(e,t,r){var n=e.inflate(a.encode64(t)).rval;return null===n?null:a.decode64(n)};var f=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=a.encode64(JSON.stringify(r)),n=e.setItem(t,r)),void 0!==n&&!0!==n.rval){var s=new Error(n.error.message);throw s.id=n.error.id,s.name=n.error.name,s}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(a.decode64(r))),r},y=function(e,t,r,n){var s=p(e,t);null===s&&(s={}),s[r]=n,f(e,t,s)},g=function(e,t,r){var n=p(e,t);return null!==n&&(n=r in n?n[r]:null),n},b=function(e,t,r){var n=p(e,t);if(null!==n&&r in n){delete n[r];var s=!0;for(var i in n){s=!1;break}s&&(n=null),f(e,t,n)}},m=function(e,t){f(e,t,null)},w=function(e,t,r){var n,s=null;void 0===r&&(r=["web","flash"]);var i=!1,o=null;for(var a in r){n=r[a];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");s=e.apply(this,t),i="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,s=e.apply(this,t),i=!0)}catch(e){o=e}if(i)break}if(!i)throw o;return s};a.setItem=function(e,t,r,n,s){w(y,arguments,s)},a.getItem=function(e,t,r,n){return w(g,arguments,n)},a.removeItem=function(e,t,r,n){w(b,arguments,n)},a.clearItems=function(e,t,r){w(m,arguments,r)},a.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},a.format=function(e){for(var t,r,n=/%./g,s=0,i=[],o=0;t=n.exec(e);){(r=e.substring(o,n.lastIndex-2)).length>0&&i.push(r),o=n.lastIndex;var a=t[0][1];switch(a){case"s":case"o":s<arguments.length?i.push(arguments[1+s++]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+a+"?>")}}return i.push(e.substring(o)),i.join("")},a.formatNumber=function(e,t,r,n){var s=e,i=isNaN(t=Math.abs(t))?2:t,o=void 0===r?",":r,a=void 0===n?".":n,c=s<0?"-":"",h=parseInt(s=Math.abs(+s||0).toFixed(i),10)+"",l=h.length>3?h.length%3:0;return c+(l?h.substr(0,l)+a:"")+h.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(i?o+Math.abs(s-h).toFixed(i).slice(2):"")},a.formatSize=function(e){return e=e>=1073741824?a.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?a.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?a.formatNumber(e/1024,0)+" KiB":a.formatNumber(e,0)+" bytes"},a.bytesFromIP=function(e){return-1!==e.indexOf(".")?a.bytesFromIPv4(e):-1!==e.indexOf(":")?a.bytesFromIPv6(e):null},a.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=a.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},a.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),n=a.createBuffer(),s=0;s<8;++s)if(e[s]&&0!==e[s].length){var i=a.hexToBytes(e[s]);i.length<2&&n.putByte(0),n.putBytes(i)}else n.fillWithByte(0,r),r=0;return n.getBytes()},a.bytesToIP=function(e){return 4===e.length?a.bytesToIPv4(e):16===e.length?a.bytesToIPv6(e):null},a.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},a.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,s=0;s<e.length;s+=2){for(var i=a.bytesToHex(e[s]+e[s+1]);"0"===i[0]&&"0"!==i;)i=i.substr(1);if("0"===i){var o=r[r.length-1],c=t.length;o&&c===o.end+1?(o.end=c,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:c,end:c})}t.push(i)}if(r.length>0){var h=r[n];h.end-h.start>0&&(t.splice(h.start,h.end-h.start+1,""),0===h.start&&t.unshift(""),7===h.end&&t.push(""))}return t.join(":")},a.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in a&&!e.update)return t(null,a.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return a.cores=navigator.hardwareConcurrency,t(null,a.cores);if("undefined"==typeof Worker)return a.cores=1,t(null,a.cores);if("undefined"==typeof Blob)return a.cores=2,t(null,a.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(n,s,i){if(0===s){var o=Math.floor(n.reduce((function(e,t){return e+t}),0)/n.length);return a.cores=Math.max(1,o),URL.revokeObjectURL(r),t(null,a.cores)}!function(e,t){for(var n=[],s=[],i=0;i<e;++i){var o=new Worker(r);o.addEventListener("message",(function(r){if(s.push(r.data),s.length===e){for(var i=0;i<e;++i)n[i].terminate();t(null,s)}})),n.push(o)}for(i=0;i<e;++i)n[i].postMessage(i)}(i,(function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var s=t[n],i=r[n]=[],o=0;o<e;++o)if(n!==o){var a=t[o];(s.st>a.st&&s.st<a.et||a.st>s.st&&a.st<s.et)&&i.push(o)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(i,r)),e(n,s-1,i)}))}([],5,16)}},25414:(e,t,r)=>{var n=r(3832);r(8925),r(3068),r(33480),r(28991),r(86971),r(66270),r(26953),r(96007),r(28095),r(97116);var s=n.asn1,i=e.exports=n.pki=n.pki||{},o=i.oids,a={};a.CN=o.commonName,a.commonName="CN",a.C=o.countryName,a.countryName="C",a.L=o.localityName,a.localityName="L",a.ST=o.stateOrProvinceName,a.stateOrProvinceName="ST",a.O=o.organizationName,a.organizationName="O",a.OU=o.organizationalUnitName,a.organizationalUnitName="OU",a.E=o.emailAddress,a.emailAddress="E";var c=n.pki.rsa.publicKeyValidator,h={name:"Certificate",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:s.Class.UNIVERSAL,type:s.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:s.Class.UNIVERSAL,type:s.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:s.Class.UNIVERSAL,type:s.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:s.Class.UNIVERSAL,type:s.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:s.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:s.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},l={name:"rsapss",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:s.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:s.Class.UNIVERSAL,type:s.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:s.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:s.Class.UNIVERSAL,type:s.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0}]}]}]},d={name:"CertificationRequest",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,s=0;null===n&&s<e.attributes.length;++s)r=e.attributes[s],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}i.RDNAttributesAsArray=function(e,t){for(var r,n,i,c=[],h=0;h<e.value.length;++h){r=e.value[h];for(var l=0;l<r.value.length;++l)i={},n=r.value[l],i.type=s.derToOid(n.value[0].value),i.value=n.value[1].value,i.valueTagClass=n.value[1].type,i.type in o&&(i.name=o[i.type],i.name in a&&(i.shortName=a[i.name])),t&&(t.update(i.type),t.update(i.value)),c.push(i)}return c},i.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],c=s.derToOid(n.value[0].value),h=n.value[1].value,l=0;l<h.length;++l){var u={};if(u.type=c,u.value=h[l].value,u.valueTagClass=h[l].type,u.type in o&&(u.name=o[u.type],u.name in a&&(u.shortName=a[u.name])),u.type===o.extensionRequest){u.extensions=[];for(var d=0;d<u.value.length;++d)u.extensions.push(i.certificateExtensionFromAsn1(u.value[d]))}t.push(u)}return t};var p=function(e,t,r){var n={};if(e!==o["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:o.sha1},mgf:{algorithmOid:o.mgf1,hash:{algorithmOid:o.sha1}},saltLength:20});var i={},a=[];if(!s.validate(t,l,i,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==i.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=s.derToOid(i.hashOid)),void 0!==i.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=s.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=s.derToOid(i.maskGenHashOid)),void 0!==i.saltLength&&(n.saltLength=i.saltLength.charCodeAt(0)),n},y=function(e){switch(o[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return n.md.sha1.create();case"md5WithRSAEncryption":return n.md.md5.create();case"sha256WithRSAEncryption":case"RSASSA-PSS":return n.md.sha256.create();case"sha384WithRSAEncryption":return n.md.sha384.create();case"sha512WithRSAEncryption":return n.md.sha512.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},g=function(e){var t,r=e.certificate;switch(r.signatureOid){case o.sha1WithRSAEncryption:case o.sha1WithRSASignature:break;case o["RSASSA-PSS"]:var s,i,a;if(void 0===(s=o[r.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[s])throw(a=new Error("Unsupported MGF hash function.")).oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=s,a;if(void 0===(i=o[r.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[i])throw(a=new Error("Unsupported MGF function.")).oid=r.signatureParameters.mgf.algorithmOid,a.name=i,a;if(i=n.mgf[i].create(n.md[s].create()),void 0===(s=o[r.signatureParameters.hash.algorithmOid])||void 0===n.md[s])throw(a=new Error("Unsupported RSASSA-PSS hash function.")).oid=r.signatureParameters.hash.algorithmOid,a.name=s,a;t=n.pss.create(n.md[s].create(),i,r.signatureParameters.saltLength)}return r.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function b(e){for(var t,r,i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){var c=(t=o[a]).value,h=s.Type.PRINTABLESTRING;"valueTagClass"in t&&(h=t.valueTagClass)===s.Type.UTF8&&(c=n.util.encodeUtf8(c)),r=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.type).getBytes()),s.create(s.Class.UNIVERSAL,h,!1,c)])]),i.value.push(r)}return i}function m(e){for(var t,r=0;r<e.length;++r){if(void 0===(t=e[r]).name&&(t.type&&t.type in i.oids?t.name=i.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=i.oids[a[t.shortName]])),void 0===t.type){if(!t.name||!(t.name in i.oids))throw(c=new Error("Attribute type not specified.")).attribute=t,c;t.type=i.oids[t.name]}if(void 0===t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=s.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(i.certificateExtensionToAsn1(w(t.extensions[n])))}var c;if(void 0===t.value)throw(c=new Error("Attribute value not specified.")).attribute=t,c}}function w(e,t){if(t=t||{},void 0===e.name&&e.id&&e.id in i.oids&&(e.name=i.oids[e.id]),void 0===e.id){if(!e.name||!(e.name in i.oids))throw(E=new Error("Extension ID not specified.")).extension=e,E;e.id=i.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var r=0,a=0,c=0;e.digitalSignature&&(a|=128,r=7),e.nonRepudiation&&(a|=64,r=6),e.keyEncipherment&&(a|=32,r=5),e.dataEncipherment&&(a|=16,r=4),e.keyAgreement&&(a|=8,r=3),e.keyCertSign&&(a|=4,r=2),e.cRLSign&&(a|=2,r=1),e.encipherOnly&&(a|=1,r=0),e.decipherOnly&&(c|=128,r=7);var h=String.fromCharCode(r);0!==c?h+=String.fromCharCode(a)+String.fromCharCode(c):0!==a&&(h+=String.fromCharCode(a)),e.value=s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,h)}else if("basicConstraints"===e.name)e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(s.create(s.Class.UNIVERSAL,s.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);var l=e.value.value;for(var u in e)!0===e[u]&&(u in o?l.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o[u]).getBytes())):-1!==u.indexOf(".")&&l.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(u).getBytes())))}else if("nsCertType"===e.name){r=0,a=0;e.client&&(a|=128,r=7),e.server&&(a|=64,r=6),e.email&&(a|=32,r=5),e.objsign&&(a|=16,r=4),e.reserved&&(a|=8,r=3),e.sslCA&&(a|=4,r=2),e.emailCA&&(a|=2,r=1),e.objCA&&(a|=1,r=0);h=String.fromCharCode(r);0!==a&&(h+=String.fromCharCode(a)),e.value=s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,h)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);for(var d=0;d<e.altNames.length;++d){h=(m=e.altNames[d]).value;if(7===m.type&&m.ip){if(null===(h=n.util.bytesFromIP(m.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===m.type&&(h=m.oid?s.oidToDer(s.oidToDer(m.oid)):s.oidToDer(h));e.value.value.push(s.create(s.Class.CONTEXT_SPECIFIC,m.type,!1,h))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=s.create(s.Class.UNIVERSAL,s.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,f.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);l=e.value.value;if(e.keyIdentifier){var p=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;l.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!1,p))}if(e.authorityCertIssuer){var y=[s.create(s.Class.CONTEXT_SPECIFIC,4,!0,[b(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];l.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,y))}if(e.serialNumber){var g=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);l.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if("cRLDistributionPoints"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);l=e.value.value;var m,w=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),v=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(d=0;d<e.altNames.length;++d){h=(m=e.altNames[d]).value;if(7===m.type&&m.ip){if(null===(h=n.util.bytesFromIP(m.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===m.type&&(h=m.oid?s.oidToDer(s.oidToDer(m.oid)):s.oidToDer(h));v.value.push(s.create(s.Class.CONTEXT_SPECIFIC,m.type,!1,h))}w.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[v])),l.push(w)}var E;if(void 0===e.value)throw(E=new Error("Extension value not specified.")).extension=e,E;return e}function v(e,t){if(e===o["RSASSA-PSS"]){var r=[];return void 0!==t.hash.algorithmOid&&r.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.hash.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.mgf.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.mgf.hash.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.saltLength).getBytes())])),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,r)}return s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")}function E(e){var t=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,i=0;i<r.length;++i){var o=r[i],a=o.value,c=s.Type.UTF8;"valueTagClass"in o&&(c=o.valueTagClass),c===s.Type.UTF8&&(a=n.util.encodeUtf8(a));var h=!1;"valueConstructed"in o&&(h=o.valueConstructed);var l=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[s.create(s.Class.UNIVERSAL,c,h,a)])]);t.value.push(l)}return t}i.certificateFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=s.fromDer(o.body,r);return i.certificateFromAsn1(c,t)},i.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:s.toDer(i.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=s.fromDer(t.body);return i.publicKeyFromAsn1(o)},i.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:s.toDer(i.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:s.toDer(i.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.getPublicKeyFingerprint=function(e,t){var r,o=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=s.toDer(i.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=s.toDer(i.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(r);var a=o.digest();if("hex"===t.encoding){var c=a.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return a},i.certificationRequestFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=s.fromDer(o.body,r);return i.certificationRequestFromAsn1(c,t)},i.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:s.toDer(i.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},i.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){m([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){m([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){m(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){m(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)w(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,s=0;null===n&&s<e.extensions.length;++s)r=e.extensions[s],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=i.getTBSCertificate(e);var h=s.toDer(e.tbsCertificate);e.md.update(h.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,o=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=o.attributes,a.actualIssuer=n.attributes,a}var c=t.md;if(null===c){c=y({signatureOid:t.signatureOid,type:"certificate"});var h=t.tbsCertificate||i.getTBSCertificate(t),l=s.toDer(h);c.update(l.getBytes())}return null!==c&&(r=g({certificate:e,md:c,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,s=t.subject;if(n.hash&&s.hash)r=n.hash===s.hash;else if(n.attributes.length===s.attributes.length){var i,o;r=!0;for(var a=0;r&&a<n.attributes.length;++a)i=n.attributes[a],o=s.attributes[a],i.type===o.type&&i.value===o.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var s=e.extensions[r];if(s.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(s.subjectKeyIdentifier)===i}}return!1},e},i.certificateFromAsn1=function(e,t){var r={},o=[];if(!s.validate(e,h,r,o)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=o,a}if(s.derToOid(r.publicKeyOid)!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=i.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var l=n.util.createBuffer(r.certSerialNumber);c.serialNumber=l.toHex(),c.signatureOid=n.asn1.derToOid(r.certSignatureOid),c.signatureParameters=p(c.signatureOid,r.certSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),c.siginfo.parameters=p(c.siginfo.algorithmOid,r.certinfoSignatureParams,!1),c.signature=r.certSignature;var u=[];if(void 0!==r.certValidity1UTCTime&&u.push(s.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&u.push(s.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&u.push(s.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&u.push(s.generalizedTimeToDate(r.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=u[0],c.validity.notAfter=u[1],c.tbsCertificate=r.tbsCertificate,t){c.md=y({signatureOid:c.signatureOid,type:"certificate"});var d=s.toDer(c.tbsCertificate);c.md.update(d.getBytes())}var g=n.md.sha1.create(),b=s.toDer(r.certIssuer);g.update(b.getBytes()),c.issuer.getField=function(e){return f(c.issuer,e)},c.issuer.addField=function(e){m([e]),c.issuer.attributes.push(e)},c.issuer.attributes=i.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(c.issuer.uniqueId=r.certIssuerUniqueId),c.issuer.hash=g.digest().toHex();var w=n.md.sha1.create(),v=s.toDer(r.certSubject);return w.update(v.getBytes()),c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){m([e]),c.subject.attributes.push(e)},c.subject.attributes=i.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(c.subject.uniqueId=r.certSubjectUniqueId),c.subject.hash=w.digest().toHex(),r.certExtensions?c.extensions=i.certificateExtensionsFromAsn1(r.certExtensions):c.extensions=[],c.publicKey=i.publicKeyFromAsn1(r.subjectPublicKeyInfo),c},i.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],s=0;s<n.value.length;++s)t.push(i.certificateExtensionFromAsn1(n.value[s]));return t},i.certificateExtensionFromAsn1=function(e){var t={};if(t.id=s.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===s.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var r=0,i=0;(c=s.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1),i=c.value.length>2?c.value.charCodeAt(2):0),t.digitalSignature=128==(128&r),t.nonRepudiation=64==(64&r),t.keyEncipherment=32==(32&r),t.dataEncipherment=16==(16&r),t.keyAgreement=8==(8&r),t.keyCertSign=4==(4&r),t.cRLSign=2==(2&r),t.encipherOnly=1==(1&r),t.decipherOnly=128==(128&i)}else if("basicConstraints"===t.name){(c=s.fromDer(t.value)).value.length>0&&c.value[0].type===s.Type.BOOLEAN?t.cA=0!==c.value[0].value.charCodeAt(0):t.cA=!1;var a=null;c.value.length>0&&c.value[0].type===s.Type.INTEGER?a=c.value[0].value:c.value.length>1&&(a=c.value[1].value),null!==a&&(t.pathLenConstraint=s.derToInteger(a))}else if("extKeyUsage"===t.name)for(var c=s.fromDer(t.value),h=0;h<c.value.length;++h){var l=s.derToOid(c.value[h].value);l in o?t[o[l]]=!0:t[l]=!0}else if("nsCertType"===t.name){r=0;(c=s.fromDer(t.value)).value.length>1&&(r=c.value.charCodeAt(1)),t.client=128==(128&r),t.server=64==(64&r),t.email=32==(32&r),t.objsign=16==(16&r),t.reserved=8==(8&r),t.sslCA=4==(4&r),t.emailCA=2==(2&r),t.objCA=1==(1&r)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var u;t.altNames=[];c=s.fromDer(t.value);for(var d=0;d<c.value.length;++d){var f={type:(u=c.value[d]).type,value:u.value};switch(t.altNames.push(f),u.type){case 1:case 2:case 6:break;case 7:f.ip=n.util.bytesToIP(u.value);break;case 8:f.oid=s.derToOid(u.value)}}}else if("subjectKeyIdentifier"===t.name){c=s.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(c.value)}return t},i.certificationRequestFromAsn1=function(e,t){var r={},o=[];if(!s.validate(e,d,r,o)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=o,a}if(s.derToOid(r.publicKeyOid)!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=i.createCertificationRequest();if(c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,c.signatureOid=n.asn1.derToOid(r.csrSignatureOid),c.signatureParameters=p(c.signatureOid,r.csrSignatureParams,!0),c.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),c.siginfo.parameters=p(c.siginfo.algorithmOid,r.csrSignatureParams,!1),c.signature=r.csrSignature,c.certificationRequestInfo=r.certificationRequestInfo,t){c.md=y({signatureOid:c.signatureOid,type:"certification request"});var h=s.toDer(c.certificationRequestInfo);c.md.update(h.getBytes())}var l=n.md.sha1.create();return c.subject.getField=function(e){return f(c.subject,e)},c.subject.addField=function(e){m([e]),c.subject.attributes.push(e)},c.subject.attributes=i.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),c.subject.hash=l.digest().toHex(),c.publicKey=i.publicKeyFromAsn1(r.subjectPublicKeyInfo),c.getAttribute=function(e){return f(c,e)},c.addAttribute=function(e){m([e]),c.attributes.push(e)},c.attributes=i.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),c},i.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){m([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){m([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){m(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){m(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=i.getCertificationRequestInfo(e);var h=s.toDer(e.certificationRequestInfo);e.md.update(h.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){r=y({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||i.getCertificationRequestInfo(e),o=s.toDer(n);r.update(o.getBytes())}return null!==r&&(t=g({certificate:e,md:r,signature:e.signature})),t},e};var A=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z");function _(e){return e>=A&&e<S?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(e)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(e))}i.getTBSCertificate=function(e){var t=_(e.validity.notBefore),r=_(e.validity.notAfter),o=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes())]),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.siginfo.algorithmOid).getBytes()),v(e.siginfo.algorithmOid,e.siginfo.parameters)]),b(e.issuer),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,r]),b(e.subject),i.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!0,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(i.certificateExtensionsToAsn1(e.extensions)),o},i.getCertificationRequestInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),b(e.subject),i.publicKeyToAsn1(e.publicKey),E(e)])},i.distinguishedNameToAsn1=function(e){return b(e)},i.certificateToAsn1=function(e){var t=e.tbsCertificate||i.getTBSCertificate(e);return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.certificateExtensionsToAsn1=function(e){var t=s.create(s.Class.CONTEXT_SPECIFIC,3,!0,[]),r=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(i.certificateExtensionToAsn1(e[n]));return t},i.certificateExtensionToAsn1=function(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.id).getBytes())),e.critical&&t.value.push(s.create(s.Class.UNIVERSAL,s.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!=typeof e.value&&(r=s.toDer(r).getBytes()),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r)),t},i.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||i.getCertificationRequestInfo(e);return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.createCaStore=function(e){var t={certs:{}};function r(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=i.RDNAttributesAsArray(b(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"==typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var o=s.toDer(i.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){if(o===s.toDer(i.certificateToAsn1(t[a])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var s=t.certs[r];if(n.util.isArray(s))for(var i=0;i<s.length;++i)e.push(s[i]);else e.push(s)}return e},t.removeCertificate=function(e){var a;if("string"==typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var c=r(e.subject);if(!n.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var h=s.toDer(i.certificateToAsn1(e)).getBytes(),l=0;l<c.length;++l){h===s.toDer(i.certificateToAsn1(c[l])).getBytes()&&(a=c[l],c.splice(l,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(e,t,r){"function"==typeof r&&(r={verify:r}),r=r||{};var s=(t=t.slice(0)).slice(0),o=r.validityCheckDate;void 0===o&&(o=new Date);var a=!0,c=null,h=0;do{var l=t.shift(),u=null,d=!1;if(o&&(o<l.validity.notBefore||o>l.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:o}),null===c){if(null===(u=t[0]||e.getIssuer(l))&&l.isIssuer(l)&&(d=!0,u=l),u){var f=u;n.util.isArray(f)||(f=[f]);for(var p=!1;!p&&f.length>0;){u=f.shift();try{p=u.verify(l)}catch(e){}}p||(c={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}null!==c||u&&!d||e.hasCertificate(l)||(c={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(null===c&&u&&!l.isIssuer(u)&&(c={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===c)for(var y={keyUsage:!0,basicConstraints:!0},g=0;null===c&&g<l.extensions.length;++g){var b=l.extensions[g];b.critical&&!(b.name in y)&&(c={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!u||d))){var m=l.getExtension("basicConstraints"),w=l.getExtension("keyUsage");if(null!==w&&(w.keyCertSign&&null!==m||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate})),null!==c||null===m||m.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===c&&null!==w&&"pathLenConstraint"in m)h-1>m.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}var v=null===c||c.error,E=r.verify?r.verify(v,h,s):v;if(!0!==E)throw!0===v&&(c={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(E||0===E)&&("object"!=typeof E||n.util.isArray(E)?"string"==typeof E&&(c.error=E):(E.message&&(c.message=E.message),E.error&&(c.error=E.error))),c;c=null,a=!1,++h}while(t.length>0);return!0}},35103:(e,t,r)=>{const n=r(91607),s=r(50603);e.exports=class{constructor(){this._buffer=new n,this._waitingConsumers=new n}push(e){const{promise:t,resolve:r}=s();return this._buffer.push({chunk:e,resolve:r}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){const e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){const{promise:e,resolve:t}=s();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}},50603:e=>{"use strict";e.exports=()=>{const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}},290:(e,t,r)=>{"use strict";e.exports=r(96114).default},96114:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(28951),i=n(r(44189)),o=n(r(8967)),a=r(56512),c=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((e=>new s.Netmask(e)));function h(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}t.default=e=>{if((0,a.isValid)(e)){const t=(0,a.parse)(e);if("ipv4"===t.kind())return function(e){for(let t of c)if(t.contains(e))return!0;return!1}(t.toNormalizedString());if("ipv6"===t.kind())return h(e)}else if((0,o.default)(e)&&i.default.v6().test(e))return h(e)}},44189:e=>{"use strict";const t="[a-fA-F\\d:]",r=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${t})|(?<=${t})(?=\\s|$))`:"",n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",i=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${n}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${n}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${n}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${n}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${n}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${n}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${n}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${n}$)|(?:^${i}$)`),a=new RegExp(`^${n}$`),c=new RegExp(`^${i}$`),h=e=>e&&e.exact?o:new RegExp(`(?:${r(e)}${n}${r(e)})|(?:${r(e)}${i}${r(e)})`,"g");h.v4=e=>e&&e.exact?a:new RegExp(`${r(e)}${n}${r(e)}`,"g"),h.v6=e=>e&&e.exact?c:new RegExp(`${r(e)}${i}${r(e)}`,"g"),e.exports=h},8967:(e,t,r)=>{"use strict";const n=r(44189),s=e=>n({exact:!0}).test(e);s.v4=e=>n.v4({exact:!0}).test(e),s.v6=e=>n.v6({exact:!0}).test(e),s.version=e=>s(e)?s.v4(e)?4:6:void 0,e.exports=s},34155:e=>{var t,r,n=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var a,c=[],h=!1,l=-1;function u(){h&&a&&(h=!1,a.length?c=a.concat(c):l=-1,c.length&&d())}function d(){if(!h){var e=o(u);h=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||h||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},62100:(e,t,r)=>{"use strict";e.exports=r(89482)},89482:(e,t,r)=>{"use strict";var n=t;function s(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(41173),n.BufferWriter=r(43155),n.Reader=r(51408),n.BufferReader=r(50593),n.util=r(99693),n.rpc=r(35994),n.roots=r(85054),n.configure=s,s()},51408:(e,t,r)=>{"use strict";e.exports=c;var n,s=r(99693),i=s.LongBits,o=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var h,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return s.Buffer?function(e){return(c.create=function(e){return s.Buffer.isBuffer(e)?new n(e):l(e)})(e)}:l};function d(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,c.prototype.uint32=(h=4294967295,function(){if(h=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return h;if(h=(h|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return h;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return h}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=u(),n._configure();var t=s.Long?"toLong":"toNumber";s.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},50593:(e,t,r)=>{"use strict";e.exports=i;var n=r(51408);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(99693);function i(e){n.call(this,e)}i._configure=function(){s.Buffer&&(i.prototype._slice=s.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},85054:e=>{"use strict";e.exports={}},35994:(e,t,r)=>{"use strict";t.Service=r(77948)},77948:(e,t,r)=>{"use strict";e.exports=s;var n=r(99693);function s(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(s.prototype=Object.create(n.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,r,s,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return n.asPromise(e,a,t,r,s,i);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,r){if(e)return a.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof s))try{r=s[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",r,t),o(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(e,t,r)=>{"use strict";e.exports=s;var n=r(99693);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=s.zero=new s(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new s(r,n)},s.from=function(e){if("number"==typeof e)return s.fromNumber(e);if(n.isString(e)){if(!n.Long)return s.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):i},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?i:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},99693:function(e,t,r){"use strict";var n=t;function s(e,t,r){for(var n=Object.keys(t),s=0;s<n.length;++s)void 0!==e[n[s]]&&r||(e[n[s]]=t[n[s]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&s(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:()=>e,set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(34537),n.base64=r(97419),n.EventEmitter=r(19211),n.float=r(10945),n.inquire=r(67199),n.utf8=r(94997),n.pool=r(76662),n.LongBits=r(1945),n.isNode=Boolean("undefined"!=typeof window&&window&&window.process&&window.process.versions&&window.process.versions.node),n.global=n.isNode&&window||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=s,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},41173:(e,t,r)=>{"use strict";e.exports=u;var n,s=r(99693),i=s.LongBits,o=s.base64,a=s.utf8;function c(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function h(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new c(h,0,0),this.tail=this.head,this.states=null}var d=function(){return s.Buffer?function(){return(u.create=function(){return new n})()}:function(){return new u}};function f(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}u.create=d(),u.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(u.alloc=s.pool(u.alloc,s.Array.prototype.subarray)),u.prototype._push=function(e,t,r){return this.tail=this.tail.next=new c(e,t,r),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(y,10,i.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=i.from(e);return this._push(y,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(y,t.length(),t)},u.prototype.bool=function(e){return this._push(f,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var b=s.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(s.isString(e)){var r=u.alloc(t=o.length(e));o.decode(e,r,0),e=r}return this.uint32(t)._push(b,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},u.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(h,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(h,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},u._configure=function(e){n=e,u.create=d(),n._configure()}},43155:(e,t,r)=>{"use strict";e.exports=i;var n=r(41173);(i.prototype=Object.create(n.prototype)).constructor=i;var s=r(99693);function i(){n.call(this)}function o(e,t,r){e.length<40?s.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}i._configure=function(){i.alloc=s._Buffer_allocUnsafe,i.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},i.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},54375:e=>{let t;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind(window):e=>(t||(t=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},33286:(e,t,r)=>{const{instantiate:n}=r(19824);function s(e={}){if(!s.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return n(new Response(new Blob([t],{type:"application/wasm"})),e)}s.supported="undefined"!=typeof WebAssembly,e.exports=s},63060:(e,t,r)=>{const n=r(57118),s=r(33286);e.exports={Rabin:n,create:async(e,t,r,i,o)=>{const a=await s();return new n(a,e,t,r,i,o)}}},57118:e=>{e.exports=class{constructor(e,t=12,r=8192,n=32768,s=64,i){this.bits=t,this.min=r,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,r,n,s,i),this.polynomial=i}fingerprint(e){const{__retain:t,__release:r,__allocArray:n,__getInt32Array:s,Int32Array_ID:i,Uint8Array_ID:o}=this.asModule,a=t(n(i,new Int32Array(Math.ceil(e.length/this.min)))),c=t(n(o,e)),h=s(this.rabin.fingerprint(c,a));r(c),r(a);const l=h.indexOf(0);return l>=0?h.subarray(0,l):h}}},61798:(e,t,r)=>{"use strict";var n=r(34155),s=65536,i=4294967295;var o=r(89509).Buffer,a=window.crypto||window.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>i)throw new RangeError("requested too many random bytes");var r=o.allocUnsafe(e);if(e>0)if(e>s)for(var c=0;c<e;c+=s)a.getRandomValues(r.slice(c,c+s));else a.getRandomValues(r);if("function"==typeof t)return n.nextTick((function(){t(null,r)}));return r}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},8558:(e,t,r)=>{const n=r(14636),s=r(81391),i=r(54156),o=r(4832),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:h}=r(91713),l=r(22288),u=r(45105),d=r(60911),f=r(33766),p=r(78686),y=r(73328),g=r(15155);e.exports={RateLimiterRedis:n,RateLimiterMongo:s,RateLimiterMySQL:i,RateLimiterPostgres:o,RateLimiterMemory:l,RateLimiterMemcache:u,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:h,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:y,RateLimiterRes:g}},73328:(e,t,r)=>{const n=r(15155);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return new n(e.remainingPoints,Math.min(e.msBeforeNext,t.msBeforeNext),e.consumedPoints,e.isFirstInDuration)}consume(e,t=1,r={}){return this._rateLimiter.consume(e,t,r).catch((s=>s instanceof n?this._burstLimiter.consume(e,t,r).then((e=>Promise.resolve(this._combineRes(s,e)))).catch((e=>e instanceof n?Promise.reject(this._combineRes(s,e)):Promise.reject(e))):Promise.reject(s)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((([e,t])=>this._combineRes(e,t)))}get points(){return this._rateLimiter.points}}},60911:(e,t,r)=>{const n=r(15155);e.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if(void 0===e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway=void 0!==e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if(void 0===e&&(e=()=>!1),"function"!=typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new n(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new n(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,t=1){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.rejectBlack()),void 0===r?this.limiter.consume(e,t):(this.runActionAnyway&&this.limiter.consume(e,t).catch((()=>{})),r)}block(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),r)}penalty(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),r)}reward(e,t){let r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),void 0===r?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),r)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),void 0===t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},81352:e=>{e.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration=void 0===e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration=void 0===e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly=void 0!==e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs=void 0===e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if(void 0===e&&(e="rlflx"),"string"!=typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},91713:(e,t,r)=>{var n=r(34155);const s=r(81265),i=r(35539),o=r(81352),a=r(22288),c=r(15155),h="rate_limiter_flexible";let l=null;const u=function(e,t,r,n){let s;s=null===n||!0===n||!1===n?n:{remainingPoints:n.remainingPoints,msBeforeNext:n.msBeforeNext,consumedPoints:n.consumedPoints,isFirstInDuration:n.isFirstInDuration},e.send({channel:h,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:r,data:s})},d=function(e){setTimeout((()=>{this._initiated?n.send(e):void 0!==this._promises[e.promiseId]&&d.call(this,e)}),30)},f=function(e,t,r,s,i){const o={channel:h,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:r,arg:s,opts:i}};this._initiated?n.send(o):d.call(this,o)},p=function(e,t){if(!t||t.channel!==h||void 0===this._rateLimiters[t.keyPrefix])return!1;let r;switch(t.func){case"consume":r=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":r=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":r=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":r=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":r=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":r=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}r&&r.then((r=>{u(e,t,"resolve",r)})).catch((r=>{u(e,t,"reject",r)}))},y=function(e){if(!e||e.channel!==h||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new c(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error(`RateLimiterCluster: no such message type '${e.type}'`)}delete this._promises[e.promiseId]}},g=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},b=function(e,t){const r=n.hrtime();let s=r[0].toString()+r[1].toString();return void 0!==this._promises[s]&&(s+=i.randomBytes(12).toString("base64")),this._promises[s]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[s],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},s};e.exports={RateLimiterClusterMaster:class{constructor(){if(l)return l;this._rateLimiters={},s.setMaxListeners(0),s.on("message",((e,t)=>{t&&t.channel===h&&"init"===t.type?(void 0===this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new a(t.opts)),e.send({channel:h,type:"init",keyPrefix:t.opts.keyPrefix})):p.call(this,e,t)})),l=this}},RateLimiterClusterMasterPM2:class{constructor(e){if(l)return l;this._rateLimiters={},e.launchBus(((t,r)=>{r.on("process:msg",(t=>{const r=t.raw;if(r&&r.channel===h&&"init"===r.type)void 0===this._rateLimiters[r.opts.keyPrefix]&&(this._rateLimiters[r.opts.keyPrefix]=new a(r.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:h,channel:h,type:"init",keyPrefix:r.opts.keyPrefix},((e,t)=>{e&&console.log(e,t)}));else{p.call(this,{send:r=>{const n=r;n.topic=h,void 0===n.data&&(n.data={}),e.sendDataToProcessId(t.process.pm_id,n,((e,t)=>{e&&console.log(e,t)}))}},r)}}))})),l=this}},RateLimiterCluster:class extends o{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs=void 0===e?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),n.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,n.on("message",(e=>{e&&e.channel===h&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:y.call(this,e)})),n.send({channel:h,type:"init",opts:g.call(this)}),this._promises={}}consume(e,t=1,r={}){return new Promise(((n,s)=>{const i=b.call(this,n,s);f.call(this,"consume",i,e,t,r)}))}penalty(e,t=1,r={}){return new Promise(((n,s)=>{const i=b.call(this,n,s);f.call(this,"penalty",i,e,t,r)}))}reward(e,t=1,r={}){return new Promise(((n,s)=>{const i=b.call(this,n,s);f.call(this,"reward",i,e,t,r)}))}block(e,t,r={}){return new Promise(((n,s)=>{const i=b.call(this,n,s);f.call(this,"block",i,e,t,r)}))}get(e,t={}){return new Promise(((r,n)=>{const s=b.call(this,r,n);f.call(this,"get",s,e,t)}))}delete(e,t={}){return new Promise(((r,n)=>{const s=b.call(this,r,n);f.call(this,"delete",s,e,t)}))}}}},45105:(e,t,r)=>{const n=r(91090),s=r(15155);e.exports=class extends n{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,r){const n=new s;return n.consumedPoints=parseInt(r.consumedPoints),n.isFirstInDuration=r.consumedPoints===t,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=r.msBeforeNext,n}_upsert(e,t,r,n=!1,s={}){return new Promise(((i,o)=>{const a=Date.now(),c=Math.floor(r/1e3);n?this.client.set(e,t,c,(r=>{r?o(r):this.client.set(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{i({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.incr(e,t,((h,l)=>{h||!1===l?this.client.add(e,t,c,((h,l)=>{if(h||!l)if(void 0===s.attemptNumber||s.attemptNumber<3){const a=Object.assign({},s);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,r,n,a).then((e=>i(e))).catch((e=>o(e)))}else o(new Error("Can not add key"));else this.client.add(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{i({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):this.client.get(`${e}_expire`,((e,t)=>{if(e)o(e);else{const e=!1===t?0:t,r={consumedPoints:l,msBeforeNext:e>=0?Math.max(e-a,0):-1};i(r)}}))}))}))}_get(e){return new Promise(((t,r)=>{const n=Date.now();this.client.get(e,((s,i)=>{i?this.client.get(`${e}_expire`,((e,s)=>{if(e)r(e);else{const e=!1===s?0:s,r={consumedPoints:i,msBeforeNext:e>=0?Math.max(e-n,0):-1};t(r)}})):t(null)}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((n,s)=>{n?r(n):!1===s?t(s):this.client.del(`${e}_expire`,(e=>{e?r(e):t(s)}))}))}))}}},22288:(e,t,r)=>{const n=r(81352),s=r(58425),i=r(15155);e.exports=class extends n{constructor(e={}){super(e),this._memoryStorage=new s}consume(e,t=1,r={}){return new Promise(((n,s)=>{const i=this.getKey(e),o=this._getKeySecDuration(r);let a=this._memoryStorage.incrby(i,t,o);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(i,a.consumedPoints,this.blockDuration)),s(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(n,e,a)}else n(a)}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const s=this._getKeySecDuration(r),i=this._memoryStorage.incrby(n,t,s);i.remainingPoints=Math.max(this.points-i.consumedPoints,0),e(i)}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise((e=>{const s=this._getKeySecDuration(r),i=this._memoryStorage.incrby(n,-t,s);i.remainingPoints=Math.max(this.points-i.consumedPoints,0),e(i)}))}block(e,t){const r=1e3*t,n=this.points+1;return this._memoryStorage.set(this.getKey(e),n,t),Promise.resolve(new i(0,0===r?-1:r,n))}set(e,t,r){const n=1e3*(r>=0?r:this.duration);return this._memoryStorage.set(this.getKey(e),t,r),Promise.resolve(new i(0,0===n?-1:n,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}},81391:(e,t,r)=>{const n=r(91090),s=r(15155);function i(e){try{const t=e.client?e.client:e,{version:r}=t.topology.s.options.metadata.driver,n=r.split(".").map((e=>parseInt(e)));return{major:n[0],feature:n[1],patch:n[2]}}catch(e){return{major:0,feature:0,patch:0}}}class o extends n{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"==typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=i(this.client)})):(this._initCollection(),this._driverVersion=i(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?o.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get client(){return this._client}set client(e){if(void 0===e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e=("function"==typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);e.createIndex({expire:-1},{expireAfterSeconds:0}),e.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=e}_getRateLimiterRes(e,t,r){const n=new s;let i;return i=void 0===r.value?r:r.value,n.isFirstInDuration=i.points===t,n.consumedPoints=i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=null!==i.expire?Math.max(new Date(i.expire).getTime()-Date.now(),0):-1,n}_upsert(e,t,r,n=!1,s={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const i=s.attrs||{};let o,a;n?(o={key:e},o=Object.assign(o,i),a={$set:{key:e,points:t,expire:r>0?new Date(Date.now()+r):null}},a.$set=Object.assign(a.$set,i)):(o={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},o=Object.assign(o,i),a={$setOnInsert:{key:e,expire:r>0?new Date(Date.now()+r):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,i));const c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise(((s,h)=>{this._collection.findOneAndUpdate(o,a,c).then((e=>{s(e)})).catch((o=>{if(o&&11e3===o.code){const o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},i),a={$set:Object.assign({key:e,points:t,expire:r>0?new Date(Date.now()+r):null},i)};this._collection.findOneAndUpdate(o,a,c).then((e=>{s(e)})).catch((i=>{i&&11e3===i.code?this._upsert(e,t,r,n).then((e=>s(e))).catch((e=>h(e))):h(i)}))}else h(o)}))}))}_get(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},r);return this._collection.findOne(n)}_delete(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const r=t.attrs||{},n=Object.assign({key:e},r);return this._collection.deleteOne(n).then((e=>e.deletedCount>0))}}e.exports=o},54156:(e,t,r)=>{const n=r(91090),s=r(15155);e.exports=class extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(r),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((r,n)=>{if(r)return t(r);e(n)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((r=>{r.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,(n=>{if(n)return this._releaseConnection(r),t(n);r.query(this._getCreateTableStmt(),(n=>{if(n)return this._releaseConnection(r),t(n);this._releaseConnection(r),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if(void 0===e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName=void 0===e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new s,[i]=r;return n.isFirstInDuration=t===i.points,n.consumedPoints=n.isFirstInDuration?t:i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,n}_upsertTransaction(e,t,r,n,s){return new Promise(((i,o)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),o(a);const c=Date.now(),h=n>0?c+n:null;let l,u;s?(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",u=[this.dbName,this.tableName,t,r,h,r,h]):(l="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",u=[this.dbName,this.tableName,t,r,h,c,r,r,c,h]),e.query(l,u,(r=>{if(r)return e.rollback(),o(r);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,r)=>{if(t)return e.rollback(),o(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),o(t);i(r)}))}))}))}))}))}_upsert(e,t,r,n=!1){return this.tableCreated?new Promise(((s,i)=>{this._getConnection().then((o=>{this._upsertTransaction(o,e,t,r,n).then((e=>{s(e),this._releaseConnection(o)})).catch((e=>{i(e),this._releaseConnection(o)}))})).catch((e=>{i(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,s)=>{e?r(e):0===s.length?t(null):t(s),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,r)=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,s)=>{e?r(e):t(s.affectedRows>0),this._releaseConnection(n)}))})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}}},4832:(e,t,r)=>{const n=r(91090),s=r(15155);e.exports=class extends n{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?"function"==typeof t&&t():this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"==typeof t&&t()})).catch((e=>{if("function"!=typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{const r={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(r).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}_releaseConnection(e){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e)}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((r=>{"23505"===r.code?e():t(r)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if(void 0===e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName=void 0===e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated=void 0!==e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout=void 0===e||Boolean(e)}_getRateLimiterRes(e,t,r){const n=new s,i=r.rows[0];return n.isFirstInDuration=t===i.points,n.consumedPoints=n.isFirstInDuration?t:i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,n}_query(e){const t={name:`${this.tableName.toLowerCase()}:${e.name}`,text:e.text,values:e.values};return new Promise(((e,r)=>{this._getConnection().then((n=>{n.query(t).then((t=>{e(t),this._releaseConnection(n)})).catch((e=>{r(e),this._releaseConnection(n)}))})).catch((e=>{r(e)}))}))}_upsert(e,t,r,n=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const s=r>0?Date.now()+r:null,i=n?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;return this._query({name:n?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${n?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${i}\n            RETURNING points, expire;`,values:[e,t,s,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,r)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{r(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}},78686:(e,t,r)=>{const n=r(45255),s=4294967295,i="limiter";e.exports=class{constructor(e,t={maxQueueSize:s}){this._queueLimiters={KEY_DEFAULT:new o(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(e="limiter"){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,t="limiter"){return this._queueLimiters[t]||(this._queueLimiters[t]=new o(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class o{constructor(e,t={maxQueueSize:s,key:i}){this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((r,s)=>{e>t._limiterFlexible.points?s(new n(`Requested tokens ${e} exceeds maximum ${t._limiterFlexible.points} tokens per interval`)):t._queue.length>0?t._queueRequest.call(t,r,s,e):t._limiterFlexible.consume(t._key,e).then((e=>{r(e.remainingPoints)})).catch((n=>{n instanceof Error?s(n):(t._queueRequest.call(t,r,s,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),n.msBeforeNext)))}))}))}_queueRequest(e,t,r){const s=this;s._queue.length<s._maxQueueSize?s._queue.push({resolve:e,reject:t,tokens:r}):t(new n(`Number of requests reached it's maximum ${s._maxQueueSize}`))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((r=>{t.resolve(r.remainingPoints),e._processFIFO.call(e)})).catch((r=>{r instanceof Error?(t.reject(r),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),r.msBeforeNext)))}))}}},14636:(e,t,r)=>{const n=r(91090),s=r(15155),i="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";e.exports=class extends n{constructor(e){super(e),e.redis?this.client=e.redis:this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,"function"==typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:i})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"==typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,r){let[n,i]=r;Array.isArray(n)&&([,n]=n,[,i]=i);const o=new s;return o.consumedPoints=parseInt(n),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=i,o}_upsert(e,t,r,n=!1){return new Promise(((s,o)=>{if(!this._isRedisReady())return o(new Error("Redis connection is not ready"));const a=Math.floor(r/1e3),c=this.client.multi();if(n)a>0?c.set(e,t,"EX",a):c.set(e,t),c.pttl(e).exec(((e,t)=>e?o(e):s(t)));else if(a>0){const r=function(e,t){return e?o(e):s(t)};"function"==typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,a,r):this.client.eval(i,1,e,t,a,r)}else c.incrby(e,t).pttl(e).exec(((e,t)=>e?o(e):s(t)))}))}_get(e){return new Promise(((t,r)=>{if(!this._isRedisReady())return r(new Error("Redis connection is not ready"));this.client.multi().get(e).pttl(e).exec(((e,n)=>{if(e)r(e);else{const[e]=n;if(null===e)return t(null);t(n)}}))}))}_delete(e){return new Promise(((t,r)=>{this.client.del(e,((e,n)=>{e?r(e):t(n>0)}))}))}}},15155:e=>{e.exports=class{constructor(e,t,r,n){this.remainingPoints=void 0===e?0:e,this.msBeforeNext=void 0===t?0:t,this.consumedPoints=void 0===r?0:r,this.isFirstInDuration=void 0!==n&&n}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},91090:(e,t,r)=>{const n=r(81352),s=r(52423),i=r(15155);e.exports=class extends n{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed||e.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration||e.inmemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new s}get client(){return this._client}set client(e){if(void 0===e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,r,n,s,i={}){const o=this._getRateLimiterRes(r,n,s);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&o.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(r,o.msBeforeNext),o.consumedPoints>this.points?t(o):e(o);if(o.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&o.consumedPoints<=this.points+n&&(o.msBeforeNext=this.msBlockDuration,e=this._block(r,o.consumedPoints,this.msBlockDuration,i)),this.inMemoryBlockOnConsumed>0&&o.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(r,this.inMemoryBlockDuration),o.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(o)})).catch((e=>{t(e)}))}else if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let t=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=o.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,o)}else e(o)}_handleError(e,t,r,s,i,o=!1,a={}){this.insuranceLimiter instanceof n?this.insuranceLimiter[t](i,o,a).then((e=>{r(e)})).catch((e=>{s(e)})):s(e)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(e){return this.getInMemoryBlockMsBeforeExpire(e)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(e){this.inMemoryBlockOnConsumed=e}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(e){this.inMemoryBlockDuration=e}get msInmemoryBlockDuration(){return 1e3*this.inMemoryBlockDuration}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if(void 0!==e&&!(e instanceof n))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t,r={}){const n=1e3*t;return this._block(this.getKey(e),this.points+1,n,r)}set(e,t,r,n={}){const s=1e3*(r>=0?r:this.duration);return this._block(this.getKey(e),t,s,n)}consume(e,t=1,r={}){return new Promise(((n,s)=>{const o=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(o);if(a>0)return s(new i(0,a));this._upsert(o,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{this._afterConsume(n,s,o,t,e)})).catch((i=>{this._handleError(i,"consume",n,s,e,t,r)}))}))}penalty(e,t=1,r={}){const n=this.getKey(e);return new Promise(((s,i)=>{this._upsert(n,t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{s(this._getRateLimiterRes(n,t,e))})).catch((n=>{this._handleError(n,"penalty",s,i,e,t,r)}))}))}reward(e,t=1,r={}){const n=this.getKey(e);return new Promise(((s,i)=>{this._upsert(n,-t,1e3*this._getKeySecDuration(r),!1,r).then((e=>{s(this._getRateLimiterRes(n,-t,e))})).catch((n=>{this._handleError(n,"reward",s,i,e,t,r)}))}))}get(e,t={}){const r=this.getKey(e);return new Promise(((n,s)=>{this._get(r,t).then((e=>{n(null==e?null:this._getRateLimiterRes(r,0,e))})).catch((r=>{this._handleError(r,"get",n,s,e,t)}))}))}delete(e,t={}){const r=this.getKey(e);return new Promise(((n,s)=>{this._delete(r,t).then((e=>{this._inMemoryBlockedKeys.delete(r),n(e)})).catch((r=>{this._handleError(r,"delete",n,s,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,r){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,r,n={}){return new Promise(((s,o)=>{this._upsert(e,t,r,!0,n).then((()=>{s(new i(0,r>0?r:-1,t))})).catch((t=>{this._handleError(t,"block",s,o,this.parseKey(e),r/1e3,n)}))}))}_get(e,t={}){throw new Error("You have to implement the method '_get'!")}_delete(e,t={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,r,n=!1,s={}){throw new Error("You have to implement the method '_upsert'!")}}},33766:(e,t,r)=>{const n=r(81352);e.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach((e=>{if(!(e instanceof n))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=e}consume(e,t=1){return new Promise(((r,n)=>{const s=[];this._limiters.forEach((r=>{s.push(r.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(s).then((e=>{const t={};let s=!1;e.forEach((e=>{!0===e.rejected&&(s=!0)}));for(let r=0;r<e.length;r++)s&&!0===e[r].rejected?t[this._limiters[r].keyPrefix]=e[r].rej:s||(t[this._limiters[r].keyPrefix]=e[r]);s?n(t):r(t)}))}))}}},78894:e=>{e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},52423:(e,t,r)=>{const n=r(78894);e.exports=n},58425:(e,t,r)=>{const n=r(9250),s=r(15155);e.exports=class{constructor(){this._storage={}}incrby(e,t,r){if(this._storage[e]){const n=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==n?(this._storage[e].value=this._storage[e].value+t,new s(0,n,this._storage[e].value,!1)):this.set(e,t,r)}return this.set(e,t,r)}set(e,t,r){const i=1e3*r;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new n(t,i>0?new Date(Date.now()+i):null),i>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),i),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new s(0,0===i?-1:i,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new s(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},9250:e=>{e.exports=class{constructor(e,t,r=null){this.value=e,this.expiresAt=t,this.timeoutId=r}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},45255:e=>{e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},73692:(e,t,r)=>{"use strict";e.exports=o;var n=r(57824),s=o.prototype,i=new Date%1e9;function o(e){e=e||{},this.id=e.id||(1e9*Math.random()>>>0)+i++,this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,r,n=this.items.length;n--;)t=this.items[n],r=new Date(t.expires)-new Date,this._lookup[t.key]=t,r>0?this.expire(t.key,r):r<=0&&this.delete(t.key)}s.has=function(e){return e in this._lookup},s.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},s.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},s.set=function(e,t,r){var n=this._lookup[e],s=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,s)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(s),this.size++),r&&("ttl"in r&&this.expire(e,r.ttl),"meta"in r&&(s.meta=r.meta),r.refresh&&(s.refresh=r.ttl)),this},s.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},s.expire=function(e,t){var r=t||0,s=this._lookup[e];if(!s)return this;if("string"==typeof r&&(r=n(t)),"number"!=typeof r)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(s.timeout),s.timeout=setTimeout(this.delete.bind(this,s.key),r),s.expires=Number(new Date)+r,this},s.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},s.toJSON=function(){for(var e,t=new Array(this.items.length),r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},82916:(e,t,r)=>{"use strict";const n=r(41807);class s{constructor(e,t,r){const s=this;this._started=n(),this._rescheduled=0,this._scheduled=t,this._args=r,this._triggered=!1,this._timerWrapper=()=>{s._rescheduled>0?(s._scheduled=s._rescheduled-(n()-s._started),s._schedule(s._scheduled)):(s._triggered=!0,e.apply(null,s._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);const t=n();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=n(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}}e.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("timeout needed");let e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new s(arguments[0],arguments[1],e)}},41807:e=>{"use strict";e.exports=function(){return Date.now()}},29967:(e,t,r)=>{e.exports=function(e,t,r){if("number"!=typeof t)throw new Error("second argument must be a Number");let s,i,o,a,c,h,l=!0;Array.isArray(e)?(s=[],o=i=e.length):(a=Object.keys(e),s={},o=i=a.length);function u(e){function t(){r&&r(e,s),r=null}l?n(t):t()}function d(t,r,n){if(s[t]=n,r&&(c=!0),0==--o||r)u(r);else if(!c&&h<i){let t;a?(t=a[h],h+=1,e[t]((function(e,r){d(t,e,r)}))):(t=h,h+=1,e[t]((function(e,r){d(t,e,r)})))}}h=t,o?a?a.some((function(r,n){return e[r]((function(e,t){d(r,e,t)})),n===t-1})):e.some((function(e,r){return e((function(e,t){d(r,e,t)})),r===t-1})):u(null);l=!1};const n=r(54375)},89509:(e,t,r)=>{var n=r(48764),s=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return s(e,t,r)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=o),o.prototype=Object.create(s.prototype),i(s,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},50202:(e,t,r)=>{"use strict";var n=r(63700),s=/[\/\?<>\\:\*\|"]/g,i=/[\x00-\x1f\x80-\x9f]/g,o=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function h(e,t){if("string"!=typeof e)throw new Error("Input must be string");var r=e.replace(s,t).replace(i,t).replace(o,t).replace(a,t).replace(c,t);return n(r,255)}e.exports=function(e,t){var r=t&&t.replacement||"",n=h(e,r);return""===r?n:h(n,"")}},27695:e=>{"use strict";const t=new Map;e.exports={setDelayedInterval:function(e,r,n){n=n||r;const s=`${Date.now()}:${Math.floor(1e6*Math.random())}`,i=setTimeout((()=>{!async function(e,r,n){for(;t.get(n);){try{await e()}catch(e){setTimeout((()=>{throw e}),1);break}if(!t.get(n))break;await new Promise((e=>{const s=setTimeout(e,r);t.set(n,s)}))}}(e,r,s)}),n);return t.set(s,i),s},clearDelayedInterval:function(e){const r=t.get(e);r&&(clearTimeout(r),t.delete(e))}}},20544:e=>{"use strict";function t(e,t){return e+r(t)}function r(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function n(e,t){return e[0]-t[0]}function s(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);for(;t<this.length;)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,n=t;for(;r<this.length;){n=e(n,this.get(r),r),r++}return n}find(e){let t,r,n=0;for(;n<this.length&&!t;)r=this.get(n),t=e(r),n++;return t?r:void 0}_internalPositionFor(e,n){const s=this._bytePosFor(e,n);if(s>=this._bitArrays.length)return-1;const i=this._bitArrays[s],o=e-7*s;if(!((i&1<<o)>0))return-1;return this._bitArrays.slice(0,s).reduce(t,0)+r(i&~(4294967295<<o+1))-1}_bytePosFor(e,t){const r=Math.floor(e/7),n=r+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return r}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}_setInternalPos(e,t,r,n){const s=this._data,i=[t,r];if(n)this._sortData(),s[e]=i;else{if(s.length)if(s[s.length-1][0]>=t)s.push(i);else if(s[0][0]<=t)s.unshift(i);else{const e=Math.round(s.length/2);this._data=s.slice(0,e).concat(i).concat(s.slice(e))}else this._data.push(i);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(n),this._changedData=!1}bitField(){const e=[];let t,r=8,n=0,s=0;const i=this._bitArrays.slice();for(;i.length||n;){0===n&&(t=i.shift(),n=7);const o=Math.min(n,r);s|=(t&~(255<<o))<<8-r,t>>>=o,n-=o,r-=o,r&&(n||i.length)||(e.push(s),s=0,r=8)}for(var o=e.length-1;o>0;o--){if(0!==e[o])break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(s)}}},50590:e=>{e.exports=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}();throw new Error("unknown stream")}},10715:(e,t,r)=>{"use strict";const{AbortController:n}=globalThis,s=r(82916);class i extends n{constructor(e){super(),this._ms=e,this._timer=s((()=>this.abort()),e),Object.setPrototypeOf(this,i.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=s((()=>this.abort()),this._ms)}}e.exports={TimeoutController:i}},84957:e=>{!function(){e.exports=g;var t=86400,r=3200,n=1168776,s=100982246400,i=1e3*s,o=864e13,a=4294967296,c=1e6,h=1e9,l="000000000",u=Math.trunc||function(e){var t=e-e%1;return 0===t&&(e<0||0===e&&1/e!=1/0)?-0:t},d=g.prototype;g.fromDate=function(e){return new g(+e)},g.fromInt64BE=E(0,1,2,3,0,4),g.fromInt64LE=E(3,2,1,0,4,0),g.fromString=function(e){var t,r=new g,n=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=+e,n=1970+(t-1970)%400;return r.year=t-n,n})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,r,n){return r<0&&(n*=-1),t=6e4*(60*+r+ +n),""})).replace(/\.\d+$/,(function(e){return r.nano=+(e+l).substr(1,9),""})).split(/\D+/);n.length>1?n[1]--:n[1]=0;if(r.time=t=Date.UTC.apply(Date,n)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return b(r)},g.fromTimeT=function(e){return w(e,0)},d.year=0,d.time=0,d.nano=0,d.addNano=function(e){return this.nano+=+e||0,this},d.getNano=function(){var e=b(this);return(e.time%1e3*c+ +e.nano+h)%h},d.getTimeT=function(){var e=b(this),s=Math.floor(e.time/1e3),i=e.year;i&&(s+=i*n*t/r);return s},d.getYear=function(){return this.toDate().getUTCFullYear()+this.year},d.toDate=function(){return m(b(this).time)},d.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},d.toString=function(e){var t=this,r=t.toDate(),n={H:function(){return S(r.getUTCHours())},L:function(){return _(r.getUTCMilliseconds(),3)},M:function(){return S(r.getUTCMinutes())},N:function(){return _(t.getNano(),9)},S:function(){return S(r.getUTCSeconds())},Y:function(){var e=t.getYear();return e>999999?"+"+e:e>9999?"+"+_(e,6):e>=0?_(e,4):e>=-999999?"-"+_(-e,6):e},a:function(){return p[r.getUTCDay()]},b:function(){return f[r.getUTCMonth()]},d:function(){return S(r.getUTCDate())},e:function(){return e=r.getUTCDate(),(e>9?"":" ")+(0|e);var e},m:function(){return S(r.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var r=t[1],s=y[r],i=n[r];return s?e(s):i?i():t}))}(e||"%Y-%m-%dT%H:%M:%S.%NZ")},d.writeInt64BE=v(0,1,2,3,0,4),d.writeInt64LE=v(3,2,1,0,4,0);var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],y={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return g;function g(e,t,r){var n=this;if(!(n instanceof g))return new g(e,t,r);n.time=+e||0,n.nano=+t||0,n.year=+r||0,b(n)}function b(e){var t,n,s=e.year,a=e.time,h=e.nano;if(h<0||c<=h){var l=Math.floor(h/c);h-=l*c,a+=l,t=1}var d=s%r;if(a<-o||o<a||d){(n=u(a/i))&&(s+=n*r,a-=n*i);var f=m(a);f.setUTCFullYear(d+f.getUTCFullYear());var p=(a=+f)+(n=u((s-=d)/r))*i;n&&-o<=p&&p<=o&&(s-=n*r,a=p),t=1}return t&&(e.year=s,e.time=a,e.nano=h),e}function m(e){var t=new Date(0);return t.setTime(e),t}function w(e,t){t|=0,e=+e||0;var n=u((t*=a)/s)+u(e/s),i=t%s+e%s,o=u(i/s);return o&&(n+=o,i-=o*s),new g(1e3*i,0,n*r)}function v(e,t,r,n,s,i){return function(e,t){var r=b(this);e||(e=new Array(8));A(e,t|=0);var n=Math.floor(r.time/1e3),c=31556952*r.year,h=u(c/a)+u(n/a),l=c%a+n%a,d=Math.floor(l/a);d&&(h+=d,l-=d*a);return o(e,t+s,h),o(e,t+i,l),e};function o(s,i,o){s[i+e]=o>>24&255,s[i+t]=o>>16&255,s[i+r]=o>>8&255,s[i+n]=255&o}}function E(e,t,r,n,s,i){return function(e,t){A(e,t|=0);var r=o(e,t+s);return w(o(e,t+i),r)};function o(s,i){return 16777216*s[i+e]+(s[i+t]<<16|s[i+r]<<8|s[i+n])}}function A(e,t){var r=e&&e.length;if(null==r)throw new TypeError("Invalid Buffer");if(r<t+8)throw new RangeError("Out of range")}function S(e){return(e>9?"":"0")+(0|e)}function _(e,t){return(l+(0|e)).substr(-t)}}()},63700:(e,t,r)=>{"use strict";var n=r(71156),s=r(90793);e.exports=n.bind(null,s)},71156:e=>{"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e,n,s){if("string"!=typeof n)throw new Error("Input must be string");for(var i,o,a=n.length,c=0,h=0;h<a;h+=1){if(i=n.charCodeAt(h),o=n[h],t(i)&&r(n.charCodeAt(h+1))&&(o+=n[h+=1]),(c+=e(o))===s)return n.slice(0,h+1);if(c>s)return n.slice(0,h-o.length+1)}return n}},55746:(e,t,r)=>{const n=r(58594),{Multiaddr:s}=r(46584);function i(e,t){if(!e)return null;if(n.v4(e))return["ip4",e];if(n.v6(e))return["ip6",e];if("["===e[0]){const t=e.substring(1,e.length-1);if(n.v6(t))return["ip6",t]}return[t,e]}function o(e,t){return e?"udp"===t?["udp",e]:["tcp",e]:null}function a(e){return e.match(/^tcp$|^udp$/)?null:[e]}e.exports=function(e,t){const r=(t=t||{}).defaultDnsType||"dns4",{scheme:n,hostname:c,port:h}=function(e){let{protocol:t,hostname:r,port:n}=new URL(e);const s=t.slice(0,-1);n||0===n||(n=function(e){if(!e)return null;return{http:"80",https:"443",ws:"80",wss:"443"}[e]}(s));return{scheme:s,hostname:r,port:n}}(e),l="/"+[i(c,r),o(h,n),a(n)].filter((e=>!!e)).reduce(((e,t)=>e.concat(t))).join("/");return new s(l)}},11447:e=>{"use strict";const t="[a-fA-F\\d:]",r=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${t})|(?<=${t})(?=\\s|$))`:"",n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",i=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${n}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${n}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${n}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${n}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${n}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${n}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${n}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=new RegExp(`(?:^${n}$)|(?:^${i}$)`),a=new RegExp(`^${n}$`),c=new RegExp(`^${i}$`),h=e=>e&&e.exact?o:new RegExp(`(?:${r(e)}${n}${r(e)})|(?:${r(e)}${i}${r(e)})`,"g");h.v4=e=>e&&e.exact?a:new RegExp(`${r(e)}${n}${r(e)}`,"g"),h.v6=e=>e&&e.exact?c:new RegExp(`${r(e)}${i}${r(e)}`,"g"),e.exports=h},58594:(e,t,r)=>{"use strict";const n=r(11447),s=e=>n({exact:!0}).test(e);s.v4=e=>n.v4({exact:!0}).test(e),s.v6=e=>n.v6({exact:!0}).test(e),s.version=e=>s(e)?s.v4(e)?4:6:void 0,e.exports=s},90793:e=>{"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!=typeof e)throw new Error("Input must be string");for(var n=e.length,s=0,i=null,o=null,a=0;a<n;a++)r(i=e.charCodeAt(a))?null!=o&&t(o)?s+=1:s+=3:i<=127?s+=1:i>=128&&i<=2047?s+=2:i>=2048&&i<=65535&&(s+=3),o=i;return s}},20384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},55955:(e,t,r)=>{"use strict";var n=r(82584),s=r(48662),i=r(86430),o=r(85692);function a(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,h="undefined"!=typeof Symbol,l=a(Object.prototype.toString),u=a(Number.prototype.valueOf),d=a(String.prototype.valueOf),f=a(Boolean.prototype.valueOf);if(c)var p=a(BigInt.prototype.valueOf);if(h)var y=a(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function b(e){return"[object Map]"===l(e)}function m(e){return"[object Set]"===l(e)}function w(e){return"[object WeakMap]"===l(e)}function v(e){return"[object WeakSet]"===l(e)}function E(e){return"[object ArrayBuffer]"===l(e)}function A(e){return"undefined"!=typeof ArrayBuffer&&(E.working?E(e):e instanceof ArrayBuffer)}function S(e){return"[object DataView]"===l(e)}function _(e){return"undefined"!=typeof DataView&&(S.working?S(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=s,t.isTypedArray=o,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):o(e)||_(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},b.working="undefined"!=typeof Map&&b(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(b.working?b(e):e instanceof Map)},m.working="undefined"!=typeof Set&&m(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(m.working?m(e):e instanceof Set)},w.working="undefined"!=typeof WeakMap&&w(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(w.working?w(e):e instanceof WeakMap)},v.working="undefined"!=typeof WeakSet&&v(new WeakSet),t.isWeakSet=function(e){return v(e)},E.working="undefined"!=typeof ArrayBuffer&&E(new ArrayBuffer),t.isArrayBuffer=A,S.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&S(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=_;var C="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function k(e){return"[object SharedArrayBuffer]"===l(e)}function I(e){return void 0!==C&&(void 0===k.working&&(k.working=k(new C)),k.working?k(e):e instanceof C)}function T(e){return g(e,u)}function x(e){return g(e,d)}function R(e){return g(e,f)}function P(e){return c&&g(e,p)}function D(e){return h&&g(e,y)}t.isSharedArrayBuffer=I,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=T,t.isStringObject=x,t.isBooleanObject=R,t.isBigIntObject=P,t.isSymbolObject=D,t.isBoxedPrimitive=function(e){return T(e)||x(e)||R(e)||P(e)||D(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(A(e)||I(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},89539:(e,t,r)=>{var n=r(34155),s=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!w(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(h(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,s=n.length,o=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=s)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<s;a=n[++r])b(a)||!A(a)?o+=" "+a:o+=" "+h(a);return o},t.deprecate=function(e,r){if(void 0!==n&&!0===n.noDeprecation)return e;if(void 0===n)return function(){return t.deprecate(e,r).apply(this,arguments)};var s=!1;return function(){if(!s){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),s=!0}return e.apply(this,arguments)}};var o={},a=/^$/;if({IPFS_MONITORING:!1,DEBUG:!1}.NODE_DEBUG){var c={IPFS_MONITORING:!1,DEBUG:!1}.NODE_DEBUG;c=c.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+c+"$","i")}function h(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(r)?n.showHidden=r:r&&t._extend(n,r),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),d(n,e,n.depth)}function l(e,t){var r=h.styles[t];return r?"["+h.colors[r][0]+"m"+e+"["+h.colors[r][1]+"m":e}function u(e,t){return e}function d(e,r,n){if(e.customInspect&&r&&C(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var s=r.inspect(n,e);return w(s)||(s=d(e,s,n)),s}var i=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(w(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(m(t))return e.stylize(""+t,"number");if(g(t))return e.stylize(""+t,"boolean");if(b(t))return e.stylize("null","null")}(e,r);if(i)return i;var o=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),_(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return f(r);if(0===o.length){if(C(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(E(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return e.stylize(Date.prototype.toString.call(r),"date");if(_(r))return f(r)}var h,l="",u=!1,A=["{","}"];(y(r)&&(u=!0,A=["[","]"]),C(r))&&(l=" [Function"+(r.name?": "+r.name:"")+"]");return E(r)&&(l=" "+RegExp.prototype.toString.call(r)),S(r)&&(l=" "+Date.prototype.toUTCString.call(r)),_(r)&&(l=" "+f(r)),0!==o.length||u&&0!=r.length?n<0?E(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),h=u?function(e,t,r,n,s){for(var i=[],o=0,a=t.length;o<a;++o)R(t,String(o))?i.push(p(e,t,r,n,String(o),!0)):i.push("");return s.forEach((function(s){s.match(/^\d+$/)||i.push(p(e,t,r,n,s,!0))})),i}(e,r,n,a,o):o.map((function(t){return p(e,r,n,a,t,u)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(h,l,A)):A[0]+l+A[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,s,i){var o,a,c;if((c=Object.getOwnPropertyDescriptor(t,s)||{value:t[s]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),R(n,s)||(o="["+s+"]"),a||(e.seen.indexOf(c.value)<0?(a=b(r)?d(e,c.value,null):d(e,c.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),v(o)){if(i&&s.match(/^\d+$/))return a;(o=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.slice(1,-1),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function y(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function b(e){return null===e}function m(e){return"number"==typeof e}function w(e){return"string"==typeof e}function v(e){return void 0===e}function E(e){return A(e)&&"[object RegExp]"===k(e)}function A(e){return"object"==typeof e&&null!==e}function S(e){return A(e)&&"[object Date]"===k(e)}function _(e){return A(e)&&("[object Error]"===k(e)||e instanceof Error)}function C(e){return"function"==typeof e}function k(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!o[e])if(a.test(e)){var r=n.pid;o[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else o[e]=function(){};return o[e]},t.inspect=h,h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},h.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(55955),t.isArray=y,t.isBoolean=g,t.isNull=b,t.isNullOrUndefined=function(e){return null==e},t.isNumber=m,t.isString=w,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=E,t.types.isRegExp=E,t.isObject=A,t.isDate=S,t.types.isDate=S,t.isError=_,t.types.isNativeError=_,t.isFunction=C,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(20384);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":");return[e.getDate(),T[e.getMonth()],t].join(" ")}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",x(),t.format.apply(t,arguments))},t.inherits=r(35717),t._extend=function(e,t){if(!t||!A(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),s=[],i=0;i<arguments.length;i++)s.push(arguments[i]);s.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,s)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,s(e))},t.promisify.custom=P,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var s=t.pop();if("function"!=typeof s)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return s.apply(i,arguments)};e.apply(this,t).then((function(e){n.nextTick(o.bind(null,null,e))}),(function(e){n.nextTick(D.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,s(e)),t}},23209:e=>{e.exports=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s}},7089:e=>{e.exports=function e(r,n,s){n=n||[];var i=s=s||0;for(;r>=t;)n[s++]=255&r|128,r/=128;for(;-128&r;)n[s++]=255&r|128,r>>>=7;return n[s]=0|r,e.bytes=s-i+1,n};var t=Math.pow(2,31)},13924:(e,t,r)=>{e.exports={encode:r(7089),decode:r(23209),encodingLength:r(64146)}},64146:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),h=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<s?4:e<i?5:e<o?6:e<a?7:e<c?8:e<h?9:10}},82838:(e,t,r)=>{"use strict";const n=r(13924);e.exports=e=>{if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];for(;e.length>0;){const r=n.decode(e);t.push(r),e=e.slice(n.decode.bytes)}return t}},26988:e=>{e.exports=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a||i>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s}},1312:e=>{e.exports=function e(r,n,s){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");n=n||[];var i=s=s||0;for(;r>=t;)n[s++]=255&r|128,r/=128;for(;-128&r;)n[s++]=255&r|128,r>>>=7;return n[s]=0|r,e.bytes=s-i+1,n};var t=Math.pow(2,31)},94676:(e,t,r)=>{e.exports={encode:r(1312),decode:r(26988),encodingLength:r(10082)}},10082:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),h=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<s?4:e<i?5:e<o?6:e<a?7:e<c?8:e<h?9:10}},47259:(e,t,r)=>{"use strict";t.TextEncoder="undefined"!=typeof TextEncoder?TextEncoder:r(89539).TextEncoder,t.TextDecoder="undefined"!=typeof TextDecoder?TextDecoder:r(89539).TextDecoder},93150:function(e,t){var r,n,s;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=[e],r=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",r=e=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const s=e=>e&&"object"==typeof e&&"function"==typeof e.then,i=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},o=e=>1==e?"argument":"arguments",a=(e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((s,o)=>{if(t.fallbackToNoCallback)try{r[e](...n,i({resolve:s,reject:o},t))}catch(i){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,i),r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(r[e](...n),s()):r[e](...n,i({resolve:s,reject:o},t))}))},c=(e,t,r)=>new Proxy(t,{apply:(t,n,s)=>r.call(n,e,...s)});let h=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},r={})=>{let n=Object.create(null),s={has:(t,r)=>r in e||r in n,get(s,i,o){if(i in n)return n[i];if(!(i in e))return;let u=e[i];if("function"==typeof u)if("function"==typeof t[i])u=c(e,e[i],t[i]);else if(h(r,i)){let t=a(i,r[i]);u=c(e,e[i],t)}else u=u.bind(e);else if("object"==typeof u&&null!==u&&(h(t,i)||h(r,i)))u=l(u,t[i],r[i]);else{if(!h(r,"*"))return Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:()=>e[i],set(t){e[i]=t}}),u;u=l(u,t[i],r["*"])}return n[i]=u,u},set:(t,r,s,i)=>(r in n?n[r]=s:e[r]=s,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(n,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(n,t)},i=Object.create(e);return new Proxy(i,s)},u=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),d=new n((e=>"function"!=typeof e?e:function(t){const r=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)})),f=new n((e=>"function"!=typeof e?e:function(t,r,n){let i,o,a=!1,c=new Promise((e=>{i=function(t){a=!0,e(t)}}));try{o=e(t,r,i)}catch(e){o=Promise.reject(e)}const h=!0!==o&&s(o);if(!0!==o&&!h&&!a)return!1;const l=e=>{e.then((e=>{n(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",n({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return l(h?o:c),!0})),p=({reject:r,resolve:n},s)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?r(new Error(s.message)):n(s)},y=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const s=p.bind(null,{resolve:e,reject:t});n.push(s),r.sendMessage(...n)}))},g={devtools:{network:{onRequestFinished:u(d)}},runtime:{onMessage:u(f),onMessageExternal:u(f),sendMessage:y.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:y.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},b={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":b},services:{"*":b},websites:{"*":b}},l(e,g,r)};e.exports=r(chrome)}else e.exports=globalThis.browser},void 0===(s="function"==typeof r?r.apply(t,n):r)||(e.exports=s)},86430:(e,t,r)=>{"use strict";var n=r(94029),s=r(63083),i=r(21924),o=r(27296),a=i("Object.prototype.toString"),c=r(96410)(),h="undefined"==typeof globalThis?window:globalThis,l=s(),u=i("String.prototype.slice"),d={},f=Object.getPrototypeOf;c&&o&&f&&n(l,(function(e){if("function"==typeof h[e]){var t=new h[e];if(Symbol.toStringTag in t){var r=f(t),n=o(r,Symbol.toStringTag);if(!n){var s=f(r);n=o(s,Symbol.toStringTag)}d[e]=n.get}}}));var p=r(85692);e.exports=function(e){return!!p(e)&&(c&&Symbol.toStringTag in e?function(e){var t=!1;return n(d,(function(r,n){if(!t)try{var s=r.call(e);s===n&&(t=s)}catch(e){}})),t}(e):u(a(e),8,-1))}},7420:()=>{},95856:()=>{},35883:()=>{},52596:()=>{},63897:()=>{},85104:()=>{},25819:()=>{},81265:()=>{},35539:()=>{},64482:function(e,t,r){"use strict";var n,s,i;s=[r(42450)],void 0===(i="function"==typeof(n=function(e){var t=e.Reader,r=e.Writer,n=e.util,s=e.roots.default||(e.roots.default={});return s.RPC=function(){function i(e){if(this.subscriptions=[],this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.subscriptions=n.emptyArray,i.prototype.messages=n.emptyArray,i.prototype.control=null,Object.defineProperty(i.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.subscriptions&&e.subscriptions.length)for(var n=0;n<e.subscriptions.length;++n)s.RPC.SubOpts.encode(e.subscriptions[n],t.uint32(10).fork()).ldelim();if(null!=e.messages&&e.messages.length)for(n=0;n<e.messages.length;++n)s.RPC.Message.encode(e.messages[n],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&s.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.push(s.RPC.SubOpts.decode(e,e.uint32()));break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.push(s.RPC.Message.decode(e,e.uint32()));break;case 3:i.control=s.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC)return e;var t=new s.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!=typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=s.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".RPC.messages: array expected");for(t.messages=[],r=0;r<e.messages.length;++r){if("object"!=typeof e.messages[r])throw TypeError(".RPC.messages: object expected");t.messages[r]=s.RPC.Message.fromObject(e.messages[r])}}if(null!=e.control){if("object"!=typeof e.control)throw TypeError(".RPC.control: object expected");t.control=s.RPC.ControlMessage.fromObject(e.control)}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.messages=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var n=0;n<e.subscriptions.length;++n)r.subscriptions[n]=s.RPC.SubOpts.toObject(e.subscriptions[n],t)}if(e.messages&&e.messages.length)for(r.messages=[],n=0;n<e.messages.length;++n)r.messages[n]=s.RPC.Message.toObject(e.messages[n],t);return null!=e.control&&e.hasOwnProperty("control")&&(r.control=s.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(r._control="control")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.SubOpts=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.subscribe=null,i.prototype.topic=null,Object.defineProperty(i.prototype,"_subscribe",{get:n.oneOfGetter(o=["subscribe"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_topic",{get:n.oneOfGetter(o=["topic"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(18).string(e.topic),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.SubOpts;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.subscribe=e.bool();break;case 2:i.topic=e.string();break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.SubOpts)return e;var t=new s.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topic&&(t.topic=String(e.topic)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe,t.oneofs&&(r._subscribe="subscribe")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic,t.oneofs&&(r._topic="topic")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.Message=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.from=null,i.prototype.data=null,i.prototype.seqno=null,i.prototype.topic="",i.prototype.signature=null,i.prototype.key=null,Object.defineProperty(i.prototype,"_from",{get:n.oneOfGetter(o=["from"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_data",{get:n.oneOfGetter(o=["data"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_seqno",{get:n.oneOfGetter(o=["seqno"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signature",{get:n.oneOfGetter(o=["signature"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_key",{get:n.oneOfGetter(o=["key"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),t.uint32(34).string(e.topic),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var i=void 0===r?e.len:e.pos+r,o=new s.RPC.Message;e.pos<i;){var a=e.uint32();switch(a>>>3){case 1:o.from=e.bytes();break;case 2:o.data=e.bytes();break;case 3:o.seqno=e.bytes();break;case 4:o.topic=e.string();break;case 5:o.signature=e.bytes();break;case 6:o.key=e.bytes();break;default:e.skipType(7&a)}}if(!o.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:o});return o},i.fromObject=function(e){if(e instanceof s.RPC.Message)return e;var t=new s.RPC.Message;return null!=e.from&&("string"==typeof e.from?n.base64.decode(e.from,t.from=n.newBuffer(n.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"==typeof e.data?n.base64.decode(e.data,t.data=n.newBuffer(n.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"==typeof e.seqno?n.base64.decode(e.seqno,t.seqno=n.newBuffer(n.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),null!=e.topic&&(t.topic=String(e.topic)),null!=e.signature&&("string"==typeof e.signature?n.base64.decode(e.signature,t.signature=n.newBuffer(n.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"==typeof e.key?n.base64.decode(e.key,t.key=n.newBuffer(n.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},i.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.topic=""),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?n.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(r._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?n.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(r._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?n.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(r._seqno="seqno")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?n.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(r._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?n.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(r._key="key")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlMessage=function(){function i(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.ihave=n.emptyArray,i.prototype.iwant=n.emptyArray,i.prototype.graft=n.emptyArray,i.prototype.prune=n.emptyArray,i.encode=function(e,t){if(t||(t=r.create()),null!=e.ihave&&e.ihave.length)for(var n=0;n<e.ihave.length;++n)s.RPC.ControlIHave.encode(e.ihave[n],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(n=0;n<e.iwant.length;++n)s.RPC.ControlIWant.encode(e.iwant[n],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(n=0;n<e.graft.length;++n)s.RPC.ControlGraft.encode(e.graft[n],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(n=0;n<e.prune.length;++n)s.RPC.ControlPrune.encode(e.prune[n],t.uint32(34).fork()).ldelim();return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlMessage;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.ihave&&i.ihave.length||(i.ihave=[]),i.ihave.push(s.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:i.iwant&&i.iwant.length||(i.iwant=[]),i.iwant.push(s.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:i.graft&&i.graft.length||(i.graft=[]),i.graft.push(s.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:i.prune&&i.prune.length||(i.prune=[]),i.prune.push(s.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlMessage)return e;var t=new s.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var r=0;r<e.ihave.length;++r){if("object"!=typeof e.ihave[r])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[r]=s.RPC.ControlIHave.fromObject(e.ihave[r])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");for(t.iwant=[],r=0;r<e.iwant.length;++r){if("object"!=typeof e.iwant[r])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[r]=s.RPC.ControlIWant.fromObject(e.iwant[r])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");for(t.graft=[],r=0;r<e.graft.length;++r){if("object"!=typeof e.graft[r])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[r]=s.RPC.ControlGraft.fromObject(e.graft[r])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");for(t.prune=[],r=0;r<e.prune.length;++r){if("object"!=typeof e.prune[r])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[r]=s.RPC.ControlPrune.fromObject(e.prune[r])}}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ihave=[],r.iwant=[],r.graft=[],r.prune=[]),e.ihave&&e.ihave.length){r.ihave=[];for(var n=0;n<e.ihave.length;++n)r.ihave[n]=s.RPC.ControlIHave.toObject(e.ihave[n],t)}if(e.iwant&&e.iwant.length)for(r.iwant=[],n=0;n<e.iwant.length;++n)r.iwant[n]=s.RPC.ControlIWant.toObject(e.iwant[n],t);if(e.graft&&e.graft.length)for(r.graft=[],n=0;n<e.graft.length;++n)r.graft[n]=s.RPC.ControlGraft.toObject(e.graft[n],t);if(e.prune&&e.prune.length)for(r.prune=[],n=0;n<e.prune.length;++n)r.prune[n]=s.RPC.ControlPrune.toObject(e.prune[n],t);return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIHave=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,i.prototype.messageIDs=n.emptyArray,Object.defineProperty(i.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(18).bytes(e.messageIDs[n]);return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlIHave;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes());break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlIHave)return e;var t=new s.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"==typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var s=0;s<e.messageIDs.length;++s)r.messageIDs[s]=t.bytes===String?n.base64.encode(e.messageIDs[s],0,e.messageIDs[s].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[s]):e.messageIDs[s]}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIWant=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return i.prototype.messageIDs=n.emptyArray,i.encode=function(e,t){if(t||(t=r.create()),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(10).bytes(e.messageIDs[n]);return t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlIWant;e.pos<n;){var o=e.uint32();o>>>3==1?(i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes())):e.skipType(7&o)}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlIWant)return e;var t=new s.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"==typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var s=0;s<e.messageIDs.length;++s)r.messageIDs[s]=t.bytes===String?n.base64.encode(e.messageIDs[s],0,e.messageIDs[s].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[s]):e.messageIDs[s]}return r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlGraft=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,Object.defineProperty(i.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlGraft;e.pos<n;){var o=e.uint32();o>>>3==1?i.topicID=e.string():e.skipType(7&o)}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlGraft)return e;var t=new s.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlPrune=function(){function i(e){if(this.peers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.topicID=null,i.prototype.peers=n.emptyArray,i.prototype.backoff=null,Object.defineProperty(i.prototype,"_topicID",{get:n.oneOfGetter(o=["topicID"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_backoff",{get:n.oneOfGetter(o=["backoff"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var n=0;n<e.peers.length;++n)s.RPC.PeerInfo.encode(e.peers[n],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.ControlPrune;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.peers&&i.peers.length||(i.peers=[]),i.peers.push(s.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlPrune)return e;var t=new s.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var r=0;r<e.peers.length;++r){if("object"!=typeof e.peers[r])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[r]=s.RPC.PeerInfo.fromObject(e.peers[r])}}return null!=e.backoff&&(n.Long?(t.backoff=n.Long.fromValue(e.backoff)).unsigned=!0:"string"==typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"==typeof e.backoff?t.backoff=e.backoff:"object"==typeof e.backoff&&(t.backoff=new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.peers&&e.peers.length){r.peers=[];for(var i=0;i<e.peers.length;++i)r.peers[i]=s.RPC.PeerInfo.toObject(e.peers[i],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"==typeof e.backoff?r.backoff=t.longs===String?String(e.backoff):e.backoff:r.backoff=t.longs===String?n.Long.prototype.toString.call(e.backoff):t.longs===Number?new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(r._backoff="backoff")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.PeerInfo=function(){function i(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var o;return i.prototype.peerID=null,i.prototype.signedPeerRecord=null,Object.defineProperty(i.prototype,"_peerID",{get:n.oneOfGetter(o=["peerID"]),set:n.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signedPeerRecord",{get:n.oneOfGetter(o=["signedPeerRecord"]),set:n.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=r.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},i.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,i=new s.RPC.PeerInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:i.peerID=e.bytes();break;case 2:i.signedPeerRecord=e.bytes();break;default:e.skipType(7&o)}}return i},i.fromObject=function(e){if(e instanceof s.RPC.PeerInfo)return e;var t=new s.RPC.PeerInfo;return null!=e.peerID&&("string"==typeof e.peerID?n.base64.decode(e.peerID,t.peerID=n.newBuffer(n.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"==typeof e.signedPeerRecord?n.base64.decode(e.signedPeerRecord,t.signedPeerRecord=n.newBuffer(n.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},i.toObject=function(e,t){t||(t={});var r={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(r.peerID=t.bytes===String?n.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(r._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?n.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(r._signedPeerRecord="signedPeerRecord")),r},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i}(),s})?n.apply(t,s):n)||(e.exports=i)},63083:e=>{"use strict";var t=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],r="undefined"==typeof globalThis?window:globalThis;e.exports=function(){for(var e=[],n=0;n<t.length;n++)"function"==typeof r[t[n]]&&(e[e.length]=t[n]);return e}},92912:(e,t,r)=>{"use strict";r.d(t,{t:()=>Rt});var n={};r.r(n),r.d(n,{identity:()=>Q});var s={};r.r(s),r.d(s,{base2:()=>Z});var i={};r.r(i),r.d(i,{base8:()=>X});var o={};r.r(o),r.d(o,{base10:()=>ee});var a={};r.r(a),r.d(a,{base16:()=>te,base16upper:()=>re});var c={};r.r(c),r.d(c,{base32:()=>ne,base32hex:()=>ae,base32hexpad:()=>he,base32hexpadupper:()=>le,base32hexupper:()=>ce,base32pad:()=>ie,base32padupper:()=>oe,base32upper:()=>se,base32z:()=>ue});var h={};r.r(h),r.d(h,{base36:()=>de,base36upper:()=>fe});var l={};r.r(l),r.d(l,{base58btc:()=>pe,base58flickr:()=>ye});var u={};r.r(u),r.d(u,{base64:()=>ge,base64pad:()=>be,base64url:()=>me,base64urlpad:()=>we});var d={};r.r(d),r.d(d,{base256emoji:()=>Se});var f={};r.r(f),r.d(f,{sha256:()=>qe,sha512:()=>Ke});var p={};r.r(p),r.d(p,{identity:()=>Ge});var y={};r.r(y),r.d(y,{code:()=>Je,decode:()=>Qe,encode:()=>Ye,name:()=>We});var g={};r.r(g),r.d(g,{code:()=>tt,decode:()=>nt,encode:()=>rt,name:()=>et});var b=r(51816),m=r(55150);function w(e,t={}){const r=(0,b.Y)(e),n=m.J.fromReader(r.reader,t),s={read:async e=>{const{value:t}=await r.reader.next(e);if(null==t)throw new Error("Value is null");return t},readLP:async()=>{const{value:e}=await n.next();if(null==e)throw new Error("Value is null");return e},readPB:async e=>{const t=await s.readLP();if(null==t)throw new Error("Value is null");const r=t instanceof Uint8Array?t:t.slice();return e.decode(r)},write:e=>{e instanceof Uint8Array?r.writer.push(e):r.writer.push(e.slice())},writeLP:e=>{s.write(m.c.single(e,t))},writePB:(e,t)=>{s.writeLP(t.encode(e))},pb:e=>({read:async()=>await s.readPB(e),write:t=>s.writePB(t,e)}),unwrap:()=>(r.rest(),r.stream)};return s}var v=r(85275);function E(){const e=(0,v.Z)();let t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){const t=await e.promise;yield*t}()}}var A=r(88211);const S=65535,_=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var C=r(512),k=r(57664),I=r(73294),T=r(15501);const x={hashSHA256:e=>(0,I.vp)(e),getHKDF(e,t){const r=new C.t(I.mE,t,e).expand(96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=k.Au();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){const t=k._w(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey:(e,t)=>k.gi(e,t),chaCha20Poly1305Encrypt:(e,t,r,n)=>new T.OK(n).seal(t,e,r),chaCha20Poly1305Decrypt:(e,t,r,n)=>new T.OK(n).open(t,e,r)};function R(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function P(e=0){return null!=globalThis.Buffer?.allocUnsafe?R(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function D(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=P(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return R(r)}const O=e=>{const t=(r=2,globalThis.Buffer?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r));var r;return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};O.bytes=2;const N=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};N.bytes=2;class L extends Error{constructor(e="Unexpected Peer"){super(e),this.code=L.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class U extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=U.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}class B extends Error{constructor(e="Invalid crypto transmission"){super(e),this.code=B.code}static get code(){return"ERR_INVALID_CRYPTO_TRANSMISSION"}}var M=r(51988),V=r(93203);var z=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const j=z,F=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class ${constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class q{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return H(this,e)}}class K{constructor(e){this.decoders=e}or(e){return H(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const H=(e,t)=>new K({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class G{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new $(e,t,r),this.decoder=new q(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const W=({name:e,prefix:t,encode:r,decode:n})=>new G(e,t,r,n),J=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=j(r,t);return W({prefix:e,name:t,encode:n,decode:e=>F(s(e))})},Y=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>W({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),Q=W({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Z=Y({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),X=Y({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ee=J({prefix:"9",name:"base10",alphabet:"0123456789"}),te=Y({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),re=Y({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ne=Y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),se=Y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ie=Y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oe=Y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ae=Y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ce=Y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),he=Y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),le=Y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ue=Y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),de=J({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fe=J({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),pe=J({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ye=J({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ge=Y({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),be=Y({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),me=Y({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),we=Y({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ve=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Ee=ve.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ae=ve.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Se=W({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Ee[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ae[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var _e=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Ce;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Ce=Math.pow(2,31);var ke=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var Ie=Math.pow(2,7),Te=Math.pow(2,14),xe=Math.pow(2,21),Re=Math.pow(2,28),Pe=Math.pow(2,35),De=Math.pow(2,42),Oe=Math.pow(2,49),Ne=Math.pow(2,56),Le=Math.pow(2,63);const Ue={encode:_e,decode:ke,encodingLength:function(e){return e<Ie?1:e<Te?2:e<xe?3:e<Re?4:e<Pe?5:e<De?6:e<Oe?7:e<Ne?8:e<Le?9:10}},Be=(e,t,r=0)=>(Ue.encode(e,t,r),t),Me=e=>Ue.encodingLength(e),Ve=(e,t)=>{const r=t.byteLength,n=Me(e),s=n+Me(r),i=new Uint8Array(s+r);return Be(e,i,0),Be(r,i,n),i.set(t,s),new ze(e,r,t,i)};class ze{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const je=({name:e,code:t,encode:r})=>new Fe(e,t,r);class Fe{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ve(this.code,t):t.then((e=>Ve(this.code,e)))}throw Error("Unknown type, must be binary type")}}const $e=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),qe=je({name:"sha2-256",code:18,encode:$e("SHA-256")}),Ke=je({name:"sha2-512",code:19,encode:$e("SHA-512")}),He=F,Ge={code:0,name:"identity",encode:He,digest:e=>Ve(0,He(e))},We="raw",Je=85,Ye=e=>F(e),Qe=e=>F(e),Ze=new TextEncoder,Xe=new TextDecoder,et="json",tt=512,rt=e=>Ze.encode(JSON.stringify(e)),nt=e=>JSON.parse(Xe.decode(e));new WeakMap;class st{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return st.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return st.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return st.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof st)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new st(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return st.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new st(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new st(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return st.create(0,DAG_PB_CODE,e)}static createV1(e,t){return st.create(1,e,t)}static decode(e){const[t,r]=st.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=st.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?st.createV0(i):st.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=st.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const it={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function ot(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const at=ot("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ct=ot("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=P((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),ht={utf8:at,"utf-8":at,hex:it.base16,latin1:ct,ascii:ct,binary:ct,...it};function lt(e,t="utf8"){const r=ht[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):R(globalThis.Buffer.from(e,"utf-8"))}var ut,dt,ft=r(46888);async function pt(e,t,r){const n=await async function(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");const r=await(0,M.unmarshalPrivateKey)(e.privateKey);return await r.sign(t)}(e,bt(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return function(e,t,r){return dt.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}(e.publicKey,n,r)}async function yt(e){return await(0,V.y5)(e.identityKey)}function gt(e){return dt.decode(e)}function bt(e){const t=lt("noise-libp2p-static-key:");return D([t,e],t.length+e.length)}async function mt(e,t,r){const n=await(0,V.y5)(t.identityKey);if(!n.equals(r))throw new Error("Peer ID doesn't match libp2p public key.");const s=bt(e);if(null==n.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const i=(0,M.unmarshalPublicKey)(n.publicKey);if(!await i.verify(s,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function wt(e){return e instanceof Uint8Array&&32===e.length}function vt(e,t="utf8"){const r=ht[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}!function(e){let t;e.codec=()=>(null==t&&(t=(0,ft.yw)(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={webtransportCerthashes:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return r}))),t),e.encode=t=>(0,ft.LE)(t,e.codec()),e.decode=t=>(0,ft.C6)(t,e.codec())}(ut||(ut={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,ft.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.identityKey&&e.identityKey.byteLength>0)&&(t.uint32(10),t.bytes(e.identityKey)),(!0===r.writeDefaults||null!=e.identitySig&&e.identitySig.byteLength>0)&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),ut.codec().encode(e.extensions,t,{writeDefaults:!1})),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.identityKey=e.bytes();break;case 2:r.identitySig=e.bytes();break;case 4:r.extensions=ut.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,ft.LE)(t,e.codec()),e.decode=t=>(0,ft.C6)(t,e.codec())}(dt||(dt={}));const Et=(0,r(38461).kg)("libp2p:noise");let At;function St(e){e?(At(`LOCAL_PUBLIC_EPHEMERAL_KEY ${vt(e.publicKey,"hex")}`),At(`LOCAL_PRIVATE_EPHEMERAL_KEY ${vt(e.privateKey,"hex")}`)):At("Missing local ephemeral keys.")}function _t(e){At(`REMOTE_EPHEMERAL_PUBLIC_KEY ${vt(e,"hex")}`)}At=_?Et:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});class Ct{constructor(e=0){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}class kt{constructor(e){this.crypto=e}encryptWithAd(e,t,r){const n=this.encrypt(e.k,e.n,t,r);return e.n.increment(),n}decryptWithAd(e,t,r){const{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,r);return s&&e.n.increment(),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(this.createEmptyKey(),e)}encrypt(e,t,r,n){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(n,t.getBytes(),r,e)}encryptAndHash(e,t){let r;return r=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,r),r}decrypt(e,t,r,n){t.assertValue();const s=this.crypto.chaCha20Poly1305Decrypt(n,t.getBytes(),r,e);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let r,n=!0;return this.hasKey(e.cs)?({plaintext:r,valid:n}=this.decryptWithAd(e.cs,e.h,t)):r=t,this.mixHash(e,t),{plaintext:r,valid:n}}dh(e,t){try{const r=this.crypto.generateX25519SharedKey(e,t);return 32===r.length?r:r.subarray(0,32)}catch(e){return Et(e.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){return this.crypto.hashSHA256(D([e,t],e.length+t.length))}mixKey(e,t){const[r,n]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(n),e.ck=r}initializeKey(e){return{k:e,n:new Ct}}initializeSymmetric(e){const t=lt(e,"utf-8"),r=this.hashProtocolName(t),n=r,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:r}}hashProtocolName(e){if(e.length<=32){const t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}split(e){const[t,r]=this.crypto.getHKDF(e.ck,new Uint8Array(0));return{cs1:this.initializeKey(t),cs2:this.initializeKey(r)}}writeMessageRegular(e,t){const r=this.encryptWithAd(e,new Uint8Array(0),t);return{ne:this.createEmptyKey(),ns:new Uint8Array(0),ciphertext:r}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}class It extends kt{initializeInitiator(e,t,r,n){const s=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(s,e);return{ss:s,s:t,rs:r,psk:n,re:new Uint8Array(32)}}initializeResponder(e,t,r,n){const s=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(s,e);return{ss:s,s:t,rs:r,psk:n,re:new Uint8Array(32)}}writeMessageA(e,t,r){const n=new Uint8Array(0);e.e=void 0!==r?r:this.crypto.generateX25519KeyPair();const s=e.e.publicKey;this.mixHash(e.ss,s);return{ne:s,ns:n,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const n=e.s.publicKey,s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));return{ne:r,ns:s,ciphertext:this.encryptAndHash(e.ss,t)}}writeMessageC(e,t){const r=e.s.publicKey,n=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const s=this.encryptAndHash(e.ss,t),i={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,messageBuffer:i,cs1:o,cs2:a}}readMessageA(e,t){return wt(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(wt(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&wt(r)&&(e.rs=r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:s,valid:i}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&i}}readMessageC(e,t){const{plaintext:r,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&wt(r)&&(e.rs=r),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:s,valid:i}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&i,cs1:o,cs2:a}}initSession(e,t,r){const n=this.createEmptyKey(),s=new Uint8Array(32);let i;return i=e?this.initializeInitiator(t,r,s,n):this.initializeResponder(t,r,s,n),{hs:i,i:e,mc:0}}sendMessage(e,t,r){let n;if(0===e.mc)n=this.writeMessageA(e.hs,t,r);else if(1===e.mc)n=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:r,messageBuffer:s,cs1:i,cs2:o}=this.writeMessageC(e.hs,t);n=s,e.h=r,e.cs1=i,e.cs2=o}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}}return e.mc++,n}recvMessage(e,t){let r=new Uint8Array(0),n=!1;if(0===e.mc)({plaintext:r,valid:n}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:r,valid:n}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:s,plaintext:i,valid:o,cs1:a,cs2:c}=this.readMessageC(e.hs,t);r=i,n=o,e.h=s,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:r,valid:n}}}class Tt{constructor(e,t,r,n,s,i,o,a){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=e,this.payload=t,this.prologue=r,this.staticKeypair=s,this.connection=i,o&&(this.remotePeer=o),this.xx=a??new It(n),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){var e,t;if(e=this.session.hs.s,At(`LOCAL_STATIC_PUBLIC_KEY ${vt(e.publicKey,"hex")}`),At(`LOCAL_STATIC_PRIVATE_KEY ${vt(e.privateKey,"hex")}`),this.isInitiator){Et("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(D([(t=e).ne,t.ciphertext],t.ne.length+t.ciphertext.length)),Et("Stage 0 - Initiator finished sending first message."),St(this.session.hs.e)}else{Et("Stage 0 - Responder waiting to receive first message...");const e=function(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}((await this.connection.readLP()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new U("xx handshake stage 0 validation fail");Et("Stage 0 - Responder received first message."),_t(this.session.hs.re)}}async exchange(){if(this.isInitiator){Et("Stage 1 - Initiator waiting to receive first message from responder...");const e=function(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new U("xx handshake stage 1 validation fail");Et("Stage 1 - Initiator received the message."),_t(this.session.hs.re),t=this.session.hs.rs,At(`REMOTE_STATIC_PUBLIC_KEY ${vt(t,"hex")}`),Et("Initiator going to check remote's signature...");try{const e=gt(r);this.remotePeer=this.remotePeer||await yt(e),await mt(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){throw new L(`Error occurred while verifying signed payload: ${e.message}`)}Et("All good with the signature!")}else{Et("Stage 1 - Responder sending out first message with signed payload and static key.");const t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(D([(e=t).ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)),Et("Stage 1 - Responder sent the second handshake message with signed payload."),St(this.session.hs.e)}var e,t}async finish(){if(this.isInitiator){Et("Stage 2 - Initiator sending third handshake message.");const t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(D([(e=t).ns,e.ciphertext],e.ns.length+e.ciphertext.length)),Et("Stage 2 - Initiator sent message with signed payload.")}else{Et("Stage 2 - Responder waiting for third handshake message...");const e=function(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}((await this.connection.readLP()).subarray()),{plaintext:t,valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new U("xx handshake stage 2 validation fail");Et("Stage 2 - Responder received the message, finished handshake.");try{const e=gt(t);this.remotePeer=this.remotePeer||await yt(e),await mt(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){throw new L(`Error occurred while verifying signed payload: ${e.message}`)}}var e,t;(t=this.session).cs1&&t.cs2?(At(`CIPHER_STATE_1 ${t.cs1.n.getUint64()} ${vt(t.cs1.k,"hex")}`),At(`CIPHER_STATE_2 ${t.cs2.n.getUint64()} ${vt(t.cs2.k,"hex")}`)):At("Missing cipher state.")}encrypt(e,t){const r=this.getCS(t);return this.xx.encryptWithAd(r,new Uint8Array(0),e)}decrypt(e,t){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new U("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}class xt{constructor(e={}){this.protocol="/noise";const{staticNoiseKey:t,extensions:r,crypto:n,prologueBytes:s,metrics:i}=e;this.crypto=n??x,this.extensions=r,this.metrics=i?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(i):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(e,t,r){const n=w(t,{lengthEncoder:O,lengthDecoder:N,maxDataLength:S}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,s),remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(e,t,r){const n=w(t,{lengthEncoder:O,lengthDecoder:N,maxDataLength:S}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:r});return{conn:await this.createSecureConnection(n,s),remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(e){const t=await pt(e.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:r,remotePeer:n,connection:s}=e,i=new Tt(r,t,this.prologue,this.crypto,this.staticKeys,s,n);try{await i.propose(),await i.exchange(),await i.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(e){if(this.metrics?.xxHandshakeErrors.increment(),e instanceof Error)throw e.message=`Error occurred during XX handshake: ${e.message}`,e}return i}async createSecureConnection(e,t){const[r,n]=function(){const e=E(),t=E();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),s=e.unwrap();return await(0,A.zG)(r,function(e,t){return async function*(r){for await(const n of r)for(let r=0;r<n.length;r+=65519){let s=r+65519;s>n.length&&(s=n.length);const i=e.encrypt(n.subarray(r,s),e.session);t?.encryptedPackets.increment(),yield O(i.byteLength),yield i}}}(t,this.metrics),s,(0,m.J)({lengthDecoder:N}),function(e,t){return async function*(r){for await(const n of r)for(let r=0;r<n.length;r+=S){let s=r+S;s>n.length&&(s=n.length);const{plaintext:i,valid:o}=e.decrypt(n.subarray(r,s),e.session);if(!o)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield i}}}(t,this.metrics),r),n}}function Rt(e={}){return()=>new xt(e)}},16721:(e,t,r)=>{"use strict";r.d(t,{fS:()=>n,oQ:()=>s});new Uint8Array(0);const n=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},s=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}},93752:(e,t,r)=>{"use strict";r.d(t,{k:()=>w});var n=r(40095),s=r(35364);const i=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};var o=r(16721);class a{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class c{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return l(this,e)}}class h{constructor(e){this.decoders=e}or(e){return l(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const l=(e,t)=>new h({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class u{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new a(e,t,r),this.decoder=new c(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const d=({name:e,prefix:t,encode:r,decode:n})=>new u(e,t,r,n),f=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=i(r,t);return d({prefix:e,name:t,encode:n,decode:e=>(0,o.oQ)(s(e))})},p=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>d({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),y=f({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),g=(f({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),p({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),b=(p({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),p({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),p({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),p({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),p({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),p({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),p({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),m=e=>{const t=b.get(e);if(null==t){const t=new Map;return b.set(e,t),t}return t};class w{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==S)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==_)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return w.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=s.Ue(e,t);return w.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return w.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&s.fS(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?E(r,m(e),t||y.encoder):A(r,m(e),t||g.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof w)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new w(e,r,n,s||C(e,r,n.bytes))}if(!0===t[k]){const{version:e,multihash:r,code:n}=t,i=s.Jx(r);return w.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==S)throw new Error(`Version 0 CID must use dag-pb (code: ${S}) block encoding`);return new w(e,t,r,r.bytes);case 1:{const n=C(e,t,r.bytes);return new w(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return w.create(0,S,e)}static createV1(e,t){return w.create(1,e,t)}static decode(e){const[t,r]=w.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=w.inspectBytes(e),r=t.size-t.multihashSize,n=(0,o.oQ)(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),a=new s.zZ(t.multihashCode,t.digestSize,i,n);return[0===t.version?w.createV0(a):w.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,s]=n.Jx(e.subarray(t));return t+=s,r};let s=r(),i=S;if(18===s?(s=0,t=0):i=r(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=r(),c=r(),h=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:h-o,size:h}}static parse(e,t){const[r,n]=v(e,t),s=w.decode(n);return m(s).set(r,e),s}}const v=(e,t)=>{switch(e[0]){case"Q":{const r=t||y;return[y.prefix,r.decode(`${y.prefix}${e}`)]}case y.prefix:{const r=t||y;return[y.prefix,r.decode(e)]}case g.prefix:{const r=t||g;return[g.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},E=(e,t,r)=>{const{prefix:n}=r;if(n!==y.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},A=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},S=112,_=18,C=(e,t,r)=>{const s=n.P$(e),i=s+n.P$(t),o=new Uint8Array(i+r.byteLength);return n.mL(e,o,0),n.mL(t,o,s),o.set(r,i),o},k=Symbol.for("@ipld/js-cid/CID")},35364:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>o,Ue:()=>i,fS:()=>a,zZ:()=>c});var n=r(16721),s=r(40095);const i=(e,t)=>{const r=t.byteLength,n=s.P$(e),i=n+s.P$(r),o=new Uint8Array(i+r);return s.mL(e,o,0),s.mL(r,o,n),o.set(t,i),new c(e,r,t,o)},o=e=>{const t=(0,n.oQ)(e),[r,i]=s.Jx(t),[o,a]=s.Jx(t.subarray(i)),h=t.subarray(i+a);if(h.byteLength!==o)throw new Error("Incorrect length");return new c(r,o,h,t)},a=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&(0,n.fS)(e.bytes,r.bytes)}};class c{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}},40095:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>g,mL:()=>b,P$:()=>m});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t=0)=>[y.decode(e,t),y.decode.bytes],b=(e,t,r=0)=>(y.encode(e,t,r),t),m=e=>y.encodingLength(e)},55093:(e,t,r)=>{"use strict";r.d(t,{Cy:()=>E,HR:()=>v,UF:()=>w,xU:()=>p});var n=r(94676),s=r(93752),i=r(35364),o=r(34219);const a={Null:e=>null===e,Int:e=>Number.isInteger(e),Float:e=>"number"==typeof e&&Number.isFinite(e),String:e=>"string"==typeof e,Bool:e=>"boolean"==typeof e,Bytes:e=>e instanceof Uint8Array,Link:e=>!a.Null(e)&&"object"==typeof e&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!a.Null(e)&&"object"==typeof e&&e.asCID!==e&&!a.List(e)&&!a.Bytes(e)},c={Int:a.Int,"CarHeader > version":e=>c.Int(e),"CarHeader > roots (anon) > valueType (anon)":a.Link,"CarHeader > roots (anon)":e=>a.List(e)&&Array.prototype.every.call(e,c["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>c["CarHeader > roots (anon)"](e),CarHeader:e=>{const t=e&&Object.keys(e);return a.Map(e)&&["version"].every((e=>t.includes(e)))&&Object.entries(e).every((([e,t])=>c["CarHeader > "+e]&&c["CarHeader > "+e](t)))}},h=c.CarHeader,l=18,u=32,d=112;async function f(e){const t=await e.upTo(8);if(!t.length)throw new Error("Unexpected end of data");const r=n.decode(t);return e.seek(n.decode.bytes),r}async function p(e,t){const r=await f(e);if(0===r)throw new Error("Invalid CAR header (zero length)");const n=await e.exactly(r);e.seek(r);const s=(0,o.decode)(n);if(!h(s))throw new Error("Invalid CAR header format");if(1!==s.version&&2!==s.version||void 0!==t&&s.version!==t)throw new Error(`Invalid CAR version: ${s.version}${void 0!==t?` (expected ${t})`:""}`);const i=Array.isArray(s.roots);if(1===s.version&&!i||2===s.version&&i)throw new Error("Invalid CAR header format");if(1===s.version)return s;const a=await async function(e){const t=await e.exactly(40),r=new DataView(t.buffer,t.byteOffset,t.byteLength);let n=0;const s={version:2,characteristics:[r.getBigUint64(n,!0),r.getBigUint64(n+=8,!0)],dataOffset:Number(r.getBigUint64(n+=8,!0)),dataSize:Number(r.getBigUint64(n+=8,!0)),indexOffset:Number(r.getBigUint64(n+=8,!0))};return e.seek(40),s}(e);e.seek(a.dataOffset-e.pos);const c=await p(e,1);return Object.assign(c,a)}async function y(e){const t=await e.exactly(2);if(t[0]===l&&t[1]===u){const t=await e.exactly(34);e.seek(34);const r=i.Jx(t);return s.k.create(0,d,r)}const r=await f(e);if(1!==r)throw new Error(`Unexpected CID version (${r})`);const o=await f(e),a=await async function(e){const t=await e.upTo(8);n.decode(t);const r=n.decode.bytes,s=n.decode(t.subarray(n.decode.bytes)),i=r+n.decode.bytes+s,o=await e.exactly(i);return e.seek(i),o}(e),c=i.Jx(a);return s.k.create(r,o,c)}async function g(e){const t=e.pos;let r=await f(e);if(0===r)throw new Error("Invalid CAR section (zero length)");r+=e.pos-t;return{cid:await y(e),length:r,blockLength:r-Number(e.pos-t)}}async function b(e){const{cid:t,blockLength:r}=await g(e),n=await e.exactly(r);return e.seek(r),{bytes:n,cid:t}}async function m(e){const t=e.pos,{cid:r,length:n,blockLength:s}=await g(e),i={cid:r,length:n,blockLength:s,offset:t,blockOffset:e.pos};return e.seek(i.blockLength),i}function w(e){const t=(async()=>{const t=await p(e);if(2===t.version){const r=e.pos-t.dataOffset;e=function(e,t){let r=0;return{async upTo(n){let s=await e.upTo(n);return s.length+r>t&&(s=s.subarray(0,t-r)),s},async exactly(n){const s=await e.exactly(n);if(s.length+r>t)throw new Error("Unexpected end of data");return s},seek(t){r+=t,e.seek(t)},get pos(){return e.pos}}}(e,t.dataSize-r)}return t})();return{header:()=>t,async*blocks(){for(await t;(await e.upTo(8)).length>0;)yield await b(e)},async*blocksIndex(){for(await t;(await e.upTo(8)).length>0;)yield await m(e)}}}function v(e){let t=0;return{upTo:async r=>e.subarray(t,t+Math.min(r,e.length-t)),async exactly(r){if(r>e.length-t)throw new Error("Unexpected end of data");return e.subarray(t,t+r)},seek(e){t+=e},get pos(){return t}}}function E(e){const t=e[Symbol.asyncIterator]();return function(e){let t=0,r=0,n=0,s=new Uint8Array(0);const i=async t=>{r=s.length-n;const i=[s.subarray(n)];for(;r<t;){const t=await e();if(null==t)break;r<0?t.length>r&&i.push(t.subarray(-r)):i.push(t),r+=t.length}s=new Uint8Array(i.reduce(((e,t)=>e+t.length),0));let o=0;for(const e of i)s.set(e,o),o+=e.length;n=0};return{upTo:async e=>(s.length-n<e&&await i(e),s.subarray(n,n+Math.min(s.length-n,e))),async exactly(e){if(s.length-n<e&&await i(e),s.length-n<e)throw new Error("Unexpected end of data");return s.subarray(n,n+e)},seek(e){t+=e,n+=e},get pos(){return t}}}((async function(){const e=await t.next();return e.done?null:e.value}))}},80636:(e,t,r)=>{"use strict";r.d(t,{vQ:()=>i});var n=r(55093);class s{constructor(e,t,r){this._version=e,this._roots=t,this._iterable=r,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class i extends s{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){const{version:t,roots:r,iterator:n}=await a(e);return new i(t,r,n)}static async fromIterable(e){const{version:t,roots:r,iterator:n}=await c(e);return new i(t,r,n)}}class o extends(null){[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;const e=this._iterable[Symbol.asyncIterator]();return{async next(){const t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){const{version:t,roots:r,iterator:n}=await a(e);return new o(t,r,n)}static async fromIterable(e){const{version:t,roots:r,iterator:n}=await c(e);return new o(t,r,n)}}async function a(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return h((0,n.HR)(e))}async function c(e){if(!e||"function"!=typeof e[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return h((0,n.Cy)(e))}async function h(e){const t=(0,n.UF)(e),{version:r,roots:s}=await t.header();return{version:r,roots:s,iterator:t.blocks()}}},71855:(e,t,r)=>{"use strict";r.d(t,{Gp:()=>h});var n=r(93752),s=r(94676),i=r(34219);function o(e){const t=(0,i.encode)({version:1,roots:e}),r=s.encode(t.length),n=new Uint8Array(r.length+t.length);return n.set(r,0),n.set(t,r.length),n}function a(){}var c=r(55093);class h{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array&&e.cid))throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const t=n.k.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then((()=>this._encoder.writeBlock({cid:t,bytes:e.bytes}))),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=function(e){if(void 0===e)return[];if(!Array.isArray(e)){const t=n.k.asCID(e);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}const t=[];for(const r of e){const e=n.k.asCID(r);if(!e)throw new TypeError("roots must be a single CID or an array of CIDs");t.push(e)}return t}(e);const{encoder:t,iterator:r}=u();return{writer:new h(e,t),out:new l(r)}}static createAppender(){const{encoder:e,iterator:t}=u();e.setRoots=()=>Promise.resolve();return{writer:new h([],e),out:new l(t)}}static async updateRootsInBytes(e,t){const r=(0,c.HR)(e);await(0,c.xU)(r);const n=o(t);if(Number(r.pos)!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${r.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}}class l{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function u(){const e=function(){const e=[];let t=null,r=a,n=!1,s=null,i=a;const o=()=>(t||(t=new Promise((e=>{r=()=>{t=null,r=a,e()}}))),t),c={write(t){e.push(t);const r=o();return i(),r},async end(){n=!0;const e=o();i(),await e}},h={async next(){const t=e.shift();return t?(0===e.length&&r(),{done:!1,value:t}):n?(r(),{done:!0,value:void 0}):(s||(s=new Promise((e=>{i=()=>(s=null,i=a,e(h.next()))}))),s)}};return{writer:c,iterator:h}}(),{writer:t,iterator:r}=e,n=function(e){return{async setRoots(t){const r=o(t);await e.write(r)},async writeBlock(t){const{cid:r,bytes:n}=t;await e.write(new Uint8Array(s.encode(r.bytes.length+n.length))),await e.write(r.bytes),n.length&&await e.write(n)},async close(){await e.end()}}}(t);return{encoder:n,iterator:r}}},34219:(e,t,r)=>{"use strict";r.r(t),r.d(t,{code:()=>H,decode:()=>W,encode:()=>G,name:()=>K});var n=r(64936),s=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=i;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},i=Math.pow(2,31);var o=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var a=Math.pow(2,7),c=Math.pow(2,14),h=Math.pow(2,21),l=Math.pow(2,28),u=Math.pow(2,35),d=Math.pow(2,42),f=Math.pow(2,49),p=Math.pow(2,56),y=Math.pow(2,63);const g={encode:s,decode:o,encodingLength:function(e){return e<a?1:e<c?2:e<h?3:e<l?4:e<u?5:e<d?6:e<f?7:e<p?8:e<y?9:10}},b=(e,t=0)=>[g.decode(e,t),g.decode.bytes],m=(e,t,r=0)=>(g.encode(e,t,r),t),w=e=>g.encodingLength(e),v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class E{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const A=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class S{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return k(this,e)}}class C{constructor(e){this.decoders=e}or(e){return k(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const k=(e,t)=>new C({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class I{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new S(e,t,r),this.decoder=new _(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const T=({name:e,prefix:t,encode:r,decode:n})=>new I(e,t,r,n),x=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=A(r,t);return T({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},R=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>T({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),P=x({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),D=(x({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),R({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),O=(R({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),R({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),R({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),R({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),R({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),R({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),R({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),R({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),N=e=>{const t=O.get(e);if(null==t){const t=new Map;return O.set(e,t),t}return t};class L{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==V)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==z)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return L.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=w(e),s=n+w(r),i=new Uint8Array(s+r);return m(e,i,0),m(r,i,n),i.set(t,s),new E(e,r,t,i)})(e,t);return L.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return L.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?B(r,N(e),t||P.encoder):M(r,N(e),t||D.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof L)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new L(e,r,n,s||j(e,r,n.bytes))}if(!0===t[F]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=v(e),[r,n]=b(t),[s,i]=b(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new E(r,s,o,t)})(r);return L.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==V)throw new Error(`Version 0 CID must use dag-pb (code: ${V}) block encoding`);return new L(e,t,r,r.bytes);case 1:{const n=j(e,t,r.bytes);return new L(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return L.create(0,V,e)}static createV1(e,t){return L.create(1,e,t)}static decode(e){const[t,r]=L.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=L.inspectBytes(e),r=t.size-t.multihashSize,n=v(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new E(t.multihashCode,t.digestSize,s,n);return[0===t.version?L.createV0(i):L.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=b(e.subarray(t));return t+=n,r};let n=r(),s=V;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=U(e,t),s=L.decode(n);return N(s).set(r,e),s}}const U=(e,t)=>{switch(e[0]){case"Q":{const r=t||P;return[P.prefix,r.decode(`${P.prefix}${e}`)]}case P.prefix:{const r=t||P;return[P.prefix,r.decode(e)]}case D.prefix:{const r=t||D;return[D.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},B=(e,t,r)=>{const{prefix:n}=r;if(n!==P.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},M=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},V=112,z=18,j=(e,t,r)=>{const n=w(e),s=n+w(t),i=new Uint8Array(s+r.byteLength);return m(e,i,0),m(t,i,n),i.set(r,s),i},F=Symbol.for("@ipld/js-cid/CID");const $={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=L.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new n.WU(n.Dy.tag,42),new n.WU(n.Dy.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const q={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};q.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return L.decode(e.subarray(1))};const K="dag-cbor",H=113,G=e=>n.cv(e,$),W=e=>n.Jx(e,q)},66258:(e,t,r)=>{"use strict";r.r(t),r.d(t,{code:()=>ne,decode:()=>ie,encode:()=>se,name:()=>re});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t=0)=>[y.decode(e,t),y.decode.bytes],b=(e,t,r=0)=>(y.encode(e,t,r),t),m=e=>y.encodingLength(e),w=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class v{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const E=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class A{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class S{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return C(this,e)}}class _{constructor(e){this.decoders=e}or(e){return C(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const C=(e,t)=>new _({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class k{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new A(e,t,r),this.decoder=new S(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const I=({name:e,prefix:t,encode:r,decode:n})=>new k(e,t,r,n),T=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=E(r,t);return I({prefix:e,name:t,encode:n,decode:e=>w(s(e))})},x=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>I({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),R=T({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),P=(T({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),x({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),D=(x({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),x({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),x({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),x({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),x({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),x({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),x({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),O=e=>{const t=D.get(e);if(null==t){const t=new Map;return D.set(e,t),t}return t};class N{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==M)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==V)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return N.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=m(e),s=n+m(r),i=new Uint8Array(s+r);return b(e,i,0),b(r,i,n),i.set(t,s),new v(e,r,t,i)})(e,t);return N.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return N.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?U(r,O(e),t||R.encoder):B(r,O(e),t||P.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof N)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new N(e,r,n,s||z(e,r,n.bytes))}if(!0===t[j]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=w(e),[r,n]=g(t),[s,i]=g(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new v(r,s,o,t)})(r);return N.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==M)throw new Error(`Version 0 CID must use dag-pb (code: ${M}) block encoding`);return new N(e,t,r,r.bytes);case 1:{const n=z(e,t,r.bytes);return new N(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return N.create(0,M,e)}static createV1(e,t){return N.create(1,e,t)}static decode(e){const[t,r]=N.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=N.inspectBytes(e),r=t.size-t.multihashSize,n=w(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new v(t.multihashCode,t.digestSize,s,n);return[0===t.version?N.createV0(i):N.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=g(e.subarray(t));return t+=n,r};let n=r(),s=M;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=L(e,t),s=N.decode(n);return O(s).set(r,e),s}}const L=(e,t)=>{switch(e[0]){case"Q":{const r=t||R;return[R.prefix,r.decode(`${R.prefix}${e}`)]}case R.prefix:{const r=t||R;return[R.prefix,r.decode(e)]}case P.prefix:{const r=t||P;return[P.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},U=(e,t,r)=>{const{prefix:n}=r;if(n!==R.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},B=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},M=112,V=18,z=(e,t,r)=>{const n=m(e),s=n+m(t),i=new Uint8Array(s+r.byteLength);return b(e,i,0),b(t,i,n),i.set(r,s),i},j=Symbol.for("@ipld/js-cid/CID");const F=x({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});x({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),x({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),x({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $=r(64936),q=r(59787),K=r(72696),H=r(85590),G=r(22042);class W extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===q.D.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===q.D.map&&(t.elements++,1!==t.elements&&(t.elements%2==1?e.push([44]):e.push([58]))))}[q.D.uint.major](e,t){this.prefix(e);const r=String(t.value),n=[];for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);e.push(n)}[q.D.negint.major](e,t){this[q.D.uint.major](e,t)}[q.D.bytes.major](e,t){throw new Error(`${H.OO} unsupported type: Uint8Array`)}[q.D.string.major](e,t){this.prefix(e);const r=(0,G.mL)(JSON.stringify(t.value));e.push(r.length>32?(0,G.Dz)(r):r)}[q.D.array.major](e,t){this.prefix(e),this.inRecursive.push({type:q.D.array,elements:0}),e.push([91])}[q.D.map.major](e,t){this.prefix(e),this.inRecursive.push({type:q.D.map,elements:0}),e.push([123])}[q.D.tag.major](e,t){}[q.D.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===q.D.array)e.push([93]);else{if(t.type!==q.D.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${H.OO} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const r=String(t.value),n=[];let s=!1;for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e),s||46!==n[e]&&101!==n[e]&&69!==n[e]||(s=!0);s||(n.push(46),n.push(48)),e.push(n)}}const J={addBreakTokens:!0,mapSorter:function(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${H.OO} complex map keys are not supported`);const r=e[0],n=t[0];if(r.type!==q.D.string||n.type!==q.D.string)throw new Error(`${H.OO} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${H.OO} unexpected duplicate map keys, this is not supported`)}};var Y=r(61287);class Q{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${H.IR} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${H.IR} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this.pos;let t=!1,r=!1;const n=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this.pos++}};if(45===this.ch()&&(t=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new q.W(q.D.uint,0,this.pos-e);this.pos++,r=!0}if(n([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${H.IR} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${H.IR} unexpected token at position ${this.pos}`);r=!0,this.pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this.pos++,this.done()||43!==this.ch()&&45!==this.ch()||this.pos++,n([48,49,50,51,52,53,54,55,56,57]));const s=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),i=parseFloat(s);return r?new q.W(q.D.float,i,this.pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(i)?new q.W(i>=0?q.D.uint:q.D.negint,i,this.pos-e):new q.W(i>=0?q.D.uint:q.D.negint,BigInt(s),this.pos-e)}parseString(){if(34!==this.ch())throw new Error(`${H.IR} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let e=this.pos,t=0;e<this.data.length&&t<65536;e++,t++){const r=this.data[e];if(92===r||r<32||r>=128)break;if(34===r){const r=String.fromCharCode.apply(null,this.data.subarray(this.pos,e));return this.pos=e+1,new q.W(q.D.string,r,t)}}const e=this.pos,t=[],r=()=>{if(this.pos+4>=this.data.length)throw new Error(`${H.IR} unexpected end of unicode escape sequence at position ${this.pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${H.IR} unexpected unicode escape character at position ${this.pos}`);t=t-65+10}e=16*e+t,this.pos++}return e},n=()=>{const e=this.ch();let r,n,s,i,o=null,a=e>239?4:e>223?3:e>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${H.IR} unexpected unicode sequence at position ${this.pos}`);switch(a){case 1:e<128&&(o=e);break;case 2:r=this.data[this.pos+1],128==(192&r)&&(i=(31&e)<<6|63&r,i>127&&(o=i));break;case 3:r=this.data[this.pos+1],n=this.data[this.pos+2],128==(192&r)&&128==(192&n)&&(i=(15&e)<<12|(63&r)<<6|63&n,i>2047&&(i<55296||i>57343)&&(o=i));break;case 4:r=this.data[this.pos+1],n=this.data[this.pos+2],s=this.data[this.pos+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(i=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&s,i>65535&&i<1114112&&(o=i))}null===o?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|1023&o),t.push(o),this.pos+=a};for(;!this.done();){const s=this.ch();let i;switch(s){case 92:if(this.pos++,this.done())throw new Error(`${H.IR} unexpected string termination at position ${this.pos}`);switch(i=this.ch(),this.pos++,i){case 34:case 39:case 92:case 47:t.push(i);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${H.IR} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new q.W(q.D.string,(0,G.Pu)(t),this.pos-e);default:if(s<32)throw new Error(`${H.IR} invalid control character at position ${this.pos}`);s<128?(t.push(s),this.pos++):n()}}throw new Error(`${H.IR} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new q.W(q.D.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new q.W(q.D.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new q.W(q.D.null,null,4);case 102:return this.expect([102,97,108,115,101]),new q.W(q.D.false,!1,5);case 116:return this.expect([116,114,117,101]),new q.W(q.D.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${H.IR} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new q.W(q.D.break,void 0,1);if(44!==this.ch())throw new Error(`${H.IR} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this.pos++,this.skipWhitespace(),new q.W(q.D.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new q.W(q.D.break,void 0,1);if(44!==this.ch())throw new Error(`${H.IR} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new q.W(q.D.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${H.IR} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${H.IR} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function Z(e){const t=F.encode(e).slice(1);return[new $.WU($.Dy.map,1/0,1),new $.WU($.Dy.string,"/",1),new $.WU($.Dy.map,1/0,1),new $.WU($.Dy.string,"bytes",5),new $.WU($.Dy.string,t,t.length),new $.WU($.Dy.break,void 0,1),new $.WU($.Dy.break,void 0,1)]}const X={typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=N.asCID(e);if(!t)return null;const r=t.toString();return[new $.WU($.Dy.map,1/0,1),new $.WU($.Dy.string,"/",1),new $.WU($.Dy.string,r,r.length),new $.WU($.Dy.break,void 0,1)]},Uint8Array:Z,Buffer:Z,undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};class ee extends Q{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===$.Dy.map){const e=this._next();if(e.type===$.Dy.string&&"/"===e.value){const e=this._next();if(e.type===$.Dy.string){if(this._next().type!==$.Dy.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new $.WU($.Dy.tag,42,0)}if(e.type===$.Dy.map){const e=this._next();if(e.type===$.Dy.string&&"bytes"===e.value){const e=this._next();if(e.type===$.Dy.string){for(let e=0;e<2;e++){if(this._next().type!==$.Dy.break)throw new Error("Invalid encoded Bytes form")}const t=F.decode(`m${e.value}`);return new $.WU($.Dy.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const te={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};te.tags[42]=N.parse;const re="dag-json",ne=297,se=e=>{return t=e,r=X,r=Object.assign({},J,r),(0,K.w$)(t,new W,r);var t,r},ie=e=>function(e,t){return t=Object.assign({tokenizer:new Q(e,t)},t),(0,Y.Jx)(e,t)}(e,Object.assign(te,{tokenizer:new ee(e,te)}))},10539:(e,t,r)=>{"use strict";r.r(t),r.d(t,{code:()=>de,createLink:()=>le,createNode:()=>he,decode:()=>pe,encode:()=>fe,name:()=>ue,prepare:()=>ae,validate:()=>ce});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t=0)=>[y.decode(e,t),y.decode.bytes],b=(e,t,r=0)=>(y.encode(e,t,r),t),m=e=>y.encodingLength(e),w=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class v{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const E=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class A{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class S{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return C(this,e)}}class _{constructor(e){this.decoders=e}or(e){return C(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const C=(e,t)=>new _({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class k{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new A(e,t,r),this.decoder=new S(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const I=({name:e,prefix:t,encode:r,decode:n})=>new k(e,t,r,n),T=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=E(r,t);return I({prefix:e,name:t,encode:n,decode:e=>w(s(e))})},x=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>I({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),R=T({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),P=(T({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),x({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),D=(x({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),x({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),x({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),x({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),x({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),x({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),x({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),O=e=>{const t=D.get(e);if(null==t){const t=new Map;return D.set(e,t),t}return t};class N{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==M)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==V)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return N.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=m(e),s=n+m(r),i=new Uint8Array(s+r);return b(e,i,0),b(r,i,n),i.set(t,s),new v(e,r,t,i)})(e,t);return N.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return N.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?U(r,O(e),t||R.encoder):B(r,O(e),t||P.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof N)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new N(e,r,n,s||z(e,r,n.bytes))}if(!0===t[j]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=w(e),[r,n]=g(t),[s,i]=g(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new v(r,s,o,t)})(r);return N.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==M)throw new Error(`Version 0 CID must use dag-pb (code: ${M}) block encoding`);return new N(e,t,r,r.bytes);case 1:{const n=z(e,t,r.bytes);return new N(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return N.create(0,M,e)}static createV1(e,t){return N.create(1,e,t)}static decode(e){const[t,r]=N.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=N.inspectBytes(e),r=t.size-t.multihashSize,n=w(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new v(t.multihashCode,t.digestSize,s,n);return[0===t.version?N.createV0(i):N.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=g(e.subarray(t));return t+=n,r};let n=r(),s=M;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=L(e,t),s=N.decode(n);return O(s).set(r,e),s}}const L=(e,t)=>{switch(e[0]){case"Q":{const r=t||R;return[R.prefix,r.decode(`${R.prefix}${e}`)]}case R.prefix:{const r=t||R;return[R.prefix,r.decode(e)]}case P.prefix:{const r=t||P;return[P.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},U=(e,t,r)=>{const{prefix:n}=r;if(n!==R.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},B=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},M=112,V=18,z=(e,t,r)=>{const n=m(e),s=n+m(t),i=new Uint8Array(s+r.byteLength);return b(e,i,0),b(t,i,n),i.set(r,s),i},j=Symbol.for("@ipld/js-cid/CID"),F=new TextDecoder;function $(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const s=e[t++];if(r+=n<28?(127&s)<<n:(127&s)*2**n,s<128)break}return[r,t]}function q(e,t){let r;[r,t]=$(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function K(e,t){let r;return[r,t]=$(e,t),[7&r,r>>3,t]}function H(e){const t={},r=e.length;let n=0;for(;n<r;){let r,s;if([r,s,n]=K(e,n),1===s){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=q(e,n)}else if(2===s){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=q(e,n),t.Name=F.decode(s)}else{if(3!==s)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=$(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const G=new TextEncoder,W=2**32;function J(e,t){let r=t.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=Z(t,r,e.Tsize)-1,t[r]=24}if("string"==typeof e.Name){const n=G.encode(e.Name);r-=n.length,t.set(n,r),r=Z(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=Z(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function Y(e){const t=function(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+X(r)}if(e.Links)for(const r of e.Links){const e=Q(r);t+=1+e+X(e)}return t}(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=Z(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let t=e.Links.length-1;t>=0;t--){const s=J(e.Links[t],r.subarray(0,n));n-=s,n=Z(r,n,s)-1,r[n]=18}return r}function Q(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+X(r)}if("string"==typeof e.Name){const r=G.encode(e.Name).length;t+=1+r+X(r)}return"number"==typeof e.Tsize&&(t+=1+X(e.Tsize)),t}function Z(e,t,r){const n=t-=X(r);for(;r>=2147483648;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function X(e){return e%2==0&&e++,Math.floor((function(e){let t=0;e>=W&&(e=Math.floor(e/W),t=32);e>=65536&&(e>>>=16,t+=16);e>=256&&(e>>>=8,t+=8);return t+ee[e]}(e)+6)/7)}const ee=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],te=["Data","Links"],re=["Hash","Name","Tsize"],ne=new TextEncoder;function se(e,t){if(e===t)return 0;const r=e.Name?ne.encode(e.Name):[],n=t.Name?ne.encode(t.Name):[];let s=r.length,i=n.length;for(let e=0,t=Math.min(s,i);e<t;++e)if(r[e]!==n[e]){s=r[e],i=n[e];break}return s<i?-1:i<s?1:0}function ie(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function oe(e){if("object"==typeof e.asCID){const t=N.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=N.asCID(e.Hash);try{r||("string"==typeof e.Hash?r=N.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=N.decode(e.Hash)))}catch(e){throw new TypeError(`Invalid DAG-PB form: ${e.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(t.Name=e.Name),"number"==typeof e.Tsize&&(t.Tsize=e.Tsize),t}function ae(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"==typeof e.Data)t.Data=ne.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(oe),t.Links.sort(se)}else t.Links=[];return t}function ce(e){if(!e||"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");if(!ie(e,te))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!=typeof r||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!ie(r,re))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize&&("number"!=typeof r.Tsize||r.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t>0&&-1===se(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function he(e,t=[]){return ae({Data:e,Links:t})}function le(e,t,r){return oe({Hash:r,Name:e,Tsize:t})}const ue="dag-pb",de=112;function fe(e){ce(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),Y(t)}function pe(e){const t=function(e){const t=e.length;let r,n,s=0,i=!1;for(;s<t;){let t,o;if([t,o,s]=K(e,s),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===o){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,s]=q(e,s),r&&(i=!0)}else{if(2!==o)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${o}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,s]=q(e,s),r.push(H(t))}}}if(s>t)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return n&&(o.Data=n),o.Links=r||[],o}(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((e=>{const t={};try{t.Hash=N.decode(e.Hash)}catch(e){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}},43323:(e,t,r)=>{"use strict";r.d(t,{U:()=>u});var n=r(94306),s=r(76237),i=r(46857),o=r(38461),a=r(93203),c=r(59769);const h=(0,o.kg)("libp2p:bootstrap");class l extends i.v{constructor(e,t={list:[]}){if(null==t.list||0===t.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=e,this.timeout=t.timeout??1e3,this.list=[];for(const e of t.list){if(!s.Ul.matches(e)){h.error("Invalid multiaddr");continue}const t=(0,n.HM)(e),r=t.getPeerId();if(null==r){h.error("Invalid bootstrap multiaddr without peer id");continue}const i={id:(0,a.jE)(r),multiaddrs:[t],protocols:[]};this.list.push(i)}this._init=t}get[c.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(h("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{h.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const e of this.list){if(await this.components.peerStore.tagPeer(e.id,this._init.tagName??"bootstrap",{value:this._init.tagValue??50,ttl:this._init.tagTTL??12e4}),null==this.timer)return;this.dispatchEvent(new i.A("peer",{detail:e}))}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}function u(e){return t=>new l(t,e)}l.tag="bootstrap"},63042:(e,t,r)=>{"use strict";r.d(t,{U:()=>o});var n=r(44234);const s={SHA1:20,SHA256:32,SHA512:64},i={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"};async function o(e,t){const r=i[e],o=await n.Z.get().subtle.importKey("raw",t,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{digest:async e=>await(async(e,t)=>{const r=await n.Z.get().subtle.sign({name:"HMAC"},e,t);return new Uint8Array(r,0,r.byteLength)})(o,e),length:s[e]}}},79944:(e,t,r)=>{"use strict";r.d(t,{XP:()=>s,nk:()=>h,O6:()=>i.Z});r(63042),r(8925),r(3832),r(50124),r(91794);var n=r(32114);var s=r(51988),i=r(95887),o=r(98960),a=r(97116);const c={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function h(e,t,r,s,i){if("sha1"!==i&&"sha2-256"!==i&&"sha2-512"!==i){const e=Object.keys(c).join(" / ");throw n(new Error(`Hash '${i}' is unknown or not supported. Must be ${e}`),"ERR_UNSUPPORTED_HASH_TYPE")}const h=o(e,t,r,s,c[i]);return a.encode64(h,null)}},51988:(e,t,r)=>{"use strict";r.r(t),r.d(t,{generateEphemeralKeyPair:()=>O,generateKeyPair:()=>yt,generateKeyPairFromSeed:()=>gt,importKey:()=>Et,keyStretcher:()=>v,keysPBM:()=>n,marshalPrivateKey:()=>vt,marshalPublicKey:()=>mt,supportedKeys:()=>dt,unmarshalPrivateKey:()=>wt,unmarshalPublicKey:()=>bt});var n={};r.r(n),r.d(n,{KeyType:()=>a,PrivateKey:()=>l,PublicKey:()=>h});var s={};r.r(s),r.d(s,{RsaPrivateKey:()=>K,RsaPublicKey:()=>q,fromJwk:()=>W,generateKeyPair:()=>J,unmarshalRsaPrivateKey:()=>H,unmarshalRsaPublicKey:()=>G});var i={};r.r(i),r.d(i,{Ed25519PrivateKey:()=>Xe,Ed25519PublicKey:()=>Ze,generateKeyPair:()=>rt,generateKeyPairFromSeed:()=>nt,unmarshalEd25519PrivateKey:()=>et,unmarshalEd25519PublicKey:()=>tt});var o={};r.r(o),r.d(o,{Secp256k1PrivateKey:()=>ct,Secp256k1PublicKey:()=>at,generateKeyPair:()=>ut,unmarshalSecp256k1PrivateKey:()=>ht,unmarshalSecp256k1PublicKey:()=>lt});var a,c,h,l,u=r(46888);!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(a||(a={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(c||(c={})),function(e){e.codec=()=>(0,u.Ji)(c)}(a||(a={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,u.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),a.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=a.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,u.LE)(t,e.codec()),e.decode=t=>(0,u.C6)(t,e.codec())}(h||(h={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,u.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),a.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Type=a.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,u.LE)(t,e.codec()),e.decode=t=>(0,u.C6)(t,e.codec())}(l||(l={}));r(3068),r(97450);var d=r(3832),f=r(32114),p=r(91794),y=r(91343),g=r(46327);function b(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=(0,y.E)(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return(0,g.P)(r)}var m=r(63042);const w={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function v(e,t,r){const n=w[e];if(null==n){const t=Object.keys(w).join(" / ");throw f(new Error(`unknown cipher type '${e}'. Must be ${t}`),"ERR_INVALID_CIPHER_TYPE")}if(null==t)throw f(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");const s=n.keySize,i=n.ivSize,o=(0,p.m)("key expansion"),a=2*(i+s+20),c=await m.U(t,r);let h=await c.digest(o);const l=[];let u=0;for(;u<a;){const e=await c.digest(b([h,o]));let t=e.length;u+t>a&&(t=a-u),l.push(e),u+=t,h=await c.digest(h)}const d=a/2,y=b(l),g=y.slice(0,d),v=y.slice(d,a),E=e=>({iv:e.slice(0,i),cipherKey:e.slice(i,i+s),macKey:e.slice(i+s)});return{k1:E(g),k2:E(v)}}var E=r(44234),A=(r(97116),r(15764),r(50124));function S(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.slice(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=b([new Uint8Array(t-r.length),r])}return(0,A.B)(r,"base64url")}function _(e){const t=C(e);return new d.jsbn.BigInteger((0,A.B)(t,"base16"),16)}function C(e,t){let r=(0,p.m)(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=b([new Uint8Array(t-r.length),r])}return r}function k(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const I={"P-256":256,"P-384":384,"P-521":521},T=Object.keys(I).join(" / ");const x={"P-256":32,"P-384":48,"P-521":66};function R(e){if(null==e.crv||null==e.x||null==e.y)throw f(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");if("P-256"!==e.crv&&"P-384"!==e.crv&&"P-521"!==e.crv)throw f(new Error(`Unknown curve: ${e.crv}. Must be ${T}`),"ERR_INVALID_CURVE");const t=x[e.crv];return b([Uint8Array.from([4]),C(e.x,t),C(e.y,t)],1+2*t)}function P(e,t){if("P-256"!==e&&"P-384"!==e&&"P-521"!==e)throw f(new Error(`Unknown curve: ${e}. Must be ${T}`),"ERR_INVALID_CURVE");const r=x[e];if(!k(t.slice(0,1),Uint8Array.from([4])))throw f(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:e,x:(0,A.B)(t.slice(1,r+1),"base64url"),y:(0,A.B)(t.slice(1+r),"base64url"),ext:!0}}const D=(e,t)=>({...P(e,t.public),d:(0,A.B)(t.private,"base64url")}),O=async function(e){if("P-256"!==e&&"P-384"!==e&&"P-521"!==e)throw f(new Error(`Unknown curve: ${e}. Must be ${T}`),"ERR_INVALID_CURVE");const t=await E.Z.get().subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]);return{key:R(await E.Z.get().subtle.exportKey("jwk",t.publicKey)),genSharedKey:async(r,n)=>{let s;s=null!=n?await E.Z.get().subtle.importKey("jwk",D(e,n),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):t.privateKey;const i=await E.Z.get().subtle.importKey("jwk",P(e,r),{name:"ECDH",namedCurve:e},!1,[]),o=await E.Z.get().subtle.deriveBits({name:"ECDH",namedCurve:e,public:i},s,I[e]);return new Uint8Array(o,0,o.byteLength)}}};var N=r(55305);function L(e){const t=e?.algorithm??"AES-GCM";let r=e?.keyLength??16;const n=e?.nonceLength??12,s=e?.digest??"SHA-256",i=e?.saltLength??16,o=e?.iterations??32767,a=E.Z.get();r*=8;return{encrypt:async function(e,c){const h=a.getRandomValues(new Uint8Array(i)),l=a.getRandomValues(new Uint8Array(n)),u={name:t,iv:l};"string"==typeof c&&(c=(0,p.m)(c));const d={name:"PBKDF2",salt:h,iterations:o,hash:{name:s}},f=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),y=await a.subtle.deriveKey(d,f,{name:t,length:r},!0,["encrypt"]),g=await a.subtle.encrypt(u,y,e);return b([h,u.iv,new Uint8Array(g)])},decrypt:async function(e,c){const h=e.slice(0,i),l=e.slice(i,i+n),u=e.slice(i+n),d={name:t,iv:l};"string"==typeof c&&(c=(0,p.m)(c));const f={name:"PBKDF2",salt:h,iterations:o,hash:{name:s}},y=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),g=await a.subtle.deriveKey(f,y,{name:t,length:r},!0,["decrypt"]),b=await a.subtle.decrypt(d,g,u);return new Uint8Array(b)}}}var U=r(85045),B=(r(63219),r(95887));r(28095);function M(e,t){return t.map((t=>_(e[t])))}async function V(e){const t=[await E.Z.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await j(e)],r=await z({privateKey:t[0],publicKey:t[1]});return{privateKey:r[0],publicKey:r[1]}}async function z(e){if(null==e.privateKey||null==e.publicKey)throw f(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([E.Z.get().subtle.exportKey("jwk",e.privateKey),E.Z.get().subtle.exportKey("jwk",e.publicKey)])}async function j(e){return await E.Z.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function F(e,t,r,n){const s=t?function(e){return d.pki.setRsaPublicKey(...M(e,["n","e"]))}(e):function(e){return d.pki.setRsaPrivateKey(...M(e,["n","e","d","p","q","dp","dq","qi"]))}(e),i=n((0,A.B)(Uint8Array.from(r),"ascii"),s);return(0,p.m)(i,"ascii")}async function $(e,t){const r=L(),n=await r.encrypt(e,t);return N.base64.encode(n)}class q{constructor(e){this._key=e}async verify(e,t){return await async function(e,t,r){const n=await E.Z.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await E.Z.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw f(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const t=d.pki.publicKeyToAsn1({n:_(e.n),e:_(e.e)});return(0,p.m)(d.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return h.encode({Type:a.RSA,Data:this.marshal()}).subarray()}encrypt(e){return F(this._key,!0,e,((e,t)=>t.encrypt(e)))}equals(e){return k(this.bytes,e.bytes)}async hash(){const{bytes:e}=await U.sha256.digest(this.bytes);return e}}class K{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return B.Z(16)}async sign(e){return await async function(e,t){const r=await E.Z.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await E.Z.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw f(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new q(this._publicKey)}decrypt(e){return F(this._key,!1,e,((e,t)=>t.decrypt(e)))}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw f(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");const t=d.pki.privateKeyToAsn1({n:_(e.n),e:_(e.e),d:_(e.d),p:_(e.p),q:_(e.q),dP:_(e.dp),dQ:_(e.dq),qInv:_(e.qi)});return(0,p.m)(d.asn1.toDer(t).getBytes(),"ascii")}(this._key)}get bytes(){return l.encode({Type:a.RSA,Data:this.marshal()}).subarray()}equals(e){return k(this.bytes,e.bytes)}async hash(){const{bytes:e}=await U.sha256.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,A.B)(e,"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new d.util.ByteBuffer(this.marshal()),r=d.asn1.fromDer(t),n=d.pki.privateKeyFromAsn1(r),s={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return d.pki.encryptRsaPrivateKey(n,e,s)}if("libp2p-key"===t)return await $(this.bytes,e);throw f(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}async function H(e){const t=function(e){const t=d.asn1.fromDer((0,A.B)(e,"ascii")),r=d.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:S(r.n),e:S(r.e),d:S(r.d),p:S(r.p),q:S(r.q),dp:S(r.dP),dq:S(r.dQ),qi:S(r.qInv),alg:"RS256"}}(e),r=await V(t);return new K(r.privateKey,r.publicKey)}function G(e){const t=function(e){const t=d.asn1.fromDer((0,A.B)(e,"ascii")),r=d.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:S(r.n),e:S(r.e)}}(e);return new q(t)}async function W(e){const t=await V(e);return new K(t.privateKey,t.publicKey)}async function J(e){const t=await async function(e){const t=await E.Z.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await z(t);return{privateKey:r[0],publicKey:r[1]}}(e);return new K(t.privateKey,t.publicKey)}var Y=r(19102),Q=r(70372),Z=r(7420),X=r.t(Z,2);const ee=BigInt(0),te=BigInt(1),re=BigInt(2),ne=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),se=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:ne,n:ne,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),ie=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),oe=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),ae=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),ce=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),he=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),le=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class ue{constructor(e,t,r,n){this.x=e,this.y=t,this.z=r,this.t=n}static fromAffine(e){if(!(e instanceof be))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(be.ZERO)?ue.ZERO:new ue(e.x,e.y,te,xe(e.x*e.y))}static toAffineBatch(e){const t=function(e,t=se.P){const r=new Array(e.length),n=Re(e.reduce(((e,n,s)=>n===ee?e:(r[s]=e,xe(e*n,t))),te),t);return e.reduceRight(((e,n,s)=>n===ee?e:(r[s]=xe(e*r[s],t),xe(e*n,t))),n),r}(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){de(e);const{x:t,y:r,z:n}=this,{x:s,y:i,z:o}=e,a=xe(t*o),c=xe(s*n),h=xe(r*o),l=xe(i*n);return a===c&&h===l}negate(){return new ue(xe(-this.x),this.y,this.z,xe(-this.t))}double(){const{x:e,y:t,z:r}=this,{a:n}=se,s=xe(e*e),i=xe(t*t),o=xe(re*xe(r*r)),a=xe(n*s),c=e+t,h=xe(xe(c*c)-s-i),l=a+i,u=l-o,d=a-i,f=xe(h*u),p=xe(l*d),y=xe(h*d),g=xe(u*l);return new ue(f,p,g,y)}add(e){de(e);const{x:t,y:r,z:n,t:s}=this,{x:i,y:o,z:a,t:c}=e,h=xe((r-t)*(o+i)),l=xe((r+t)*(o-i)),u=xe(l-h);if(u===ee)return this.double();const d=xe(n*re*c),f=xe(s*re*a),p=f+d,y=l+h,g=f-d,b=xe(p*u),m=xe(y*g),w=xe(p*g),v=xe(u*y);return new ue(b,m,v,w)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,r=[];let n=this,s=n;for(let i=0;i<t;i++){s=n,r.push(s);for(let t=1;t<2**(e-1);t++)s=s.add(n),r.push(s);n=s.double()}return r}wNAF(e,t){!t&&this.equals(ue.BASE)&&(t=be.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&ge.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=ue.normalizeZ(n),ge.set(t,n)));let s=ue.ZERO,i=ue.ZERO;const o=1+256/r,a=2**(r-1),c=BigInt(2**r-1),h=2**r,l=BigInt(r);for(let t=0;t<o;t++){const r=t*a;let o=Number(e&c);if(e>>=l,o>a&&(o-=h,e+=te),0===o){let e=n[r];t%2&&(e=e.negate()),i=i.add(e)}else{let e=n[r+Math.abs(o)-1];o<0&&(e=e.negate()),s=s.add(e)}}return ue.normalizeZ([s,i])[0]}multiply(e,t){return this.wNAF(Be(e,se.l),t)}multiplyUnsafe(e){let t=Be(e,se.l,!1);const r=ue.BASE,n=ue.ZERO;if(t===ee)return n;if(this.equals(n)||t===te)return this;if(this.equals(r))return this.wNAF(t);let s=n,i=this;for(;t>ee;)t&te&&(s=s.add(i)),i=i.double(),t>>=te;return s}isSmallOrder(){return this.multiplyUnsafe(se.h).equals(ue.ZERO)}isTorsionFree(){return this.multiplyUnsafe(se.l).equals(ue.ZERO)}toAffine(e=Re(this.z)){const{x:t,y:r,z:n}=this,s=xe(t*e),i=xe(r*e);if(xe(n*e)!==te)throw new Error("invZ was invalid");return new be(s,i)}fromRistrettoBytes(){pe()}toRistrettoBytes(){pe()}fromRistrettoHash(){pe()}}function de(e){if(!(e instanceof ue))throw new TypeError("ExtendedPoint expected")}function fe(e){if(!(e instanceof ye))throw new TypeError("RistrettoPoint expected")}function pe(){throw new Error("Legacy method: switch to RistrettoPoint")}ue.BASE=new ue(se.Gx,se.Gy,te,xe(se.Gx*se.Gy)),ue.ZERO=new ue(ee,te,te,ee);class ye{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=se,r=xe(oe*e*e),n=xe((r+te)*he);let s=BigInt(-1);const i=xe((s-t*r)*xe(r+t));let{isValid:o,value:a}=Oe(n,i),c=xe(a*e);Ce(c)||(c=xe(-c)),o||(a=c),o||(s=r);const h=xe(s*(r-te)*le-i),l=a*a,u=xe((a+a)*i),d=xe(h*ae),f=xe(te-l),p=xe(te+l);return new ue(xe(u*p),xe(f*d),xe(d*p),xe(u*f))}static hashToCurve(e){const t=Te((e=Ue(e,64)).slice(0,32)),r=this.calcElligatorRistrettoMap(t),n=Te(e.slice(32,64)),s=this.calcElligatorRistrettoMap(n);return new ye(r.add(s))}static fromHex(e){e=Ue(e,32);const{a:t,d:r}=se,n="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Te(e);if(!function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(_e(s),e)||Ce(s))throw new Error(n);const i=xe(s*s),o=xe(te+t*i),a=xe(te-t*i),c=xe(o*o),h=xe(a*a),l=xe(t*r*c-h),{isValid:u,value:d}=Ne(xe(l*h)),f=xe(d*a),p=xe(d*f*l);let y=xe((s+s)*f);Ce(y)&&(y=xe(-y));const g=xe(o*p),b=xe(y*g);if(!u||Ce(b)||g===ee)throw new Error(n);return new ye(new ue(y,g,te,b))}toRawBytes(){let{x:e,y:t,z:r,t:n}=this.ep;const s=xe(xe(r+t)*xe(r-t)),i=xe(e*t),o=xe(i*i),{value:a}=Ne(xe(s*o)),c=xe(a*s),h=xe(a*i),l=xe(c*h*n);let u;if(Ce(n*l)){let r=xe(t*oe),n=xe(e*oe);e=r,t=n,u=xe(c*ce)}else u=h;Ce(e*l)&&(t=xe(-t));let d=xe((r-t)*u);return Ce(d)&&(d=xe(-d)),_e(d)}toHex(){return Ee(this.toRawBytes())}toString(){return this.toHex()}equals(e){fe(e);const t=this.ep,r=e.ep,n=xe(t.x*r.y)===xe(t.y*r.x),s=xe(t.y*r.y)===xe(t.x*r.x);return n||s}add(e){return fe(e),new ye(this.ep.add(e.ep))}subtract(e){return fe(e),new ye(this.ep.subtract(e.ep))}multiply(e){return new ye(this.ep.multiply(e))}multiplyUnsafe(e){return new ye(this.ep.multiplyUnsafe(e))}}ye.BASE=new ye(ue.BASE),ye.ZERO=new ye(ue.ZERO);const ge=new WeakMap;class be{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,ge.delete(this)}static fromHex(e,t=!0){const{d:r,P:n}=se,s=(e=Ue(e,32)).slice();s[31]=-129&e[31];const i=ke(s);if(t&&i>=n)throw new Error("Expected 0 < hex < P");if(!t&&i>=ie)throw new Error("Expected 0 < hex < 2**256");const o=xe(i*i),a=xe(o-te),c=xe(r*o+te);let{isValid:h,value:l}=Oe(a,c);if(!h)throw new Error("Point.fromHex: invalid y coordinate");const u=(l&te)===te;return 0!=(128&e[31])!==u&&(l=xe(-l)),new be(l,i)}static async fromPrivateKey(e){return(await Fe(e)).point}toRawBytes(){const e=_e(this.y);return e[31]|=this.x&te?128:0,e}toHex(){return Ee(this.toRawBytes())}toX25519(){const{y:e}=this;return _e(xe((te+e)*Re(te-e)))}isTorsionFree(){return ue.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new be(xe(-this.x),this.y)}add(e){return ue.fromAffine(this).add(ue.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ue.fromAffine(this).multiply(e,this).toAffine()}}be.BASE=new be(se.Gx,se.Gy),be.ZERO=new be(ee,te);class me{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=Ue(e,64),r=be.fromHex(t.slice(0,32),!1),n=ke(t.slice(32,64));return new me(r,n)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof be))throw new Error("Expected Point instance");return Be(t,se.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(_e(this.s),32),e}toHex(){return Ee(this.toRawBytes())}}function we(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}const ve=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Ee(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=ve[e[r]];return t}function Ae(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,s=e.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[r]=i}return t}function Se(e){return Ae(e.toString(16).padStart(64,"0"))}function _e(e){return Se(e).reverse()}function Ce(e){return(xe(e)&te)===te}function ke(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Ee(Uint8Array.from(e).reverse()))}const Ie=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Te(e){return xe(ke(e)&Ie)}function xe(e,t=se.P){const r=e%t;return r>=ee?r:t+r}function Re(e,t=se.P){if(e===ee||t<=ee)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=xe(e,t),n=t,s=ee,i=te,o=te,a=ee;for(;r!==ee;){const e=n/r,t=n%r,c=s-o*e,h=i-a*e;n=r,r=t,s=o,i=a,o=c,a=h}if(n!==te)throw new Error("invert: does not exist");return xe(s,t)}function Pe(e,t){const{P:r}=se;let n=e;for(;t-- >ee;)n*=n,n%=r;return n}function De(e){const{P:t}=se,r=BigInt(5),n=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),a=e*e%t*e%t,c=Pe(a,re)*a%t,h=Pe(c,te)*e%t,l=Pe(h,r)*h%t,u=Pe(l,n)*l%t,d=Pe(u,s)*u%t,f=Pe(d,i)*d%t,p=Pe(f,o)*f%t,y=Pe(p,o)*f%t,g=Pe(y,n)*l%t;return{pow_p_5_8:Pe(g,re)*e%t,b2:a}}function Oe(e,t){const r=xe(t*t*t),n=xe(r*r*t);let s=xe(e*r*De(e*n).pow_p_5_8);const i=xe(t*s*s),o=s,a=xe(s*oe),c=i===e,h=i===xe(-e),l=i===xe(-e*oe);return c&&(s=o),(h||l)&&(s=a),Ce(s)&&(s=xe(-s)),{isValid:c||h,value:s}}function Ne(e){return Oe(te,e)}function Le(e){return xe(ke(e),se.l)}function Ue(e,t){const r=e instanceof Uint8Array?Uint8Array.from(e):Ae(e);if("number"==typeof t&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function Be(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if("number"==typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"==typeof e&&e<t)if(r){if(ee<e)return e}else if(ee<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Me(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Ve(e){if(32!==(e="bigint"==typeof e||"number"==typeof e?Se(Be(e,ie)):Ue(e)).length)throw new Error("Expected 32 bytes");return e}function ze(e){const t=Me(e.slice(0,32)),r=e.slice(32,64),n=Le(t),s=be.BASE.multiply(n),i=s.toRawBytes();return{head:t,prefix:r,scalar:n,point:s,pointBytes:i}}let je;async function Fe(e){return ze(await Ge.sha512(Ve(e)))}async function $e(e){return(await Fe(e)).pointBytes}function qe(e,t,r){t=Ue(t),r instanceof be||(r=be.fromHex(r,!1));const{r:n,s}=e instanceof me?e.assertValidity():me.fromHex(e);return{r:n,s,SB:ue.BASE.multiplyUnsafe(s),pub:r,msg:t}}function Ke(e,t,r,n){const s=Le(n),i=ue.fromAffine(e).multiplyUnsafe(s);return ue.fromAffine(t).add(i).subtract(r).multiplyUnsafe(se.h).equals(ue.ZERO)}be.BASE._setWindowSize(8);const He={node:X,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Ge={bytesToHex:Ee,hexToBytes:Ae,concatBytes:we,getExtendedPublicKey:Fe,mod:xe,invert:Re,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if((e=Ue(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return xe(ke(e),se.l-te)+te},randomBytes:(e=32)=>{if(He.web)return He.web.getRandomValues(new Uint8Array(e));if(He.node){const{randomBytes:t}=He.node;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ge.randomBytes(32),sha512:async(...e)=>{const t=we(...e);if(He.web){const e=await He.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}if(He.node)return Uint8Array.from(He.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")},precompute(e=8,t=be.BASE){const r=t.equals(be.BASE)?t:new be(t.x,t.y);return r._setWindowSize(e),r.multiply(re),r},sha512Sync:void 0};Object.defineProperties(Ge,{sha512Sync:{configurable:!1,get:()=>je,set(e){je||(je=e)}}});const We=64;async function Je(e,t){const r=e.slice(0,32);return await async function(e,t){e=Ue(e);const{prefix:r,scalar:n,pointBytes:s}=await Fe(t),i=Le(await Ge.sha512(r,e)),o=be.BASE.multiply(i),a=xe(i+Le(await Ge.sha512(o.toRawBytes(),s,e))*n,se.l);return new me(o,a).toRawBytes()}(t,r)}async function Ye(e,t,r){return await async function(e,t,r){const{r:n,SB:s,msg:i,pub:o}=qe(e,t,r),a=await Ge.sha512(n.toRawBytes(),o.toRawBytes(),i);return Ke(o,n,s,a)}(t,r,e)}function Qe(e,t){const r=new Uint8Array(We);for(let n=0;n<32;n++)r[n]=e[n],r[32+n]=t[n];return r}class Ze{constructor(e){this._key=st(e,32)}async verify(e,t){return await Ye(this._key,t,e)}marshal(){return this._key}get bytes(){return h.encode({Type:a.Ed25519,Data:this.marshal()}).subarray()}equals(e){return k(this.bytes,e.bytes)}async hash(){const{bytes:e}=await U.sha256.digest(this.bytes);return e}}class Xe{constructor(e,t){this._key=st(e,We),this._publicKey=st(t,32)}async sign(e){return await Je(this._key,e)}get public(){return new Ze(this._publicKey)}marshal(){return this._key}get bytes(){return l.encode({Type:a.Ed25519,Data:this.marshal()}).subarray()}equals(e){return k(this.bytes,e.bytes)}async hash(){const{bytes:e}=await U.sha256.digest(this.bytes);return e}async id(){const e=await Q.identity.digest(this.public.bytes);return Y.base58btc.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await $(this.bytes,e);throw f(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function et(e){if(e.length>We){const t=(e=st(e,96)).slice(0,We),r=e.slice(We,e.length);return new Xe(t,r)}const t=(e=st(e,We)).slice(0,We),r=e.slice(32);return new Xe(t,r)}function tt(e){return e=st(e,32),new Ze(e)}async function rt(){const{privateKey:e,publicKey:t}=await async function(){const e=Ge.randomPrivateKey(),t=await $e(e);return{privateKey:Qe(e,t),publicKey:t}}();return new Xe(e,t)}async function nt(e){const{privateKey:t,publicKey:r}=await async function(e){if(32!==e.length)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,r=await $e(t);return{privateKey:Qe(t,r),publicKey:r}}(e);return new Xe(t,r)}function st(e,t){if((e=Uint8Array.from(e??[])).length!==t)throw f(new Error(`Key must be a Uint8Array of length ${t}, got ${e.length}`),"ERR_INVALID_KEY_TYPE");return e}var it=r(27760);function ot(e){try{it.E9.fromHex(e)}catch(e){throw f(e,"ERR_INVALID_PUBLIC_KEY")}}class at{constructor(e){ot(e),this._key=e}async verify(e,t){return await async function(e,t,r){try{const{digest:n}=await U.sha256.digest(r);return it.T(t,n,e)}catch(e){throw f(e,"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,it.E9.fromHex(e).toRawBytes(!0);var e}get bytes(){return h.encode({Type:a.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return k(this.bytes,e.bytes)}async hash(){const{bytes:e}=await U.sha256.digest(this.bytes);return e}}class ct{constructor(e,t){this._key=e,this._publicKey=t??function(e){try{return it.$3(e,!0)}catch(e){throw f(e,"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{it.$3(e,!0)}catch(e){throw f(e,"ERR_INVALID_PRIVATE_KEY")}}(this._key),ot(this._publicKey)}async sign(e){return await async function(e,t){const{digest:r}=await U.sha256.digest(t);try{return await it.Xx(r,e)}catch(e){throw f(e,"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new at(this._publicKey)}marshal(){return this._key}get bytes(){return l.encode({Type:a.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return k(this.bytes,e.bytes)}async hash(){const{bytes:e}=await U.sha256.digest(this.bytes);return e}async id(){const e=await this.public.hash();return(0,A.B)(e,"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await $(this.bytes,e);throw f(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function ht(e){return new ct(e)}function lt(e){return new at(e)}async function ut(){const e=await it.P6.randomPrivateKey();return new ct(e)}const dt={rsa:s,ed25519:i,secp256k1:o};function ft(e){const t=Object.keys(dt).join(" / ");return f(new Error(`invalid or unsupported key type ${e}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}function pt(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return dt[e];throw ft(e)}async function yt(e,t){return await pt(e).generateKeyPair(t??2048)}async function gt(e,t,r){if("ed25519"!==e.toLowerCase())throw f(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return await nt(t)}function bt(e){const t=h.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case a.RSA:return dt.rsa.unmarshalRsaPublicKey(r);case a.Ed25519:return dt.ed25519.unmarshalEd25519PublicKey(r);case a.Secp256k1:return dt.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw ft(t.Type??"RSA")}}function mt(e,t){return pt(t=(t??"rsa").toLowerCase()),e.bytes}async function wt(e){const t=l.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case a.RSA:return await dt.rsa.unmarshalRsaPrivateKey(r);case a.Ed25519:return dt.ed25519.unmarshalEd25519PrivateKey(r);case a.Secp256k1:return dt.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw ft(t.Type??"RSA")}}function vt(e,t){return pt(t=(t??"rsa").toLowerCase()),e.bytes}async function Et(e,t){try{const r=await async function(e,t){const r=N.base64.decode(e),n=L();return await n.decrypt(r,t)}(e,t);return await wt(r)}catch(e){}const r=d.pki.decryptRsaPrivateKey(e,t);if(null===r)throw f(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=d.asn1.toDer(d.pki.privateKeyToAsn1(r));return n=(0,p.m)(n.getBytes(),"ascii"),await dt.rsa.unmarshalRsaPrivateKey(n)}},95887:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(27760),s=r(32114);function i(e){if(isNaN(e)||e<=0)throw s(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return n.P6.randomBytes(e)}},44234:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}}},54676:(e,t,r)=>{"use strict";r.d(t,{kU:()=>u,Dp:()=>l,ET:()=>d});const n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};var s=r(44072);class i{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class o{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i(e,t,r),this.decoder=new o(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),u=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:o}=n(r,t);return l({prefix:e,name:t,encode:i,decode:e=>(0,s.oQ)(o(e))})},d=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)})},19102:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base58btc:()=>s,base58flickr:()=>i});var n=r(54676);const s=(0,n.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),i=(0,n.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},55305:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base64:()=>s,base64pad:()=>i,base64url:()=>o,base64urlpad:()=>a});var n=r(54676);const s=(0,n.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),i=(0,n.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),o=(0,n.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),a=(0,n.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})},44072:(e,t,r)=>{"use strict";r.d(t,{BB:()=>i,mL:()=>s,oQ:()=>n});new Uint8Array(0);const n=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),i=e=>(new TextDecoder).decode(e)},11186:(e,t,r)=>{"use strict";r.d(t,{Ue:()=>s});r(44072);var n=r(18962);const s=(e,t)=>{const r=t.byteLength,s=n.P$(e),o=s+n.P$(r),a=new Uint8Array(o+r);return n.mL(e,a,0),n.mL(r,a,s),a.set(t,o),new i(e,r,t,a)};class i{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}},41124:(e,t,r)=>{"use strict";r.d(t,{D:()=>s});var n=r(11186);const s=({name:e,code:t,encode:r})=>new i(e,t,r);class i{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?n.Ue(this.code,t):t.then((e=>n.Ue(this.code,e)))}throw Error("Unknown type, must be binary type")}}},70372:(e,t,r)=>{"use strict";r.r(t),r.d(t,{identity:()=>o});var n=r(44072),s=r(11186);const i=n.oQ,o={code:0,name:"identity",encode:i,digest:e=>s.Ue(0,i(e))}},85045:(e,t,r)=>{"use strict";r.r(t),r.d(t,{sha256:()=>i,sha512:()=>o});var n=r(41124);const s=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),i=(0,n.D)({name:"sha2-256",code:18,encode:s("SHA-256")}),o=(0,n.D)({name:"sha2-512",code:19,encode:s("SHA-512")})},18962:(e,t,r)=>{"use strict";r.d(t,{mL:()=>g,P$:()=>b});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t,r=0)=>(y.encode(e,t,r),t),b=e=>y.encodingLength(e)},91343:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var n=r(46327);function s(e=0){return null!=globalThis.Buffer?.allocUnsafe?(0,n.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},91794:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var n=r(34536),s=r(46327);function i(e,t="utf8"){const r=n.Z[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):(0,s.P)(globalThis.Buffer.from(e,"utf-8"))}},50124:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var n=r(34536);function s(e,t="utf8"){const r=n.Z[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},46327:(e,t,r)=>{"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}r.d(t,{P:()=>n})},34536:(e,t,r)=>{"use strict";r.d(t,{Z:()=>re});var n={};r.r(n),r.d(n,{identity:()=>y});var s={};r.r(s),r.d(s,{base2:()=>g});var i={};r.r(i),r.d(i,{base8:()=>b});var o={};r.r(o),r.d(o,{base10:()=>m});var a={};r.r(a),r.d(a,{base16:()=>w,base16upper:()=>v});var c={};r.r(c),r.d(c,{base32:()=>E,base32hex:()=>C,base32hexpad:()=>I,base32hexpadupper:()=>T,base32hexupper:()=>k,base32pad:()=>S,base32padupper:()=>_,base32upper:()=>A,base32z:()=>x});var h={};r.r(h),r.d(h,{base36:()=>R,base36upper:()=>P});var l={};r.r(l),r.d(l,{base256emoji:()=>B});var u={};r.r(u),r.d(u,{code:()=>j,decode:()=>$,encode:()=>F,name:()=>z});var d={};r.r(d),r.d(d,{code:()=>G,decode:()=>J,encode:()=>W,name:()=>H});var f=r(54676),p=r(44072);const y=(0,f.Dp)({prefix:"\0",name:"identity",encode:e=>(0,p.BB)(e),decode:e=>(0,p.mL)(e)}),g=(0,f.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),b=(0,f.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),m=(0,f.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),w=(0,f.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),v=(0,f.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),E=(0,f.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),A=(0,f.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),S=(0,f.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_=(0,f.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),C=(0,f.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),k=(0,f.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),I=(0,f.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),T=(0,f.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x=(0,f.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),R=(0,f.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),P=(0,f.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var D=r(19102),O=r(55305);const N=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),L=N.reduce(((e,t,r)=>(e[r]=t,e)),[]),U=N.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const B=(0,f.Dp)({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=L[t]),"")},decode:function(e){const t=[];for(const r of e){const e=U[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var M=r(85045),V=r(70372);const z="raw",j=85,F=e=>(0,p.oQ)(e),$=e=>(0,p.oQ)(e),q=new TextEncoder,K=new TextDecoder,H="json",G=512,W=e=>q.encode(JSON.stringify(e)),J=e=>JSON.parse(K.decode(e));r(18962),r(11186);new WeakMap;class Y{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Y.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Y.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Y.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Y)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Y(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Y.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Y(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Y(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Y.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Y.create(1,e,t)}static decode(e){const[t,r]=Y.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Y.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Y.createV0(i):Y.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Y.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");r(41124);const Q={...n,...s,...i,...o,...a,...c,...h,...D,...O,...l};var Z=r(91343);function X(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ee=X("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),te=X("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=(0,Z.E)(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),re={utf8:ee,"utf-8":ee,hex:Q.base16,latin1:te,ascii:te,binary:te,...Q}},35505:(e,t,r)=>{"use strict";r.d(t,{OP:()=>p});var n=r(38461),s=r(15999),i=r(57665),o=r(85275),a=r(32114),c=r(32044);const h=(0,n.kg)("libp2p:delegated-content-routing"),l=3e4;var u,d;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(u||(u={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(d||(d={}));class f{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new i.Z({concurrency:4}),this.httpQueueRefs=new i.Z({concurrency:2});const{protocol:t,host:r,port:n}=e.getEndpointConfig();h(`enabled DelegatedContentRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,t={}){h("findProviders starts: %c",e),t.timeout=t.timeout??l,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=(0,o.Z)(),n=(0,o.Z)();this.httpQueue.add((async()=>(r.resolve(),await n.promise)));try{await r.promise;for await(const r of this.client.dht.findProvs(e,t))"PROVIDER"===r.name&&(yield*r.providers.map((e=>({id:e.id,protocols:[],multiaddrs:e.multiaddrs}))))}catch(e){throw h.error("findProviders errored:",e),e}finally{n.resolve(),h("findProviders finished: %c",e)}}async provide(e,t={}){h("provide starts: %c",e),t.timeout=t.timeout??l,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueueRefs.add((async()=>{await this.client.block.stat(e,t),await s(this.client.dht.provide(e,t))})),h("provide finished: %c",e)}async put(e,t,r={}){h("put value start: %b",e),r.timeout=r.timeout??l,r.signal=c([this.abortController.signal].concat(null!=r.signal?[r.signal]:[])),await this.httpQueue.add((async()=>{await s(this.client.dht.put(e,t,r))})),h("put value finished: %b",e)}async get(e,t={}){return h("get value start: %b",e),t.timeout=t.timeout??l,t.signal=c([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueue.add((async()=>{for await(const r of this.client.dht.get(e,t))if("VALUE"===r.name)return h("get value finished: %b",e),r.value;throw a(new Error("Not found"),"ERR_NOT_FOUND")}))}}function p(e){return()=>new f(e)}},77395:(e,t,r)=>{"use strict";r.d(t,{e8:()=>Z});var n=r(38461),s=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=i;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},i=Math.pow(2,31);var o=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var a=Math.pow(2,7),c=Math.pow(2,14),h=Math.pow(2,21),l=Math.pow(2,28),u=Math.pow(2,35),d=Math.pow(2,42),f=Math.pow(2,49),p=Math.pow(2,56),y=Math.pow(2,63);const g={encode:s,decode:o,encodingLength:function(e){return e<a?1:e<c?2:e<h?3:e<l?4:e<u?5:e<d?6:e<f?7:e<p?8:e<y?9:10}},b=(e,t=0)=>[g.decode(e,t),g.decode.bytes],m=(e,t,r=0)=>(g.encode(e,t,r),t),w=e=>g.encodingLength(e),v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class E{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const A=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class S{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return k(this,e)}}class C{constructor(e){this.decoders=e}or(e){return k(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const k=(e,t)=>new C({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class I{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new S(e,t,r),this.decoder=new _(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const T=({name:e,prefix:t,encode:r,decode:n})=>new I(e,t,r,n),x=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=A(r,t);return T({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},R=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>T({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),P=x({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),D=(x({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),R({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),O=(R({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),R({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),R({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),R({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),R({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),R({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),R({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),R({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),N=e=>{const t=O.get(e);if(null==t){const t=new Map;return O.set(e,t),t}return t};class L{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==V)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==z)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return L.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=w(e),s=n+w(r),i=new Uint8Array(s+r);return m(e,i,0),m(r,i,n),i.set(t,s),new E(e,r,t,i)})(e,t);return L.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return L.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?B(r,N(e),t||P.encoder):M(r,N(e),t||D.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof L)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new L(e,r,n,s||j(e,r,n.bytes))}if(!0===t[F]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=v(e),[r,n]=b(t),[s,i]=b(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new E(r,s,o,t)})(r);return L.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==V)throw new Error(`Version 0 CID must use dag-pb (code: ${V}) block encoding`);return new L(e,t,r,r.bytes);case 1:{const n=j(e,t,r.bytes);return new L(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return L.create(0,V,e)}static createV1(e,t){return L.create(1,e,t)}static decode(e){const[t,r]=L.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=L.inspectBytes(e),r=t.size-t.multihashSize,n=v(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new E(t.multihashCode,t.digestSize,s,n);return[0===t.version?L.createV0(i):L.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=b(e.subarray(t));return t+=n,r};let n=r(),s=V;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=U(e,t),s=L.decode(n);return N(s).set(r,e),s}}const U=(e,t)=>{switch(e[0]){case"Q":{const r=t||P;return[P.prefix,r.decode(`${P.prefix}${e}`)]}case P.prefix:{const r=t||P;return[P.prefix,r.decode(e)]}case D.prefix:{const r=t||D;return[D.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},B=(e,t,r)=>{const{prefix:n}=r;if(n!==P.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},M=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},V=112,z=18,j=(e,t,r)=>{const n=w(e),s=n+w(t),i=new Uint8Array(s+r.byteLength);return m(e,i,0),m(t,i,n),i.set(r,s),i},F=Symbol.for("@ipld/js-cid/CID");var $=r(57665),q=r(85275),K=r(32114),H=r(32044),G=r(93203);const W=(0,n.kg)("libp2p-delegated-peer-routing");var J,Y;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(J||(J={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(Y||(Y={}));class Q{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new $.Z({concurrency:4});const{protocol:t,host:r,port:n}=e.getEndpointConfig();W(`enabled DelegatedPeerRouting via ${t}://${r}:${n}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,t={}){W("findPeer starts: %p",e),t.timeout=t.timeout??3e4,t.signal=H([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const r=(0,q.Z)(),n=(0,q.Z)();this.httpQueue.add((async()=>(r.resolve(),await n.promise)));try{await r.promise;for await(const r of this.client.dht.findPeer(e,t))if("FINAL_PEER"===r.name){return{id:r.peer.id,multiaddrs:r.peer.multiaddrs,protocols:[]}}}catch(e){throw W.error("findPeer errored: %o",e),e}finally{n.resolve(),W("findPeer finished: %p",e)}throw K(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){let r;const n=L.asCID(e);r=null!=n?n:(0,G.cv)(e),W("getClosestPeers starts: %s",r),t.timeout=t.timeout??3e4,t.signal=H([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const s=(0,q.Z)(),i=(0,q.Z)();this.httpQueue.add((async()=>(s.resolve(),await i.promise)));try{await s.promise;for await(const e of this.client.dht.query(r,t))"PEER_RESPONSE"===e.name&&(yield*e.closer.map((e=>({id:e.id,multiaddrs:e.multiaddrs,protocols:[]}))))}catch(e){throw W.error("getClosestPeers errored:",e),e}finally{i.resolve(),W("getClosestPeers finished: %b",e)}}}function Z(e){return()=>new Q(e)}},59769:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});const n=Symbol.for("@libp2p/peer-discovery")},682:(e,t,r)=>{"use strict";r.d(t,{I:()=>s,N:()=>n});const n=Symbol.for("@libp2p/peer-id");function s(e){return null!=e&&Boolean(e[n])}},1388:(e,t,r)=>{"use strict";r.d(t,{d:()=>n,w:()=>s});const n=Symbol.for("@libp2p/topology");function s(e){return null!=e&&Boolean(e[n])}},12348:(e,t,r)=>{"use strict";r.d(t,{N:()=>n});const n=Symbol.for("@libp2p/transport")},52770:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});class n extends Error{constructor(e="The operation was aborted"){super(e),this.code=n.code,this.type=n.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}},46857:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,v:()=>i});var n,s=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class i extends EventTarget{constructor(){super(...arguments),n.set(this,new Map)}listenerCount(e){const t=s(this,n,"f").get(e);return null==t?0:t.length}addEventListener(e,t,r){super.addEventListener(e,t,r);let i=s(this,n,"f").get(e);null==i&&(i=[],s(this,n,"f").set(e,i)),i.push({callback:t,once:(!0!==r&&!1!==r&&r?.once)??!1})}removeEventListener(e,t,r){super.removeEventListener(e.toString(),t??null,r);let i=s(this,n,"f").get(e);null!=i&&(i=i.filter((({callback:e})=>e!==t)),s(this,n,"f").set(e,i))}dispatchEvent(e){const t=super.dispatchEvent(e);let r=s(this,n,"f").get(e.type);return null==r||(r=r.filter((({once:e})=>!e)),s(this,n,"f").set(e.type,r)),t}}n=new WeakMap;class o extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}}const a=globalThis.CustomEvent??o},57447:(e,t,r)=>{"use strict";function n(e){return null!=e&&"function"==typeof e.start&&"function"==typeof e.stop}r.d(t,{qK:()=>n})},66756:(e,t,r)=>{"use strict";r.d(t,{p:()=>Bs});var n={};r.r(n),r.d(n,{sha256:()=>ee,sha512:()=>te});var s={};r.r(s),r.d(s,{identity:()=>pe});var i={};r.r(i),r.d(i,{base2:()=>ye});var o={};r.r(o),r.d(o,{base8:()=>ge});var a={};r.r(a),r.d(a,{base10:()=>be});var c={};r.r(c),r.d(c,{base16:()=>me,base16upper:()=>we});var h={};r.r(h),r.d(h,{base32:()=>ve,base32hex:()=>_e,base32hexpad:()=>ke,base32hexpadupper:()=>Ie,base32hexupper:()=>Ce,base32pad:()=>Ae,base32padupper:()=>Se,base32upper:()=>Ee,base32z:()=>Te});var l={};r.r(l),r.d(l,{base36:()=>xe,base36upper:()=>Re});var u={};r.r(u),r.d(u,{base58btc:()=>Pe,base58flickr:()=>De});var d={};r.r(d),r.d(d,{base64:()=>Oe,base64pad:()=>Ne,base64url:()=>Le,base64urlpad:()=>Ue});var f={};r.r(f),r.d(f,{base256emoji:()=>ze});var p={};r.r(p),r.d(p,{identity:()=>Fe});var y={};r.r(y),r.d(y,{code:()=>qe,decode:()=>He,encode:()=>Ke,name:()=>$e});var g={};r.r(g),r.d(g,{code:()=>Ye,decode:()=>Ze,encode:()=>Qe,name:()=>Je});var b={};r.r(b),r.d(b,{identity:()=>xr});var m={};r.r(m),r.d(m,{base2:()=>Rr});var w={};r.r(w),r.d(w,{base8:()=>Pr});var v={};r.r(v),r.d(v,{base10:()=>Dr});var E={};r.r(E),r.d(E,{base16:()=>Or,base16upper:()=>Nr});var A={};r.r(A),r.d(A,{base32:()=>Lr,base32hex:()=>Vr,base32hexpad:()=>jr,base32hexpadupper:()=>Fr,base32hexupper:()=>zr,base32pad:()=>Br,base32padupper:()=>Mr,base32upper:()=>Ur,base32z:()=>$r});var S={};r.r(S),r.d(S,{base36:()=>qr,base36upper:()=>Kr});var _={};r.r(_),r.d(_,{base58btc:()=>Hr,base58flickr:()=>Gr});var C={};r.r(C),r.d(C,{base64:()=>Wr,base64pad:()=>Jr,base64url:()=>Yr,base64urlpad:()=>Qr});var k={};r.r(k),r.d(k,{base256emoji:()=>tn});var I={};r.r(I),r.d(I,{sha256:()=>Sn,sha512:()=>_n});var T={};r.r(T),r.d(T,{identity:()=>kn});var x={};r.r(x),r.d(x,{code:()=>Tn,decode:()=>Rn,encode:()=>xn,name:()=>In});var R={};r.r(R),r.d(R,{code:()=>Nn,decode:()=>Un,encode:()=>Ln,name:()=>On});var P=r(99507);new Uint8Array(0);const D=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var O=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=N;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},N=Math.pow(2,31);var L=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var U=Math.pow(2,7),B=Math.pow(2,14),M=Math.pow(2,21),V=Math.pow(2,28),z=Math.pow(2,35),j=Math.pow(2,42),F=Math.pow(2,49),$=Math.pow(2,56),q=Math.pow(2,63);const K={encode:O,decode:L,encodingLength:function(e){return e<U?1:e<B?2:e<M?3:e<V?4:e<z?5:e<j?6:e<F?7:e<$?8:e<q?9:10}},H=(e,t=0)=>[K.decode(e,t),K.decode.bytes],G=(e,t,r=0)=>(K.encode(e,t,r),t),W=e=>K.encodingLength(e),J=(e,t)=>{const r=t.byteLength,n=W(e),s=n+W(r),i=new Uint8Array(s+r);return G(e,i,0),G(r,i,n),i.set(t,s),new Y(e,r,t,i)};class Y{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Q=({name:e,code:t,encode:r})=>new Z(e,t,r);class Z{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?J(this.code,t):t.then((e=>J(this.code,e)))}throw Error("Unknown type, must be binary type")}}const X=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ee=Q({name:"sha2-256",code:18,encode:X("SHA-256")}),te=Q({name:"sha2-512",code:19,encode:X("SHA-512")});var re=r(42837),ne=r(21177);var se=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const ie=se;class oe{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ae{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return he(this,e)}}class ce{constructor(e){this.decoders=e}or(e){return he(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const he=(e,t)=>new ce({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class le{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new oe(e,t,r),this.decoder=new ae(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ue=({name:e,prefix:t,encode:r,decode:n})=>new le(e,t,r,n),de=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=ie(r,t);return ue({prefix:e,name:t,encode:n,decode:e=>D(s(e))})},fe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>ue({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),pe=ue({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),ye=fe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ge=fe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),be=de({prefix:"9",name:"base10",alphabet:"0123456789"}),me=fe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),we=fe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ve=fe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ee=fe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ae=fe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Se=fe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_e=fe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ce=fe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ke=fe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ie=fe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Te=fe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),xe=de({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Re=de({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Pe=de({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),De=de({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Oe=fe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ne=fe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Le=fe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ue=fe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Be=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Me=Be.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ve=Be.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const ze=ue({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Me[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ve[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),je=D,Fe={code:0,name:"identity",encode:je,digest:e=>J(0,je(e))},$e="raw",qe=85,Ke=e=>D(e),He=e=>D(e),Ge=new TextEncoder,We=new TextDecoder,Je="json",Ye=512,Qe=e=>Ge.encode(JSON.stringify(e)),Ze=e=>JSON.parse(We.decode(e)),Xe=new WeakMap,et=e=>{const t=Xe.get(e);if(null==t){const t=new Map;return Xe.set(e,t),t}return t};class tt{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==it)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ot)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return tt.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=J(e,t);return tt.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return tt.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?nt(r,et(e),t||Pe.encoder):st(r,et(e),t||ve.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof tt)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new tt(e,r,n,s||at(e,r,n.bytes))}if(!0===t[ct]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=D(e),[r,n]=H(t),[s,i]=H(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Y(r,s,o,t)})(r);return tt.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==it)throw new Error(`Version 0 CID must use dag-pb (code: ${it}) block encoding`);return new tt(e,t,r,r.bytes);case 1:{const n=at(e,t,r.bytes);return new tt(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return tt.create(0,it,e)}static createV1(e,t){return tt.create(1,e,t)}static decode(e){const[t,r]=tt.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=tt.inspectBytes(e),r=t.size-t.multihashSize,n=D(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Y(t.multihashCode,t.digestSize,s,n);return[0===t.version?tt.createV0(i):tt.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=H(e.subarray(t));return t+=n,r};let n=r(),s=it;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=rt(e,t),s=tt.decode(n);return et(s).set(r,e),s}}const rt=(e,t)=>{switch(e[0]){case"Q":{const r=t||Pe;return[Pe.prefix,r.decode(`${Pe.prefix}${e}`)]}case Pe.prefix:{const r=t||Pe;return[Pe.prefix,r.decode(e)]}case ve.prefix:{const r=t||ve;return[ve.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},nt=(e,t,r)=>{const{prefix:n}=r;if(n!==Pe.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},st=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},it=112,ot=18,at=(e,t,r)=>{const n=W(e),s=n+W(t),i=new Uint8Array(s+r.byteLength);return G(e,i,0),G(t,i,n),i.set(r,s),i},ct=Symbol.for("@ipld/js-cid/CID"),ht={...s,...i,...o,...a,...c,...h,...l,...u,...d,...f};function lt(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ut(e=0){return null!=globalThis.Buffer?.allocUnsafe?lt(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function dt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ft=dt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),pt=dt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=ut((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),yt={utf8:ft,"utf-8":ft,hex:ht.base16,latin1:pt,ascii:pt,binary:pt,...ht};function gt(e,t="utf8"){const r=yt[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var bt=r(290),mt=r(93203);const wt="/dht/provider",vt=20,Et=3,At=Number(3e5),St=Number(3e4),_t=Number(3e5),Ct=Number(3e4),kt=Number(3e4),It=function(e,t="utf8"){const r=yt[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):lt(globalThis.Buffer.from(e,"utf-8"))}("/pk/");function Tt(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,r]]=e.stringTuples();return(4===t||6===t)&&(null!=r&&!bt(r))}))}}function xt(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,r]]=e.stringTuples();return(4===t||6===t)&&(null!=r&&bt(r))}))}}async function Rt(e){return(await ee.digest(e)).digest}async function Pt(e){return await Rt(e.toBytes())}function Dt(e){return new re.s(`/dht/record/${gt(e,"base32")}`,!1)}function Ot(e){return function(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=ut(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return lt(r)}([It,e.toBytes()])}function Nt(e,t){const r=new Date;return new ne.Y(e,t,r).serialize()}var Lt=r(57665),Ut=r(10715),Bt=r(38461),Mt=r(4542);const Vt="routing-table-size";class zt{constructor(e,t){const{kBucketSize:r,pingTimeout:n,lan:s,pingConcurrency:i,protocol:o,tagName:a,tagValue:c}=t;this.components=e,this.log=(0,Bt.kg)(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table`),this.kBucketSize=r??20,this.pingTimeout=n??1e4,this.pingConcurrency=i??10,this.lan=s,this.running=!1,this.protocol=o,this.tagName=a??"kad-close",this.tagValue=c??50;const h=()=>{this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:"ping-queue-size",value:this.pingQueue.size}),this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:"ping-running",value:this.pingQueue.pending})};this.pingQueue=new Lt.Z({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",h),this.pingQueue.addListener("next",h),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0;const e=new P({localNodeId:await Pt(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.on("ping",this._onPing),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new Mt.fd;const r=function(e,t=100){let r;return()=>{clearTimeout(r),r=setTimeout((()=>e()),t)}}((()=>{const r=new Mt.fd(e.closest(e.localNodeId,20).map((e=>e.peer))),n=r.difference(t),s=t.difference(r);Promise.resolve().then((async()=>{for(const e of n)await this.components.peerStore.tagPeer(e,this.tagName,{value:this.tagValue});for(const e of s)await this.components.peerStore.unTagPeer(e,this.tagName)})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=r}));e.on("added",(()=>{r()})),e.on("removed",(()=>{r()}))}_onPing(e,t){this.pingQueue.add((async()=>{if(!this.running)return;let r=0;try{await Promise.all(e.map((async e=>{let t;try{t=new Ut.TimeoutController(this.pingTimeout);const n={signal:t.signal};this.log("pinging old contact %p",e.peer);const s=await this.components.connectionManager.openConnection(e.peer,n);(await s.newStream(this.protocol,n)).close(),r++}catch(t){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",e.peer,t),this.log("evicting old contact after ping failed %p",e),this.kb.remove(e.id))}finally{null!=t&&t.clear(),this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Vt,value:this.size})}}))),this.running&&r<e.length&&null!=this.kb&&(this.log("adding new contact %p",t.peer),this.kb.add(t))}catch(e){this.log.error("could not process k-bucket ping event",e)}})).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await Pt(e),r=this.closestPeer(t);if(null!=r&&e.equals(r))return r}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){if(null==this.kb)return[];return this.kb.closest(e,t).map((e=>e.peer))}async add(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await Pt(e);this.kb.add({id:t,peer:e}),this.log("added %p with kad id %b",e,t),this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Vt,value:this.size})}async remove(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await Pt(e);this.kb.remove(t),this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:Vt,value:this.size})}}function jt(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const r=ut(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return lt(r)}const Ft=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];var $t=r(79944),qt=r(95918);class Kt{constructor(e){const{peerRouting:t,routingTable:r,refreshInterval:n,refreshQueryTimeout:s,lan:i}=e;this.log=(0,Bt.kg)(`libp2p:kad-dht:${i?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=r,this.refreshInterval=n??_t,this.refreshQueryTimeout=s??Ct,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");const t=this._maxCommonPrefix(),r=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log(`max common prefix length ${t}`),this.log(`tracked CPLs [ ${r.map((e=>e.toISOString())).join(", ")} ]`),Promise.all(r.map((async(n,s)=>{try{if(await this._refreshCommonPrefixLength(s,n,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(s+1),r.length-1);for(let r=s+1;r<t+1;r++)try{await this._refreshCommonPrefixLength(r,n,e)}catch(e){this.log.error(e)}}}catch(e){this.log.error(e)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,r){if(!r&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const n=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,n,this.routingTable.size);const s=new Ut.TimeoutController(this.refreshQueryTimeout);try{const t=await(0,qt.Z)(this.peerRouting.getClosestPeers(n.toBytes(),{signal:s.signal}));this.log(`found ${t} peers that were close to imaginary peer %p`,n),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,n,this.routingTable.size)}finally{s.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let r=0;r<=e;r++)t[r]=this.commonPrefixLengthRefreshedAt[r]??new Date;return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=(0,$t.O6)(2),r=(t[1]<<8)+t[0],n=await this._makePeerId(this.routingTable.kb.localNodeId,r,e);return(0,mt.cv)(n)}async _makePeerId(e,t,r){if(r>15)throw new Error("Cannot generate peer ID for common prefix length greater than 15");const n=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1),s=65535<<16-(r+1),i=Ft[(n^32768>>r)&s|t&~s],o=new ArrayBuffer(34),a=new DataView(o,0,o.byteLength);return a.setUint8(0,ee.code),a.setUint8(1,32),a.setUint32(2,i,!1),new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const r of this._prefixLengths())r===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=jt(this.routingTable.kb.localNodeId,e);let r=0;for(const e of t){if(0!==e)break;r++}yield r}}}var Ht,Gt,Wt=r(32114),Jt=r(88211),Yt=r(55150),Qt=r(93361),Zt=r(91486),Xt=r(94306),er=r(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,er.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 3:r.author=e.bytes();break;case 4:r.signature=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,er.LE)(t,e.codec()),e.decode=t=>(0,er.C6)(t,e.codec())}(Ht||(Ht={})),function(e){let t,r,n,s,i,o;!function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(r||(r={})),function(e){e.codec=()=>(0,er.Ji)(r)}(t=e.MessageType||(e.MessageType={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(n=e.ConnectionType||(e.ConnectionType={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(s||(s={})),function(e){e.codec=()=>(0,er.Ji)(s)}(n=e.ConnectionType||(e.ConnectionType={})),function(t){let r;t.codec=()=>(null==r&&(r=(0,er.yw)(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.id&&(r.uint32(10),r.bytes(t.id)),null==t.addrs)throw new Error('Protocol error: required field "addrs" was not found in object');for(const e of t.addrs)r.uint32(18),r.bytes(e);null!=t.connection&&(r.uint32(24),e.ConnectionType.codec().encode(t.connection,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={addrs:[]},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.id=t.bytes();break;case 2:n.addrs.push(t.bytes());break;case 3:n.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&r)}}return n}))),r),t.encode=e=>(0,er.LE)(e,t.codec()),t.decode=e=>(0,er.C6)(e,t.codec())}(i=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=(0,er.yw)(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.MessageType.codec().encode(t.type,r)),null!=t.clusterLevelRaw&&(r.uint32(80),r.int32(t.clusterLevelRaw)),null!=t.key&&(r.uint32(18),r.bytes(t.key)),null!=t.record&&(r.uint32(26),r.bytes(t.record)),null==t.closerPeers)throw new Error('Protocol error: required field "closerPeers" was not found in object');for(const n of t.closerPeers)r.uint32(66),e.Peer.codec().encode(n,r);if(null==t.providerPeers)throw new Error('Protocol error: required field "providerPeers" was not found in object');for(const n of t.providerPeers)r.uint32(74),e.Peer.codec().encode(n,r);!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={closerPeers:[],providerPeers:[]},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.type=e.MessageType.codec().decode(t);break;case 10:n.clusterLevelRaw=t.int32();break;case 2:n.key=t.bytes();break;case 3:n.record=t.bytes();break;case 8:n.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:n.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&r)}}return n}))),o),e.encode=t=>(0,er.LE)(t,e.codec()),e.decode=t=>(0,er.C6)(t,e.codec())}(Gt||(Gt={}));const tr=Gt.MessageType,rr=Gt.ConnectionType,nr=Object.keys(tr);class sr{constructor(e,t,r){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=r,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return Gt.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(ir),providerPeers:this.providerPeers.map(ir),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){const t=Gt.decode(e),r=new sr(t.type??Gt.MessageType.PUT_VALUE,t.key??Uint8Array.from([]),t.clusterLevelRaw??0);return r.closerPeers=t.closerPeers.map(or),r.providerPeers=t.providerPeers.map(or),null!=t.record?.length&&(r.record=ne.Y.deserialize(t.record)),r}}function ir(e){return{id:e.id.toBytes(),addrs:(e.multiaddrs??[]).map((e=>e.bytes)),connection:rr.CONNECTED}}function or(e){if(null==e.id)throw new Error("Invalid peer in message");return{id:(0,mt.cv)(e.id),multiaddrs:(e.addrs??[]).map((e=>(0,Xt.HM)(e))),protocols:[]}}var ar=r(46857);function cr(e){return{...e,name:"SENDING_QUERY",type:0,messageName:e.type,messageType:nr.indexOf(e.type.toString())}}function hr(e){return{...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]}}function lr(e){return{...e,name:"FINAL_PEER",type:2}}function ur(e){return{...e,name:"QUERY_ERROR",type:3}}function dr(e){return{...e,name:"PROVIDER",type:4}}function fr(e){return{...e,name:"VALUE",type:5}}function pr(e){return{...e,name:"DIALING_PEER",type:7}}var yr=r(73861);class gr extends ar.v{constructor(e,t){super();const{protocol:r,lan:n}=t;this.components=e,this.log=(0,Bt.kg)(`libp2p:kad-dht:${n?"lan":"wan"}:network`),this.running=!1,this.protocol=r}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield pr({peer:e}),yield cr({to:e,type:t.type});try{const n=await this.components.connectionManager.openConnection(e,r),s=await n.newStream(this.protocol,r),i=await this._writeReadMessage(s,t.serialize(),r);yield hr({from:e,messageType:i.type,closer:i.closerPeers,providers:i.providerPeers,record:i.record})}catch(t){yield ur({from:e,error:t})}finally{null!=s&&s.close()}}async*sendMessage(e,t,r={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield pr({peer:e}),yield cr({to:e,type:t.type});try{const n=await this.components.connectionManager.openConnection(e,r),s=await n.newStream(this.protocol,r);await this._writeMessage(s,t.serialize(),r),yield hr({from:e,messageType:t.type})}catch(t){yield ur({from:e,error:t})}finally{null!=s&&s.close()}}async _writeMessage(e,t,r){null!=r.signal&&(e=(0,yr.D7)(e,r.signal)),await(0,Jt.zG)([t],Yt.c(),e,Qt.Z)}async _writeReadMessage(e,t,r){null!=r.signal&&(e=(0,yr.D7)(e,r.signal));const n=await(0,Jt.zG)([t],Yt.c(),e,Yt.J(),(async e=>{const t=await(0,Zt.Z)(e);if(null!=t)return t;throw Wt(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")})),s=sr.deserialize(n);return s.closerPeers.forEach((e=>{this.dispatchEvent(new ar.A("peer",{detail:e}))})),s.providerPeers.forEach((e=>{this.dispatchEvent(new ar.A("peer",{detail:e}))})),s}}function br(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var mr=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const wr=mr,vr=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Er{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ar{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _r(this,e)}}class Sr{constructor(e){this.decoders=e}or(e){return _r(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _r=(e,t)=>new Sr({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Cr{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Er(e,t,r),this.decoder=new Ar(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const kr=({name:e,prefix:t,encode:r,decode:n})=>new Cr(e,t,r,n),Ir=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=wr(r,t);return kr({prefix:e,name:t,encode:n,decode:e=>vr(s(e))})},Tr=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>kr({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),xr=kr({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Rr=Tr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Pr=Tr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Dr=Ir({prefix:"9",name:"base10",alphabet:"0123456789"}),Or=Tr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nr=Tr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Lr=Tr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ur=Tr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Br=Tr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Mr=Tr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Vr=Tr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zr=Tr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jr=Tr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fr=Tr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$r=Tr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),qr=Ir({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kr=Ir({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Hr=Ir({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Gr=Ir({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Wr=Tr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Jr=Tr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yr=Tr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qr=Tr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Zr=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Xr=Zr.reduce(((e,t,r)=>(e[r]=t,e)),[]),en=Zr.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const tn=kr({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Xr[t]),"")},decode:function(e){const t=[];for(const r of e){const e=en[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var rn=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=nn;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},nn=Math.pow(2,31);var sn=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var on=Math.pow(2,7),an=Math.pow(2,14),cn=Math.pow(2,21),hn=Math.pow(2,28),ln=Math.pow(2,35),un=Math.pow(2,42),dn=Math.pow(2,49),fn=Math.pow(2,56),pn=Math.pow(2,63);const yn={encode:rn,decode:sn,encodingLength:function(e){return e<on?1:e<an?2:e<cn?3:e<hn?4:e<ln?5:e<un?6:e<dn?7:e<fn?8:e<pn?9:10}},gn=(e,t,r=0)=>(yn.encode(e,t,r),t),bn=e=>yn.encodingLength(e),mn=(e,t)=>{const r=t.byteLength,n=bn(e),s=n+bn(r),i=new Uint8Array(s+r);return gn(e,i,0),gn(r,i,n),i.set(t,s),new wn(e,r,t,i)};class wn{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const vn=({name:e,code:t,encode:r})=>new En(e,t,r);class En{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?mn(this.code,t):t.then((e=>mn(this.code,e)))}throw Error("Unknown type, must be binary type")}}const An=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Sn=vn({name:"sha2-256",code:18,encode:An("SHA-256")}),_n=vn({name:"sha2-512",code:19,encode:An("SHA-512")}),Cn=vr,kn={code:0,name:"identity",encode:Cn,digest:e=>mn(0,Cn(e))},In="raw",Tn=85,xn=e=>vr(e),Rn=e=>vr(e),Pn=new TextEncoder,Dn=new TextDecoder,On="json",Nn=512,Ln=e=>Pn.encode(JSON.stringify(e)),Un=e=>JSON.parse(Dn.decode(e));new WeakMap;class Bn{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Bn.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Bn.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Bn.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?cid_toStringV0(r,cid_baseCache(e),t||base58btc.encoder):cid_toStringV1(r,cid_baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Bn)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Bn(e,r,n,s||cid_encodeCID(e,r,n.bytes))}if(!0===t[cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Bn.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${cid_DAG_PB_CODE}) block encoding`);return new Bn(e,t,r,r.bytes);case 1:{const n=cid_encodeCID(e,t,r.bytes);return new Bn(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Bn.create(0,cid_DAG_PB_CODE,e)}static createV1(e,t){return Bn.create(1,e,t)}static decode(e){const[t,r]=Bn.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Bn.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Bn.createV0(i):Bn.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=cid_parseCIDtoBytes(e,t),s=Bn.decode(n);return cid_baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Mn={...b,...m,...w,...v,...E,...A,...S,..._,...C,...k};function Vn(e=0){return null!=globalThis.Buffer?.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e);var t}function zn(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const jn=zn("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Fn=zn("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Vn((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),$n={utf8:jn,"utf-8":jn,hex:Mn.base16,latin1:Fn,ascii:Fn,binary:Fn,...Mn};function qn(e,t="utf8"){const r=$n[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function Kn(e,t){const r=t.key,n=qn(r).split("/");if(n.length<3)return;const s=e[n[1].toString()];if(null==s){throw Wt(new Error("Invalid record keytype"),"ERR_INVALID_RECORD_KEY_TYPE")}return s(r,t.value)}const Hn={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw Wt(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw Wt(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==qn(e.subarray(0,4)))throw Wt(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");if(!function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.slice(4),(await Sn.digest(t)).bytes))throw Wt(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")}};const Gn={pk:function(e,t){return 0}};var Wn=r(69849),Jn=r(21007);class Yn{constructor(e,t){const{validators:r,selectors:n,peerRouting:s,queryManager:i,routingTable:o,network:a,lan:c}=t;this.components=e,this.log=(0,Bt.kg)(`libp2p:kad-dht:${c?"lan":"wan"}:content-fetching`),this.validators=r,this.selectors=n,this.peerRouting=s,this.queryManager=i,this.routingTable=o,this.network=a}async putLocal(e,t){const r=Dt(e);await this.components.datastore.put(r,t)}async getLocal(e){this.log("getLocal %b",e);const t=Dt(e);this.log("fetching record for key %k",t);const r=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const n=ne.Y.deserialize(r);return await Kn(this.validators,n),n}async*sendCorrectionRecord(e,t,r,n={}){this.log("sendCorrection for %b",e);const s=await Nt(e,r);for(const{value:i,from:o}of t){if(br(i,r)){this.log("record was ok");continue}if(this.components.peerId.equals(o)){try{const t=Dt(e);this.log(`Storing corrected record for key ${t.toString()}`),await this.components.datastore.put(t,s.subarray())}catch(e){this.log.error("Failed error correcting self",e)}continue}let t=!1;const a=new sr(tr.PUT_VALUE,e,0);a.record=ne.Y.deserialize(s);for await(const e of this.network.sendRequest(o,a,n))"PEER_RESPONSE"===e.name&&null!=e.record&&br(e.record.value,ne.Y.deserialize(s).value)&&(t=!0),yield e;t||(yield ur({from:o,error:Wt(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(e,t,r={}){this.log("put key %b value %b",e,t);const n=await Nt(e,t),s=Dt(e);this.log(`storing record for key ${s.toString()}`),await this.components.datastore.put(s,n.subarray()),yield*(0,Jt.zG)(this.peerRouting.getClosestPeers(e,{signal:r.signal}),(t=>(0,Jn.Z)(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[],i=new sr(tr.PUT_VALUE,e,0);i.record=ne.Y.deserialize(n),this.log("send put to %p",t.peer.id);for await(const e of this.network.sendRequest(t.peer.id,i,r))s.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&br(e.record.value,ne.Y.deserialize(n).value)||s.push(ur({from:t.peer.id,error:Wt(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return s}))),(e=>(0,Wn.Z)(e,{ordered:!1,concurrency:Et})),(async function*(e){for await(const t of e)yield*t}))}async*get(e,t={}){this.log("get %b",e);const r=[];for await(const n of this.getMany(e,t))"VALUE"===n.name&&r.push(n),yield n;if(0===r.length)return;const n=r.map((e=>e.value));let s=0;try{s=function(e,t,r){if(0===r.length)throw Wt(new Error("No records given"),"ERR_NO_RECORDS_RECEIVED");const n=qn(t).split("/");if(n.length<3)throw Wt(new Error("Record key does not have a selector function"),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY");const s=e[n[1].toString()];if(null==s){const e=`Unrecognized key prefix: ${n[1]}`;throw Wt(new Error(e),"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===r.length?0:s(t,r)}(this.selectors,e,n)}catch(e){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==e.code)throw e}const i=n[s];if(this.log("GetValue %b %b",e,i),null==i)throw Wt(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,r,i,t),yield r[s]}async*getMany(e,t={}){this.log("getMany values for %b",e);try{const t=await this.getLocal(e);yield fr({value:t.value,from:this.components.peerId})}catch(t){this.log("error getting local value for %b",e,t)}const r=await Rt(e),n=this.routingTable.closestPeers(r);this.log("found %d peers in routing table",n.length);const s=this;yield*this.queryManager.run(e,n,(async function*({peer:t,signal:r}){for await(const n of s.peerRouting.getValueOrPeers(t,e,{signal:r}))yield n,"PEER_RESPONSE"===n.name&&null!=n.record&&(yield fr({from:t,value:n.record.value}))}),t)}}class Qn{constructor(e,t){const{network:r,peerRouting:n,queryManager:s,routingTable:i,providers:o,lan:a}=t;this.components=e,this.log=(0,Bt.kg)(`libp2p:kad-dht:${a?"lan":"wan"}:content-routing`),this.network=r,this.peerRouting=n,this.queryManager=s,this.routingTable=i,this.providers=o}async*provide(e,t,r={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.peerId);const n=new sr(tr.ADD_PROVIDER,e.bytes,0);n.providerPeers=[{id:this.components.peerId,multiaddrs:t,protocols:[]}];let s=0;const i=t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const i=[];this.log("putProvider %s to %p",e,t.peer.id);try{this.log("sending provider record for %s to %p",e,t.peer.id);for await(const o of this.network.sendMessage(t.peer.id,n,r))"PEER_RESPONSE"===o.name&&(this.log("sent provider record for %s to %p",e,t.peer.id),s++),i.push(o)}catch(e){this.log.error("error sending provide record to peer %p",t.peer.id,e),i.push(ur({from:t.peer.id,error:e}))}return i};yield*(0,Jt.zG)(this.peerRouting.getClosestPeers(e.multihash.bytes,r),(e=>(0,Jn.Z)(e,(e=>i(e)))),(e=>(0,Wn.Z)(e,{ordered:!1,concurrency:Et})),(async function*(e){for await(const t of e)yield*t})),this.log("sent provider records to %d peers",s)}async*findProviders(e,t){const r=this.routingTable.kBucketSize,n=e.multihash.bytes,s=await Rt(n),i=this;this.log("findProviders %c",e);const o=await this.providers.getProviders(e);if(o.length>0){const e=[];for(const t of o.slice(0,r))e.push({id:t,multiaddrs:(await this.components.peerStore.addressBook.get(t)??[]).map((e=>e.multiaddr)),protocols:[]});yield hr({from:this.components.peerId,messageType:tr.GET_PROVIDERS,providers:e}),yield dr({from:this.components.peerId,providers:e})}if(o.length>=r)return;const a=async function*({peer:e,signal:t}){const r=new sr(tr.GET_PROVIDERS,n,0);yield*i.network.sendRequest(e,r,{signal:t})},c=new Set(o.map((e=>e.toString())));for await(const i of this.queryManager.run(n,this.routingTable.closestPeers(s),a,t))if(yield i,"PEER_RESPONSE"===i.name){this.log("Found %d provider entries for %c and %d closer peers",i.providers.length,e,i.closer.length);const t=[];for(const e of i.providers)c.has(e.id.toString())||(c.add(e.id.toString()),t.push(e));if(t.length>0&&(yield dr({from:i.from,providers:t})),c.size===r)return}}}function Zn(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}class Xn{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await Pt(e),r={peerId:e,distance:jt(this.originDhtKey,t)};this.peerDistances.push(r),this.peerDistances.sort(((e,t)=>Zn(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(Pt)),r=this.peerDistances[this.peerDistances.length-1].distance;for(const e of t){if(Zn(jt(this.originDhtKey,e),r)<0)return!0}return!1}}class es{constructor(e,t){const{routingTable:r,network:n,validators:s,queryManager:i,lan:o}=t;this.components=e,this.routingTable=r,this.network=n,this.validators=s,this.queryManager=i,this.log=(0,Bt.kg)(`libp2p:kad-dht:${o?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let t;const r=await this.routingTable.find(e);if(null!=r){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.peerStore.get(r)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}}if(null==t)try{t=await this.components.peerStore.get(e)}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}async*_getValueSingle(e,t,r={}){const n=new sr(tr.GET_VALUE,t,0);yield*this.network.sendRequest(e,n,r)}async*getPublicKeyFromNode(e,t={}){const r=Ot(e);for await(const n of this._getValueSingle(e,r,t))if(yield n,"PEER_RESPONSE"===n.name&&null!=n.record){const t=await(0,mt.y5)($t.XP.marshalPublicKey({bytes:n.record.value}));if(!t.equals(e))throw Wt(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==t.publicKey)throw Wt(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield fr({from:e,value:t.publicKey})}throw Wt(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this.log("findPeer %p",e);const r=await this.findPeerLocal(e);if(null!=r)return this.log("found local"),void(yield lr({from:this.components.peerId,peer:r}));const n=await Pt(e),s=this.routingTable.closestPeers(n);if(null!=s.find((t=>t.equals(e))))try{const t=await this.components.peerStore.get(e);return this.log("found in peerStore"),void(yield lr({from:this.components.peerId,peer:{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}))}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}const i=this,o=async function*({peer:t,signal:r}){const n=new sr(tr.FIND_NODE,e.toBytes(),0);for await(const s of i.network.sendRequest(t,n,{signal:r}))if(yield s,"PEER_RESPONSE"===s.name){const t=s.closer.find((t=>t.id.equals(e)));null!=t&&(yield lr({from:s.from,peer:t}))}};let a=!1;for await(const r of this.queryManager.run(e.toBytes(),s,o,t))"FINAL_PEER"===r.name&&(a=!0),yield r;a||(yield ur({from:this.components.peerId,error:Wt(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this.log("getClosestPeers to %b",e);const r=await Rt(e),n=this.routingTable.closestPeers(r),s=this,i=new Xn(r,this.routingTable.kBucketSize);await Promise.all(n.map((async e=>await i.add(e))));const o=async function*({peer:t,signal:r}){s.log("closerPeersSingle %s from %p",gt(e,"base32"),t);const n=new sr(tr.FIND_NODE,e,0);yield*s.network.sendRequest(t,n,{signal:r})};for await(const r of this.queryManager.run(e,n,o,t))yield r,"PEER_RESPONSE"===r.name&&await Promise.all(r.closer.map((async e=>await i.add(e.id))));this.log("found %d peers close to %b",i.length,e);for(const e of i.peers)yield lr({from:this.components.peerId,peer:{id:e,multiaddrs:(await this.components.peerStore.addressBook.get(e)??[]).map((e=>e.multiaddr)),protocols:[]}})}async*getValueOrPeers(e,t,r={}){for await(const n of this._getValueSingle(e,t,r)){if("PEER_RESPONSE"===n.name&&null!=n.record)try{await this._verifyRecordOnline(n.record)}catch(e){const t="invalid record received, discarded";this.log(t),yield ur({from:n.from,error:Wt(new Error(t),"ERR_INVALID_RECORD")});continue}yield n}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw Wt(new Error("invalid record received"),"ERR_INVALID_RECORD");await Kn(this.validators,new ne.Y(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const r=await Rt(e),n=this.routingTable.closestPeers(r),s=[];for(const e of n)if(!e.equals(t))try{const t=await this.components.peerStore.addressBook.get(e),r=await this.components.peerStore.protoBook.get(e);s.push({id:e,multiaddrs:t.map((e=>e.multiaddr)),protocols:r})}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}return s.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",s.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),s}}var ts=r(70248),rs=r(94676);const ns=(0,Bt.kg)("libp2p:kad-dht:providers");class ss{constructor(e,t={}){const{cacheSize:r,cleanupInterval:n,provideValidity:s}=t;this.components=e,this.cleanupInterval=n??36e5,this.provideValidity=s??864e5,this.cache=ts(r??256),this.syncQueue=new Lt.Z({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{ns.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add((async()=>{const e=Date.now();let t=0,r=0;const n=new Map,s=this.components.datastore.batch(),i=this.components.datastore.query({prefix:wt});for await(const e of i)try{const{cid:i,peerId:o}=os(e.key),a=as(e.value).getTime(),c=Date.now(),h=c-a,l=h>this.provideValidity;if(ns("comparing: %d - %d = %d > %d %s",c,a,h,this.provideValidity,l?"(expired)":""),l){r++,s.delete(e.key);const t=n.get(i)??new Set;t.add(o),n.set(i,t)}t++}catch(e){ns.error(e.message)}n.size>0?(ns("deleting %d / %d entries",r,t),await s.commit()):ns("nothing to delete");for(const[e,t]of n){const r=is(e),n=this.cache.get(r);if(null!=n){for(const e of t)n.delete(e);0===n.size?this.cache.remove(r):this.cache.set(r,n)}}ns("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=is(e);let r=this.cache.get(t);return null==r&&(r=await async function(e,t){const r=new Map,n=e.query({prefix:is(t)});for await(const e of n){const{peerId:t}=os(e.key);r.set(t,as(e.value))}return r}(this.components.datastore,e),this.cache.set(t,r)),r}async addProvider(e,t){return await this.syncQueue.add((async()=>{ns("%p provides %s",t,e);const r=await this._getProvidersMap(e);ns("loaded %s provs",r.size);const n=new Date;r.set(t.toString(),n);const s=is(e);this.cache.set(s,r),await async function(e,t,r,n){const s=[is(t),"/",r.toString()].join(""),i=new re.s(s),o=Uint8Array.from(rs.encode(n.getTime()));return await e.put(i,o)}(this.components.datastore,e,t,n)}))}async getProviders(e){return await this.syncQueue.add((async()=>{ns("get providers for %s",e);return[...(await this._getProvidersMap(e)).keys()].map((e=>(0,mt.jE)(e)))}))}}function is(e){return`/dht/provider/${"string"==typeof e?e:gt(e.multihash.bytes,"base32")}`}function os(e){const t=e.toString().split("/");if(5!==t.length)throw new Error(`incorrectly formatted provider entry key in datastore: ${e.toString()}`);return{cid:t[3],peerId:t[4]}}function as(e){return new Date(rs.decode(e))}var cs=r(32044),hs=r(85275);const ls=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*us(e){const{key:t,startingPeer:r,ourPeerId:n,signal:s,query:i,alpha:o,pathIndex:a,numPaths:c,cleanUp:h,queryFuncTimeout:l,log:u,peersSeen:d}=e,f=new Lt.Z({concurrency:o}),p=await Rt(t);!function e(r,o){if(null==r)return;d.add(r);const h=BigInt("0x"+gt(jt(o,p),"base16"));f.add((async()=>{let o;const y=[s];null!=l&&(o=new Ut.TimeoutController(l),y.push(o.signal));const g=(0,cs.anySignal)(y);try{for await(const s of i({key:t,peer:r,signal:g,pathIndex:a,numPaths:c})){if(g.aborted)return;if("PEER_RESPONSE"===s.name)for(const i of s.closer){if(d.has(i.id)){u("already seen %p in query",i.id);continue}if(n.equals(i.id)){u("not querying ourselves");continue}const s=await Pt(i.id);BigInt("0x"+gt(jt(s,p),"base16"))>h?u("skipping %p as they are not closer to %b than %p",i.id,t,r):(u("querying closer peer %p",i.id),e(i.id,s))}f.emit("completed",s)}o?.clear()}catch(e){s.aborted?f.emit("error",e):f.emit("completed",ur({from:r,error:e}))}finally{o?.clear()}}),{priority:ls-h}).catch((e=>{u.error(e)}))}(r,await Pt(r)),yield*async function*(e,t,r,n){let s=(0,hs.Z)(),i=!0;const o=[],a=()=>{i&&(n("clean up queue, results %d, queue size %d, pending tasks %d",o.length,e.size,e.pending),i=!1,e.clear(),o.splice(0,o.length))};e.on("completed",(e=>{o.push(e),s.resolve()})),e.on("error",(e=>{n("queue error",e),a(),s.reject(e)})),e.on("idle",(()=>{n("queue idle"),i=!1,s.resolve()})),t.addEventListener("abort",(()=>{n("abort queue");const e=i;a(),e&&s.reject(Wt(new Error("Query aborted"),"ERR_QUERY_ABORTED"))})),r.addEventListener("cleanup",(()=>{a(),s.resolve()}));for(;i;)for(await s.promise,s=(0,hs.Z)();o.length>0;){const e=o.shift();null!=e&&(yield e)}yield*o}(f,s,h,u)}var ds=r(52019),fs=r(17187);const ps="running-queries";class ys{constructor(e,t){const{lan:r=!1,disjointPaths:n=vt,alpha:s=Et}=t;this.components=e,this.disjointPaths=n??vt,this.controllers=new Set,this.running=!1,this.alpha=s??Et,this.lan=r,this.queries=0}isStarted(){return this.running}async start(){this.running=!0}async stop(){this.running=!1;for(const e of this.controllers)e.abort();this.controllers.clear()}async*run(e,t,r,n={}){if(!this.running)throw new Error("QueryManager not started");let s;if(null==n.signal){s=new Ut.TimeoutController(kt),n.signal=s.signal;try{null!=fs.setMaxListeners&&(0,fs.setMaxListeners)(1/0,s.signal)}catch{}}const i=new AbortController;this.controllers.add(i);const o=[i.signal];null!=n.signal&&o.push(n.signal);const a=(0,cs.anySignal)(o);try{null!=fs.setMaxListeners&&(0,fs.setMaxListeners)(1/0,a)}catch{}const c=(0,Bt.kg)(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+gt(e,"base58btc")),h=t.slice(0,Math.min(this.disjointPaths,t.length)),l=Date.now(),u=new ar.v;try{if(c("query:start"),this.queries++,this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:ps,value:this.queries}),0===t.length)return void c.error("Running query with no peers");const o=new Mt.fd,d=h.map(((t,s)=>us({key:e,startingPeer:t,ourPeerId:this.components.peerId,signal:a,query:r,pathIndex:s,numPaths:h.length,alpha:this.alpha,cleanUp:u,queryFuncTimeout:n.queryFuncTimeout,log:c,peersSeen:o})));for await(const e of(0,ds.Z)(...d))yield e,"QUERY_ERROR"===e.name&&c("error",e.error)}catch(e){if(this.running||"ERR_QUERY_ABORTED"!==e.code)throw e}finally{this.controllers.delete(i),null!=s&&s.clear(),this.queries--,this.components.metrics?.updateComponentMetric({system:"libp2p",component:"kad-dht-"+(this.lan?"lan":"wan"),metric:ps,value:this.queries}),u.dispatchEvent(new ar.A("cleanup")),c("query:done in %dms",Date.now()-l)}}}const gs=(0,Bt.kg)("libp2p:kad-dht:rpc:handlers:add-provider");class bs{constructor(e){const{providers:t}=e;this.providers=t}async handle(e,t){if(gs("start"),null==t.key||0===t.key.length)throw Wt(new Error("Missing key"),"ERR_MISSING_KEY");let r;try{r=tt.decode(t.key)}catch(e){throw Wt(new Error("Invalid CID"),"ERR_INVALID_CID")}null!=t.providerPeers&&0!==t.providerPeers.length||gs.error("no providers found in message"),await Promise.all(t.providerPeers.map((async t=>{t.id.equals(e)?t.multiaddrs.length<1?gs("no valid addresses for provider %p. Ignore",e):(gs("received provider %p for %s (addrs %s)",e,r,t.multiaddrs.map((e=>e.toString()))),await this.providers.addProvider(r,t.id)):gs("invalid provider peer %p from %p",t.id,e)})))}}const ms=(0,Bt.kg)("libp2p:kad-dht:rpc:handlers:find-node");class ws{constructor(e,t){const{peerRouting:r,lan:n}=t;this.components=e,this.peerRouting=r,this.lan=Boolean(n)}async handle(e,t){ms("incoming request from %p for peers closer to %b",e,t.key);let r=[];r=br(this.components.peerId.toBytes(),t.key)?[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode((0,Xt.a_)("p2p").code))),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(t.key,e),r=r.map(this.lan?xt:Tt).filter((({multiaddrs:e})=>e.length));const n=new sr(t.type,new Uint8Array(0),t.clusterLevel);return r.length>0?n.closerPeers=r:ms("could not find any peers closer to %b than %p",t.key,e),n}}const vs=(0,Bt.kg)("libp2p:kad-dht:rpc:handlers:get-providers");class Es{constructor(e,t){const{peerRouting:r,providers:n,lan:s}=t;this.components=e,this.peerRouting=r,this.providers=n,this.lan=Boolean(s)}async handle(e,t){let r;try{r=tt.decode(t.key)}catch(e){throw Wt(new Error("Invalid CID"),"ERR_INVALID_CID")}vs("%p asking for providers for %s",e,r);const[n,s]=await Promise.all([this.providers.getProviders(r),this.peerRouting.getCloserPeersOffline(t.key,e)]),i=await this._getPeers(n),o=await this._getPeers(s.map((({id:e})=>e))),a=new sr(t.type,t.key,t.clusterLevel);return i.length>0&&(a.providerPeers=i),o.length>0&&(a.closerPeers=o),vs("got %s providers %s closerPeers",i.length,o.length),a}async _getAddresses(e){return(await this.components.peerStore.addressBook.get(e)).map((e=>e.multiaddr))}async _getPeers(e){const t=[],r=this.lan?xt:Tt;for(const n of e){const e=r({id:n,multiaddrs:await this._getAddresses(n),protocols:[]});e.multiaddrs.length>0&&t.push(e)}return t}}const As=(0,Bt.kg)("libp2p:kad-dht:rpc:handlers:get-value");class Ss{constructor(e,t){const{peerRouting:r}=t;this.components=e,this.peerRouting=r}async handle(e,t){const r=t.key;if(As("%p asked for key %b",e,r),null==r||0===r.length)throw Wt(new Error("Invalid key"),"ERR_INVALID_KEY");const n=new sr(tr.GET_VALUE,r,t.clusterLevel);if(function(e){return"/pk/"===gt(e.subarray(0,4))}(r)){As("is public key");const e=function(e){return(0,mt.cv)(e.subarray(4))}(r);let t;try{const r=await this.components.peerStore.keyBook.get(e);if(null==r)throw Wt(new Error("No public key found in key book"),"ERR_NOT_FOUND");t=r}catch(e){if("ERR_NOT_FOUND"!==e.code)throw e}if(null!=t)return As("returning found public key"),n.record=new ne.Y(r,t,new Date),n}const[s,i]=await Promise.all([this._checkLocalDatastore(r),this.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=s&&(As("had record for %b in local datastore",r),n.record=s),i.length>0&&(As("had %s closer peers in routing table",i.length),n.closerPeers=i),n}async _checkLocalDatastore(e){As("checkLocalDatastore looking for %b",e);const t=Dt(e);let r;try{r=await this.components.datastore.get(t)}catch(e){if("ERR_NOT_FOUND"===e.code)return;throw e}const n=ne.Y.deserialize(r);if(null==n)throw Wt(new Error("Invalid record"),"ERR_INVALID_RECORD");if(!(null==n.timeReceived||Date.now()-n.timeReceived.getTime()>1296e5))return n;await this.components.datastore.delete(t)}}const _s=(0,Bt.kg)("libp2p:kad-dht:rpc:handlers:ping");class Cs{async handle(e,t){return _s("ping from %p",e),t}}class ks{constructor(e,t){const{validators:r}=t;this.components=e,this.log=(0,Bt.kg)("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=r}async handle(e,t){const r=t.key;this.log("%p asked us to store value for key %b",e,r);const n=t.record;if(null==n){const t=`Empty record from: ${e.toString()}`;throw this.log.error(t),Wt(new Error(t),"ERR_EMPTY_RECORD")}try{await Kn(this.validators,n),n.timeReceived=new Date;const e=Dt(n.key);await this.components.datastore.put(e,n.serialize().subarray()),this.log("put record for %b into datastore under key %k",r,e)}catch(e){this.log("did not put record for key %b into datastore %o",r,e)}return t}}class Is{constructor(e,t){const{providers:r,peerRouting:n,validators:s,lan:i}=t;this.log=(0,Bt.kg)("libp2p:kad-dht:rpc"),this.routingTable=t.routingTable,this.handlers={[tr.GET_VALUE]:new Ss(e,{peerRouting:n}),[tr.PUT_VALUE]:new ks(e,{validators:s}),[tr.FIND_NODE]:new ws(e,{peerRouting:n,lan:i}),[tr.ADD_PROVIDER]:new bs({providers:r}),[tr.GET_PROVIDERS]:new Es(e,{peerRouting:n,providers:r,lan:i}),[tr.PING]:new Cs}}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(e){this.log.error("Failed to update the kbucket store",e)}const r=this.handlers[t.type];if(null!=r)return await r.handle(e,t);this.log.error(`no handler found for message type: ${t.type}`)}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:r}=e,n=r.remotePeer;try{await this.routingTable.add(n)}catch(e){this.log.error(e)}const s=this;await(0,Jt.zG)(t,Yt.J(),(async function*(e){for await(const t of e){const e=sr.deserialize(t);s.log("incoming %s from %p",e.type,n);const r=await s.handleMessage(n,e);null!=r&&(yield r.serialize())}}),Yt.c(),t)})).catch((e=>{this.log.error(e)}))}}var Ts=r(21466);class xs extends ar.v{constructor(e,t){super();const{protocol:r,lan:n}=t;this.components=e,this.log=(0,Bt.kg)("libp2p:kad-dht:topology-listener:"+(n?"lan":"wan")),this.running=!1,this.protocol=r}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;const e=(0,Ts.a)({onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new ar.A("peer",{detail:e}))}});this.registrarId=await this.components.registrar.register(this.protocol,e)}stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}var Rs=r(44363);class Ps{constructor(e,t){const{peerRouting:r,lan:n,count:s,interval:i,queryTimeout:o}=t;this.components=e,this.log=(0,Bt.kg)(`libp2p:kad-dht:${n?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=r,this.count=s??vt,this.interval=i??At,this.queryTimeout=o??St}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}_querySelf(){Promise.resolve().then((async()=>{const e=new Ut.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;const t=(0,cs.anySignal)([this.controller.signal,e.signal]);try{null!=fs.setMaxListeners&&(0,fs.setMaxListeners)(1/0,t)}catch{}const r=await(0,Jt.zG)(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:t}),(e=>(0,Rs.Z)(e,this.count)),(async e=>await(0,qt.Z)(e)));this.log("query ran successfully - found %d peers",r)}catch(e){this.log("query error",e)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),e.clear()}})).catch((e=>{this.log("query error",e)}))}}var Ds=r(59769);class Os extends ar.v{constructor(e,t){super();const{kBucketSize:r,clientMode:n,validators:s,selectors:i,querySelfInterval:o,lan:a,protocolPrefix:c,pingTimeout:h,pingConcurrency:l,maxInboundStreams:u,maxOutboundStreams:d}=t;this.running=!1,this.components=e,this.lan=Boolean(a),this.log=(0,Bt.kg)("libp2p:kad-dht:"+(!0===a?"lan":"wan")),this.protocol=`${c??"/ipfs"}${!0===a?"/lan":""}/kad/1.0.0`,this.kBucketSize=r??20,this.clientMode=n??!0,this.maxInboundStreams=u??32,this.maxOutboundStreams=d??64,this.routingTable=new zt(e,{kBucketSize:r,lan:this.lan,pingTimeout:h,pingConcurrency:l,protocol:this.protocol}),this.providers=new ss(e),this.validators={...Hn,...s},this.selectors={...Gn,...i},this.network=new gr(e,{protocol:this.protocol,lan:this.lan}),this.queryManager=new ys(e,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:a}),this.peerRouting=new es(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new Yn(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new Qn(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new Kt({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new Is(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new xs(e,{protocol:this.protocol,lan:this.lan}),this.querySelf=new Ps(e,{peerRouting:this.peerRouting,interval:o,lan:this.lan}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new ar.A("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.addressBook.get(t),r={id:t,multiaddrs:e.map((e=>e.multiaddr)),protocols:[]};await this.onPeerConnect(r)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))}))}get[Ds.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}async onPeerConnect(e){if(this.log("peer %p connected with protocols %s",e.id,e.protocols),0!==(e=this.lan?xt(e):Tt(e)).multiaddrs.length)try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}else this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.registrar.unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(e,t,r={}){yield*this.contentFetching.put(e,t,r)}async*get(e,t={}){yield*this.contentFetching.get(e,t)}async*provide(e,t={}){yield*this.contentRouting.provide(e,this.components.addressManager.getAddresses(),t)}async*findProviders(e,t={}){yield*this.contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this.peerRouting.getClosestPeers(e,t)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}}const Ns=(0,Bt.kg)("libp2p:kad-dht");class Ls extends ar.v{constructor(e,t,r){super(),this.components=e,this.wan=t,this.lan=r,this.wan.addEventListener("peer",(e=>{this.dispatchEvent(new ar.A("peer",{detail:e.detail}))})),this.lan.addEventListener("peer",(e=>{this.dispatchEvent(new ar.A("peer",{detail:e.detail}))}))}get[Ds.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,t,r={}){for await(const n of(0,ds.Z)(this.lan.put(e,t,r),this.wan.put(e,t,r)))yield n}async*get(e,t={}){let r=!1,n=!1;for await(const s of(0,ds.Z)(this.lan.get(e,t),this.wan.get(e,t)))yield s,"DIALING_PEER"===s.name&&(r=!0),"VALUE"===s.name&&(r=!0,null!=s.value&&(n=!0)),"SENDING_QUERY"===s.name&&(r=!0);if(!r)throw Wt(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");n||(yield ur({from:this.components.peerId,error:Wt(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let r=0,n=0;const s=[],i=[this.lan];"server"===await this.wan.getMode()&&i.push(this.wan);for await(const o of(0,ds.Z)(...i.map((r=>r.provide(e,t)))))yield o,"SENDING_QUERY"===o.name&&r++,"QUERY_ERROR"===o.name&&s.push(o.error),"PEER_RESPONSE"===o.name&&"ADD_PROVIDER"===o.messageName&&(Ns("sent provider record for %s to %p",e,o.from),n++);if(0===n){if(s.length>0)throw Wt(new Error(`Failed to provide to ${s.length} of ${r} peers`),"ERR_PROVIDES_FAILED",{errors:s});throw Wt(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}}async*findProviders(e,t={}){yield*(0,ds.Z)(this.lan.findProviders(e,t),this.wan.findProviders(e,t))}async*findPeer(e,t={}){let r=!1;for await(const n of(0,ds.Z)(this.lan.findPeer(e,t),this.wan.findPeer(e,t)))yield n,"SENDING_QUERY"!==n.name&&"FINAL_PEER"!==n.name||(r=!0);if(!r)throw Wt(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*(0,ds.Z)(this.lan.getClosestPeers(e,t),this.wan.getClosestPeers(e,t))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class Us extends Ls{constructor(e,t){super(e,new Os(e,{protocolPrefix:"/ipfs",...t,lan:!1}),new Os(e,{protocolPrefix:"/ipfs",...t,clientMode:!1,lan:!0}))}}function Bs(e){return t=>new Us(t,e)}},38461:(e,t,r)=>{"use strict";r.d(t,{kg:()=>g});var n=r(11227);const s=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};new Uint8Array(0);class i{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class o{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i(e,t,r),this.decoder=new o(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),u=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=s(r,t);return l({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(i(e))})},d=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),f=u({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p=(u({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),d({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),y=(d({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),d({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),d({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),d({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),d({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),d({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),d({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),d({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));d({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),d({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),d({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function g(e){return Object.assign(n(e),{error:n(`${e}:error`),trace:n(`${e}:trace`)})}n.formatters.b=e=>null==e?"undefined":f.baseEncode(e),n.formatters.t=e=>null==e?"undefined":p.baseEncode(e),n.formatters.m=e=>null==e?"undefined":y.baseEncode(e),n.formatters.p=e=>null==e?"undefined":e.toString(),n.formatters.c=e=>null==e?"undefined":e.toString(),n.formatters.k=e=>null==e?"undefined":e.toString()},48310:(e,t,r)=>{"use strict";r.d(t,{R:()=>gt});var n={};r.r(n),r.d(n,{identity:()=>H});var s={};r.r(s),r.d(s,{base2:()=>G});var i={};r.r(i),r.d(i,{base8:()=>W});var o={};r.r(o),r.d(o,{base10:()=>J});var a={};r.r(a),r.d(a,{base16:()=>Y,base16upper:()=>Q});var c={};r.r(c),r.d(c,{base32:()=>Z,base32hex:()=>re,base32hexpad:()=>se,base32hexpadupper:()=>ie,base32hexupper:()=>ne,base32pad:()=>ee,base32padupper:()=>te,base32upper:()=>X,base32z:()=>oe});var h={};r.r(h),r.d(h,{base36:()=>ae,base36upper:()=>ce});var l={};r.r(l),r.d(l,{base58btc:()=>he,base58flickr:()=>le});var u={};r.r(u),r.d(u,{base64:()=>ue,base64pad:()=>de,base64url:()=>fe,base64urlpad:()=>pe});var d={};r.r(d),r.d(d,{base256emoji:()=>me});var f={};r.r(f),r.d(f,{sha256:()=>Ve,sha512:()=>ze});var p={};r.r(p),r.d(p,{identity:()=>Fe});var y={};r.r(y),r.d(y,{code:()=>qe,decode:()=>He,encode:()=>Ke,name:()=>$e});var g={};r.r(g),r.d(g,{code:()=>Ye,decode:()=>Ze,encode:()=>Qe,name:()=>Je});var b,m=r(88211),w=r(37430),v=r(73861),E=r(94676);function A(e){return new Uint8Array(e)}!function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(b||(b={}));const S=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),_=Object.freeze({NEW_STREAM:b.NEW_STREAM,MESSAGE:b.MESSAGE_INITIATOR,CLOSE:b.CLOSE_INITIATOR,RESET:b.RESET_INITIATOR}),C=Object.freeze({MESSAGE:b.MESSAGE_RECEIVER,CLOSE:b.CLOSE_RECEIVER,RESET:b.RESET_RECEIVER}),k=10240;const I=new class{constructor(){this._pool=A(k),this._poolOffset=0}write(e){const t=this._pool;let r=this._poolOffset;E.encode(e.id<<3|e.type,t,r),r+=E.encode.bytes??0,e.type!==b.NEW_STREAM&&e.type!==b.MESSAGE_INITIATOR&&e.type!==b.MESSAGE_RECEIVER||null==e.data?E.encode(0,t,r):E.encode(e.data.length,t,r),r+=E.encode.bytes??0;const n=t.subarray(this._poolOffset,r);return k-r<100?(this._pool=A(k),this._poolOffset=0):this._poolOffset=r,e.type!==b.NEW_STREAM&&e.type!==b.MESSAGE_INITIATOR&&e.type!==b.MESSAGE_RECEIVER||null==e.data?[n]:[n,...e.data instanceof Uint8Array?[e.data]:e.data]}};var T=r(90581);class x{constructor(){this._buffer=new T.H,this._headerInfo=null}write(e){if(null==e||0===e.length)return[];this._buffer.append(e);const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(e){break}const{id:e,type:r,length:n,offset:s}=this._headerInfo;if(this._buffer.length-s<n)break;const i={id:e,type:r};r!==b.NEW_STREAM&&r!==b.MESSAGE_INITIATOR&&r!==b.MESSAGE_RECEIVER||(i.data=this._buffer.sublist(s,s+n)),t.push(i),this._buffer.consume(s+n),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:r}=R(e),{value:n,offset:s}=R(e,r),i=7&t;if(null==S[i])throw new Error(`Invalid type received: ${i}`);return{id:t>>3,type:i,offset:r+s,length:n}}}function R(e,t=0){let r,n=0,s=0,i=t;const o=e.length;do{if(i>=o||s>49)throw t=0,new RangeError("Could not decode varint");r=e.get(i++),n+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128);return{value:n,offset:t=i-t}}async function*P(e){const t=new x;for await(const r of e){const e=t.write(r);e.length>0&&(yield e)}}const D=1<<20;var O=r(32114),N=r(32044);var L=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const U=L,B=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class M{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class V{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return j(this,e)}}class z{constructor(e){this.decoders=e}or(e){return j(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const j=(e,t)=>new z({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class F{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new M(e,t,r),this.decoder=new V(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $=({name:e,prefix:t,encode:r,decode:n})=>new F(e,t,r,n),q=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=U(r,t);return $({prefix:e,name:t,encode:n,decode:e=>B(s(e))})},K=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>$({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),H=$({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),G=K({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),W=K({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),J=q({prefix:"9",name:"base10",alphabet:"0123456789"}),Y=K({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Q=K({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Z=K({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X=K({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ee=K({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),te=K({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),re=K({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ne=K({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),se=K({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ie=K({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),oe=K({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ae=q({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ce=q({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),he=q({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),le=q({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ue=K({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),de=K({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),fe=K({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),pe=K({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ye=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ge=ye.reduce(((e,t,r)=>(e[r]=t,e)),[]),be=ye.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const me=$({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=ge[t]),"")},decode:function(e){const t=[];for(const r of e){const e=be[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var we=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ve;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ve=Math.pow(2,31);var Ee=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var Ae=Math.pow(2,7),Se=Math.pow(2,14),_e=Math.pow(2,21),Ce=Math.pow(2,28),ke=Math.pow(2,35),Ie=Math.pow(2,42),Te=Math.pow(2,49),xe=Math.pow(2,56),Re=Math.pow(2,63);const Pe={encode:we,decode:Ee,encodingLength:function(e){return e<Ae?1:e<Se?2:e<_e?3:e<Ce?4:e<ke?5:e<Ie?6:e<Te?7:e<xe?8:e<Re?9:10}},De=(e,t,r=0)=>(Pe.encode(e,t,r),t),Oe=e=>Pe.encodingLength(e),Ne=(e,t)=>{const r=t.byteLength,n=Oe(e),s=n+Oe(r),i=new Uint8Array(s+r);return De(e,i,0),De(r,i,n),i.set(t,s),new Le(e,r,t,i)};class Le{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Ue=({name:e,code:t,encode:r})=>new Be(e,t,r);class Be{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ne(this.code,t):t.then((e=>Ne(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Me=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ve=Ue({name:"sha2-256",code:18,encode:Me("SHA-256")}),ze=Ue({name:"sha2-512",code:19,encode:Me("SHA-512")}),je=B,Fe={code:0,name:"identity",encode:je,digest:e=>Ne(0,je(e))},$e="raw",qe=85,Ke=e=>B(e),He=e=>B(e),Ge=new TextEncoder,We=new TextDecoder,Je="json",Ye=512,Qe=e=>Ge.encode(JSON.stringify(e)),Ze=e=>JSON.parse(We.decode(e));new WeakMap;class Xe{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Xe.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Xe.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Xe.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Xe)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Xe(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Xe.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Xe(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Xe(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Xe.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Xe.create(1,e,t)}static decode(e){const[t,r]=Xe.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Xe.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Xe.createV0(i):Xe.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Xe.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const et={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function tt(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function rt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const nt=rt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),st=rt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?tt(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),it={utf8:nt,"utf-8":nt,hex:et.base16,latin1:st,ascii:st,binary:st,...et};function ot(e,t="utf8"){const r=it[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):tt(globalThis.Buffer.from(e,"utf-8"))}var at=r(38461);const ct=(0,at.kg)("libp2p:mplex:stream"),ht="ERR_STREAM_RESET";function lt(e,t="utf8"){const r=it[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var ut=r(8558);const dt=(0,at.kg)("libp2p:mplex");function ft(e){const t={...e,type:`${S[e.type]} (${e.type})`};return e.type===b.NEW_STREAM&&(t.data=lt(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==b.MESSAGE_INITIATOR&&e.type!==b.MESSAGE_RECEIVER||(t.data=lt(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class pt{constructor(e){this.protocol="/mplex/6.7.0",e=e??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.sink=this._createSink();const t=this._createSource();this._source=t,this.source=t,this.closeController=new AbortController,this.rateLimiter=new ut.RateLimiterMemory({points:e.disconnectThreshold??5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}close(e){this.closeController.signal.aborted||(null!=e?this.streams.forEach((t=>t.abort(e))):this.streams.forEach((e=>e.close())),this.closeController.abort())}_newReceiverStream(e){const{id:t,name:r}=e,n=this._streams.receivers;return this._newStream({id:t,name:r,type:"receiver",registry:n})}_newStream(e){const{id:t,name:r,type:n,registry:s}=e;if(dt("new %s stream %s %s",n,t),"initiator"===n&&this._streams.initiators.size===(this._init.maxOutboundStreams??1024))throw O(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(s.has(t))throw new Error(`${n} stream ${t} already exists!`);const i=function(e){const{id:t,name:r,send:n,onEnd:s,type:i="initiator",maxMsgSize:o=D}=e,a=new AbortController,c=new AbortController,h=new AbortController,l="initiator"===i?_:C,u="initiator"===i?`i${t}`:`r${t}`,d=`${null==r?t:r}`;let f,p=!1,y=!1,g=!1;const b={open:Date.now()},m=e=>{y||(y=!0,ct.trace("%s stream %s sink end - err: %o",i,d,e),null!=e&&null==f&&(f=e),p&&(b.close=Date.now(),null!=s&&s(f)))},E=(0,w.d)({onEnd:e=>{p||(p=!0,ct.trace("%s stream %s source end - err: %o",i,d,e),null!=e&&null==f&&(f=e),y&&(A.stat.timeline.close=Date.now(),null!=s&&s(f)))}}),A={close:()=>{ct.trace("%s stream %s close",i,d),A.closeRead(),A.closeWrite()},closeRead:()=>{ct.trace("%s stream %s closeRead",i,d),p||E.end()},closeWrite:()=>{if(ct.trace("%s stream %s closeWrite",i,d),!y){h.abort();try{n({id:t,type:l.CLOSE})}catch(e){ct.trace("%s stream %s error sending close",i,r,e)}m()}},abort:e=>{ct.trace("%s stream %s abort",i,d,e),E.end(e),a.abort(),m(e)},reset:()=>{const e=O(new Error("stream reset"),ht);c.abort(),E.end(e),m(e)},sink:async e=>{if(g)throw O(new Error("sink already called on stream"),"ERR_DOUBLE_SINK");if(g=!0,y)throw O(new Error("stream closed for writing"),"ERR_SINK_ENDED");e=(0,v.wJ)(e,(0,N.anySignal)([a.signal,c.signal,h.signal]));try{"initiator"===i&&n({id:t,type:_.NEW_STREAM,data:new T.H(ot(d))});const r=new T.H;for await(const s of e)if(s.length<=o)n({id:t,type:l.MESSAGE,data:s instanceof T.H?s:new T.H(s)});else for(r.append(s);0!==r.length;){if(r.length<=o){n({id:t,type:l.MESSAGE,data:r.sublist()}),r.consume(r.length);break}n({id:t,type:l.MESSAGE,data:r.sublist(0,o)}),r.consume(o)}}catch(e){if("aborted"===e.type&&"The operation was aborted"===e.message){if(h.signal.aborted)return;c.signal.aborted&&(e.message="stream reset",e.code=ht),a.signal.aborted&&(e.message="stream aborted",e.code="ERR_STREAM_ABORT")}if(e.code===ht)ct.trace("%s stream %s reset",i,r);else{ct.trace("%s stream %s error",i,r,e);try{n({id:t,type:l.RESET})}catch(e){ct.trace("%s stream %s error sending reset",i,r,e)}}return E.end(e),void m(e)}try{n({id:t,type:l.CLOSE})}catch(e){ct.trace("%s stream %s error sending close",i,r,e)}m()},source:E,sourcePush:e=>{E.push(e)},sourceReadableLength:()=>E.readableLength,stat:{direction:"initiator"===i?"outbound":"inbound",timeline:b},metadata:{},id:u};return A}({id:t,name:r,send:e=>{dt.enabled&&dt.trace("%s stream %s send",n,t,ft(e)),this._source.push(e)},type:n,onEnd:()=>{dt("%s stream with id %s and protocol %s ended",n,t,i.stat.protocol),s.delete(t),null!=this._init.onStreamEnd&&this._init.onStreamEnd(i)},maxMsgSize:this._init.maxMsgSize});return s.set(t,i),i}_createSink(){return async e=>{const t=[this.closeController.signal];null!=this._init.signal&&t.push(this._init.signal),e=(0,v.wJ)(e,N(t));try{await(0,m.zG)(e,P,function(e){const t=e??D,r=e=>{if((e.type===b.NEW_STREAM||e.type===b.MESSAGE_INITIATOR||e.type===b.MESSAGE_RECEIVER)&&e.data.byteLength>t)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return e=>async function*(){for await(const t of e)Array.isArray(t)?(t.forEach(r),yield*t):(r(t),yield t)}()}(this._init.maxMsgSize),(async e=>{for await(const t of e)await this._handleIncoming(t)})),this._source.end()}catch(e){dt("error in sink",e),this._source.end(e)}}}_createSource(){const e=(0,w.e)({objectMode:!0,onEnd:e=>{this.close(e)}});return Object.assign(async function*(e){for await(const t of e)if(Array.isArray(t))for(const e of t)yield*I.write(e);else yield*I.write(t)}(e),{push:e.push,end:e.end,return:e.return})}async _handleIncoming(e){const{id:t,type:r}=e;if(dt.enabled&&dt.trace("incoming message",ft(e)),e.type===b.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??1024)){dt("too many inbound streams open"),this._source.push({id:t,type:b.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return dt("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this._source.end(new Error("Too many open streams"))}return}const r=this._newReceiverStream({id:t,name:lt(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(r))}const n=(1==(1&r)?this._streams.initiators:this._streams.receivers).get(t);if(null==n)return void dt("missing stream %s for message type %s",t,S[r]);const s=this._init.maxStreamBufferSize??4194304;switch(r){case b.MESSAGE_INITIATOR:case b.MESSAGE_RECEIVER:if(n.sourceReadableLength()>s){this._source.push({id:e.id,type:r===b.MESSAGE_INITIATOR?b.RESET_RECEIVER:b.RESET_INITIATOR});const t=O(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");return void n.abort(t)}n.sourcePush(e.data);break;case b.CLOSE_INITIATOR:case b.CLOSE_RECEIVER:n.closeRead();break;case b.RESET_INITIATOR:case b.RESET_RECEIVER:n.reset();break;default:dt("unknown message type %s",r)}}}class yt{constructor(e={}){this.protocol="/mplex/6.7.0",this._init=e}createStreamMuxer(e={}){return new pt({...e,...this._init})}}function gt(e={}){return()=>new yt(e)}},4542:(e,t,r)=>{"use strict";r.d(t,{ji:()=>i,fd:()=>o});var n=r(93203);function s(e,t){const r={[Symbol.iterator]:()=>r,next:()=>{const r=e.next(),n=r.value;if(!0===r.done||null==n){return{done:!0,value:void 0}}return{done:!1,value:t(n)}}};return r}class i{constructor(e){if(this.map=new Map,null!=e)for(const[t,r]of e.entries())this.map.set(t.toString(),r)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return s(this.map.entries(),(e=>[(0,n.jE)(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,r)=>{e(t,(0,n.jE)(r),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return s(this.map.keys(),(e=>(0,n.jE)(e)))}values(){return this.map.values()}get size(){return this.map.size}}class o{constructor(e){if(this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return s(this.set.entries(),(e=>{const t=(0,n.jE)(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const r=(0,n.jE)(t);e(r,r,this)}))}has(e){return this.set.has(e.toString())}values(){return s(this.set.values(),(e=>(0,n.jE)(e)))}intersection(e){const t=new o;for(const r of e)this.has(r)&&t.add(r);return t}difference(e){const t=new o;for(const r of this)e.has(r)||t.add(r);return t}union(e){const t=new o;for(const r of e)t.add(r);for(const e of this)t.add(e);return t}}class a{constructor(e){if(this.list=[],null!=e)for(const t of e)this.list.push(t.toString())}[Symbol.iterator](){return mapIterable(this.list.entries(),(e=>peerIdFromString(e[1])))}concat(e){const t=new a(this);for(const r of e)t.push(r);return t}entries(){return mapIterable(this.list.entries(),(e=>[e[0],peerIdFromString(e[1])]))}every(e){return this.list.every(((t,r)=>e(peerIdFromString(t),r,this)))}filter(e){const t=new a;return this.list.forEach(((r,n)=>{const s=peerIdFromString(r);e(s,n,this)&&t.push(s)})),t}find(e){const t=this.list.find(((t,r)=>e(peerIdFromString(t),r,this)));if(null!=t)return peerIdFromString(t)}findIndex(e){return this.list.findIndex(((t,r)=>e(peerIdFromString(t),r,this)))}forEach(e){this.list.forEach(((t,r)=>{e(peerIdFromString(t),r,this)}))}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){const e=this.list.pop();if(null!=e)return peerIdFromString(e)}push(...e){for(const t of e)this.list.push(t.toString())}shift(){const e=this.list.shift();if(null!=e)return peerIdFromString(e)}unshift(...e){let t=this.list.length;for(let t=e.length-1;t>-1;t--)this.list.unshift(e[t].toString());return t}get length(){return this.list.length}}},34361:(e,t,r)=>{"use strict";r.d(t,{n9:()=>Ke,W$:()=>He});var n={};r.r(n),r.d(n,{identity:()=>x});var s={};r.r(s),r.d(s,{base2:()=>R});var i={};r.r(i),r.d(i,{base8:()=>P});var o={};r.r(o),r.d(o,{base10:()=>D});var a={};r.r(a),r.d(a,{base16:()=>O,base16upper:()=>N});var c={};r.r(c),r.d(c,{base32:()=>L,base32hex:()=>V,base32hexpad:()=>j,base32hexpadupper:()=>F,base32hexupper:()=>z,base32pad:()=>B,base32padupper:()=>M,base32upper:()=>U,base32z:()=>$});var h={};r.r(h),r.d(h,{base36:()=>q,base36upper:()=>K});var l={};r.r(l),r.d(l,{base58btc:()=>H,base58flickr:()=>G});var u={};r.r(u),r.d(u,{base64:()=>W,base64pad:()=>J,base64url:()=>Y,base64urlpad:()=>Q});var d={};r.r(d),r.d(d,{base256emoji:()=>te});var f={};r.r(f),r.d(f,{sha256:()=>Ae,sha512:()=>Se});var p={};r.r(p),r.d(p,{identity:()=>Ce});var y={};r.r(y),r.d(y,{code:()=>Ie,decode:()=>xe,encode:()=>Te,name:()=>ke});var g={};r.r(g),r.d(g,{code:()=>Oe,decode:()=>Le,encode:()=>Ne,name:()=>De});var b=r(51988);var m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const w=m,v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class E{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _(this,e)}}class S{constructor(e){this.decoders=e}or(e){return _(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _=(e,t)=>new S({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class C{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new E(e,t,r),this.decoder=new A(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const k=({name:e,prefix:t,encode:r,decode:n})=>new C(e,t,r,n),I=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=w(r,t);return k({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},T=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>k({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),x=k({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),R=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),P=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),D=I({prefix:"9",name:"base10",alphabet:"0123456789"}),O=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),L=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),U=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),q=I({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K=I({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),H=I({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G=I({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Q=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Z=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),X=Z.reduce(((e,t,r)=>(e[r]=t,e)),[]),ee=Z.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const te=k({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=X[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ee[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var re=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ne;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ne=Math.pow(2,31);var se=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var ie=Math.pow(2,7),oe=Math.pow(2,14),ae=Math.pow(2,21),ce=Math.pow(2,28),he=Math.pow(2,35),le=Math.pow(2,42),ue=Math.pow(2,49),de=Math.pow(2,56),fe=Math.pow(2,63);const pe={encode:re,decode:se,encodingLength:function(e){return e<ie?1:e<oe?2:e<ae?3:e<ce?4:e<he?5:e<le?6:e<ue?7:e<de?8:e<fe?9:10}},ye=(e,t,r=0)=>(pe.encode(e,t,r),t),ge=e=>pe.encodingLength(e),be=(e,t)=>{const r=t.byteLength,n=ge(e),s=n+ge(r),i=new Uint8Array(s+r);return ye(e,i,0),ye(r,i,n),i.set(t,s),new me(e,r,t,i)};class me{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const we=({name:e,code:t,encode:r})=>new ve(e,t,r);class ve{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?be(this.code,t):t.then((e=>be(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ee=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ae=we({name:"sha2-256",code:18,encode:Ee("SHA-256")}),Se=we({name:"sha2-512",code:19,encode:Ee("SHA-512")}),_e=v,Ce={code:0,name:"identity",encode:_e,digest:e=>be(0,_e(e))},ke="raw",Ie=85,Te=e=>v(e),xe=e=>v(e),Re=new TextEncoder,Pe=new TextDecoder,De="json",Oe=512,Ne=e=>Re.encode(JSON.stringify(e)),Le=e=>JSON.parse(Pe.decode(e));new WeakMap;class Ue{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ue.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Ue.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ue.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ue)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Ue(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Ue.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Ue(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Ue(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ue.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Ue.create(1,e,t)}static decode(e){const[t,r]=Ue.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ue.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Ue.createV0(i):Ue.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Ue.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Be={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Me(e=0){return null!=globalThis.Buffer?.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e);var t}function Ve(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ze=Ve("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),je=Ve("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Me((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}));var Fe,$e=r(93203),qe=r(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,qe.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={id:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:r.pubKey=e.bytes();break;case 3:r.privKey=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,qe.LE)(t,e.codec()),e.decode=t=>(0,qe.C6)(t,e.codec())}(Fe||(Fe={}));const Ke=async()=>{const e=await(0,b.generateKeyPair)("Ed25519"),t=await Ge(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)},He=async e=>{const t=await(0,b.generateKeyPair)("RSA",e?.bits??2048),r=await Ge(t);if("RSA"===r.type)return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function Ge(e){return await(0,$e.y5)((0,b.marshalPublicKey)(e.public),(0,b.marshalPrivateKey)(e))}},93203:(e,t,r)=>{"use strict";r.d(t,{cv:()=>nt,y5:()=>st,vL:()=>tt,jE:()=>rt});var n={};r.r(n),r.d(n,{base58btc:()=>H,base58flickr:()=>G});var s={};r.r(s),r.d(s,{base32:()=>W,base32hex:()=>Z,base32hexpad:()=>ee,base32hexpadupper:()=>te,base32hexupper:()=>X,base32pad:()=>Y,base32padupper:()=>Q,base32upper:()=>J,base32z:()=>re});var i={};r.r(i),r.d(i,{identity:()=>fe});var o={};r.r(o),r.d(o,{base2:()=>pe});var a={};r.r(a),r.d(a,{base8:()=>ye});var c={};r.r(c),r.d(c,{base10:()=>ge});var h={};r.r(h),r.d(h,{base16:()=>be,base16upper:()=>me});var l={};r.r(l),r.d(l,{base36:()=>we,base36upper:()=>ve});var u={};r.r(u),r.d(u,{base64:()=>Ee,base64pad:()=>Ae,base64url:()=>Se,base64urlpad:()=>_e});var d={};r.r(d),r.d(d,{base256emoji:()=>Te});var f={};r.r(f),r.d(f,{sha256:()=>De,sha512:()=>Oe});var p={};r.r(p),r.d(p,{identity:()=>Le});var y={};r.r(y),r.d(y,{code:()=>Be,decode:()=>Ve,encode:()=>Me,name:()=>Ue});var g={};r.r(g),r.d(g,{code:()=>$e,decode:()=>Ke,encode:()=>qe,name:()=>Fe});var b=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=m;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},m=Math.pow(2,31);var w=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var v=Math.pow(2,7),E=Math.pow(2,14),A=Math.pow(2,21),S=Math.pow(2,28),_=Math.pow(2,35),C=Math.pow(2,42),k=Math.pow(2,49),I=Math.pow(2,56),T=Math.pow(2,63);const x={encode:b,decode:w,encodingLength:function(e){return e<v?1:e<E?2:e<A?3:e<S?4:e<_?5:e<C?6:e<k?7:e<I?8:e<T?9:10}},R=(e,t=0)=>[x.decode(e,t),x.decode.bytes],P=(e,t,r=0)=>(x.encode(e,t,r),t),D=e=>x.encodingLength(e),O=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),N=(e,t)=>{const r=t.byteLength,n=D(e),s=n+D(r),i=new Uint8Array(s+r);return P(e,i,0),P(r,i,n),i.set(t,s),new U(e,r,t,i)},L=e=>{const t=O(e),[r,n]=R(t),[s,i]=R(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new U(r,s,o,t)};class U{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const B=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class M{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class V{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return j(this,e)}}class z{constructor(e){this.decoders=e}or(e){return j(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const j=(e,t)=>new z({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class F{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new M(e,t,r),this.decoder=new V(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $=({name:e,prefix:t,encode:r,decode:n})=>new F(e,t,r,n),q=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=B(r,t);return $({prefix:e,name:t,encode:n,decode:e=>O(s(e))})},K=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>$({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),H=q({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G=q({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=K({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),J=K({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Y=K({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Q=K({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Z=K({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),X=K({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ee=K({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),te=K({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),re=K({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ne=new WeakMap,se=e=>{const t=ne.get(e);if(null==t){const t=new Map;return ne.set(e,t),t}return t};class ie{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==he)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==le)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ie.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=N(e,t);return ie.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ie.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?ae(r,se(e),t||H.encoder):ce(r,se(e),t||W.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof ie)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new ie(e,r,n,s||ue(e,r,n.bytes))}if(!0===t[de]){const{version:e,multihash:r,code:n}=t,s=L(r);return ie.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==he)throw new Error(`Version 0 CID must use dag-pb (code: ${he}) block encoding`);return new ie(e,t,r,r.bytes);case 1:{const n=ue(e,t,r.bytes);return new ie(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return ie.create(0,he,e)}static createV1(e,t){return ie.create(1,e,t)}static decode(e){const[t,r]=ie.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=ie.inspectBytes(e),r=t.size-t.multihashSize,n=O(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new U(t.multihashCode,t.digestSize,s,n);return[0===t.version?ie.createV0(i):ie.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=R(e.subarray(t));return t+=n,r};let n=r(),s=he;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=oe(e,t),s=ie.decode(n);return se(s).set(r,e),s}}const oe=(e,t)=>{switch(e[0]){case"Q":{const r=t||H;return[H.prefix,r.decode(`${H.prefix}${e}`)]}case H.prefix:{const r=t||H;return[H.prefix,r.decode(e)]}case W.prefix:{const r=t||W;return[W.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ae=(e,t,r)=>{const{prefix:n}=r;if(n!==H.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},ce=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},he=112,le=18,ue=(e,t,r)=>{const n=D(e),s=n+D(t),i=new Uint8Array(s+r.byteLength);return P(e,i,0),P(t,i,n),i.set(r,s),i},de=Symbol.for("@ipld/js-cid/CID"),fe=$({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),pe=K({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ye=K({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ge=q({prefix:"9",name:"base10",alphabet:"0123456789"}),be=K({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),me=K({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),we=q({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ve=q({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ee=K({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ae=K({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Se=K({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_e=K({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ce=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ke=Ce.reduce(((e,t,r)=>(e[r]=t,e)),[]),Ie=Ce.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Te=$({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=ke[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Ie[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),xe=({name:e,code:t,encode:r})=>new Re(e,t,r);class Re{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?N(this.code,t):t.then((e=>N(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Pe=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),De=xe({name:"sha2-256",code:18,encode:Pe("SHA-256")}),Oe=xe({name:"sha2-512",code:19,encode:Pe("SHA-512")}),Ne=O,Le={code:0,name:"identity",encode:Ne,digest:e=>N(0,Ne(e))},Ue="raw",Be=85,Me=e=>O(e),Ve=e=>O(e),ze=new TextEncoder,je=new TextDecoder,Fe="json",$e=512,qe=e=>ze.encode(JSON.stringify(e)),Ke=e=>JSON.parse(je.decode(e)),He={...i,...o,...a,...c,...h,...s,...l,...n,...u,...d};function Ge(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var We=r(32114),Je=r(682);const Ye=Object.values(He).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),He.identity.decoder);class Qe{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Je.N](){return!0}toString(){return null==this.string&&(this.string=H.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return ie.createV1(114,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Ge(this.multihash.bytes,e);if("string"==typeof e)return rt(e).equals(this);if(null!=e?.multihash?.bytes)return Ge(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}}class Ze extends Qe{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}}class Xe extends Qe{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}}class et extends Qe{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}}function tt(e){if("RSA"===e.type)return new Ze(e);if("Ed25519"===e.type)return new Xe(e);if("secp256k1"===e.type)return new et(e);throw We(new Error("Not a PeerId"),"ERR_INVALID_PARAMETERS")}function rt(e,t){if(t=t??Ye,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=L(H.decode(`z${e}`));return e.startsWith("12D")?new Xe({multihash:t}):e.startsWith("16U")?new et({multihash:t}):new Ze({multihash:t})}return nt(Ye.decode(e))}function nt(e){try{const t=L(e);if(t.code===Le.code){if(36===t.digest.length)return new Xe({multihash:t});if(37===t.digest.length)return new et({multihash:t})}if(t.code===De.code)return new Ze({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&114!==e.code)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===De.code)return new Ze({multihash:e.multihash});if(t.code===Le.code){if(36===t.digest.length)return new Xe({multihash:e.multihash});if(37===t.digest.length)return new et({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(ie.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function st(e,t){return 36===e.length?new Xe({multihash:N(Le.code,e),privateKey:t}):37===e.length?new et({multihash:N(Le.code,e),privateKey:t}):new Ze({multihash:await De.digest(e),publicKey:e,privateKey:t})}},92713:(e,t,r)=>{"use strict";r.d(t,{K:()=>tt,X:()=>Ye});var n={};r.r(n),r.d(n,{identity:()=>x});var s={};r.r(s),r.d(s,{base2:()=>R});var i={};r.r(i),r.d(i,{base8:()=>P});var o={};r.r(o),r.d(o,{base10:()=>D});var a={};r.r(a),r.d(a,{base16:()=>O,base16upper:()=>N});var c={};r.r(c),r.d(c,{base32:()=>L,base32hex:()=>V,base32hexpad:()=>j,base32hexpadupper:()=>F,base32hexupper:()=>z,base32pad:()=>B,base32padupper:()=>M,base32upper:()=>U,base32z:()=>$});var h={};r.r(h),r.d(h,{base36:()=>q,base36upper:()=>K});var l={};r.r(l),r.d(l,{base58btc:()=>H,base58flickr:()=>G});var u={};r.r(u),r.d(u,{base64:()=>W,base64pad:()=>J,base64url:()=>Y,base64urlpad:()=>Q});var d={};r.r(d),r.d(d,{base256emoji:()=>te});var f={};r.r(f),r.d(f,{sha256:()=>Ae,sha512:()=>Se});var p={};r.r(p),r.d(p,{identity:()=>Ce});var y={};r.r(y),r.d(y,{code:()=>Ie,decode:()=>xe,encode:()=>Te,name:()=>ke});var g={};r.r(g),r.d(g,{code:()=>Oe,decode:()=>Le,encode:()=>Ne,name:()=>De});var b=r(32114);var m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const w=m,v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class E{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _(this,e)}}class S{constructor(e){this.decoders=e}or(e){return _(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _=(e,t)=>new S({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class C{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new E(e,t,r),this.decoder=new A(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const k=({name:e,prefix:t,encode:r,decode:n})=>new C(e,t,r,n),I=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=w(r,t);return k({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},T=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>k({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),x=k({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),R=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),P=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),D=I({prefix:"9",name:"base10",alphabet:"0123456789"}),O=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),L=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),U=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),q=I({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K=I({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),H=I({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G=I({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Q=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Z=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),X=Z.reduce(((e,t,r)=>(e[r]=t,e)),[]),ee=Z.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const te=k({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=X[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ee[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var re=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ne;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ne=Math.pow(2,31);var se=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var ie=Math.pow(2,7),oe=Math.pow(2,14),ae=Math.pow(2,21),ce=Math.pow(2,28),he=Math.pow(2,35),le=Math.pow(2,42),ue=Math.pow(2,49),de=Math.pow(2,56),fe=Math.pow(2,63);const pe={encode:re,decode:se,encodingLength:function(e){return e<ie?1:e<oe?2:e<ae?3:e<ce?4:e<he?5:e<le?6:e<ue?7:e<de?8:e<fe?9:10}},ye=(e,t,r=0)=>(pe.encode(e,t,r),t),ge=e=>pe.encodingLength(e),be=(e,t)=>{const r=t.byteLength,n=ge(e),s=n+ge(r),i=new Uint8Array(s+r);return ye(e,i,0),ye(r,i,n),i.set(t,s),new me(e,r,t,i)};class me{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const we=({name:e,code:t,encode:r})=>new ve(e,t,r);class ve{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?be(this.code,t):t.then((e=>be(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ee=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ae=we({name:"sha2-256",code:18,encode:Ee("SHA-256")}),Se=we({name:"sha2-512",code:19,encode:Ee("SHA-512")}),_e=v,Ce={code:0,name:"identity",encode:_e,digest:e=>be(0,_e(e))},ke="raw",Ie=85,Te=e=>v(e),xe=e=>v(e),Re=new TextEncoder,Pe=new TextDecoder,De="json",Oe=512,Ne=e=>Re.encode(JSON.stringify(e)),Le=e=>JSON.parse(Pe.decode(e));new WeakMap;class Ue{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ue.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Ue.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ue.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ue)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Ue(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Ue.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Ue(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Ue(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ue.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Ue.create(1,e,t)}static decode(e){const[t,r]=Ue.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ue.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Ue.createV0(i):Ue.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Ue.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Be={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Me(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ve(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ze=Ve("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),je=Ve("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Me(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Fe={utf8:ze,"utf-8":ze,hex:Be.base16,latin1:je,ascii:je,binary:je,...Be};var $e=r(51988);const qe="ERR_SIGNATURE_NOT_VALID";var Ke,He=r(46888);!function(e){let t;e.codec=()=>(null==t&&(t=(0,He.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.publicKey&&e.publicKey.byteLength>0)&&(t.uint32(10),t.bytes(e.publicKey)),(!0===r.writeDefaults||null!=e.payloadType&&e.payloadType.byteLength>0)&&(t.uint32(18),t.bytes(e.payloadType)),(!0===r.writeDefaults||null!=e.payload&&e.payload.byteLength>0)&&(t.uint32(26),t.bytes(e.payload)),(!0===r.writeDefaults||null!=e.signature&&e.signature.byteLength>0)&&(t.uint32(42),t.bytes(e.signature)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.publicKey=e.bytes();break;case 2:r.payloadType=e.bytes();break;case 3:r.payload=e.bytes();break;case 5:r.signature=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,He.LE)(t,e.codec()),e.decode=t=>(0,He.C6)(t,e.codec())}(Ke||(Ke={}));var Ge=r(93203),We=r(90581),Je=r(77443);class Ye{constructor(e){const{peerId:t,payloadType:r,payload:n,signature:s}=e;this.peerId=t,this.payloadType=r,this.payload=n,this.signature=s}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=Ke.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(this.marshal(),e.marshal())}async validate(e){const t=Qe(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");const r=(0,$e.unmarshalPublicKey)(this.peerId.publicKey);return await r.verify(t.subarray(),this.signature)}}Ye.createFromProtobuf=async e=>{const t=Ke.decode(e),r=await(0,Ge.y5)(t.publicKey);return new Ye({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},Ye.seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const r=e.domain,n=e.codec,s=e.marshal(),i=Qe(r,n,s),o=await(0,$e.unmarshalPrivateKey)(t.privateKey),a=await o.sign(i.subarray());return new Ye({peerId:t,payloadType:n,payload:s,signature:a})},Ye.openAndCertify=async(e,t)=>{const r=await Ye.createFromProtobuf(e);if(!await r.validate(t))throw b(new Error("envelope signature is not valid for the given domain"),qe);return r};const Qe=(e,t,r)=>{const n=function(e,t="utf8"){const r=Fe[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Me(globalThis.Buffer.from(e,"utf-8"))}(e),s=Je.hG.encode(n.byteLength),i=Je.hG.encode(t.length),o=Je.hG.encode(r.length);return new We.H(s,n,i,t,o,r)};var Ze,Xe=r(94306);!function(e){let t,r;!function(e){let t;e.codec=()=>(null==t&&(t=(0,He.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.multiaddr&&e.multiaddr.byteLength>0)&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.multiaddr=e.bytes();else e.skipType(7&t)}return r}))),t),e.encode=t=>(0,He.LE)(t,e.codec()),e.decode=t=>(0,He.C6)(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==r&&(r=(0,He.yw)(((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),(!0===n.writeDefaults||null!=t.peerId&&t.peerId.byteLength>0)&&(r.uint32(10),r.bytes(t.peerId)),!0!==n.writeDefaults&&0n===t.seq||(r.uint32(16),r.uint64(t.seq)),null!=t.addresses)for(const n of t.addresses)r.uint32(26),e.AddressInfo.codec().encode(n,r,{writeDefaults:!0});!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={peerId:new Uint8Array(0),seq:0n,addresses:[]},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.peerId=t.bytes();break;case 2:n.seq=t.uint64();break;case 3:n.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&r)}}return n}))),r),e.encode=t=>(0,He.LE)(t,e.codec()),e.decode=t=>(0,He.C6)(t,e.codec())}(Ze||(Ze={}));const et=Uint8Array.from([3,1]);class tt{constructor(e){this.domain=tt.DOMAIN,this.codec=tt.CODEC;const{peerId:t,multiaddrs:r,seqNumber:n}=e;this.peerId=t,this.multiaddrs=r??[],this.seqNumber=n??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=Ze.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof tt&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!function(e,t){const r=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(r),e.sort(r).every(((e,r)=>t[r].equals(e))))}(this.multiaddrs,e.multiaddrs)))}}tt.createFromProtobuf=e=>{const t=Ze.decode(e),r=(0,Ge.cv)(t.peerId),n=(t.addresses??[]).map((e=>(0,Xe.HM)(e.multiaddr))),s=t.seq;return new tt({peerId:r,multiaddrs:n,seqNumber:s})},tt.DOMAIN="libp2p-peer-record",tt.CODEC=et},21177:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o});var n,s=r(46888);function i(e){const t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),s=String(e.getUTCHours()).padStart(2,"0"),i=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds();return`${t}-${r}-${n}T${s}:${i}:${o}.${String(1e3*a*1e3).padStart(9,"0")}Z`}!function(e){let t;e.codec=()=>(null==t&&(t=(0,s.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.key&&e.key.byteLength>0)&&(t.uint32(10),t.bytes(e.key)),(!0===r.writeDefaults||null!=e.value&&e.value.byteLength>0)&&(t.uint32(18),t.bytes(e.value)),!0!==r.writeDefaults&&""===e.timeReceived||(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,s.LE)(t,e.codec()),e.decode=t=>(0,s.C6)(t,e.codec())}(n||(n={}));class o{constructor(e,t,r){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=r}serialize(){return n.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:i(this.timeReceived)}}static deserialize(e){const t=n.decode(e);return new o(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),s=parseInt(r[2],10)-1,i=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),h=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,s,i,o,a,c,h))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new o(e.key,e.value,t)}}},21466:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});var n=r(1388);const s=()=>{};class i{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??s,this.onDisconnect=e.onDisconnect??s}get[Symbol.toStringTag](){return n.d.toString()}get[n.d](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}}function o(e){return new i(e)}},20199:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});class n extends Map{constructor(e){super();const{system:t,component:r,metric:n,metrics:s}=e;this.system=t??"libp2p",this.component=r,this.metric=n,this.metrics=s,this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}}function s(e){const{system:t,component:r,metric:s,metrics:i}=e;let o;return o=null!=i?new n({system:t,component:r,metric:s,metrics:i}):new Map,o}},61979:(e,t,r)=>{"use strict";r.d(t,{E:()=>ft});var n={};r.r(n),r.d(n,{identity:()=>R});var s={};r.r(s),r.d(s,{base2:()=>P});var i={};r.r(i),r.d(i,{base8:()=>D});var o={};r.r(o),r.d(o,{base10:()=>O});var a={};r.r(a),r.d(a,{base16:()=>N,base16upper:()=>L});var c={};r.r(c),r.d(c,{base32:()=>U,base32hex:()=>z,base32hexpad:()=>F,base32hexpadupper:()=>$,base32hexupper:()=>j,base32pad:()=>M,base32padupper:()=>V,base32upper:()=>B,base32z:()=>q});var h={};r.r(h),r.d(h,{base36:()=>K,base36upper:()=>H});var l={};r.r(l),r.d(l,{base58btc:()=>G,base58flickr:()=>W});var u={};r.r(u),r.d(u,{base64:()=>J,base64pad:()=>Y,base64url:()=>Q,base64urlpad:()=>Z});var d={};r.r(d),r.d(d,{base256emoji:()=>re});var f={};r.r(f),r.d(f,{sha256:()=>Se,sha512:()=>_e});var p={};r.r(p),r.d(p,{identity:()=>ke});var y={};r.r(y),r.d(y,{code:()=>Te,decode:()=>Re,encode:()=>xe,name:()=>Ie});var g={};r.r(g),r.d(g,{code:()=>Ne,decode:()=>Ue,encode:()=>Le,name:()=>Oe});const b=WebSocket;var m=r(90507);var w=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const v=w,E=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class A{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class S{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return C(this,e)}}class _{constructor(e){this.decoders=e}or(e){return C(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const C=(e,t)=>new _({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class k{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new A(e,t,r),this.decoder=new S(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const I=({name:e,prefix:t,encode:r,decode:n})=>new k(e,t,r,n),T=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=v(r,t);return I({prefix:e,name:t,encode:n,decode:e=>E(s(e))})},x=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>I({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),R=I({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),P=x({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),D=x({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),O=T({prefix:"9",name:"base10",alphabet:"0123456789"}),N=x({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),L=x({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),U=x({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),B=x({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),M=x({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),V=x({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),z=x({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),j=x({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),F=x({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$=x({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),q=x({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),K=T({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),H=T({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),G=T({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),W=T({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),J=x({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Y=x({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q=x({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Z=x({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),X=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ee=X.reduce(((e,t,r)=>(e[r]=t,e)),[]),te=X.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const re=I({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=ee[t]),"")},decode:function(e){const t=[];for(const r of e){const e=te[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var ne=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=se;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},se=Math.pow(2,31);var ie=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var oe=Math.pow(2,7),ae=Math.pow(2,14),ce=Math.pow(2,21),he=Math.pow(2,28),le=Math.pow(2,35),ue=Math.pow(2,42),de=Math.pow(2,49),fe=Math.pow(2,56),pe=Math.pow(2,63);const ye={encode:ne,decode:ie,encodingLength:function(e){return e<oe?1:e<ae?2:e<ce?3:e<he?4:e<le?5:e<ue?6:e<de?7:e<fe?8:e<pe?9:10}},ge=(e,t,r=0)=>(ye.encode(e,t,r),t),be=e=>ye.encodingLength(e),me=(e,t)=>{const r=t.byteLength,n=be(e),s=n+be(r),i=new Uint8Array(s+r);return ge(e,i,0),ge(r,i,n),i.set(t,s),new we(e,r,t,i)};class we{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const ve=({name:e,code:t,encode:r})=>new Ee(e,t,r);class Ee{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?me(this.code,t):t.then((e=>me(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ae=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Se=ve({name:"sha2-256",code:18,encode:Ae("SHA-256")}),_e=ve({name:"sha2-512",code:19,encode:Ae("SHA-512")}),Ce=E,ke={code:0,name:"identity",encode:Ce,digest:e=>me(0,Ce(e))},Ie="raw",Te=85,xe=e=>E(e),Re=e=>E(e),Pe=new TextEncoder,De=new TextDecoder,Oe="json",Ne=512,Le=e=>Pe.encode(JSON.stringify(e)),Ue=e=>JSON.parse(De.decode(e));new WeakMap;class Be{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Be.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Be.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Be.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Be)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Be(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Be.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Be(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Be(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Be.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Be.create(1,e,t)}static decode(e){const[t,r]=Be.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Be.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Be.createV0(i):Be.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Be.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Me={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Ve(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ze(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const je=ze("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Fe=ze("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Ve(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),$e={utf8:je,"utf-8":je,hex:Me.base16,latin1:Fe,ascii:Fe,binary:Fe,...Me};function qe(e){return e instanceof ArrayBuffer||"ArrayBuffer"===e?.constructor?.name&&"number"==typeof e?.byteLength}const Ke=e=>{e.binaryType="arraybuffer";const t=async()=>await new Promise(((t,r)=>{if(s)return t();if(null!=n)return r(n);const i=t=>{e.removeEventListener("open",o),e.removeEventListener("error",a),t()},o=()=>i(t),a=t=>{i((()=>r(t.error??new Error(`connect ECONNREFUSED ${e.url}`))))};e.addEventListener("open",o),e.addEventListener("error",a)})),r=async function*(){const r=new m.zN((({push:t,stop:r,fail:n})=>{const s=e=>{let r=null;"string"==typeof e.data&&(r=function(e,t="utf8"){const r=$e[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ve(globalThis.Buffer.from(e,"utf-8"))}(e.data)),qe(e.data)&&(r=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(r=e.data),null!=r&&t(r)},i=e=>n(e.error??new Error("Socket error"));return e.addEventListener("message",s),e.addEventListener("error",i),e.addEventListener("close",r),()=>{e.removeEventListener("message",s),e.removeEventListener("error",i),e.removeEventListener("close",r)}}),{highWaterMark:1/0});await t();for await(const e of r)yield qe(e)?new Uint8Array(e):e}();let n,s=1===e.readyState;return e.addEventListener("open",(()=>{s=!0,n=null})),e.addEventListener("close",(()=>{s=!1,n=null})),e.addEventListener("error",(t=>{s||(n=t.error??new Error(`connect ECONNREFUSED ${e.url}`))})),Object.assign(r,{connected:t})},He=e=>{if(e.readyState>=2)throw new Error("socket closed");if(1!==e.readyState)return new Promise(((t,r)=>{function n(){e.removeEventListener("open",s),e.removeEventListener("error",i)}function s(){n(),t()}function i(t){n(),r(t.error??new Error(`connect ECONNREFUSED ${e.url}`))}e.addEventListener("open",s),e.addEventListener("error",i)}))},Ge=(e,t)=>{(t=t??{}).closeOnEnd=!1!==t.closeOnEnd;return async r=>{for await(const t of r){try{await He(e)}catch(e){if("socket closed"===e.message)break;throw e}e.send(t)}if(null!=t.closeOnEnd&&e.readyState<=1)return await new Promise(((t,r)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});r(t)}})),setTimeout((()=>e.close()))}))}};var We=r(17745);const Je={http:"ws",https:"wss"};function Ye(e,t){t=t??{};const r=((e,t)=>(0,We.relative)(e,t,Je,"ws"))(e,("undefined"==typeof window?"":window.location).toString());return((e,t)=>{t=t??{};const r=Ke(e);let n=t.remoteAddress,s=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);n=t.hostname,s=parseInt(t.port,10)}catch{}if(null==n||null==s)throw new Error("Remote connection did not have address and/or port");return{sink:Ge(e,t),source:r,connected:async()=>await r.connected(),close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:n,remotePort:s,socket:e}})(new b(r,t.websocket),t)}var Qe=r(45182),Ze=r(52770),Xe=r(85275),et=r(38461),tt=r(14560);var rt=r(73861);class nt extends Error{constructor(e){super(e),this.name="TimeoutError"}}class st extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const it=e=>void 0===globalThis.DOMException?new st(e):new DOMException(e),ot=e=>{const t=void 0===e.reason?it("This operation was aborted."):e.reason;return t instanceof Error?t:it(t)};const at=(0,et.kg)("libp2p:websockets:socket");function ct(e,t,r){const n={async sink(t){null!=r?.signal&&(t=(0,rt.wJ)(t,r.signal));try{await e.sink(t)}catch(e){"aborted"!==e.type&&at.error(e)}},source:null!=(r=r??{}).signal?(0,rt.wJ)(e.source,r.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){const t=Date.now();try{await function(e,t){const{milliseconds:r,fallback:n,message:s,customTimers:i={setTimeout,clearTimeout}}=t;let o;const a=new Promise(((a,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r!==Number.POSITIVE_INFINITY){if(t.signal){const{signal:e}=t;e.aborted&&c(ot(e)),e.addEventListener("abort",(()=>{c(ot(e))}))}o=i.setTimeout.call(void 0,(()=>{if(n){try{a(n())}catch(e){c(e)}return}const t=s instanceof Error?s:new nt("string"==typeof s?s:`Promise timed out after ${r} milliseconds`);"function"==typeof e.cancel&&e.cancel(),c(t)}),r),(async()=>{try{a(await e)}catch(e){c(e)}finally{i.clearTimeout.call(void 0,o)}})()}else a(e)}));return a.clear=()=>{i.clearTimeout.call(void 0,o),o=void 0},a}(e.close(),{milliseconds:2e3})}catch(r){const{host:s,port:i}=n.remoteAddr.toOptions();at("timeout closing stream to %s:%s after %dms, destroying it manually",s,i,Date.now()-t),e.destroy()}finally{n.timeline.close=Date.now()}}};return e.socket.addEventListener("close",(()=>{null==n.timeline.close&&(n.timeline.close=Date.now())}),{once:!0}),n}var ht=r(76237);var lt=r(12348);const ut=(0,et.kg)("libp2p:websockets");class dt{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[lt.N](){return!0}async dial(e,t){ut("dialing %s",e),t=t??{};const r=ct(await this._connect(e,t),e);ut("new outbound connection %s",r.remoteAddr);const n=await t.upgrader.upgradeOutbound(r);return ut("outbound connection %s upgraded",r.remoteAddr),n}async _connect(e,t){if(!0===t?.signal?.aborted)throw new Ze._;const r=e.toOptions();ut("dialing %s:%s",r.host,r.port);const n=(0,Xe.Z)(),s=e=>{ut.error("connection error:",e),n.reject(e)},i=Ye((0,Qe.k)(e),this.init);if(null!=i.socket.on?i.socket.on("error",s):i.socket.onerror=s,null==t.signal)return await Promise.race([i.connected(),n.promise]),ut("connected %s",e),i;let o;const a=new Promise(((e,r)=>{if(o=()=>{r(new Ze._),i.close().catch((e=>{ut.error("error closing raw socket",e)}))},!0===t?.signal?.aborted)return o();t?.signal?.addEventListener("abort",o)}));try{await Promise.race([a,n.promise,i.connected()])}finally{null!=o&&t?.signal?.removeEventListener("abort",o)}return ut("connected %s",e),i}createListener(e){return function(){throw new Error("WebSocket Servers can not be created in the browser!")}(this.init)}filter(e){return e=Array.isArray(e)?e:[e],null!=this.init?.filter?this.init?.filter(e):tt.jU||tt.n2?function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return ht.th.matches(t)&&ht.Rk.matches(t.decapsulateCode(6).decapsulateCode(478))}))}(e):function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return ht.Ce.matches(t)||ht.th.matches(t)}))}(e)}}function ft(e={}){return()=>new dt(e)}},76237:(e,t,r)=>{"use strict";r.d(t,{Ce:()=>f,Cz:()=>C,Rk:()=>a,Ul:()=>_,dx:()=>S,th:()=>p,xk:()=>b});var n=r(94306);const s=x("dns4"),i=x("dns6"),o=x("dnsaddr"),a=T(x("dns"),o,s,i),c=T(x("ip4"),x("ip6")),h=T(I(c,x("tcp")),I(a,x("tcp"))),l=I(c,x("udp")),u=I(l,x("utp")),d=I(l,x("quic")),f=T(I(h,x("ws")),I(a,x("ws"))),p=T(I(h,x("wss")),I(a,x("wss"))),y=T(I(h,x("http")),I(c,x("http")),I(a,x("http"))),g=T(I(h,x("https")),I(c,x("https")),I(a,x("https"))),b=T(I(f,x("p2p-webrtc-star"),x("p2p")),I(p,x("p2p-webrtc-star"),x("p2p")),I(f,x("p2p-webrtc-star")),I(p,x("p2p-webrtc-star"))),m=(T(I(f,x("p2p-websocket-star"),x("p2p")),I(p,x("p2p-websocket-star"),x("p2p")),I(f,x("p2p-websocket-star")),I(p,x("p2p-websocket-star"))),T(I(y,x("p2p-webrtc-direct"),x("p2p")),I(g,x("p2p-webrtc-direct"),x("p2p")),I(y,x("p2p-webrtc-direct")),I(g,x("p2p-webrtc-direct")))),w=T(f,p,y,g,b,m,h,u,d,a),v=(T(I(w,x("p2p-stardust"),x("p2p")),I(w,x("p2p-stardust"))),T(I(w,x("p2p")),b,m,x("p2p"))),E=T(I(v,x("p2p-circuit"),v),I(v,x("p2p-circuit")),I(x("p2p-circuit"),v),I(w,x("p2p-circuit")),I(x("p2p-circuit"),w),x("p2p-circuit")),A=()=>T(I(E,A),E),S=A(),_=T(I(S,v,S),I(v,S),I(S,v),S,v),C=_;function k(e){return function(t){let r;try{r=(0,n.HM)(t)}catch(e){return!1}const s=e(r.protoNames());return null!==s&&(!0===s||!1===s?s:0===s.length)}}function I(...e){function t(t){if(t.length<e.length)return null;let r=t;return e.some((e=>(r="function"==typeof e?e().partialMatch(t):e.partialMatch(t),Array.isArray(r)&&(t=r),null===r))),r}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:k(t),partialMatch:t}}function T(...e){function t(t){let r=null;return e.some((e=>{const n="function"==typeof e?e().partialMatch(t):e.partialMatch(t);return null!=n&&(r=n,!0)})),r}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:k(t),partialMatch:t}}function x(e){const t=e;return{toString:function(){return t},matches:function(e){let r;try{r=(0,n.HM)(e)}catch(e){return!1}const s=r.protoNames();return 1===s.length&&s[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}},45182:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var n=r(94306);const s=(e,t)=>t,i={ip4:s,ip6:(e,t,r,n)=>1===n.length&&"ip6"===n[0].protocol?t:`[${t}]`,tcp:(e,t,r,n,s)=>n.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:((e,t,r,n)=>{if(null!=n&&!1===n.assumeHttp)return`tcp://${e}:${t}`;let s="tcp",i=`:${t}`;return"tcp"===r[r.length-1].protocol&&(s="443"===t?"https":"http",i="443"===t||"80"===t?"":i),`${s}://${e}${i}`})(e,t,n,s),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:s,dns4:s,dns6:s,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};function o(e,t){const r=(0,n.HM)(e),s=r.toString().split("/").slice(1);return r.tuples().map((e=>({protocol:s.shift()??"",content:null!=e[1]?s.shift()??"":""}))).reduce(((e,r,n,s)=>{const o=i[r.protocol];if(null==o)throw new Error(`Unsupported protocol ${r.protocol}`);return o(e,r.content,n,s,t)}),"")}},94306:(e,t,r)=>{"use strict";r.d(t,{uv:()=>$t,h2:()=>Kt,K9:()=>qt,HM:()=>Gt,a_:()=>ct.Ev,s_:()=>jt});var n={};r.r(n),r.d(n,{identity:()=>D});var s={};r.r(s),r.d(s,{base2:()=>O});var i={};r.r(i),r.d(i,{base8:()=>N});var o={};r.r(o),r.d(o,{base10:()=>L});var a={};r.r(a),r.d(a,{base16:()=>U,base16upper:()=>B});var c={};r.r(c),r.d(c,{base32:()=>M,base32hex:()=>F,base32hexpad:()=>q,base32hexpadupper:()=>K,base32hexupper:()=>$,base32pad:()=>z,base32padupper:()=>j,base32upper:()=>V,base32z:()=>H});var h={};r.r(h),r.d(h,{base36:()=>G,base36upper:()=>W});var l={};r.r(l),r.d(l,{base58btc:()=>J,base58flickr:()=>Y});var u={};r.r(u),r.d(u,{base64:()=>Q,base64pad:()=>Z,base64url:()=>X,base64urlpad:()=>ee});var d={};r.r(d),r.d(d,{base256emoji:()=>se});var f={};r.r(f),r.d(f,{sha256:()=>Ie,sha512:()=>Te});var p={};r.r(p),r.d(p,{identity:()=>Re});var y={};r.r(y),r.d(y,{code:()=>De,decode:()=>Ne,encode:()=>Oe,name:()=>Pe});var g={};r.r(g),r.d(g,{code:()=>Me,decode:()=>ze,encode:()=>Ve,name:()=>Be});const b=new class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,r=e();return void 0===r&&(this.index=t),r}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,r){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return r()}))}readNumber(e,t,r,n){return this.readAtomically((()=>{let s=0,i=0;const o=this.peekChar();if(void 0===o)return;const a="0"===o,c=2**(8*n)-1;for(;;){const r=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const r=Number.parseInt(t,e);return Number.isNaN(r)?void 0:r}));if(void 0===r)break;if(s*=e,s+=r,s>c)return;if(i+=1,void 0!==t&&i>t)return}return 0===i||!r&&a&&i>1?void 0:s}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const r=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===r)return;e[t]=r}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const r=2*t;if(t<e.length-3){const n=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==n)return e[r]=n[0],e[r+1]=n[1],e[r+2]=n[2],e[r+3]=n[3],[r+4,!0]}const n=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===n)return[r,!1];e[r]=n>>8,e[r+1]=255&n}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[r,n]=e(t);if(16===r)return t;if(n)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const s=new Uint8Array(14),i=16-(r+2),[o]=e(s.subarray(0,i));return t.set(s.subarray(0,o),16-o),t}))}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};function m(e){return Boolean(function(e){if(!(e.length>15))return b.new(e).parseWith((()=>b.readIPv4Addr()))}(e))}function w(e){return Boolean(function(e){if(!(e.length>45))return b.new(e).parseWith((()=>b.readIPv6Addr()))}(e))}function v(e){return Boolean(function(e){if(!(e.length>45))return b.new(e).parseWith((()=>b.readIPAddr()))}(e))}var E=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const A=E,S=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class _{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class C{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return I(this,e)}}class k{constructor(e){this.decoders=e}or(e){return I(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const I=(e,t)=>new k({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class T{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new _(e,t,r),this.decoder=new C(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const x=({name:e,prefix:t,encode:r,decode:n})=>new T(e,t,r,n),R=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=A(r,t);return x({prefix:e,name:t,encode:n,decode:e=>S(s(e))})},P=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>x({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),D=x({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),O=P({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),N=P({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),L=R({prefix:"9",name:"base10",alphabet:"0123456789"}),U=P({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),B=P({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),M=P({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),V=P({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),z=P({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),j=P({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),F=P({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$=P({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),q=P({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),K=P({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),H=P({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),G=R({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),W=R({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),J=R({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Y=R({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Q=P({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Z=P({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),X=P({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ee=P({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),te=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),re=te.reduce(((e,t,r)=>(e[r]=t,e)),[]),ne=te.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const se=x({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=re[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ne[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var ie=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=oe;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},oe=Math.pow(2,31);var ae=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var ce=Math.pow(2,7),he=Math.pow(2,14),le=Math.pow(2,21),ue=Math.pow(2,28),de=Math.pow(2,35),fe=Math.pow(2,42),pe=Math.pow(2,49),ye=Math.pow(2,56),ge=Math.pow(2,63);const be={encode:ie,decode:ae,encodingLength:function(e){return e<ce?1:e<he?2:e<le?3:e<ue?4:e<de?5:e<fe?6:e<pe?7:e<ye?8:e<ge?9:10}},me=(e,t=0)=>[be.decode(e,t),be.decode.bytes],we=(e,t,r=0)=>(be.encode(e,t,r),t),ve=e=>be.encodingLength(e),Ee=(e,t)=>{const r=t.byteLength,n=ve(e),s=n+ve(r),i=new Uint8Array(s+r);return we(e,i,0),we(r,i,n),i.set(t,s),new Se(e,r,t,i)},Ae=e=>{const t=S(e),[r,n]=me(t),[s,i]=me(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Se(r,s,o,t)};class Se{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const _e=({name:e,code:t,encode:r})=>new Ce(e,t,r);class Ce{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ee(this.code,t):t.then((e=>Ee(this.code,e)))}throw Error("Unknown type, must be binary type")}}const ke=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ie=_e({name:"sha2-256",code:18,encode:ke("SHA-256")}),Te=_e({name:"sha2-512",code:19,encode:ke("SHA-512")}),xe=S,Re={code:0,name:"identity",encode:xe,digest:e=>Ee(0,xe(e))},Pe="raw",De=85,Oe=e=>S(e),Ne=e=>S(e),Le=new TextEncoder,Ue=new TextDecoder,Be="json",Me=512,Ve=e=>Le.encode(JSON.stringify(e)),ze=e=>JSON.parse(Ue.decode(e)),je=new WeakMap,Fe=e=>{const t=je.get(e);if(null==t){const t=new Map;return je.set(e,t),t}return t};class $e{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Ge)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==We)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return $e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Ee(e,t);return $e.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return $e.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?Ke(r,Fe(e),t||J.encoder):He(r,Fe(e),t||M.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof $e)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new $e(e,r,n,s||Je(e,r,n.bytes))}if(!0===t[Ye]){const{version:e,multihash:r,code:n}=t,s=Ae(r);return $e.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ge)throw new Error(`Version 0 CID must use dag-pb (code: ${Ge}) block encoding`);return new $e(e,t,r,r.bytes);case 1:{const n=Je(e,t,r.bytes);return new $e(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return $e.create(0,Ge,e)}static createV1(e,t){return $e.create(1,e,t)}static decode(e){const[t,r]=$e.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=$e.inspectBytes(e),r=t.size-t.multihashSize,n=S(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Se(t.multihashCode,t.digestSize,s,n);return[0===t.version?$e.createV0(i):$e.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=me(e.subarray(t));return t+=n,r};let n=r(),s=Ge;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=qe(e,t),s=$e.decode(n);return Fe(s).set(r,e),s}}const qe=(e,t)=>{switch(e[0]){case"Q":{const r=t||J;return[J.prefix,r.decode(`${J.prefix}${e}`)]}case J.prefix:{const r=t||J;return[J.prefix,r.decode(e)]}case M.prefix:{const r=t||M;return[M.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Ke=(e,t,r)=>{const{prefix:n}=r;if(n!==J.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},He=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},Ge=112,We=18,Je=(e,t,r)=>{const n=ve(e),s=n+ve(t),i=new Uint8Array(s+r.byteLength);return we(e,i,0),we(t,i,n),i.set(r,s),i},Ye=Symbol.for("@ipld/js-cid/CID"),Qe={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Ze(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Xe(e=0){return null!=globalThis.Buffer?.allocUnsafe?Ze(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function et(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const tt=et("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),rt=et("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Xe((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),nt={utf8:tt,"utf-8":tt,hex:Qe.base16,latin1:rt,ascii:rt,binary:rt,...Qe};function st(e,t="utf8"){const r=nt[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const it=m,ot=w,at=function(e){let t=0;if(e=e.toString().trim(),it(e)){const r=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{r[t++]=255&parseInt(e,10)})),r}if(ot(e)){const r=e.split(":",8);let n;for(n=0;n<r.length;n++){let e;it(r[n])&&(e=at(r[n]),r[n]=st(e.slice(0,2),"base16")),null!=e&&++n<8&&r.splice(n,0,st(e.slice(2,4),"base16"))}if(""===r[0])for(;r.length<8;)r.unshift("0");else if(""===r[r.length-1])for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&""!==r[n];n++);const e=[n,1];for(n=9-r.length;n>0;n--)e.push("0");r.splice.apply(r,e)}const s=new Uint8Array(t+16);for(n=0;n<r.length;n++){const e=parseInt(r[n],16);s[t++]=e>>8&255,s[t++]=255&e}return s}throw new Error("invalid ip address")};var ct=r(20030),ht=r(94676);function lt(e,t="utf8"){const r=nt[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ze(globalThis.Buffer.from(e,"utf-8"))}function ut(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=Xe(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Ze(r)}function dt(e,t){switch((0,ct.Ev)(e).code){case 4:case 41:return function(e){const t=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(4===r){const n=[];for(let s=0;s<r;s++)n.push(e[t+s]);return n.join(".")}if(16===r){const e=[];for(let s=0;s<r;s+=2)e.push(n.getUint16(t+s).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""}(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!v(t))throw new Error("invalid ip address");return t}(t);case 6:case 273:case 33:case 132:return mt(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return function(e){const t=ht.decode(e);if((e=e.slice(ht.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return st(e)}(t);case 421:return function(e){const t=ht.decode(e),r=e.slice(ht.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return st(r,"base58btc")}(t);case 444:case 445:return wt(t);case 466:return function(e){const t=ht.decode(e),r=e.slice(ht.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+st(r,"base64url")}(t);default:return st(t,"base16")}}function ft(e,t){switch((0,ct.Ev)(e).code){case 4:case 41:return gt(t);case 6:case 273:case 33:case 132:return bt(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return function(e){const t=lt(e),r=Uint8Array.from(ht.encode(t.length));return ut([r,t],r.length+t.length)}(t);case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?Ae(J.decode(`z${e}`)).bytes:$e.parse(e).multihash.bytes;const r=Uint8Array.from(ht.encode(t.length));return ut([r,t],r.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=M.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=bt(n);return ut([r,s],r.length+s.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=M.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=bt(n);return ut([r,s],r.length+s.length)}(t);case 466:return function(e){const t=yt.decode(e),r=Uint8Array.from(ht.encode(t.length));return ut([r,t],r.length+t.length)}(t);default:return lt(t,"base16")}}const pt=Object.values(Qe).map((e=>e.decoder)),yt=function(){let e=pt[0].or(pt[1]);return pt.slice(2).forEach((t=>e=e.or(t))),e}();function gt(e){if(!v(e))throw new Error("invalid ip address");return at(e)}function bt(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function mt(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function wt(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2);return`${st(t,"base32")}:${mt(r)}`}function vt(e){return e.map((e=>{const t=Rt(e);return null!=e[1]?[t.code,dt(t.code,e[1])]:[t.code]}))}function Et(e){return kt(ut(e.map((e=>{const t=Rt(e);let r=Uint8Array.from(ht.encode(t.code));return e.length>1&&null!=e[1]&&(r=ut([r,e[1]])),r}))))}function At(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return ht.decode(t)+ht.decode.bytes}function St(e){const t=[];let r=0;for(;r<e.length;){const n=ht.decode(e,r),s=ht.decode.bytes,i=At((0,ct.Ev)(n),e.slice(r+s));if(0===i){t.push([n]),r+=s;continue}const o=e.slice(r+s,r+s+i);if(r+=i+s,r>e.length)throw xt("Invalid address Uint8Array: "+st(e,"base16"));t.push([n,o])}return t}function _t(e){return function(e){const t=[];return e.map((e=>{const r=Rt(e);return t.push(r.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),Tt(t.join("/"))}(vt(St(e)))}function Ct(e){const t=function(e){const t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(let n=0;n<r.length;n++){const s=r[n],i=(0,ct.Ev)(s);if(0!==i.size){if(n++,n>=r.length)throw xt("invalid address: "+e);if(!0===i.path){t.push([s,Tt(r.slice(n).join("/"))]);break}t.push([s,r[n]])}else t.push([s])}return t}(e=Tt(e));return Et(t.map((e=>{Array.isArray(e)||(e=[e]);const t=Rt(e);return e.length>1?[t.code,ft(t.code,e[1])]:[t.code]})))}function kt(e){const t=It(e);if(null!=t)throw t;return Uint8Array.from(e)}function It(e){try{St(e)}catch(e){return e}}function Tt(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function xt(e){return new Error("Error parsing address: "+e)}function Rt(e){return(0,ct.Ev)(e[0])}var Pt=r(32114);var Dt,Ot,Nt,Lt,Ut=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Bt=function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r};const Mt=Symbol.for("nodejs.util.inspect.custom"),Vt=[(0,ct.Ev)("dns").code,(0,ct.Ev)("dns4").code,(0,ct.Ev)("dns6").code,(0,ct.Ev)("dnsaddr").code],zt=[(0,ct.Ev)("p2p").code,(0,ct.Ev)("ipfs").code],jt=new Map,Ft=Symbol.for("@multiformats/js-multiaddr/multiaddr");function $t(e,t){if(null==e)throw new Error("requires node address object");if(null==t)throw new Error("requires transport protocol");let r;switch(e.family){case 4:r="ip4";break;case 6:r="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new Ht("/"+[r,e.address,t,e.port].join("/"))}function qt(e){return!!Kt(e)&&e.protos().some((e=>e.resolvable))}function Kt(e){return Boolean(e?.[Ft])}class Ht{constructor(e){if(Dt.set(this,void 0),Ot.set(this,void 0),Nt.set(this,void 0),this[Lt]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=kt(e);else if("string"==typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Ct(e)}else{if(!Kt(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=kt(e.bytes)}}toString(){return null==Ut(this,Dt,"f")&&Bt(this,Dt,_t(this.bytes),"f"),Ut(this,Dt,"f")}toJSON(){return this.toString()}toOptions(){const e=this.protoCodes(),t=this.toString().split("/").slice(1);let r,n;if(t.length>2)Vt.includes(e[0])&&zt.includes(e[1])?(r=(0,ct.Ev)("tcp").name,n=443):(r=(0,ct.Ev)(t[2]).name,n=parseInt(t[3]));else{if(!Vt.includes(e[0]))throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');r=(0,ct.Ev)("tcp").name,n=443}return{family:41===e[0]||55===e[0]?6:4,host:t[1],transport:r,port:n}}protos(){return this.protoCodes().map((e=>Object.assign({},(0,ct.Ev)(e))))}protoCodes(){const e=[],t=this.bytes;let r=0;for(;r<t.length;){const n=ht.decode(t,r),s=ht.decode.bytes;r+=At((0,ct.Ev)(n),t.slice(r+s))+s,e.push(n)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==Ut(this,Ot,"f")&&Bt(this,Ot,St(this.bytes),"f"),Ut(this,Ot,"f")}stringTuples(){return null==Ut(this,Nt,"f")&&Bt(this,Nt,vt(this.tuples()),"f"),Ut(this,Nt,"f")}encapsulate(e){return e=new Ht(e),new Ht(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),r=this.toString(),n=r.lastIndexOf(t);if(n<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Ht(r.slice(0,n))}decapsulateCode(e){const t=this.tuples();for(let r=t.length-1;r>=0;r--)if(t[r][0]===e)return new Ht(Et(t.slice(0,r)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===ct.R5.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?st(J.decode(`z${e}`),"base58btc"):st($e.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>!0===(0,ct.Ev)(e[0]).path))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const r=jt.get(t.name);if(null==r)throw Pt(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this,e)).map((e=>new Ht(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(Dt=new WeakMap,Ot=new WeakMap,Nt=new WeakMap,Lt=Ft,Mt)](){return this.inspect()}inspect(){return"<Multiaddr "+st(this.bytes,"base16")+" - "+_t(this.bytes)+">"}}function Gt(e){return new Ht(e)}},20030:(e,t,r)=>{"use strict";r.d(t,{Ev:()=>o,R5:()=>s});const n=-1,s={},i={};function o(e){if("number"==typeof e){if(null!=i[e])return i[e];throw new Error(`no protocol with code: ${e}`)}if("string"==typeof e){if(null!=s[e])return s[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,n,"ip6zone"],[53,n,"dns",!0],[54,n,"dns4",!0],[55,n,"dns6",!0],[56,n,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,n,"unix",!1,!0],[421,n,"ipfs"],[421,n,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,n,"garlic64"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,n,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,n,"memory"]].forEach((e=>{const t=function(e,t,r,n,s){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(s)}}(...e);i[t.code]=t,s[t.name]=t}))},34097:(e,t,r)=>{"use strict";r.d(t,{Pv:()=>L});const n=new Uint8Array(0),s=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):n};var i=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=o;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},o=Math.pow(2,31);var a=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var c=Math.pow(2,7),h=Math.pow(2,14),l=Math.pow(2,21),u=Math.pow(2,28),d=Math.pow(2,35),f=Math.pow(2,42),p=Math.pow(2,49),y=Math.pow(2,56),g=Math.pow(2,63);const b={encode:i,decode:a,encodingLength:function(e){return e<c?1:e<h?2:e<l?3:e<u?4:e<d?5:e<f?6:e<p?7:e<y?8:e<g?9:10}},m=(e,t,r=0)=>(b.encode(e,t,r),t),w=e=>b.encodingLength(e),v=(e,t)=>{const r=t.byteLength,n=w(e),s=n+w(r),i=new Uint8Array(s+r);return m(e,i,0),m(r,i,n),i.set(t,s),new E(e,r,t,i)};class E{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const A=({name:e,code:t,encode:r})=>new S(e,t,r);class S{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?v(this.code,t):t.then((e=>v(this.code,e)))}throw Error("Unknown type, must be binary type")}}const _=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class C{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class k{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return T(this,e)}}class I{constructor(e){this.decoders=e}or(e){return T(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const T=(e,t)=>new I({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class x{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new C(e,t,r),this.decoder=new k(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const R=({name:e,prefix:t,encode:r,decode:n})=>new x(e,t,r,n),P=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=_(r,t);return R({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(s(e))})},D=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>R({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)});P({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),P({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),D({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),D({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),D({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),D({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),D({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),D({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),D({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),D({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap;class O{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return O.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return O.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return O.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof O)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new O(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return O.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new O(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new O(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return O.create(0,DAG_PB_CODE,e)}static createV1(e,t){return O.create(1,e,t)}static decode(e){const[t,r]=O.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=O.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?O.createV0(i):O.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=O.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");var N=r(40469);A({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(N.x86.hash32(e))});const L=A({name:"murmur3-128",code:34,encode:e=>s(N.x64.hash128(e))});A({name:"murmur3-x64-64",code:34,encode:e=>s(N.x64.hash128(e)).subarray(0,8)})},27760:(e,t,r)=>{"use strict";var n;r.d(t,{$3:()=>W,E9:()=>g,P6:()=>ie,T:()=>re,Xx:()=>ee});var s=r(95856);const i=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(3),h=BigInt(8),l=Object.freeze({a:i,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:o,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function u(e){const{a:t,b:r}=l,n=D(e*e),s=D(n*e);return D(s+t*e+r)}const d=l.a===i;class f extends Error{constructor(e){super(e)}}class p{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof g))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new p(e.x,e.y,o)}static toAffineBatch(e){const t=function(e,t=l.P){const r=new Array(e.length),n=N(e.reduce(((e,n,s)=>n===i?e:(r[s]=e,D(e*n,t))),o),t);return e.reduceRight(((e,n,s)=>n===i?e:(r[s]=D(e*r[s],t),D(e*n,t))),n),r}(e.map((e=>e.z)));return e.map(((e,r)=>e.toAffine(t[r])))}static normalizeZ(e){return p.toAffineBatch(e).map(p.fromAffine)}equals(e){if(!(e instanceof p))throw new TypeError("JacobianPoint expected");const{x:t,y:r,z:n}=this,{x:s,y:i,z:o}=e,a=D(n*n),c=D(o*o),h=D(t*c),l=D(s*a),u=D(D(r*o)*c),d=D(D(i*n)*a);return h===l&&u===d}negate(){return new p(this.x,D(-this.y),this.z)}double(){const{x:e,y:t,z:r}=this,n=D(e*e),s=D(t*t),i=D(s*s),o=e+s,l=D(a*(D(o*o)-n-i)),u=D(c*n),d=D(u*u),f=D(d-a*l),y=D(u*(l-f)-h*i),g=D(a*t*r);return new p(f,y,g)}add(e){if(!(e instanceof p))throw new TypeError("JacobianPoint expected");const{x:t,y:r,z:n}=this,{x:s,y:o,z:c}=e;if(s===i||o===i)return this;if(t===i||r===i)return e;const h=D(n*n),l=D(c*c),u=D(t*l),d=D(s*h),f=D(D(r*c)*l),y=D(D(o*n)*h),g=D(d-u),b=D(y-f);if(g===i)return b===i?this.double():p.ZERO;const m=D(g*g),w=D(g*m),v=D(u*m),E=D(b*b-w-a*v),A=D(b*(v-E)-f*w),S=D(n*c*g);return new p(E,A,S)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=p.ZERO;if("bigint"==typeof e&&e===i)return t;let r=P(e);if(r===o)return this;if(!d){let e=t,n=this;for(;r>i;)r&o&&(e=e.add(n)),n=n.double(),r>>=o;return e}let{k1neg:n,k1:s,k2neg:a,k2:c}=B(r),h=t,u=t,f=this;for(;s>i||c>i;)s&o&&(h=h.add(f)),c&o&&(u=u.add(f)),f=f.double(),s>>=o,c>>=o;return n&&(h=h.negate()),a&&(u=u.negate()),u=new p(D(u.x*l.beta),u.y,u.z),h.add(u)}precomputeWindow(e){const t=d?128/e+1:256/e+1,r=[];let n=this,s=n;for(let i=0;i<t;i++){s=n,r.push(s);for(let t=1;t<2**(e-1);t++)s=s.add(n),r.push(s);n=s.double()}return r}wNAF(e,t){!t&&this.equals(p.BASE)&&(t=g.BASE);const r=t&&t._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let n=t&&y.get(t);n||(n=this.precomputeWindow(r),t&&1!==r&&(n=p.normalizeZ(n),y.set(t,n)));let s=p.ZERO,i=p.ZERO;const a=1+(d?128/r:256/r),c=2**(r-1),h=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let t=0;t<a;t++){const r=t*c;let a=Number(e&h);if(e>>=u,a>c&&(a-=l,e+=o),0===a){let e=n[r];t%2&&(e=e.negate()),i=i.add(e)}else{let e=n[r+Math.abs(a)-1];a<0&&(e=e.negate()),s=s.add(e)}}return{p:s,f:i}}multiply(e,t){let r,n,s=P(e);if(d){const{k1neg:e,k1:i,k2neg:o,k2:a}=B(s);let{p:c,f:h}=this.wNAF(i,t),{p:u,f:d}=this.wNAF(a,t);e&&(c=c.negate()),o&&(u=u.negate()),u=new p(D(u.x*l.beta),u.y,u.z),r=c.add(u),n=h.add(d)}else{const{p:e,f:i}=this.wNAF(s,t);r=e,n=i}return p.normalizeZ([r,n])[0]}toAffine(e=N(this.z)){const{x:t,y:r,z:n}=this,s=e,i=D(s*s),a=D(i*s),c=D(t*i),h=D(r*a);if(D(n*s)!==o)throw new Error("invZ was invalid");return new g(c,h)}}p.BASE=new p(l.Gx,l.Gy,o),p.ZERO=new p(i,o,i);const y=new WeakMap;class g{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,y.delete(this)}hasEvenY(){return this.y%a===i}static fromCompressedHex(e){const t=32===e.length,r=x(t?e:e.subarray(1));if(!$(r))throw new Error("Point is not on curve");let n=function(e){const{P:t}=l,r=BigInt(6),n=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),h=BigInt(88),u=e*e*e%t,d=u*u*e%t,f=O(d,c)*d%t,p=O(f,c)*d%t,y=O(p,a)*u%t,g=O(y,n)*y%t,b=O(g,s)*g%t,m=O(b,o)*b%t,w=O(m,h)*m%t,v=O(w,o)*b%t,E=O(v,c)*d%t,A=O(E,i)*g%t,S=O(A,r)*u%t;return O(S,a)}(u(r));const s=(n&o)===o;if(t)s&&(n=D(-n));else{1==(1&e[0])!==s&&(n=D(-n))}const i=new g(r,n);return i.assertValidity(),i}static fromUncompressedHex(e){const t=x(e.subarray(1,33)),r=x(e.subarray(33,65)),n=new g(t,r);return n.assertValidity(),n}static fromHex(e){const t=R(e),r=t.length,n=t[0];if(32===r||33===r&&(2===n||3===n))return this.fromCompressedHex(t);if(65===r&&4===n)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return g.BASE.multiply(K(e))}static fromSignature(e,t,r){const n=M(e=R(e)),{r:s,s:i}=G(t);if(0!==r&&1!==r)throw new Error("Cannot recover signature: invalid recovery bit");const o=1&r?"03":"02",a=g.fromHex(o+_(s)),{n:c}=l,h=N(s,c),u=D(-n*h,c),d=D(i*h,c),f=g.BASE.multiplyAndAddUnsafe(a,u,d);if(!f)throw new Error("Cannot recover signature: point at infinify");return f.assertValidity(),f}toRawBytes(e=!1){return T(this.toHex(e))}toHex(e=!1){const t=_(this.x);if(e){return`${this.hasEvenY()?"02":"03"}${t}`}return`04${t}${_(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:r}=this;if(!$(t)||!$(r))throw new Error(e);const n=D(r*r);if(D(n-u(t))!==i)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new g(this.x,D(-this.y))}double(){return p.fromAffine(this).double().toAffine()}add(e){return p.fromAffine(this).add(p.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return p.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){const n=p.fromAffine(this),s=t===i||t===o||this!==g.BASE?n.multiplyUnsafe(t):n.multiply(t),a=p.fromAffine(e).multiplyUnsafe(r),c=s.add(a);return c.equals(p.ZERO)?void 0:c.toAffine()}}function b(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function m(e){if(e.length<2||2!==e[0])throw new Error(`Invalid signature integer tag: ${A(e)}`);const t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:x(r),left:e.subarray(t+2)}}g.BASE=new g(l.Gx,l.Gy),g.ZERO=new g(i,i);class w{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,r="Signature.fromCompact";if("string"!=typeof e&&!t)throw new TypeError(`${r}: Expected string or Uint8Array`);const n=t?A(e):e;if(128!==n.length)throw new Error(`${r}: Expected 64-byte hex`);return new w(I(n.slice(0,64)),I(n.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if("string"!=typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r,s:n}=function(e){if(e.length<2||48!=e[0])throw new Error(`Invalid signature tag: ${A(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:r}=m(e.subarray(2)),{data:n,left:s}=m(r);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${A(s)}`);return{r:t,s:n}}(t?e:T(e));return new w(r,n)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!F(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!F(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=l.n>>o;return this.s>e}normalizeS(){return this.hasHighS()?new w(this.r,l.n-this.s):this}toDERRawBytes(e=!1){return T(this.toDERHex(e))}toDERHex(e=!1){const t=b(k(this.s));if(e)return t;const r=b(k(this.r)),n=k(r.length/2),s=k(t.length/2);return`30${k(r.length/2+t.length/2+4)}02${n}${r}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return T(this.toCompactHex())}toCompactHex(){return _(this.r)+_(this.s)}}function v(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const s=e[t];r.set(s,n),n+=s.length}return r}const E=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function A(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=E[e[r]];return t}const S=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function _(e){if("bigint"!=typeof e)throw new Error("Expected bigint");if(!(i<=e&&e<S))throw new Error("Expected number < 2^256");return e.toString(16).padStart(64,"0")}function C(e){const t=T(_(e));if(32!==t.length)throw new Error("Error: expected 32 bytes");return t}function k(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function I(e){if("string"!=typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function T(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r,s=e.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[r]=i}return t}function x(e){return I(A(e))}function R(e){return e instanceof Uint8Array?Uint8Array.from(e):T(e)}function P(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==typeof e&&F(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function D(e,t=l.P){const r=e%t;return r>=i?r:t+r}function O(e,t){const{P:r}=l;let n=e;for(;t-- >i;)n*=n,n%=r;return n}function N(e,t=l.P){if(e===i||t<=i)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=D(e,t),n=t,s=i,a=o,c=o,h=i;for(;r!==i;){const e=n/r,t=n%r,i=s-c*e,o=a-h*e;n=r,r=t,s=c,a=h,c=i,h=o}if(n!==o)throw new Error("invert: does not exist");return D(s,t)}const L=(e,t)=>(e+t/a)/t,U={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-o*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function B(e){const{n:t}=l,{a1:r,b1:n,a2:s,b2:i,POW_2_128:o}=U,a=L(i*e,t),c=L(-n*e,t);let h=D(e-a*r-c*s,t),u=D(-a*n-c*i,t);const d=h>o,f=u>o;if(d&&(h=t-h),f&&(u=t-u),h>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:d,k1:h,k2neg:f,k2:u}}function M(e){const{n:t}=l,r=8*e.length-256;let n=x(e);return r>0&&(n>>=BigInt(r)),n>=t&&(n-=t),n}let V,z;class j{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return ie.hmacSha256(this.k,...e)}hmacSync(...e){return z(this.k,...e)}checkSync(){if("function"!=typeof z)throw new f("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),0!==e.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}}function F(e){return i<e&&e<l.n}function $(e){return i<e&&e<l.P}function q(e,t,r){const n=x(e);if(!F(n))return;const{n:s}=l,a=g.BASE.multiply(n),c=D(a.x,s);if(c===i)return;const h=D(N(n,s)*D(t+r*c,s),s);if(h===i)return;const u=new w(c,h);return{sig:u,recovery:(a.x===u.r?0:2)|Number(a.y&o)}}function K(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw new Error("Expected 32 bytes of private key");t=I(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(32!==e.length)throw new Error("Expected 32 bytes of private key");t=x(e)}if(!F(t))throw new Error("Expected private key: 0 < key < n");return t}function H(e){return e instanceof g?(e.assertValidity(),e):g.fromHex(e)}function G(e){if(e instanceof w)return e.assertValidity(),e;try{return w.fromDER(e)}catch(t){return w.fromCompact(e)}}function W(e,t=!1){return g.fromPrivateKey(e).toRawBytes(t)}function J(e){return x(e.length>32?e.slice(0,32):e)}function Y(e){const t=J(e),r=D(t,l.n);return Q(r<i?t:r)}function Q(e){return C(e)}function Z(e,t,r){if(null==e)throw new Error(`sign: expected valid message hash, not "${e}"`);const n=R(e),s=K(t),i=[Q(s),Y(n)];if(null!=r){!0===r&&(r=ie.randomBytes(32));const e=R(r);if(32!==e.length)throw new Error("sign: Expected 32 bytes of extra data");i.push(e)}return{seed:v(...i),m:J(n),d:s}}function X(e,t){let{sig:r,recovery:n}=e;const{canonical:s,der:i,recovered:o}=Object.assign({canonical:!0,der:!0},t);s&&r.hasHighS()&&(r=r.normalizeS(),n^=1);const a=i?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function ee(e,t,r={}){const{seed:n,m:s,d:i}=Z(e,t,r.extraEntropy);let o;const a=new j;for(await a.reseed(n);!(o=q(await a.generate(),s,i));)await a.reseed();return X(o,r)}const te={strict:!0};function re(e,t,r,n=te){let s;try{s=G(e),t=R(t)}catch(e){return!1}const{r:i,s:o}=s;if(n.strict&&s.hasHighS())return!1;const a=M(t);let c;try{c=H(r)}catch(e){return!1}const{n:h}=l,u=N(o,h),d=D(a*u,h),f=D(i*u,h),p=g.BASE.multiplyAndAddUnsafe(c,d,f);if(!p)return!1;return D(p.x,h)===i}g.BASE._setWindowSize(8);const ne={node:n||(n=r.t(s,2)),web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},se={},ie={bytesToHex:A,hexToBytes:T,concatBytes:v,mod:D,invert:N,isValidPrivateKey(e){try{return K(e),!0}catch(e){return!1}},_bigintTo32Bytes:C,_normalizePrivateKey:K,hashToPrivateKey:e=>{if((e=R(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return C(D(x(e),l.n-o)+o)},randomBytes:(e=32)=>{if(ne.web)return ne.web.getRandomValues(new Uint8Array(e));if(ne.node){const{randomBytes:t}=ne.node;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ie.hashToPrivateKey(ie.randomBytes(40)),sha256:async(...e)=>{if(ne.web){const t=await ne.web.subtle.digest("SHA-256",v(...e));return new Uint8Array(t)}if(ne.node){const{createHash:t}=ne.node,r=t("sha256");return e.forEach((e=>r.update(e))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(ne.web){const r=await ne.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=v(...t),s=await ne.web.subtle.sign("HMAC",r,n);return new Uint8Array(s)}if(ne.node){const{createHmac:r}=ne.node,n=r("sha256",e);return t.forEach((e=>n.update(e))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=se[e];if(void 0===r){const t=await ie.sha256(Uint8Array.from(e,(e=>e.charCodeAt(0))));r=v(t,t),se[e]=r}return ie.sha256(r,...t)},taggedHashSync:(e,...t)=>{if("function"!=typeof V)throw new f("sha256Sync is undefined, you need to set it");let r=se[e];if(void 0===r){const t=V(Uint8Array.from(e,(e=>e.charCodeAt(0))));r=v(t,t),se[e]=r}return V(r,...t)},precompute(e=8,t=g.BASE){const r=t===g.BASE?t:new g(t.x,t.y);return r._setWindowSize(e),r.multiply(c),r}};Object.defineProperties(ie,{sha256Sync:{configurable:!1,get:()=>V,set(e){V||(V=e)}},hmacSha256Sync:{configurable:!1,get:()=>z,set(e){z||(z=e)}}})},73861:(e,t,r)=>{"use strict";r.d(t,{_L:()=>n,D7:()=>o,wJ:()=>s});class n extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function s(e,t,r){const s=r??{},i=function(e){if(null!=e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);return async function*(){let r;const o=()=>{null!=r&&r()};for(t.addEventListener("abort",o);;){let a;try{if(t.aborted){const{abortMessage:e,abortCode:t}=s;throw new n(e,t)}const e=new Promise(((e,t)=>{r=()=>{const{abortMessage:e,abortCode:r}=s;t(new n(e,r))}}));a=await Promise.race([e,i.next()]),r=null}catch(r){t.removeEventListener("abort",o);const n="aborted"===r.type&&t.aborted;if(n&&null!=s.onAbort&&await s.onAbort(e),"function"==typeof i.return)try{const e=i.return();e instanceof Promise&&e.catch((e=>{null!=s.onReturnError&&s.onReturnError(e)}))}catch(e){null!=s.onReturnError&&s.onReturnError(e)}if(n&&!0===s.returnOnAbort)return;throw r}if(!0===a.done)break;yield a.value}t.removeEventListener("abort",o)}()}function i(e,t,r){return n=>e(s(n,t,r))}function o(e,t,r){return{sink:i(e.sink,t,{...r,onAbort:void 0}),source:s(e.source,t,r)}}},7688:(e,t,r)=>{"use strict";function n(e){if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);for(let t=(e=[...e]).length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}r.d(t,{Z:()=>n})},70514:(e,t,r)=>{"use strict";var n={};r.r(n),r.d(n,{destroy:()=>w,init:()=>m});var s={};r.r(s),r.d(s,{brave:()=>S,braveNodeType:()=>x,destroy:()=>C,init:()=>_,releaseBraveEndpoint:()=>D,useBraveEndpoint:()=>P});var i={};r.r(i),r.d(i,{destroy:()=>Ge,init:()=>He});var o=r(93150),a=r(11227);const c="/dist/landing-pages/welcome/index.html",h="/dist/options/options.html";class l extends Error{constructor(e){super(e),this.name="TimeoutError"}}class u extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const d=e=>void 0===globalThis.DOMException?new u(e):new DOMException(e),f=e=>{const t=void 0===e.reason?d("This operation was aborted."):e.reason;return t instanceof Error?t:d(t)};const p=Symbol("resolveValue");async function y(e,t={}){const{interval:r=20,timeout:n=Number.POSITIVE_INFINITY,before:s=!0}=t;let i;const o=new Promise(((t,n)=>{const o=async()=>{try{const n=await e();if("object"==typeof n&&n[p])t(n[p]);else{if("boolean"!=typeof n)throw new TypeError("Expected condition to return a boolean");!0===n?t():i=setTimeout(o,r)}}catch(e){n(e)}};s?o():i=setTimeout(o,r)}));if(n===Number.POSITIVE_INFINITY)return o;try{return await function(e,t){const{milliseconds:r,fallback:n,message:s,customTimers:i={setTimeout,clearTimeout}}=t;let o;const a=new Promise(((a,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r!==Number.POSITIVE_INFINITY){if(t.signal){const{signal:e}=t;e.aborted&&c(f(e)),e.addEventListener("abort",(()=>{c(f(e))}))}o=i.setTimeout.call(void 0,(()=>{if(n){try{a(n())}catch(e){c(e)}return}const t=s instanceof Error?s:new l("string"==typeof s?s:`Promise timed out after ${r} milliseconds`);"function"==typeof e.cancel&&e.cancel(),c(t)}),r),(async()=>{try{a(await e)}catch(e){c(e)}finally{i.clearTimeout.call(void 0,o)}})()}else a(e)}));return a.clear=()=>{i.clearTimeout.call(void 0,o),o=void 0},a}(o,"number"==typeof n?{milliseconds:n}:n)}finally{clearTimeout(i)}}y.resolveWith=e=>({[p]:e});var g=r(32507);const b=a("ipfs-companion:client:external");async function m(e,t){b(`init with IPFS API at ${t.apiURLString}`);const r=t.apiURLString;return await(0,g.Ue)(r)}async function w(e){b("destroy")}b.error=a("ipfs-companion:client:external:error");var v=r(95700);const E=a("ipfs-companion:client:brave");E.error=a("ipfs-companion:client:brave:error");const A=(e,t)=>y(e,{interval:250,timeout:t||1/0}),S="object"==typeof chrome&&"object"==typeof chrome.ipfs&&"function"==typeof chrome.ipfs.getIPFSEnabled&&"function"==typeof chrome.ipfs.getResolveMethodType&&"function"==typeof chrome.ipfs.launch&&"function"==typeof chrome.ipfs.shutdown&&"function"==typeof chrome.ipfs.getExecutableAvailable&&"function"==typeof chrome.ipfs.getConfig?Object.freeze({getIPFSEnabled:async()=>Boolean(await R(chrome.ipfs.getIPFSEnabled)),getResolveMethodType:async()=>String(await R(chrome.ipfs.getResolveMethodType)),getConfig:async()=>await R(chrome.ipfs.getConfig),getExecutableAvailable:async()=>Boolean(await R(chrome.ipfs.getExecutableAvailable)),launch:async()=>Boolean(await R(chrome.ipfs.launch)),shutdown:async()=>Boolean(await R(chrome.ipfs.shutdown))}):void 0;async function _(e,t){return E("ensuring Brave Settings are correct"),await async function(e,t){let r=await t.getResolveMethodType();E(`brave.resolveMethodType is '${r}'`),"ask"===r&&(await e.tabs.create({url:k}),E("waiting for user to make a decision how IPFS resources should be resolved"),await A((async()=>(r=await t.getResolveMethodType(),r&&"ask"!==r))),E(`user set resolveMethodType to '${r}'`),"local"===r&&(E("waiting while Brave downloads IPFS executable.."),await A((()=>t.getExecutableAvailable())),E("waiting while Brave creates repo and config via ipfs init.."),await A((async()=>void 0!==await t.getConfig()))));if("local"!==r)throw await e.storage.local.set({active:!1}),await N(e,k),await N(e,I),await e.tabs.create({url:T}),new Error('"Method to resolve IPFS resources" in Brave settings should be "Local node"');E("waiting while brave.launch() starts ipfs daemon.."),await A((()=>t.launch())),E("brave.launch() finished"),await P(e),setTimeout((()=>async function(e){try{const{customGatewayUrl:t}=await e.storage.local.get("customGatewayUrl");await A((async()=>{try{return await fetch(`${t}/ipfs/bafkqae2xmvwgg33nmuqhi3zajfiemuzahiwss`).then((e=>e.ok))}catch(e){return!1}})),E("[activation ui cleanup] Brave gateway is up, cleaning up");const r=e.runtime.getURL(c),n=e.runtime.getURL(h);for(const t of await e.tabs.query({}))try{t.url!==k&&t.url!==I||await e.tabs.remove(t.id),t.url===r&&(await e.tabs.reload(t.id),await e.tabs.update(t.id,{active:!0})),t.url===n&&await e.tabs.update(t.id,{active:!0})}catch(e){E.error("[activation ui cleanup] unexpected error, but safe to ignore",e);continue}E("[activation ui cleanup] done")}catch(e){E.error("[activation ui cleanup] failed to cleanup ephemeral UI tab",e)}}(e)),250)}(e,S),E('delegating API client init to "external" backend pointed at node managed by Brave'),m(0,t)}async function C(e){E("shuting down node managed by Brave");return"local"===await S.getResolveMethodType()&&(E("waiting for brave.shutdown() to finish"),await A((()=>S.shutdown())),E("brave.shutdown() done")),E('delegating API client destroy to "external" backend pointed at node managed by Brave'),w()}const k="ipfs://bafkqae2xmvwgg33nmuqhi3zajfiemuzahiwss/",I="https://bafkqae2xmvwgg33nmuqhi3zajfiemuzahiwss.ipfs.dweb.link/",T="brave://settings/extensions",x="external:brave";const R=e=>new Promise(((t,r)=>{try{e===chrome.ipfs.getConfig&&e(((e,r)=>t(e&&r?JSON.parse(r):void 0))),e((e=>t(e)))}catch(e){E.error("unexpected error during promisifyBraveCheck",e),r(e)}}));async function P(e){const t=await S.getConfig();if(void 0===t)return void E.error("useBraveEndpoint: IPFS_PATH/config is missing, unable to use endpoint from Brave at this time, will try later");const{externalNodeConfig:r,customGatewayUrl:n,ipfsApiUrl:s}=await e.storage.local.get(["customGatewayUrl","ipfsApiUrl","externalNodeConfig"]),i=O(t.Addresses.API),o=O(t.Addresses.Gateway);i!==s||o!==n?(E(`useBraveEndpoint: setting api=${i}, gw=${o} (before: api=${s}, gw=${n})`),await e.storage.local.set({ipfsApiUrl:i,customGatewayUrl:o,externalNodeConfig:r||[n,s]})):E("useBraveEndpoint: ok")}async function D(e){const[t,r]=(await e.storage.local.get("externalNodeConfig")).externalNodeConfig;E(`releaseBraveEndpoint: restoring api=${r}, gw=${t}`),await e.storage.local.set({ipfsApiUrl:r,customGatewayUrl:t,externalNodeConfig:null})}function O(e){return Array.isArray(e)&&(e=e[0]),v(e,{assumeHttp:!0})}async function N(e,t){for(const r of await e.tabs.query({}))r.url===t&&await e.tabs.remove(r.id)}const{version:L}=o.runtime.getManifest();async function U(){const{onInstallTasks:e,displayReleaseNotes:t}=await o.storage.local.get(["onInstallTasks","displayReleaseNotes"]);switch(await o.storage.local.remove("onInstallTasks"),e){case"onFirstInstall":return await async function(e){const t=a("ipfs-companion:on-installed");t.error=a("ipfs-companion:on-installed:error");const{ipfsNodeType:r,ipfsApiUrl:n}=await e.storage.local.get(["ipfsNodeType","ipfsApiUrl"]);if(void 0!==S&&r!==x)try{t(`brave detected, but node type is ${r}. testing external endpoint at ${n}`);const e=await(await fetch(`${n}/api/v0/id`,{method:"post"})).json();if(void 0===e.ID)throw new Error(`unable to read PeerID from API at ${n}`);t(`endpoint is online, PeerID is ${e.ID}, nothing to do`)}catch(r){t.error(`endpoint ${n} does not work`,r),t("switching node type to one provided by brave"),await e.storage.local.set({ipfsNodeType:x})}}(o),o.tabs.create({url:c});case"onVersionUpdate":if(!t)return;return await o.storage.local.set({dismissedUpdate:L}),o.tabs.create({url:"https://github.com/ipfs-shipyard/ipfs-companion/releases/tag/v"+L})}}const B=new Set(["ipfs-firefox-addon@lidel.org","nibjojkomfdiaoajekhjakgkdhaomnch"]);var M=r(18531);const V="[a-fA-F\\d:]",z=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${V})|(?<=${V})(?=\\s|$))`:"",j="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",F="[a-fA-F\\d]{1,4}",$=`\n(?:\n(?:${F}:){7}(?:${F}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${F}:){6}(?:${j}|:${F}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${F}:){5}(?::${j}|(?::${F}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${F}:){4}(?:(?::${F}){0,1}:${j}|(?::${F}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${F}:){3}(?:(?::${F}){0,2}:${j}|(?::${F}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${F}:){2}(?:(?::${F}){0,3}:${j}|(?::${F}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${F}:){1}(?:(?::${F}){0,4}:${j}|(?::${F}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${F}){0,5}:${j}|(?::${F}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),q=new RegExp(`(?:^${j}$)|(?:^${$}$)`),K=new RegExp(`^${j}$`),H=new RegExp(`^${$}$`),G=e=>e&&e.exact?q:new RegExp(`(?:${z(e)}${j}${z(e)})|(?:${z(e)}${$}${z(e)})`,"g");G.v4=e=>e&&e.exact?K:new RegExp(`${z(e)}${j}${z(e)}`,"g"),G.v6=e=>e&&e.exact?H:new RegExp(`${z(e)}${$}${z(e)}`,"g");const W=G;const{toString:J}=Object.prototype;const Y={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function Q(e,t={}){if(r=e,"[object RegExp]"!==J.call(r))throw new TypeError("Expected a RegExp instance");var r;const n=Object.keys(Y).map((r=>("boolean"==typeof t[r]?t[r]:e[r])?Y[r]:"")).join(""),s=new RegExp(t.source||e.source,n);return s.lastIndex="number"==typeof t.lastIndex?t.lastIndex:e.lastIndex,s}function Z(e,t,{timeout:r}={}){try{return function(e){const t=(...t)=>e(...t);return Object.defineProperty(t,"name",{value:`functionTimeout(${e.name||"<anonymous>"})`,configurable:!0}),t}((()=>Q(e).test(t)))()}catch(e){throw e}}const X={timeout:400};function ee(e){return Z(W.v6({exact:!0}),e.slice(0,45),X)}const te=Object.freeze({active:!0,ipfsNodeType:"external",ipfsNodeConfig:JSON.stringify({config:{Addresses:{Swarm:[]}}},null,2),publicGatewayUrl:"https://ipfs.io",publicSubdomainGatewayUrl:"https://dweb.link",useCustomGateway:!0,useSubdomains:!0,enabledOn:[],disabledOn:[],automaticMode:!0,linkify:!1,dnslinkPolicy:"best-effort",dnslinkDataPreload:!0,dnslinkRedirect:!0,recoverFailedHttpRequests:!0,detectIpfsPathHeader:!0,preloadAtPublicGateway:!0,catchUnhandledProtocols:!0,displayNotifications:!0,displayReleaseNotes:!1,customGatewayUrl:"http://localhost:8080",ipfsApiUrl:"http://127.0.0.1:5001",ipfsApiPollMs:3e3,logNamespaces:"jsipfs*,ipfs*,libp2p:mdns*,libp2p-delegated*,-*:ipns*,-ipfs:preload*,-ipfs-http-client:request*,-ipfs:http-api*",importDir:"/ipfs-companion-imports/%Y-%M-%D_%h%m%s/",useLatestWebUI:!1,dismissedUpdate:null,openViaWebUI:!0,telemetryGroupMinimal:!0,telemetryGroupPerformance:!1,telemetryGroupUx:!1,telemetryGroupFeedback:!1,telemetryGroupLocation:!1});function re(e,t){return t=t||{useLocalhostName:!0},"string"==typeof e&&(e=new URL(e)),"0.0.0.0"===e.hostname&&((e=new URL(e.toString())).hostname="127.0.0.1"),t.useLocalhostName&&ie(e)&&(e.hostname="localhost"),!t.useLocalhostName&&oe(e)&&(e.hostname="127.0.0.1"),e}function ne(e,t){return re(e,t).toString().replace(/\/$/,"")}function se(e){if(M(e)||(t=e,Z(W.v4({exact:!0}),t.slice(0,15),X)))return!0;var t;const r=e.match(/^\[(.*)\]$/);return null!=r&&ee(r[1])}function ie(e){return"string"==typeof e&&(e=new URL(e)),"127.0.0.1"===e.hostname||"[::1]"===e.hostname}function oe(e){return"string"==typeof e&&(e=new URL(e)),"localhost"===e.hostname.toLowerCase()}var ae=r(55746);const ce=(e,t,r,n)=>{if("length"===r||"prototype"===r)return;if("arguments"===r||"caller"===r)return;const s=Object.getOwnPropertyDescriptor(e,r),i=Object.getOwnPropertyDescriptor(t,r);!he(s,i)&&n||Object.defineProperty(e,r,i)},he=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},le=(e,t)=>`/* Wrapped ${e}*/\n${t}`,ue=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),de=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");function fe(e,t,{ignoreNonConfigurable:r=!1}={}){const{name:n}=e;for(const n of Reflect.ownKeys(t))ce(e,t,n,r);return((e,t)=>{const r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)})(e,t),((e,t,r)=>{const n=""===r?"":`with ${r.trim()}() `,s=le.bind(null,n,t.toString());Object.defineProperty(s,"name",de),Object.defineProperty(e,"toString",{...ue,value:s})})(e,t,n),e}const pe=new WeakMap;function ye(e,{cacheKey:t=(([e])=>e),cache:r=new Map}={}){const n=new Map,s=function(...s){const i=t(s);if(n.has(i))return n.get(i);const o=(async()=>{try{if(r&&await r.has(i))return await r.get(i);const t=e.apply(this,s),o=await t;try{return o}finally{r&&await r.set(i,o)}}finally{n.delete(i)}})();return n.set(i,o),o};return fe(s,e,{ignoreNonConfigurable:!0}),pe.set(s,r),s}var ge=r(39593),be=r(33686);const me=-1;var we=r(24981);const ve=3e5,Ee=e=>e.replace(/\/$/,"");function Ae(e,t){if(t=t||{},e&&e.toString().startsWith("ip")&&(e=e.replace(/^(ip[n|f]s):\/\//,"/$1/")),!we.urlOrPath(e))return null;we.path(e)&&(e=`https://localhost${e}`);let r="string"==typeof e?new URL(e):e;if(we.subdomain(e)){let{id:e,ns:t}=Se(r);e=function(e){e&&!e.includes(".")&&e.includes("-")&&!we.cid(e)&&(e=e.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));return e}(e),r=new URL(`https://localhost/${t}/${e}${r.pathname}${r.search}${r.hash}`)}const n=decodeURI(r.pathname);return we.path(n)?t.keepURIParams?`${n}${r.search}${r.hash}`:n:null}function Se(e){"string"==typeof e&&(e=new URL(e));const t=e.toString().match(we.subdomainGatewayPattern);if(!t||t.length<3)return!1;return{id:t[1],ns:t[2]}}function _e(e,t){return Ce(new URL(`${t}${e}`).toString())}function Ce(e){return e.replace(/([^:]\/)\/+/g,"$1")}function ke(e,t){if("string"==typeof e&&(e=new URL(e)),"string"==typeof t&&(t=new URL(t)),"ipfs.io"===e.hostname)return e.hostname===t.hostname;if("0.0.0.0"===e.hostname&&((e=new URL(e.toString())).hostname="127.0.0.1"),!(we.url(e.toString())||we.subdomain(e.toString())||e.pathname.startsWith("/api/v0/")||e.pathname.startsWith("/webui")))return!1;const r=[t.host];"localhost"===t.hostname&&r.push(`127.0.0.1:${t.port}`),"127.0.0.1"!==t.hostname&&"[::1]"!==t.hostname||r.push(`localhost:${t.port}`);for(const t of r)if(e.host.endsWith(t))return!0;return!1}function Ie(e,t,r){const n={publicIpfsOrIpnsResource(t){const{gwURL:r,apiURL:n}=e();return!ke(t,r)&&!ke(t,n)&&this.validIpfsOrIpns(t)},validIpfsOrIpns(e){const t=Ae(e);if(!t)return!1;if(we.ipfsPath(t))return!0;if(we.ipnsPath(t)){const e=t.match(/^\/ipns\/([^/?#]+)/)[1];if(we.cid(e))return!0;if(r.readAndCacheDnslink(e))return!0}return!1},isIpfsPageActionsContext(t){if(!t)return!1;const{apiURLString:n}=e(),{hostname:s}=new URL(t);return Boolean(t&&!t.startsWith(n)&&(!!Ae(t)||r.cachedDnslink(s)))},isRedirectPageActionsContext(t){const{localGwAvailable:r,gwURL:n,apiURL:s}=e();return r&&(we.ipnsUrl(t)||(t.startsWith("http")||t.startsWith("ip"))&&!ke(t,n)&&!ke(t,s))},resolveToPublicUrl(t){const{pubSubdomainGwURL:n,pubGwURLString:s}=e(),i=t;if(i.startsWith("ipns://")){const e=new URL(i);e.protocol="https:";if(r.readAndCacheDnslink(e.hostname))return e.toString()}if(we.subdomain(i)){const e=function(e,t){"string"==typeof e&&(e=new URL(e));const{id:r,ns:n}=Se(e);if(!r||!n)throw new Error("no matching isIPFS.*subdomainPattern");return new URL(Ce(`${t.protocol}//${r}.${n}.${t.hostname}${e.pathname}${e.search}${e.hash}`)).toString()}(i,n);if(we.ipfsSubdomain(e))return e;const t=new URL(e),{id:s}=Se(t);if(!we.cid(s)){if(r.readAndCacheDnslink(s))return t.hostname=s,t.toString()}if(we.ipnsSubdomain(e))return e}const o=Ae(i,{keepURIParams:!0});return we.path(o)?_e(o,s):i&&i.startsWith("http")?i:null},resolveToLocalUrl(t){const{gwURLString:r}=e(),n=Ae(t,{keepURIParams:!0});return we.path(n)?_e(n,r):null},async resolveToPermalink(t,r){const n=t,s=await this.resolveToImmutableIpfsPath(n),i=r||e().pubGwURLString;return s?_e(s,i):n.startsWith("http")?n:null},resolveToIpfsPath(e){const t=e,n=Ae(t,{keepURIParams:!0});if(n)return n;if(!t.startsWith("http"))return null;const{hostname:s}=new URL(t);return r.cachedDnslink(s)?r.convertToIpnsPath(t):null},resolveToImmutableIpfsPath:ye((async function(e){const r=n.resolveToIpfsPath(e);if(!r)return null;if(we.ipnsPath(r)){const e=`/ipns/${r.split("/")[2]}`,n=await t().resolve(e,{recursive:!0}),s=n.Path?n.Path:n;return r.replace(e,s)}return r}),{maxAge:ve}),resolveToCid:ye((async function(e){const s=n.resolveToIpfsPath(e);if(!s)return null;const i=s.split("#")[0].split("?")[0];const o=await(async e=>{try{return await e()}catch(e){const t=i.replace(/^.*\/ipns\/([^/]+).*/,"$1");if("resolve non-IPFS names is not implemented"===e.message&&M(t)){const e=r.readAndCacheDnslink(t);if(e){const t=Ce(i.replace(/^.*(\/ipns\/[^/]+)/,e));if(i!==t){const e=await n.resolveToCid(t);return we.cid(e)?`/ipfs/${e}`:e}}}throw e}})((async()=>t().resolve(i,{recursive:!0,dhtt:"5s",dhtrc:1})));return we.ipfsPath(o)?o.split("/")[2]:o}),{maxAge:ve})};return n}var Te=r(57665);const xe=a("ipfs-companion:dnslink");xe.error=a("ipfs-companion:dnslink:error");const Re=a("ipfs-companion:request");Re.error=a("ipfs-companion:request:error");const Pe="x-ipfs-companion-no-redirect",De=new Set(["NS_ERROR_UNKNOWN_HOST","NS_ERROR_NET_TIMEOUT","NS_ERROR_NET_RESET","NS_ERROR_NET_ON_RESOLVED","net::ERR_NAME_NOT_RESOLVED","net::ERR_CONNECTION_TIMED_OUT","net::ERR_INTERNET_DISCONNECTED"]),Oe=new Set;function Ne(e,t,r,n){const s=n.browser,i=s.runtime.getURL("/"),o=i?new URL(i).origin:"http://companion-origin",a=new ge({max:128,ttl:3e4}),c=e=>a.set(e,!0),h=e=>void 0!==a.get(e),l=new ge({max:3,ttl:1e3}),u=e=>{if(we.ipnsSubdomain(e)){const r=t.findDNSLinkHostname(e);if(r)return r}return new URL(e).hostname},d=(e,r)=>{(ke(r.url,e.gwURL)||ke(r.url,e.apiURL))&&c(r.requestId),"websocket"===r.type&&c(r.requestId),(r.url.startsWith("http://127.0.0.1")||r.url.startsWith("http://localhost")||r.url.startsWith("http://[::1]"))&&c(r.requestId);const{fqdn:n,parentFqdn:s}=(e=>{const{url:t,originUrl:r,initiator:n}=e,s=r||n;return{fqdn:u(t),parentFqdn:s&&"null"!==s&&t!==s?u(s):null}})(r);return e.disabledOn.some((e=>"gateway.ipfs.io"!==n&&!!(n.endsWith(e)||s&&s.endsWith(e))))&&c(r.requestId),"main_frame"===r.type&&e.dnslinkPolicy&&t.canLookupURL(r.url)&&t.resolve(r.url),h(r.requestId)};return{onBeforeRequest(s){const o=e();if(o.active){if(!o.nodeActive&&"main_frame"===s.type&&ke(s.url,o.gwURL)){const e=r.resolveToPublicUrl(s.url,o.pubGwURLString);return{redirectUrl:`${Ee(i)}/dist/recovery/recovery.html#${encodeURIComponent(e)}`}}if(o.redirect&&"main_frame"===s.type&&ke(s.url,o.gwURL)){const e=re(s.url,{useLocalhostName:o.useSubdomains}).toString();if(e!==s.url)return{redirectUrl:e}}if(o.redirect&&"main_frame"===s.type&&ke(s.url,o.apiURL)){const e=re(s.url,{useLocalhostName:!1}).toString();if(e!==s.url)return{redirectUrl:e}}if(!d(o,s)){if(o.catchUnhandledProtocols&&function(e){return"main_frame"===e.type&&e.url.includes("%3A%2F")}(s)){const e=function(e,t){let r=function(e){const t=e.match(Ve);if(t&&t.length>1){const e=decodeURIComponent(t[1]),r=`/${decodeURIComponent(t[2])}`;return we.path(r)?r:`/${e}${r}`}return null}(e.url);if(r=Me(r),we.path(r))return{redirectUrl:_e(r,t)}}(s,o.pubGwURLString);if(e)return e}if(function(e){return e.url.startsWith(Be)}(s)){const e=function(e,t){const r=decodeURIComponent(new URL(e.url).hash);let n=r;if(n=n.replace(/^#web\+dweb:\//i,"/"),n=n.replace(/^#web\+ipfs:\/\//i,"/ipfs/"),n=n.replace(/^#web\+ipns:\/\//i,"/ipns/"),n=n.replace(/^#dweb:\//i,"/"),n=n.replace(/^#ipfs:\/\//i,"/ipfs/"),n=n.replace(/^#ipns:\/\//i,"/ipns/"),n=Me(n),r!==n&&we.path(n))return{redirectUrl:_e(n,t)};return null}(s,o.pubGwURLString);if(e)return e}if(o.redirect){if(((e,t)=>(!e.localGwAvailable&&ke(t.url,e.pubGwURL)&&c(t.requestId),h(t.requestId)))(o,s))return;if(r.publicIpfsOrIpnsResource(s.url)&&Ue(s,n))return Le(s,s.url,o,r,n);if(o.dnslinkPolicy&&t.canLookupURL(s.url)){if(o.dnslinkRedirect){const e=t.dnslinkAtGateway(s.url);if(e&&Ue(s,n))return Le(s,e,o,r,n)}else o.dnslinkDataPreload&&t.preloadData(s.url);"best-effort"===o.dnslinkPolicy&&t.resolve(s.url)}}}}},onBeforeSendHeaders(t){const r=e();if(r.active&&ke(t.url,r.apiURL)){const{requestHeaders:e}=t;if((e=>{const{originUrl:t,initiator:r}=e,{origin:n}=new URL(t||r||"http://missing-origin");return n===o})(t)){const t=e.findIndex((e=>"origin"===e.name.toLowerCase())),{origin:n}=r.apiURL;t>-1?e[t].value=n:e.push({name:"Origin",value:n})}if(t.url.includes("/api/v0/add")&&t.url.includes("stream-channels=true")){let t=!0;const r={name:"Expect",value:"100-continue"},n='Executing "Expect: 100-continue" workaround for ipfs.add due to https://github.com/ipfs/go-ipfs/issues/5168';for(const s of e)if(s.name===r.name){t=!1,s.value!==r.value&&(Re(n),s.value=r.value);break}t&&(Re(n),e.push(r))}return{requestHeaders:e}}},onHeadersReceived(s){const i=e();if(i.active&&!h(s.requestId)&&i.redirect){if(n.requiresXHRCORSfix&&Oe.has(s.requestId)){if(Oe.delete(s.requestId),i.dnslinkPolicy){const e=t.dnslinkAtGateway(s.url);if(e)return Le(s,e,i,r,n)}return Le(s,s.url,i,r,n)}const{url:e}=s,o=!(ke(e,i.pubGwURL)||ke(e,i.gwURL)||ke(e,i.apiURL));if(i.detectIpfsPathHeader&&s.responseHeaders&&o)for(const e of s.responseHeaders)if("x-ipfs-path"===e.name.toLowerCase()&&Ue(s,n)){const o=e.value;if(i.dnslinkRedirect&&i.dnslinkPolicy&&t.canLookupURL(s.url)){const e=t.readAndCacheDnslink(new URL(s.url).hostname),o=t.dnslinkAtGateway(s.url,e);if(o&&i.localGwAvailable)return Re(`onHeadersReceived: dnslinkRedirect from ${s.url} to ${o}`),Le(s,o,i,r,n)}if(we.ipnsPath(o));else if(we.ipfsPath(o)){const e=new URL(s.url),t=_e(`${o}${e.search}${e.hash}`,i.pubGwURLString);if(t&&i.localGwAvailable)return Re(`onHeadersReceived: normalized ${s.url} to  ${t}`),Le(s,t,i,r,n)}}}},onErrorOccurred(i){const o=e();if(o.active&&!l.has(i.url)){if(l.set(i.url,i.requestId),"NS_ERROR_UNKNOWN_HOST"===i.error&&i.url.includes("://www.")){const e=i.url.replace("://www.","://");if(l.has(e))return}if(function(e,t){return t.recoverFailedHttpRequests&&"main_frame"===e.type&&De.has(e.error)&&new URL(e.url).hostname.endsWith(".eth")}(i,o)){const e=new URL(i.url);e.hostname=`${e.hostname}.link`,e.protocol="https:";const t=e.toString();return Re(`onErrorOccurred: attempting to recover from DNS error (${i.error}) using EthDNS for ${i.url} → ${t}`,i),je(i,t,s)}if(function(e,t,r){return t.recoverFailedHttpRequests&&"main_frame"===e.type&&t.dnslinkPolicy&&De.has(e.error)&&r.canLookupURL(e.url)}(i,o,t)){const{hostname:e}=new URL(i.url),r=t.readAndCacheDnslink(e);if(r){const e=t.dnslinkAtGateway(i.url,r);return Re(`onErrorOccurred: attempting to recover from network error (${i.error}) using dnslink for ${i.url} → ${e}`,i),je(i,e,s)}}if(n.requiresXHRCORSfix&&Oe.has(i.requestId)&&Oe.delete(i.requestId),ze(i,o,r)){const e=r.resolveToPublicUrl(i.url);return Re(`onErrorOccurred: attempting to recover from network error (${i.error}) for ${i.url} → ${e}`,i),je(i,e,s)}}},onCompleted(t){const n=e();if(n.active&&200!==t.statusCode){if("main_frame"===t.type&&404===t.statusCode&&t.url.match(/\/\/[^/]+\/ipns\/ipfs\.io\/blog\//)){Re("onCompleted: fixing /ipns/ipfs.io/blog → /ipns/blog.ipfs.io");const e=t.url.replace("/ipns/ipfs.io/blog","/ipns/blog.ipfs.io");return setTimeout((()=>s.tabs.update(t.tabId,{url:e})),1e3),s.tabs.update(t.tabId,{url:e})}if(ze(t,n,r)){const e=r.resolveToPublicUrl(t.url);return Re(`onCompleted: attempting to recover from HTTP Error ${t.statusCode} for ${t.url} → ${e}`,t),je(t,e,s)}}}}}function Le(e,t,r,n,s){const{resolveToPublicUrl:i,resolveToLocalUrl:o}=n;let a=r.localGwAvailable?o(t):i(t);if(r.localGwAvailable){const{type:n,originUrl:i,initiator:o}=e,c=i||o;if("main_frame"!==n&&c&&!ke(c,r.gwURL)){a=re(a,{useLocalhostName:!1}).toString()}if("main_frame"===n&&r.ipfsNodeType===x&&!ke(e.url,r.gwURL)&&(a=function(e){const t=Ae(e,{keepURIParams:!0});return t?t.replace(/^\/(ip[f|n]s)\//,"$1://"):null}(a),a!==t))return Re("redirectToGateway: upgrading address bar to native URI",a),s.browser.tabs.update(e.tabId,{url:a})}if(a&&e.url!==a)return{redirectUrl:a}}function Ue(e,t){const{url:r,type:n,originUrl:s}=e;if(r.includes(Pe))return!1;if("main_frame"!==n&&s&&s.includes(Pe))return!1;if(t.requiresXHRCORSfix&&"xmlhttprequest"===e.type&&!e.responseHeaders&&e.originUrl){if(new URL(e.originUrl).origin!==new URL(e.url).origin)return Re("Delaying redirect of CORS XHR until onHeadersReceived due to https://github.com/ipfs-shipyard/ipfs-companion/issues/436 :",e.url),Oe.add(e.requestId),!1}return!t.brave||"main_frame"===e.type}const Be="https://dweb.link/ipfs/?uri=";function Me(e){if(!e||!e.startsWith("/ipfs/"))return e;const[,t]=e.match(/^\/ipfs\/([^/?#]+)/);return t&&!we.cid(t)&&M(t)?e.replace(/^\/ipfs\//,"/ipns/"):e}const Ve=/=(?:web%2B|)(ipfs(?=%3A%2F%2F)|ipns(?=%3A%2F%2F)|dweb(?=%3A%2Fip[f|n]s))%3A(?:%2F%2F|%2F)([^&]+)/;function ze(e,t,r){const{error:n,statusCode:s,url:i}=e,{redirect:o,localGwAvailable:a,pubGwURL:c,pubSubdomainGwURL:h}=t;return t.recoverFailedHttpRequests&&"main_frame"===e.type&&(De.has(n)||(l=s)&&l>=400)&&r.publicIpfsOrIpnsResource(i)&&(o&&a||!ke(i,c)&&!ke(i,h));var l}async function je(e,t,r){if(e.url!==t)return r.tabs.update(e.tabId,{active:!0,url:t})}var Fe=r(40726),$e=r(13939);const qe=a("ipfs-companion:client:embedded");qe.error=a("ipfs-companion:client:embedded:error");let Ke=null;async function He(e,t){qe("init");const r=JSON.parse(te.ipfsNodeConfig),n=JSON.parse(t.ipfsNodeConfig),s=(0,Fe.Z)(r,n,{start:!0}),i=e=>!Array.isArray(e)||!e.length,{Addresses:o}=s.config;return i(o.Swarm)&&(o.Swarm=["/dns4/wrtc-star1.par.dwebops.pub/tcp/443/wss/p2p-webrtc-star","/dns4/wrtc-star2.sjc.dwebops.pub/tcp/443/wss/p2p-webrtc-star"]),i(s.Delegates)&&(o.Delegates=["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]),Ke=await(0,$e.Ue)(s),Ke}async function Ge(e){qe("destroy"),Ke&&(await Ke.stop(),Ke=null)}const We=a("ipfs-companion:precache");async function Je(e,t){try{return await e.dag.get(t,{offline:!0,timeout:5e3}),!0}catch(e){return!1}}We.error=a("ipfs-companion:precache:error");class Ye{constructor(e,t){if(!e||!t)throw new Error("Instances of browser and logger are needed!");this._browserInstance=e,this._log=t}init(){this._log("Initialized without additional config.")}validation(){throw new Error("Validation: Method Not Implemented")}message(){throw new Error("Message: Method Not Implemented")}reload(e){e.filter((e=>this.validation(e))).forEach((e=>{this._log(this.message(e)),this._browserInstance.tabs.reload(e.id)}))}}class Qe extends Ye{init(){this.extensionOrigin=this._browserInstance.runtime.getURL("/"),this._log("InternalTabReloader Ready for use.")}validation({url:e}){return e.startsWith(this.extensionOrigin)}message({url:e}){return`reloading internal extension page at ${e}`}}class Ze extends Ye{validation({url:e,title:t}){return(we.url(e)||we.subdomain(e))&&(e.includes(t)||"problem loading page"===t.toLowerCase())}message({url:e}){return`reloading local gateway at ${e}`}}class Xe extends Ye{validation({url:e}){const t=!e.startsWith("http")&&e.includes("/webui/index.html#/"),r=e.includes("/webui.ipfs.io/#/");return t||r}message({url:e}){return`reloading webui at ${e}`}}const et=a("ipfs-companion:client");let tt;async function rt(e,t){if(et("init ipfs client"),tt)return;let r;switch(t.ipfsNodeType){case"embedded:chromesockets":throw setTimeout((async()=>{et("converting embedded:chromesockets to native external:brave"),t.ipfsNodeType="external:brave",await e.storage.local.set({ipfsNodeType:"external:brave",ipfsNodeConfig:"{}"}),await e.tabs.create({url:"https://docs.ipfs.tech/how-to/companion-node-types/#native"})}),0),new Error("Embedded + chrome.sockets is deprecated. Switching to Native IPFS in Brave.");case"embedded":r=i;break;case"external:brave":r=s;break;case"external":r=n;break;default:throw new Error(`Unsupported ipfsNodeType: ${t.ipfsNodeType}`)}const o=await r.init(e,t);return st(e,o,t),tt=r,o}async function nt(e){if(et("destroy ipfs client"),tt)try{await tt.destroy(e),await st(e)}finally{tt=null}}async function st(e,t,r,n=[Xe,Ze,Qe]){if(e.tabs&&e.tabs.query){const t=await e.tabs.query({});if(t)try{const r=await function(e,t,r){const n=Array.isArray(e)?e:[e];return Promise.all(n.map((async e=>{try{const n=new e(t,r);return await n.init(),n}catch(t){r(`Extension Instance Failed to Initialize with error: ${t}. Extension: ${e}`)}})))}(n,e,et);r.forEach((e=>e.reload(t)))}catch(e){et("Failed to trigger reloaders")}}tt&&t&&r&&setTimeout((()=>async function(e,t){const r=[];try{let n,s;t.useLatestWebUI?(n=await e.dns("webui.ipfs.io",{recursive:!0}),s="latest webui from DNSLink at webui.ipfs.io"):(n=new URL((await fetch(`${t.apiURLString}webui`)).url).pathname,s=`stable webui hardcoded at ${t.apiURLString}webui`),r.push({nodeType:"external",name:s,cid:n})}catch(e){We.error("unable to find webui content path for precache",e)}for(const{name:n,cid:s,nodeType:i}of r)if(t.ipfsNodeType===i)if(await Je(e,s))We(`${n} (${s}) already in local repo, skipping import`);else{We(`importing ${n} (${s}) to local ipfs repo`);try{for await(const t of e.refs(s,{recursive:!0}))t.err&&We.error(`error while preloading ${n} (${s})`,t.err);We(`${n} successfully cached under CID ${s}`)}catch(e){We.error(`error while processing ${n}`,e)}}}(t,r)),5e3)}et.error=a("ipfs-companion:client:error");const it=a("ipfs-companion:import");it.error=a("ipfs-companion:import:error");function ot(e){e=(e=e.replace(/\/$|$/,"/")).replace(/(\/)\/+/g,"$1");const t=new Date,r=[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()].map((e=>String(e).padStart(2,"0")));return[/%Y/g,/%M/g,/%D/g,/%h/g,/%m/g,/%s/g].forEach(((t,n)=>{e=e.replace(t,r[n])})),e}const at=a("ipfs-companion:notifier");at.error=a("ipfs-companion:notifier:error");const ct=a("ipfs-companion:context-menus");ct.error=a("ipfs-companion:context-menus:error");const ht={selection:"selectionText",image:"srcUrl",video:"srcUrl",audio:"srcUrl",link:"linkUrl",page:"pageUrl"};async function lt(e,t){if(e){if(t){return e[ht[t]]}if(e.srcUrl)return e.srcUrl;if(e.linkUrl)return e.linkUrl;if(e.pageUrl)return e.pageUrl}return(await o.tabs.query({active:!0,currentWindow:!0}).then((e=>e[0]))).url}const ut="contextMenu_importToIpfs",dt="panelCopy_currentIpnsAddress",ft="panelCopy_copyRawCid",pt="panel_copyCurrentPublicGwUrl",yt=new Set([ft,dt,ut]),gt=new Set,bt=new Set;async function mt(e,t){try{try{await navigator.clipboard.writeText(e)}catch(r){function n(t){document.removeEventListener("copy",n,!0),t.stopImmediatePropagation(),t.preventDefault(),t.clipboardData.setData("text/plain",e)}document.addEventListener("copy",n,!0),document.execCommand("copy")}t("notify_copiedTitle",e)}catch(s){console.error("[ipfs-companion] Failed to copy text",s),t("notify_addonIssueTitle","Unable to copy")}}async function wt(e){const{name:t,version:r}=await function(e){return e&&e.runtime&&e.runtime.getBrowserInfo?e.runtime.getBrowserInfo():Promise.resolve({})}(e),n=t&&(t.includes("Firefox")||t.includes("Fennec")),s=!!(e&&e.protocol&&e.protocol.registerStringProtocol),i=await function(e){return e&&e.runtime&&e.runtime.getPlatformInfo?e.runtime.getPlatformInfo():Promise.resolve()}(e),o=!!i&&"android"===i.os;return Object.freeze({browser:e,brave:S,isFirefox:n,isAndroid:o,requiresXHRCORSfix:!!(n&&r&&r.startsWith("68")),hasNativeProtocolHandler:s})}const vt=a("ipfs-companion:http-proxy");async function Et(e,t,r){if(t.isFirefox)try{const{active:r,useSubdomains:n,gwURLString:s}=e(),i=r&&n,{hostname:a,port:c}=re(s,{useLocalhostName:!1});if(t.isFirefox)return await async function(e,t,r){const{onRequest:n}=o.proxy,s=At;s&&n.hasListener(s)&&n.removeListener(s);if(e)return At=e=>new URL(e.url).port===r?{type:"http",host:t,port:r}:{type:"direct"},n.addListener(At,{urls:["http://*.localhost/*"],incognito:!1}),void vt(`enabled ${t}:${r} as HTTP proxy for *.localhost`);vt("disabled HTTP proxy for *.localhost")}(i,a,c)}catch(e){vt.error("registerSubdomainProxy failed",e);try{r&&r("notify_addonIssueTitle","notify_addonIssueMsg")}catch(e){}}}let At;vt.error=a("ipfs-companion:http-proxy:error");const St={url:"https://countly.ipfs.tech",autoTrack:!0,interval:5e3,max_events:500,queue_size:1e3,session_update:60,require_consent:!0},_t={key:"",count:1,sum:1,dur:0,segmentation:{}};class Ct{constructor(e,t=3e5){this.events=new Map,this.metricsService=e,this.flushInterval=t,this.setupUnloadEvent()}setupUnloadEvent(){var e;const t=()=>{this.flushAll()};"function"==typeof globalThis.addEventListener?globalThis.addEventListener("beforeunload",t):"function"==typeof(null===(e=globalThis.process)||void 0===e?void 0:e.on)&&globalThis.process.on("beforeExit",t)}addEventDefaults(e){return Object.assign(Object.assign({},_t),e)}setupEventAccumulator(e){const{key:t}=e;this.events.set(t,{eventData:e,startTime:Date.now(),timeout:setTimeout((()=>{this.flush(t)}),this.flushInterval)})}accumulateEventData(e){const{key:t,count:r,segmentation:n}=e,s=this.events.get(t);if(null==s)return void this.setupEventAccumulator(e);const{eventData:i}=s;i.count+=r,i.sum+=1,i.segmentation=Object.assign(Object.assign({},i.segmentation),n)}addEvent(e,t=!1){const r=this.addEventDefaults(e),{key:n}=r;if(""===n)throw new Error("Event key is required.");this.accumulateEventData(r),t&&this.flush(n)}flush(e){const t=this.events.get(e);if(null==t)return;const{eventData:r,startTime:n,timeout:s}=t;r.dur=Date.now()-n,this.metricsService.add_event(r),clearTimeout(s),this.events.delete(e)}flushAll(){this.events.forEach(((e,t)=>{this.flush(t)}))}}var kt=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};class It{constructor(e){this.groupedFeatures=this.mapAllEvents({minimal:["sessions","views","events"],performance:["crashes","apm"],ux:["scrolls","clicks","forms"],feedback:["star-rating","feedback"],location:["location"]}),this.sessionStarted=!1,this._consentGranted=new Set,this.initDone=!1;const{appKey:t}=e,r=kt(e,["appKey"]),n=Object.assign(Object.assign(Object.assign({},St),r),{app_key:t}),{autoTrack:s,metricsService:i,storageProvider:o}=n;this.metricsService=i,this.storageProvider=null!=o?o:null,this.metricsService.init(n),this.accumulate=new Ct(i),this.metricsService.group_features(this.groupedFeatures),s&&this.setupAutoTrack();const a=this.getConsentStore();a.length>0&&this.addConsent(a),this.initDone=!0}mapAllEvents(e){return Object.assign(Object.assign({},e),{all:Object.values(e).flat()})}get consentGranted(){return[...this._consentGranted]}setupAutoTrack(){var e,t,r,n,s;const i=this.metricsService;null===(e=i.track_clicks)||void 0===e||e.call(i),null===(t=i.track_forms)||void 0===t||t.call(i),null===(r=i.track_links)||void 0===r||r.call(i),null===(n=i.track_scrolls)||void 0===n||n.call(i),null===(s=i.track_sessions)||void 0===s||s.call(i),this.metricsService.track_errors(),this.metricsService.track_pageview(),this.metricsService.track_view()}addConsent(e){Array.isArray(e)||(e=[e]),e.forEach((e=>this._consentGranted.add(e))),this.metricsService.add_consent(e),this.setConsentStore()}removeConsent(e){Array.isArray(e)||(e=[e]),e.forEach((e=>this._consentGranted.delete(e))),this.metricsService.remove_consent(e,!0),this.setConsentStore()}setConsentStore(){null!=this.storageProvider&&this.initDone&&this.storageProvider.setStore(Array.from(this._consentGranted))}getConsentStore(){var e,t;return null!==(t=null===(e=this.storageProvider)||void 0===e?void 0:e.getStore())&&void 0!==t?t:[]}checkConsent(e){return e in this.groupedFeatures?this.groupedFeatures[e].every(this.metricsService.check_consent):this.metricsService.check_consent(e)}updateConsent(e){const t=new Set(e);Object.keys(this.groupedFeatures).forEach((e=>{t.has(e)?this.addConsent(e):this.removeConsent(e)}))}trackView(e,t,r){this.metricsService.track_view(e,t,r)}trackEvent(e){this.metricsService.add_event(e)}trackError(e,t=!0,r={}){this.metricsService.recordError(e,t,r)}startSession(e=!1,t=!1){this.sessionStarted||(this.sessionStarted=!0,this.metricsService.begin_session(e,t))}endSession(e=!1){this.sessionStarted&&(this.metricsService.end_session(void 0,e),this.sessionStarted=!1)}}class Tt{setStore(e){try{const t=JSON.stringify(e);globalThis.localStorage.setItem("@ipfs-shipyard/ignite-metrics:consent",t)}catch(e){console.error(e)}}getStore(){try{const e=globalThis.localStorage.getItem("@ipfs-shipyard/ignite-metrics:consent");if(null!=e)return JSON.parse(e)}catch(e){console.error(e)}return["minimal"]}}var xt=r(74087);const Rt=class extends It{constructor(e){super(Object.assign({metricsService:xt,storageProvider:new Tt},e))}},Pt=a("ipfs-companion:telemetry"),Dt=new Rt({appKey:"393f72eb264c28a1b59973da1e0a3938d60dc38a",autoTrack:!1,storageProvider:null});function Ot(e){const t={minimal:(null==e?void 0:e.telemetryGroupMinimal)||!1,performance:(null==e?void 0:e.telemetryGroupPerformance)||!1,ux:(null==e?void 0:e.telemetryGroupUx)||!1,feedback:(null==e?void 0:e.telemetryGroupFeedback)||!1,location:(null==e?void 0:e.telemetryGroupLocation)||!1};for(const[e,r]of Object.entries(t))r?(Pt(`Adding consent for '${e}'`),Dt.addConsent(e)):(Pt(`Removing consent for '${e}'`),Dt.removeConsent(e))}const Nt=[];const Lt=(...e)=>Dt.startSession(...e),Ut=(...e)=>Dt.endSession(...e),Bt=a("ipfs-companion:main");let Mt;async function Vt(){let e,t,r,n,s,i,c,h,l,u,d,f;try{Bt("init"),await async function(e,t,r){const n=Object.keys(t),s={},i=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);for(const o of n)i(e,o)&&e[o]!==t[o]||i(await r.get(o),o)||(s[o]=t[o]);return await r.set(s),s}(await o.storage.local.get(),te,o.storage.local),await async function(e,t){const r=t("ipfs-companion:migrations");r.error=t("ipfs-companion:migrations:error");const{dnslink:n}=await e.get("dnslink");n&&(await e.set({dnslinkPolicy:"best-effort",detectIpfsPathHeader:!0}),await e.remove("dnslink"));const{noRedirectHostnames:s}=await e.get("noRedirectHostnames");s&&(await e.set({noIntegrationsHostnames:s}),await e.remove("noRedirectHostnames"));const{customGatewayUrl:i}=await e.get("customGatewayUrl");if(i&&(ie(i)||oe(i))){const{useSubdomains:t}=await e.get("useSubdomains"),r=ne(i,{useLocalhostName:t});i!==r&&await e.set({customGatewayUrl:r})}{const{disabledOn:t,noIntegrationsHostnames:n}=await e.get(["disabledOn","noIntegrationsHostnames"]);n&&(r("migrating noIntregrationsHostnames → disabledOn"),await e.set({disabledOn:t.concat(n)}),await e.remove("noIntegrationsHostnames"))}{const{enabledOn:t,disabledOn:n}=await e.get(["enabledOn","disabledOn"]);for(const s of["proto.school","app.fleek.co"])t.includes(s)||n.includes(s)||(r(`adding '${s}' to 'disabledOn' list`),n.push(s),await e.set({disabledOn:n}))}{const{displayReleaseNotes:t,dismissedUpdate:n}=await e.get(["displayReleaseNotes","dismissedUpdate"]);!n&&t&&(r("converting displayReleaseNotes from out-out to opt-in"),await e.set({displayReleaseNotes:!1}))}}(o.storage.local,a);const d=await o.storage.local.get(te);if(l=await wt(o),t=function(e,t){var r,n,s,i;const o=Object.assign({},e);return o.peerCount=me,o.pubGwURL=re(e.publicGatewayUrl),o.pubGwURLString=null===(r=o.pubGwURL)||void 0===r?void 0:r.toString(),delete o.publicGatewayUrl,o.pubSubdomainGwURL=re(e.publicSubdomainGatewayUrl),o.pubSubdomainGwURLString=null===(n=o.pubSubdomainGwURL)||void 0===n?void 0:n.toString(),delete o.publicSubdomainGatewayUrl,o.redirect=e.useCustomGateway,delete o.useCustomGateway,o.apiURL=re(e.ipfsApiUrl,{useLocalhostName:!1}),o.apiURLString=null===(s=o.apiURL)||void 0===s?void 0:s.toString(),delete o.ipfsApiUrl,o.gwURL=re(e.customGatewayUrl,{useLocalhostName:o.useSubdomains}),o.gwURLString=null===(i=o.gwURL)||void 0===i?void 0:i.toString(),delete o.customGatewayUrl,o.dnslinkPolicy="false"!==String(e.dnslinkPolicy)&&e.dnslinkPolicy,o.activeIntegrations=e=>{if(!o.active)return!1;try{var t,r;const n=se(e)?e:new URL(e).hostname,s=null===(t=o.disabledOn)||void 0===t?void 0:t.some((e=>n.endsWith(e))),i=null===(r=o.enabledOn)||void 0===r?void 0:r.some((e=>e===n));return!(s&&!i)}catch(e){return!1}},Object.defineProperty(o,"nodeActive",{get:function(){return this.peerCount!==me}}),Object.defineProperty(o,"localGwAvailable",{get:function(){return"embedded"!==this.ipfsNodeType}}),Object.defineProperty(o,"webuiRootUrl",{get:function(){return o.useLatestWebUI?`${o.gwURLString}ipns/webui.ipfs.io/`:`${o.apiURLString}webui`}}),t&&Object.assign(o,t),o}(d),i=function(e){const{getMessage:t}=o.i18n;return async(r,n,s)=>{const i=o.i18n.getMessage(r)||r;let a;if(a=n.startsWith("notify_")?s?t(n,s):t(n):n,at(`${i}: ${a}`),e().displayNotifications&&o&&o.notifications.create)try{return await o.notifications.create({type:"basic",iconUrl:o.runtime.getURL("icons/ipfs-logo-on.svg"),title:i,message:a})}catch(e){at.error("failed to create a notification",e)}}}(p),Ot(t),t.active){Lt();try{e=await rt(o,t)}catch(e){console.error("[ipfs-companion] Failed to init IPFS client",e),i("notify_startIpfsNodeErrorTitle","ValidationError"===e.name?e.details[0].message:e.message)}}r=function(e){const t={max:1e3,ttl:432e5},r=new ge(t),n=new Te.Z({concurrency:4}),s=new ge(t),i=new Te.Z({concurrency:4}),o={get _cache(){return r},setDnslink(e,t){r.set(e,t)},clearCache(){r.clear()},cachedDnslink:e=>r.get(e),canLookupURL(t){const r=e();return r.dnslinkPolicy&&t.startsWith("http")&&!we.url(t)&&!ke(t,r.apiURL)&&!ke(t,r.gwURL)},dnslinkAtGateway(t,r){if("string"==typeof t&&(t=new URL(t)),o.canRedirectToIpns(t,r)){const r=e();return _e(o.convertToIpnsPath(t),r.redirect&&r.localGwAvailable?r.gwURLString:r.pubGwURLString)}},readAndCacheDnslink(e){let t=o.cachedDnslink(e);if(void 0===t)try{xe(`dnslink cache miss for '${e}', running DNS TXT lookup`),t=o.readDnslinkFromTxtRecord(e),t?(o.setDnslink(e,t),xe(`found dnslink: '${e}' -> '${t}'`)):(o.setDnslink(e,!1),xe(`found NO dnslink for '${e}'`))}catch(t){xe.error(`error in readAndCacheDnslink for '${e}'`,t)}return t},async resolve(e){if(!o.canLookupURL(e))return;const t=new URL(e).hostname;return o.cachedDnslink(t)||n.add((()=>o.readAndCacheDnslink(t)))},async preloadData(t){const r=e();if(!r.dnslinkDataPreload||r.dnslinkRedirect)return;if(s.get(t))return;s.set(t,!0);const n=await o.resolve(t);return!n||!r.localGwAvailable||r.peerCount<1?void 0:i.add((async()=>{const{pathname:e}=new URL(t),s=new URL(r.gwURLString);return s.pathname=`${n}${e}`,await fetch(s.toString(),{method:"HEAD"}),s}))},readDnslinkFromTxtRecord(t){const r=e();let n;n=r.ipfsNodeType.startsWith("embedded")||r.peerCount===me?"https://ipfs.io/":r.gwURLString;const s=`${n}api/v0/name/resolve/${t}?r=false`,i=new XMLHttpRequest;if(i.open("GET",s,!1),i.setRequestHeader("Accept","application/json"),i.send(null),200===i.status){const e=JSON.parse(i.responseText).Path;if(!we.path(e))throw new Error(`dnslink for '${t}' is not a valid IPFS path: '${e}'`);return e}if(500===i.status)return!1;throw new Error(i.statusText)},canRedirectToIpns(t,r){"string"==typeof t&&(t=new URL(t));const n=t.pathname;if(!(n.startsWith("/ipfs/")||n.startsWith("/ipns/")||n.startsWith("/api/v"))){const n=t.hostname;if(r||("enabled"===e().dnslinkPolicy?o.readAndCacheDnslink(n):o.cachedDnslink(n)))return!0}return!1},convertToIpnsPath:e=>("string"==typeof e&&(e=new URL(e)),`/ipns/${e.hostname}${e.pathname}${e.search}${e.hash}`),findDNSLinkHostname(e){if(!e)return;const t=Ae(e);if(we.ipnsPath(t)){const e=t.match(/^\/ipns\/([^/]+)/)[1];if(!we.cid(e)&&o.readAndCacheDnslink(e))return e}const{hostname:r}=new URL(e);return o.readAndCacheDnslink(r)?r:void 0}};return o}(p),n=Ie(p,y,r),c=function(e,t){return{async copyTextToClipboard(t){await mt(t,e)},async copyCanonicalAddress(r,n){const s=await lt(r,n),i=t.resolveToIpfsPath(s);await mt(i,e)},async copyCidAddress(r,n){const s=await lt(r,n),i=await t.resolveToImmutableIpfsPath(s);await mt(i,e)},async copyRawCid(r,n){const s=await lt(r,n);try{const r=await t.resolveToCid(s);await mt(r,e)}catch(t){console.error("Unable to resolve/copy direct CID:",t.message),e&&(t.toString().startsWith("Error: no link")?e("notify_addonIssueTitle","Unable to resolve CID within HAMT-sharded directory, sorry! Will be fixed soon."):e("notify_addonIssueTitle","notify_inlineErrorMsg",t.message))}},async copyAddressAtPublicGw(r,n){const s=await lt(r,n),i=t.resolveToPublicUrl(s);await mt(i,e)},async copyPermalink(r,n){const s=await lt(r,n),i=await t.resolveToPermalink(s);await mt(i,e)}}}(i,n),f=function(e,t,r,n,s){const{resolveToPublicUrl:i,resolveToCid:a}=r,c={getIpfsPathAndNativeAddress(t){const r=e(),s=`/ipfs/${t}`;return n.hasNativeProtocolHandler?{path:s,url:`ipfs://${t}`}:{path:s,url:new URL(s,r.pubGwURLString).toString()}},async openFilesAtGateway(e){const r=t(),{cid:n}=await r.files.stat(e),{url:s}=c.getIpfsPathAndNativeAddress(n);await o.tabs.create({url:s})},async openFilesAtWebUI(t){const r=`${e().webuiRootUrl}#/files${t}`;await o.tabs.create({url:r})},async copyImportResultsToFiles(e,r){const n=t();await n.files.mkdir(r,{parents:!0});const s=e.filter((e=>""!==e.path));for(const e of s)await n.files.cp(`/ipfs/${e.cid}`,`${r}${e.path}`);it(`created import dir at ${r}`)},async copyShareLink(e){if(!e||!s)return;const t=e.find((e=>""===e.path));if(!t)return;let r;if(2===e.length){const n=e.find((e=>""!==e.path));r=`/ipfs/${t.cid}/${n.path}`}else r=`/ipfs/${t.cid}/`;const n=i(r);await s.copyTextToClipboard(n)},async preloadFilesAtPublicGateway(t){if(e().preloadAtPublicGateway)for(const e of t)if(e&&e.cid){const{path:t}=c.getIpfsPathAndNativeAddress(e.cid),r=i(`${t}#${Pe}`);try{await fetch(r,{method:"HEAD"}),it("successfully preloaded",e)}catch(e){it.error("preload failed",e)}}},async filesCpImportCurrentTab(r){try{const{copyShareLink:n,preloadFilesAtPublicGateway:s,openFilesAtWebUI:i}=this,o=await r.tabs.query({active:!0,currentWindow:!0}).then((e=>e[0])),c=ot(e().importDir),h=t(),l=Ae(o.url,{keepURIParams:!1}),u=l.split("/").filter(Boolean),d=void 0!==u[2],f=await a(l),p=d?u.slice(-1):`${"ipns"===u[0]?u[1]:"unnamed"}_${f.slice(-4)}`;await h.files.mkdir(c,{parents:!0}),await h.files.cp(`/ipfs/${f}`,`${c}${p}`),await i(c);const{cid:y}=await h.files.stat(c,{hash:!0}),g=[{path:"",cid:y},{path:p,cid:f}];await n(g),await s(g)}catch(e){it.error("unexpected error during filesCpImportCurrentTab",e)}}};return c}(p,y,n,l,c),h=function(e,t,r){return{async viewOnGateway(e,n){const s=await lt(e,n),i=_e(t.resolveToIpfsPath(s),r().pubGwURLString);await o.tabs.create({url:i})}}}(0,n,p),u=function(e,t,r,{onAddFromContext:n,onCopyRawCid:s,onCopyAddressAtPublicGw:i}){try{const e=(e,t,r)=>{o.contextMenus.create({id:e,title:o.i18n.getMessage(e),documentUrlPatterns:["<all_urls>"],contexts:[t]})},t=(e,t,r,s)=>{const i=`${e}_${t}`;return gt.add(i),o.contextMenus.create({id:i,parentId:e,title:o.i18n.getMessage(t),contexts:[r],documentUrlPatterns:["<all_urls>"],enabled:!1,onclick:e=>n(e,r,s)})},r=(e,t,r,n)=>{const s=`${e}_${t}`;return bt.add(s),yt.has(t)&&gt.add(s),o.contextMenus.create({id:s,parentId:e,title:o.i18n.getMessage(t),contexts:[r],documentUrlPatterns:["*://*/ipfs/*","*://*/ipns/*","*://*.ipfs.dweb.link/*","*://*.ipns.dweb.link/*","*://*.ipfs.localhost/*","*://*.ipns.localhost/*"],onclick:e=>n(e,r)})},a=(n,o)=>{e(n,o),t(n,ut,o,{wrapWithDirectory:!0,pin:!1}),r(n,pt,o,i),r(n,ft,o,s)};t(null,"contextMenu_importToIpfsSelection","selection",{pin:!1}),a("contextMenu_parentImage","image"),a("contextMenu_parentVideo","video"),a("contextMenu_parentAudio","audio"),a("contextMenu_parentLink","link"),a("contextMenu_parentPage","page")}catch(e){if(e.message.indexOf("createProperties.documentUrlPatterns of contextMenus.create is not supported yet")>-1)return ct("context menus disabled - createProperties.documentUrlPatterns of contextMenus.create is not supported yet"),{update:()=>Promise.resolve()};if("browser.contextMenus is undefined"===e.message||void 0===o.contextMenus)return ct("context menus disabled - browser.contextMenus is undefined"),{update:()=>Promise.resolve()};throw e}const a=new Set([...gt].filter((e=>bt.has(e))));let c=!1;return{async update(t){try{if(t){const e=await o.tabs.query({active:!0,currentWindow:!0}).then((e=>e[0]));e&&e.id===t&&(c=r.isIpfsPageActionsContext(e.url))}const n=e().peerCount>=0;for(const e of gt)await o.contextMenus.update(e,{enabled:n});for(const e of bt)await o.contextMenus.update(e,{enabled:c});for(const e of a)await o.contextMenus.update(e,{enabled:n&&c})}catch(e){ct.error("Error updating context menus",e)}}}}(p,0,n,{onAddFromContext:async function(r,n,s){const{copyImportResultsToFiles:a,copyShareLink:c,preloadFilesAtPublicGateway:h,openFilesAtGateway:l,openFilesAtWebUI:u}=f,d=ot(t.importDir);let p,y;try{const i=await lt(r,n);if("selection"===n)p={path:`${new URL(r.pageUrl).hostname}.txt`,content:i};else{const e={cache:"force-cache",referrer:r.pageUrl},t=await fetch(i,e),n=await t.blob(),s=new URL(t.url),o="/"===s.pathname?s.hostname:s.pathname.replace(/[\\/]+$/,"").split("/").pop();p={path:decodeURIComponent(o),content:n}}y=await(0,be.Z)(e.addAll([p],s)),c(y),h(y),await a(y,d),!t.openViaWebUI||t.ipfsNodeType.startsWith("embedded")?await l(d):await u(d)}catch(e){console.error("Error in import to IPFS context menu",e),"NetworkError when attempting to fetch resource."===e.message?(i("notify_importErrorTitle","notify_importTrackingProtectionErrorMsg"),console.warn("IPFS import often fails because remote file can not be downloaded due to Tracking Protection. See details at: https://github.com/ipfs/ipfs-companion/issues/227"),o.tabs.create({url:"https://github.com/ipfs/ipfs-companion/issues/227"})):i("notify_importErrorTitle","notify_inlineErrorMsg",`${e.message}`)}},onCopyCanonicalAddress:c.copyCanonicalAddress,onCopyRawCid:c.copyRawCid,onCopyAddressAtPublicGw:c.copyAddressAtPublicGw}),s=Ne(p,r,n,l),Bt("register all listeners"),function(){const e=["blocking","requestHeaders"];o.webRequest.OnBeforeSendHeadersOptions&&"EXTRA_HEADERS"in o.webRequest.OnBeforeSendHeadersOptions&&e.push("extraHeaders");o.webRequest.onBeforeSendHeaders.addListener(g,{urls:["<all_urls>"]},e),o.webRequest.onBeforeRequest.addListener(b,{urls:["<all_urls>"]},["blocking"]),o.webRequest.onHeadersReceived.addListener(m,{urls:["<all_urls>"]},["blocking","responseHeaders"]),o.webRequest.onErrorOccurred.addListener(w,{urls:["<all_urls>"],types:["main_frame"]}),o.webRequest.onCompleted.addListener(v,{urls:["<all_urls>"],types:["main_frame"]}),o.storage.onChanged.addListener(V),o.webNavigation.onCommitted.addListener(R),o.webNavigation.onDOMContentLoaded.addListener(O),o.tabs.onActivated.addListener(T),o.windows&&o.windows.onFocusChanged.addListener(I);o.runtime.onMessage.addListener(E),o.runtime.onConnect.addListener(S),l.hasNativeProtocolHandler?Bt("native protocol handler support detected, but IPFS handler is not implemented yet :-("):Bt("no browser.protocol API, native protocol will not be registered")}(),await Et(p,l,i),Bt("init done"),N(d.ipfsApiPollMs),await U()}catch(e){throw Bt.error("Unable to initialize addon due to error",e),i&&i("notify_addonIssueTitle","notify_addonIssueMsg"),e}function p(){return t}function y(){if(t.active&&e)return e;throw Bt.error("refused access to IPFS API client, check if extension is enabled"),new Error("IPFS Companion: API client is disabled")}function g(e){return s.onBeforeSendHeaders(e)}function b(e){return s.onBeforeRequest(e)}function m(e){return s.onHeadersReceived(e)}function w(e){return s.onErrorOccurred(e)}function v(e){return s.onCompleted(e)}function E(e,t){if(e.pubGwUrlForIpfsOrIpnsPath){const t=e.pubGwUrlForIpfsOrIpnsPath,{validIpfsOrIpns:r,resolveToPublicUrl:s}=n,i=r(t)?s(t):null;return Promise.resolve({pubGwUrlForIpfsOrIpnsPath:i})}if(e.telemetry)return Promise.resolve(function(e,t){if(e.trackView){const{version:t}=o.runtime.getManifest();return r=e.trackView,n={version:t},Pt("trackView called for view: ",r),void Dt.trackView(r,Nt,n)}var r,n}(e.telemetry))}const A=new ge({max:10,ttl:3e4});function S(e){"browser-action-port"===e.name&&(Mt=e,Mt.onMessage.addListener(C),Mt.onDisconnect.addListener((()=>{Mt=null})),k())}const _={notification:e=>i(e.title,e.message),browserActionFilesCpImportCurrentTab:()=>f.filesCpImportCurrentTab(o),panel_contextMenuViewOnGateway:h.viewOnGateway,[dt]:c.copyCanonicalAddress,panelCopy_currentIpfsAddress:c.copyCidAddress,[ft]:c.copyRawCid,[pt]:c.copyAddressAtPublicGw,panel_copyCurrentPermalink:c.copyPermalink};function C(e){const t=_[e&&e.event];if(!t)return console.warn("Unknown browser action message event",e);t(e)}async function k(){if(!Mt)return;const s=await o.tabs.query({active:!0,currentWindow:!0}).then((e=>e[0])),{version:i}=o.runtime.getManifest(),a={active:t.active,ipfsNodeType:t.ipfsNodeType,peerCount:t.peerCount,gwURLString:Ee(t.gwURLString),pubGwURLString:Ee(t.pubGwURLString),webuiRootUrl:Ee(t.webuiRootUrl),importDir:t.importDir,openViaWebUI:t.openViaWebUI,apiURLString:Ee(t.apiURLString),redirect:t.redirect,enabledOn:t.enabledOn,disabledOn:t.disabledOn,newVersion:t.dismissedUpdate!==i?i:null,currentTab:s};try{const t=await e.version();t&&(a.gatewayVersion=t.commit?t.version+"/"+t.commit:t.version)}catch(e){a.gatewayVersion=null}if(t.active&&a.currentTab){const e=a.currentTab.url;if(a.isIpfsContext=n.isIpfsPageActionsContext(e),a.isIpfsContext)if(a.currentTabPublicUrl=n.resolveToPublicUrl(e),a.currentTabContentPath=n.resolveToIpfsPath(e),A.has(e)){const[t,r,n]=A.get(e);a.currentTabImmutablePath=t,a.currentTabPermalink=r,a.currentTabCid=n}else setTimeout((async()=>{A.set(e,[await n.resolveToImmutableIpfsPath(e),await n.resolveToPermalink(e),await n.resolveToCid(e)]),await k()}),0);a.currentDnslinkFqdn=r.findDNSLinkHostname(e),a.currentFqdn=a.currentDnslinkFqdn||(e=>{try{return new URL(e).hostname}catch(t){console.error(`[ipfs-companion] safeHostname(url) error for url='${e}'`,t)}return null})(e),a.currentTabIntegrationsOptOut=!t.activeIntegrations(a.currentFqdn),a.isRedirectContext=a.currentFqdn&&n.isRedirectPageActionsContext(e)}Mt&&Mt.postMessage({statusUpdate:a})}async function I(e){if(e!==o.windows.WINDOW_ID_NONE){const t=await o.tabs.query({active:!0,windowId:e}).then((e=>e[0]));await u.update(t.id)}}async function T(e){await u.update(e.tabId)}async function R(e){await u.update(e.tabId),await async function(e,r){l.isFirefox&&n.isIpfsPageActionsContext(r)&&(ke(r,t.gwURL)||ke(r,t.apiURL)?(await o.pageAction.setIcon({tabId:e,path:"/icons/ipfs-logo-on.svg"}),await o.pageAction.setTitle({tabId:e,title:o.i18n.getMessage("pageAction_titleIpfsAtCustomGateway")})):(await o.pageAction.setIcon({tabId:e,path:"/icons/ipfs-logo-off.svg"}),await o.pageAction.setTitle({tabId:e,title:o.i18n.getMessage("pageAction_titleIpfsAtPublicGateway")})),await o.pageAction.show(e))}(e.tabId,e.url)}async function O(e){if(t.active&&e.url&&e.url.startsWith("http")&&t.activeIntegrations(e.url)){if(t.linkify){Bt(`running linkfy experiment on ${e.url}`);try{await o.tabs.executeScript(e.tabId,{file:"/dist/bundles/linkifyContentScript.bundle.js",matchAboutBlank:!1,allFrames:!0,runAt:"document_idle"})}catch(t){Bt.error(`Unable to linkify DOM at '${e.url}' due to`,t)}}if(e.url.startsWith(t.webuiRootUrl)){const r=ae(t.apiURLString);await o.tabs.executeScript(e.tabId,{runAt:"document_start",code:`if (!localStorage.getItem('ipfsApi')) {\n        console.log('[ipfs-companion] Setting API to ${r}');\n        localStorage.setItem('ipfsApi', '${r}');\n        window.location.reload();\n      }`})}}}async function N(e){d&&clearInterval(d),d=setInterval((()=>async function(e){try{if("active"===await o.idle.queryState(300))return e()}catch(t){return console.error("Unable to read idle state, executing action without idle check",t),e()}}(L)),e),await L()}async function L(){const r=t.peerCount;t.peerCount=await async function(){if(!e)return me;try{return(await e.swarm.peers({timeout:2500})).length}catch(e){return console.error(`Error while ipfs.swarm.peers: ${e}`),me}}(),await Promise.all([M(r,t.peerCount),B(),u.update(),k()])}async function B(){if(void 0===o.browserAction.setBadgeBackgroundColor)return;let e,r,n;e="",t.peerCount>0?(r="#418B8E",n="/icons/ipfs-logo-on.svg",e=t.peerCount>999?Math.floor(t.peerCount/1e3).toString()+"k":t.peerCount.toString()):0===t.peerCount?(r="red",n="/icons/ipfs-logo-on.svg"):(r="#8C8C8C",n="/icons/ipfs-logo-off.svg");try{r!==function(e){if(!e)return"";const t=t=>e[t].toString(16).padStart(2,"0"),r=t(0),n=t(1),s=t(2);return("#"+r+n+s).toUpperCase()}(await o.browserAction.getBadgeBackgroundColor({}))&&(await o.browserAction.setBadgeBackgroundColor({color:r}),await async function(e){let t={path:e};try{await o.browserAction.setIcon(t)}catch(r){t=await zt(e),await o.browserAction.setIcon(t)}}(n));await o.browserAction.getBadgeText({})!==e&&await o.browserAction.setBadgeText({text:e})}catch(e){console.error("Unable to update browserAction badge due to error",e)}}async function M(r,n){t.automaticMode&&t.localGwAvailable&&(r===me&&n>me&&!t.redirect?(await o.storage.local.set({useCustomGateway:!0}),st(o,e,t,[Ze])):n===me&&t.redirect&&await o.storage.local.set({useCustomGateway:!1}))}async function V(r,n){let s=!1,a=!1,c=!1;for(const e in r){const n=r[e];if(n.oldValue!==n.newValue)switch(Bt(`storage key "${e}" changed: "${n.oldValue}" → "${n.newValue}"`),e){case"active":t[e]=n.newValue,await Et(p,l),a=!0,c=!t.active,t.active?Lt():Ut();break;case"ipfsNodeType":n.oldValue!==x&&n.newValue===x?P(o):n.oldValue===x&&n.newValue!==x&&D(o),a=!0,t[e]=n.newValue;break;case"ipfsNodeConfig":a=!0,t[e]=n.newValue;break;case"ipfsApiUrl":t.apiURL=re(n.newValue,{useLocalhostName:!1}),t.apiURLString=t.apiURL.toString(),a=!0;break;case"ipfsApiPollMs":N(n.newValue);break;case"customGatewayUrl":t.gwURL=re(n.newValue,{useLocalhostName:t.useSubdomains}),t.gwURLString=t.gwURL.toString();break;case"publicGatewayUrl":t.pubGwURL=new URL(n.newValue),t.pubGwURLString=t.pubGwURL.toString();break;case"publicSubdomainGatewayUrl":t.pubSubdomainGwURL=new URL(n.newValue),t.pubSubdomainGwURLString=t.pubSubdomainGwURL.toString();break;case"useCustomGateway":t.redirect=n.newValue;break;case"useSubdomains":t[e]=n.newValue,await o.storage.local.set({customGatewayUrl:ne(t.gwURLString,{useLocalhostName:t.useSubdomains})}),await Et(p,l);break;case"dnslinkPolicy":t.dnslinkPolicy="false"!==String(n.newValue)&&n.newValue,"best-effort"!==t.dnslinkPolicy||t.detectIpfsPathHeader||await o.storage.local.set({detectIpfsPathHeader:!0});break;case"logNamespaces":s=!0,t[e]=localStorage.debug=n.newValue;break;default:t[e]=n.newValue}}if(Ot(t),t.active&&a||c){try{Bt("stoping ipfs client due to config changes",r),await nt(o)}catch(e){console.error("[ipfs-companion] Failed to destroy IPFS client",e),i("notify_stopIpfsNodeErrorTitle",e.message)}finally{e=null}if(!t.active)return;try{Bt("starting ipfs client with the new config"),e=await rt(o,t)}catch(e){console.error("[ipfs-companion] Failed to init IPFS client",e),i("notify_startIpfsNodeErrorTitle","ValidationError"===e.name?e.details[0].message:e.message)}L()}s&&(Bt("reloading extension due to config change"),o.tabs.reload(),await o.runtime.reload()),await k()}return{get ipfs(){return e},get state(){return t},get runtime(){return l},get dnslinkResolver(){return r},get ipfsPathValidator(){return n},get notify(){return i},get ipfsImportHandler(){return f},async destroy(){t&&(t.active=!1,t.peerCount=-1),d&&(clearInterval(d),d=null),e&&(await nt(o),e=null)}}}Bt.error=a("ipfs-companion:main:error");const zt=ye((e=>{const t=t=>`/icons/png/${/\/icons\/(.+)\.svg/.exec(e)[1]}_${t}.png`;return{path:{19:t(19),38:t(38),128:t(128)}}}));var jt;o.runtime.onInstalled.addListener((async function(e){"install"===e.reason||e.temporary?await o.storage.local.set({onInstallTasks:"onFirstInstall"}):("update"===e.reason||e.temporary)&&await o.storage.local.set({onInstallTasks:"onVersionUpdate"})})),o.runtime.setUninstallURL((jt=o,B.has(jt.runtime.id)?"https://docs.google.com/forms/d/e/1FAIpQLSfLF7uzaxRKiF4XpPL9_DvkdaQHoRnDihRTZ1uVL6ceQwIrtg/viewform":"")),document.addEventListener("DOMContentLoaded",(async()=>{o.runtime.sendMessage({telemetry:{trackView:"background"}});const e=(await o.storage.local.get({logNamespaces:te.logNamespaces})).logNamespaces;e!==localStorage.debug&&(localStorage.debug=e,window.location.reload()),window.ipfsCompanion=await Vt()}))},64591:(e,t,r)=>{"use strict";r.d(t,{E:()=>c});var n=r(95962),s=r(92634),i=r(13033),o=r(82672);const a=(e,t)=>async function*(){const r=await o(e);yield*r.sort(t)}();class c{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await n(this.putMany(e,r)),e=[],await n(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=s(r,(t=>t.key.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>s(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>a(e,t)),r)),null!=e.offset){let t=0;r=s(r,(()=>t++>=(e.offset||0)))}return null!=e.limit&&(r=i(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=s(r,(t=>t.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>s(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>a(e,t)),r)),null!=e.offset){let t=0;r=s(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=i(r,e.limit)),r}}},6908:(e,t,r)=>{"use strict";r.d(t,{Ed:()=>a.E});var n={};r.r(n),r.d(n,{abortedError:()=>o,notFoundError:()=>i});var s=r(32114);function i(e){return e=e||new Error("Not Found"),s(e,"ERR_NOT_FOUND")}function o(e){return e=e||new Error("Aborted"),s(e,"ERR_ABORTED")}var a=r(64591);const c=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};new Uint8Array(0);class h{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class l{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return d(this,e)}}class u{constructor(e){this.decoders=e}or(e){return d(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const d=(e,t)=>new u({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class f{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new h(e,t,r),this.decoder=new l(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const p=({name:e,prefix:t,encode:r,decode:n})=>new f(e,t,r,n),y=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=c(r,t);return p({prefix:e,name:t,encode:n,decode:e=>(e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")})(s(e))})},g=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>p({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)});g({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),g({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),g({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),g({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),g({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),g({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),g({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),g({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});Math.pow(2,31);Math.pow(2,7),Math.pow(2,14),Math.pow(2,21),Math.pow(2,28),Math.pow(2,35),Math.pow(2,42),Math.pow(2,49),Math.pow(2,56),Math.pow(2,63);y({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),y({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),new WeakMap;class b{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return b.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return b.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return b.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof b)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new b(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return b.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new b(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new b(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return b.create(0,DAG_PB_CODE,e)}static createV1(e,t){return b.create(1,e,t)}static decode(e){const[t,r]=b.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=b.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?b.createV0(i):b.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=b.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID")},53597:(e,t,r)=>{"use strict";async function*n(e,t={}){const r=e.getReader();try{for(;;){const e=await r.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await r.cancel(),r.releaseLock()}}r.d(t,{Z:()=>n})},64936:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>i.D,Jx:()=>s.Jx,WU:()=>i.W,cv:()=>n.cv});var n=r(72696),s=r(61287),i=r(59787)},55580:(e,t,r)=>{"use strict";r.d(t,{Fh:()=>p,Jl:()=>c,Km:()=>l,Tp:()=>y,X0:()=>a,YX:()=>h,Zh:()=>u,cs:()=>d,kj:()=>o,or:()=>i,uN:()=>f});var n=r(59787),s=r(85590);const i=[24,256,65536,4294967296,BigInt("18446744073709551616")];function o(e,t,r){(0,s.DO)(e,t,1);const n=e[t];if(!0===r.strict&&n<i[0])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);return n}function a(e,t,r){(0,s.DO)(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<i[1])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);return n}function c(e,t,r){(0,s.DO)(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<i[2])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);return n}function h(e,t,r){(0,s.DO)(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],a=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===r.strict&&a<i[3])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);if(a<=Number.MAX_SAFE_INTEGER)return Number(a);if(!0===r.allowBigInt)return a;throw new Error(`${s.IR} integers outside of the safe integer range are not supported`)}function l(e,t,r,s){return new n.W(n.D.uint,o(e,t+1,s),2)}function u(e,t,r,s){return new n.W(n.D.uint,a(e,t+1,s),3)}function d(e,t,r,s){return new n.W(n.D.uint,c(e,t+1,s),5)}function f(e,t,r,s){return new n.W(n.D.uint,h(e,t+1,s),9)}function p(e,t){return y(e,0,t.value)}function y(e,t,r){if(r<i[0]){const n=Number(r);e.push([t|n])}else if(r<i[1]){const n=Number(r);e.push([24|t,n])}else if(r<i[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<i[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<i[4]))throw new Error(`${s.IR} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let s=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&s,s>>=8,r[7]=255&s,s>>=8,r[6]=255&s,s>>=8,r[5]=255&s,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,e.push(r)}}}p.encodedSize=function(e){return y.encodedSize(e.value)},y.encodedSize=function(e){return e<i[0]?1:e<i[1]?2:e<i[2]?3:e<i[3]?5:9},p.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}},53929:(e,t,r)=>{"use strict";r.d(t,{UT:()=>d,ec:()=>u,r0:()=>a,wy:()=>c,yr:()=>o});var n=r(59787),s=r(55580),i=r(85590);function o(e,t,r,i){return new n.W(n.D.negint,-1-s.kj(e,t+1,i),2)}function a(e,t,r,i){return new n.W(n.D.negint,-1-s.X0(e,t+1,i),3)}function c(e,t,r,i){return new n.W(n.D.negint,-1-s.Jl(e,t+1,i),5)}const h=BigInt(-1),l=BigInt(1);function u(e,t,r,o){const a=s.YX(e,t+1,o);if("bigint"!=typeof a){const e=-1-a;if(e>=Number.MIN_SAFE_INTEGER)return new n.W(n.D.negint,e,9)}if(!0!==o.allowBigInt)throw new Error(`${i.IR} integers outside of the safe integer range are not supported`);return new n.W(n.D.negint,h-BigInt(a),9)}function d(e,t){const r=t.value,n="bigint"==typeof r?r*h-l:-1*r-1;s.Tp(e,t.type.majorEncoded,n)}d.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*h-l:-1*t-1;return r<s.or[0]?1:r<s.or[1]?2:r<s.or[2]?3:r<s.or[3]?5:9},d.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}},92887:(e,t,r)=>{"use strict";r.d(t,{BS:()=>l,Ii:()=>c,ME:()=>d,UQ:()=>h,hg:()=>p,zU:()=>u});var n=r(59787),s=r(85590),i=r(55580),o=r(22042);function a(e,t,r,i){(0,s.DO)(e,t,r+i);const a=(0,o.tP)(e,t+r,t+r+i);return new n.W(n.D.bytes,a,r+i)}function c(e,t,r,n){return a(e,t,1,r)}function h(e,t,r,n){return a(e,t,2,i.kj(e,t+1,n))}function l(e,t,r,n){return a(e,t,3,i.X0(e,t+1,n))}function u(e,t,r,n){return a(e,t,5,i.Jl(e,t+1,n))}function d(e,t,r,n){const o=i.YX(e,t+1,n);if("bigint"==typeof o)throw new Error(`${s.IR} 64-bit integer bytes lengths not supported`);return a(e,t,9,o)}function f(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===n.D.string?(0,o.mL)(e.value):e.value),e.encodedBytes}function p(e,t){const r=f(t);i.Tp(e,t.type.majorEncoded,r.length),e.push(r)}p.encodedSize=function(e){const t=f(e);return i.Tp.encodedSize(t.length)+t.length},p.compareTokens=function(e,t){return r=f(e),n=f(t),r.length<n.length?-1:r.length>n.length?1:(0,o.qu)(r,n);var r,n}},50768:(e,t,r)=>{"use strict";r.d(t,{Bq:()=>l,YW:()=>p,bc:()=>f,h:()=>u,nt:()=>h,q0:()=>d});var n=r(59787),s=r(85590),i=r(55580),o=r(92887),a=r(22042);function c(e,t,r,i,o){const c=r+i;(0,s.DO)(e,t,c);const h=new n.W(n.D.string,(0,a.BB)(e,t+r,t+c),c);return!0===o.retainStringBytes&&(h.byteValue=(0,a.tP)(e,t+r,t+c)),h}function h(e,t,r,n){return c(e,t,1,r,n)}function l(e,t,r,n){return c(e,t,2,i.kj(e,t+1,n),n)}function u(e,t,r,n){return c(e,t,3,i.X0(e,t+1,n),n)}function d(e,t,r,n){return c(e,t,5,i.Jl(e,t+1,n),n)}function f(e,t,r,n){const o=i.YX(e,t+1,n);if("bigint"==typeof o)throw new Error(`${s.IR} 64-bit integer string lengths not supported`);return c(e,t,9,o,n)}const p=o.hg},8278:(e,t,r)=>{"use strict";r.d(t,{HF:()=>f,Ju:()=>a,OC:()=>h,a8:()=>u,h7:()=>c,lY:()=>l,s5:()=>d});var n=r(59787),s=r(55580),i=r(85590);function o(e,t,r,s){return new n.W(n.D.array,s,r)}function a(e,t,r,n){return o(0,0,1,r)}function c(e,t,r,n){return o(0,0,2,s.kj(e,t+1,n))}function h(e,t,r,n){return o(0,0,3,s.X0(e,t+1,n))}function l(e,t,r,n){return o(0,0,5,s.Jl(e,t+1,n))}function u(e,t,r,n){const a=s.YX(e,t+1,n);if("bigint"==typeof a)throw new Error(`${i.IR} 64-bit integer array lengths not supported`);return o(0,0,9,a)}function d(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${i.IR} indefinite length items not allowed`);return o(0,0,1,1/0)}function f(e,t){s.Tp(e,n.D.array.majorEncoded,t.value)}f.compareTokens=s.Fh.compareTokens,f.encodedSize=function(e){return s.Tp.encodedSize(e.value)}},59283:(e,t,r)=>{"use strict";r.d(t,{F2:()=>u,G:()=>c,IY:()=>l,KI:()=>f,_K:()=>a,ng:()=>d,qe:()=>h});var n=r(59787),s=r(55580),i=r(85590);function o(e,t,r,s){return new n.W(n.D.map,s,r)}function a(e,t,r,n){return o(0,0,1,r)}function c(e,t,r,n){return o(0,0,2,s.kj(e,t+1,n))}function h(e,t,r,n){return o(0,0,3,s.X0(e,t+1,n))}function l(e,t,r,n){return o(0,0,5,s.Jl(e,t+1,n))}function u(e,t,r,n){const a=s.YX(e,t+1,n);if("bigint"==typeof a)throw new Error(`${i.IR} 64-bit integer map lengths not supported`);return o(0,0,9,a)}function d(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${i.IR} indefinite length items not allowed`);return o(0,0,1,1/0)}function f(e,t){s.Tp(e,n.D.map.majorEncoded,t.value)}f.compareTokens=s.Fh.compareTokens,f.encodedSize=function(e){return s.Tp.encodedSize(e.value)}},82428:(e,t,r)=>{"use strict";r.d(t,{CF:()=>a,MV:()=>h,ZR:()=>o,qJ:()=>i,vP:()=>c,xy:()=>l});var n=r(59787),s=r(55580);function i(e,t,r,s){return new n.W(n.D.tag,r,1)}function o(e,t,r,i){return new n.W(n.D.tag,s.kj(e,t+1,i),2)}function a(e,t,r,i){return new n.W(n.D.tag,s.X0(e,t+1,i),3)}function c(e,t,r,i){return new n.W(n.D.tag,s.Jl(e,t+1,i),5)}function h(e,t,r,i){return new n.W(n.D.tag,s.YX(e,t+1,i),9)}function l(e,t){s.Tp(e,n.D.tag.majorEncoded,t.value)}l.compareTokens=s.Fh.compareTokens,l.encodedSize=function(e){return s.Tp.encodedSize(e.value)}},73851:(e,t,r)=>{"use strict";r.d(t,{GI:()=>l,h1:()=>o,mW:()=>h,tA:()=>d,vV:()=>u,y7:()=>a});var n=r(59787),s=r(85590),i=r(55580);function o(e,t,r,i){if(!1===i.allowUndefined)throw new Error(`${s.IR} undefined values are not supported`);return!0===i.coerceUndefinedToNull?new n.W(n.D.null,null,1):new n.W(n.D.undefined,void 0,1)}function a(e,t,r,i){if(!1===i.allowIndefinite)throw new Error(`${s.IR} indefinite length items not allowed`);return new n.W(n.D.break,void 0,1)}function c(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${s.IR} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${s.IR} Infinity values are not supported`)}return new n.W(n.D.float,e,t)}function h(e,t,r,n){return c(b(e,t+1),3,n)}function l(e,t,r,n){return c(w(e,t+1),5,n)}function u(e,t,r,n){return c(v(e,t+1),9,n)}function d(e,t,r){const s=t.value;if(!1===s)e.push([20|n.D.float.majorEncoded]);else if(!0===s)e.push([21|n.D.float.majorEncoded]);else if(null===s)e.push([22|n.D.float.majorEncoded]);else if(void 0===s)e.push([23|n.D.float.majorEncoded]);else{let t,n=!1;r&&!0===r.float64||(g(s),t=b(y,1),s===t||Number.isNaN(s)?(y[0]=249,e.push(y.slice(0,3)),n=!0):(m(s),t=w(y,1),s===t&&(y[0]=250,e.push(y.slice(0,5)),n=!0))),n||(i=s,p.setFloat64(0,i,!1),t=v(y,1),y[0]=251,e.push(y.slice(0,9)))}var i}d.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){g(r);let e=b(y,1);if(r===e||Number.isNaN(r))return 3;if(m(r),e=w(y,1),r===e)return 5}return 9};const f=new ArrayBuffer(9),p=new DataView(f,1),y=new Uint8Array(f,0);function g(e){if(e===1/0)p.setUint16(0,31744,!1);else if(e===-1/0)p.setUint16(0,64512,!1);else if(Number.isNaN(e))p.setUint16(0,32256,!1);else{p.setFloat32(0,e);const t=p.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)p.setUint16(0,31744,!1);else if(0===r)p.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?p.setUint16(0,0):e<-14?p.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):p.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function b(e,t){if(e.length-t<2)throw new Error(`${s.IR} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,i=1023&r;let o;return o=0===n?i*2**-24:31!==n?(i+1024)*2**(n-25):0===i?1/0:NaN,32768&r?-o:o}function m(e){p.setFloat32(0,e,!1)}function w(e,t){if(e.length-t<4)throw new Error(`${s.IR} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function v(e,t){if(e.length-t<8)throw new Error(`${s.IR} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}d.compareTokens=i.Fh.compareTokens},22042:(e,t,r)=>{"use strict";r.d(t,{BB:()=>c,Dz:()=>a,Pu:()=>b,mL:()=>h,nI:()=>l,qu:()=>p,tP:()=>u,un:()=>f,zo:()=>d});const n=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,s=new TextDecoder,i=new TextEncoder;function o(e){return n&&globalThis.Buffer.isBuffer(e)}function a(e){return e instanceof Uint8Array?o(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const c=n?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):g(e,t,r):(e,t,r)=>r-t>64?s.decode(e.subarray(t,r)):g(e,t,r),h=n?e=>e.length>64?globalThis.Buffer.from(e):y(e):e=>e.length>64?i.encode(e):y(e),l=e=>Uint8Array.from(e),u=n?(e,t,r)=>o(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),d=n?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),a(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},f=n?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function p(e,t){if(o(e)&&o(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function y(e,t=1/0){let r;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function g(e,t,r){const n=[];for(;t<r;){const s=e[t];let i=null,o=s>239?4:s>223?3:s>191?2:1;if(t+o<=r){let r,n,a,c;switch(o){case 1:s<128&&(i=s);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&s)<<6|63&r,c>127&&(i=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&s)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&s)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),t+=o}return b(n)}function b(e){const t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}},85590:(e,t,r)=>{"use strict";r.d(t,{DO:()=>o,IR:()=>n,OO:()=>s});const n="CBOR decode error:",s="CBOR encode error:",i=[];function o(e,t,r){if(e.length-t<r)throw new Error(`${n} not enough data for type`)}i[23]=1,i[24]=2,i[25]=3,i[26]=5,i[27]=9},61287:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>u});var n=r(85590),s=r(59787),i=r(53741);const o={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class a{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=i.PS[e];if(void 0===t){const r=i.cW[e];if(!r)throw new Error(`${n.IR} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const s=31&e;t=r(this.data,this.pos,s,this.options)}return this.pos+=t.encodedLength,t}}const c=Symbol.for("DONE"),h=Symbol.for("BREAK");function l(e,t){if(e.done())return c;const r=e.next();if(r.type===s.D.break)return h;if(r.type.terminal)return r.value;if(r.type===s.D.array)return function(e,t,r){const s=[];for(let i=0;i<e.value;i++){const o=l(t,r);if(o===h){if(e.value===1/0)break;throw new Error(`${n.IR} got unexpected break to lengthed array`)}if(o===c)throw new Error(`${n.IR} found array but not enough entries (got ${i}, expected ${e.value})`);s[i]=o}return s}(r,e,t);if(r.type===s.D.map)return function(e,t,r){const s=!0===r.useMaps,i=s?void 0:{},o=s?new Map:void 0;for(let a=0;a<e.value;a++){const u=l(t,r);if(u===h){if(e.value===1/0)break;throw new Error(`${n.IR} got unexpected break to lengthed map`)}if(u===c)throw new Error(`${n.IR} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(!0!==s&&"string"!=typeof u)throw new Error(`${n.IR} non-string keys not supported (got ${typeof u})`);const d=l(t,r);if(d===c)throw new Error(`${n.IR} found map but not enough entries (got ${a} [no value], expected ${e.value})`);s?o.set(u,d):i[u]=d}return s?o:i}(r,e,t);if(r.type===s.D.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=l(e,t);return t.tags[r.value](n)}throw new Error(`${n.IR} tag not supported (${r.value})`)}throw new Error("unsupported")}function u(e,t){if(!(e instanceof Uint8Array))throw new Error(`${n.IR} data to decode must be a Uint8Array`);const r=(t=Object.assign({},o,t)).tokenizer||new a(e,t),s=l(r,t);if(s===c)throw new Error(`${n.IR} did not find any content to decode`);if(s===h)throw new Error(`${n.IR} got unexpected break`);if(!r.done())throw new Error(`${n.IR} too many terminals, data makes no sense`);return s}},72696:(e,t,r)=>{"use strict";r.d(t,{cv:()=>T,w$:()=>I});const n=["string","number","bigint","symbol"],s=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function i(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(n.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(s.includes(t))return t;return}(e);return r||"Object"}var o=r(59787),a=r(22042);class c{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=(0,a.un)(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=(0,a.tP)(r,0,this.cursor)}else t=(0,a.zo)(this.chunks,this.cursor);return e&&this.reset(),t}}var h=r(85590),l=r(53741),u=r(55580),d=r(53929),f=r(92887),p=r(50768),y=r(8278),g=r(59283),b=r(82428),m=r(73851);const w={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const s=r.type.major,i=v[s].compareTokens(r,n);0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return i},quickEncodeToken:l.JN};const v=function(){const e=[];return e[o.D.uint.major]=u.Fh,e[o.D.negint.major]=d.UT,e[o.D.bytes.major]=f.hg,e[o.D.string.major]=p.YW,e[o.D.array.major]=y.HF,e[o.D.map.major]=g.KI,e[o.D.tag.major]=b.xy,e[o.D.float.major]=m.tA,e}(),E=new c;class A{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${h.OO} object contains circular references`);return new A(t,e)}}const S={null:new o.W(o.D.null,null),undefined:new o.W(o.D.undefined,void 0),true:new o.W(o.D.true,!0),false:new o.W(o.D.false,!1),emptyArray:new o.W(o.D.array,0),emptyMap:new o.W(o.D.map,0)},_={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?e>=0?new o.W(o.D.uint,e):new o.W(o.D.negint,e):new o.W(o.D.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new o.W(o.D.uint,e):new o.W(o.D.negint,e),Uint8Array:(e,t,r,n)=>new o.W(o.D.bytes,e),string:(e,t,r,n)=>new o.W(o.D.string,e),boolean:(e,t,r,n)=>e?S.true:S.false,null:(e,t,r,n)=>S.null,undefined:(e,t,r,n)=>S.undefined,ArrayBuffer:(e,t,r,n)=>new o.W(o.D.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new o.W(o.D.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[S.emptyArray,new o.W(o.D.break)]:S.emptyArray;n=A.createCheck(n,e);const s=[];let i=0;for(const t of e)s[i++]=C(t,r,n);return r.addBreakTokens?[new o.W(o.D.array,e.length),s,new o.W(o.D.break)]:[new o.W(o.D.array,e.length),s]},Object(e,t,r,n){const s="Object"!==t,i=s?e.keys():Object.keys(e),a=s?e.size:i.length;if(!a)return!0===r.addBreakTokens?[S.emptyMap,new o.W(o.D.break)]:S.emptyMap;n=A.createCheck(n,e);const c=[];let h=0;for(const t of i)c[h++]=[C(t,r,n),C(s?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(c,r),r.addBreakTokens?[new o.W(o.D.map,a),c,new o.W(o.D.break)]:[new o.W(o.D.map,a),c]}};_.Map=_.Object,_.Buffer=_.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))_[`${e}Array`]=_.DataView;function C(e,t={},r){const n=i(e),s=t&&t.typeEncoders&&t.typeEncoders[n]||_[n];if("function"==typeof s){const i=s(e,n,t,r);if(null!=i)return i}const o=_[n];if(!o)throw new Error(`${h.OO} unsupported type: ${n}`);return o(e,n,t,r)}function k(e,t,r,n){if(Array.isArray(t))for(const s of t)k(e,s,r,n);else r[t.type.major](e,t,n)}function I(e,t,r){const n=C(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const s=t[n.type.major];if(s.encodedSize){const e=s.encodedSize(n,r),t=new c(e);if(s(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return(0,a.Dz)(t.chunks[0])}}return E.reset(),k(E,n,t,r),E.toBytes(!0)}function T(e,t){return t=Object.assign({},w,t),I(e,v,t)}},53741:(e,t,r)=>{"use strict";r.d(t,{JN:()=>m,PS:()=>b,cW:()=>g});var n=r(59787),s=r(55580),i=r(53929),o=r(92887),a=r(50768),c=r(8278),h=r(59283),l=r(82428),u=r(73851),d=r(85590),f=r(22042);function p(e,t,r){throw new Error(`${d.IR} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function y(e){return()=>{throw new Error(`${d.IR} ${e}`)}}const g=[];for(let e=0;e<=23;e++)g[e]=p;g[24]=s.Km,g[25]=s.Zh,g[26]=s.cs,g[27]=s.uN,g[28]=p,g[29]=p,g[30]=p,g[31]=p;for(let e=32;e<=55;e++)g[e]=p;g[56]=i.yr,g[57]=i.r0,g[58]=i.wy,g[59]=i.ec,g[60]=p,g[61]=p,g[62]=p,g[63]=p;for(let e=64;e<=87;e++)g[e]=o.Ii;g[88]=o.UQ,g[89]=o.BS,g[90]=o.zU,g[91]=o.ME,g[92]=p,g[93]=p,g[94]=p,g[95]=y("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)g[e]=a.nt;g[120]=a.Bq,g[121]=a.h,g[122]=a.q0,g[123]=a.bc,g[124]=p,g[125]=p,g[126]=p,g[127]=y("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)g[e]=c.Ju;g[152]=c.h7,g[153]=c.OC,g[154]=c.lY,g[155]=c.a8,g[156]=p,g[157]=p,g[158]=p,g[159]=c.s5;for(let e=160;e<=183;e++)g[e]=h._K;g[184]=h.G,g[185]=h.qe,g[186]=h.IY,g[187]=h.F2,g[188]=p,g[189]=p,g[190]=p,g[191]=h.ng;for(let e=192;e<=215;e++)g[e]=l.qJ;g[216]=l.ZR,g[217]=l.CF,g[218]=l.vP,g[219]=l.MV,g[220]=p,g[221]=p,g[222]=p,g[223]=p;for(let e=224;e<=243;e++)g[e]=y("simple values are not supported");g[244]=p,g[245]=p,g[246]=p,g[247]=u.h1,g[248]=y("simple values are not supported"),g[249]=u.mW,g[250]=u.GI,g[251]=u.vV,g[252]=p,g[253]=p,g[254]=p,g[255]=u.y7;const b=[];for(let e=0;e<24;e++)b[e]=new n.W(n.D.uint,e,1);for(let e=-1;e>=-24;e--)b[31-e]=new n.W(n.D.negint,e,1);function m(e){switch(e.type){case n.D.false:return(0,f.nI)([244]);case n.D.true:return(0,f.nI)([245]);case n.D.null:return(0,f.nI)([246]);case n.D.bytes:return e.value.length?void 0:(0,f.nI)([64]);case n.D.string:return""===e.value?(0,f.nI)([96]):void 0;case n.D.array:return 0===e.value?(0,f.nI)([128]):void 0;case n.D.map:return 0===e.value?(0,f.nI)([160]):void 0;case n.D.uint:return e.value<24?(0,f.nI)([Number(e.value)]):void 0;case n.D.negint:if(e.value>=-24)return(0,f.nI)([31-Number(e.value)])}}b[64]=new n.W(n.D.bytes,new Uint8Array(0),1),b[96]=new n.W(n.D.string,"",1),b[128]=new n.W(n.D.array,0,1),b[160]=new n.W(n.D.map,0,1),b[244]=new n.W(n.D.false,!1,1),b[245]=new n.W(n.D.true,!0,1),b[246]=new n.W(n.D.null,null,1)},59787:(e,t,r)=>{"use strict";r.d(t,{D:()=>n,W:()=>s});class n{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}n.uint=new n(0,"uint",!0),n.negint=new n(1,"negint",!0),n.bytes=new n(2,"bytes",!0),n.string=new n(3,"string",!0),n.array=new n(4,"array",!1),n.map=new n(5,"map",!1),n.tag=new n(6,"tag",!1),n.float=new n(7,"float",!0),n.false=new n(7,"false",!0),n.true=new n(7,"true",!0),n.null=new n(7,"null",!0),n.undefined=new n(7,"undefined",!0),n.break=new n(7,"break",!0);class s{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}},46392:(e,t,r)=>{"use strict";r.r(t),r.d(t,{code:()=>Q,decode:()=>re,encode:()=>te,name:()=>Y,toGeneral:()=>ee});const n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}},s=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class i{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class o{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i(e,t,r),this.decoder=new o(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),u=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:o}=n(r,t);return l({prefix:e,name:t,encode:i,decode:e=>s(o(e))})},d=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),f=(d({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),d({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}));d({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function p(e){return f.encode(e).slice(1)}function y(e){return f.decode(`u${e}`)}var g=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=b;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},b=Math.pow(2,31);var m=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var w=Math.pow(2,7),v=Math.pow(2,14),E=Math.pow(2,21),A=Math.pow(2,28),S=Math.pow(2,35),_=Math.pow(2,42),C=Math.pow(2,49),k=Math.pow(2,56),I=Math.pow(2,63);const T={encode:g,decode:m,encodingLength:function(e){return e<w?1:e<v?2:e<E?3:e<A?4:e<S?5:e<_?6:e<C?7:e<k?8:e<I?9:10}},x=(e,t=0)=>[T.decode(e,t),T.decode.bytes],R=(e,t,r=0)=>(T.encode(e,t,r),t),P=e=>T.encodingLength(e);class D{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const O=u({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),N=(u({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),d({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),L=(d({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),d({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),d({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),d({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),d({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),d({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),d({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),U=e=>{const t=L.get(e);if(null==t){const t=new Map;return L.set(e,t),t}return t};class B{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==j)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==F)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return B.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=P(e),s=n+P(r),i=new Uint8Array(s+r);return R(e,i,0),R(r,i,n),i.set(t,s),new D(e,r,t,i)})(e,t);return B.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return B.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?V(r,U(e),t||O.encoder):z(r,U(e),t||N.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof B)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new B(e,r,n,s||$(e,r,n.bytes))}if(!0===t[q]){const{version:e,multihash:r,code:n}=t,i=(e=>{const t=s(e),[r,n]=x(t),[i,o]=x(t.subarray(n)),a=t.subarray(n+o);if(a.byteLength!==i)throw new Error("Incorrect length");return new D(r,i,a,t)})(r);return B.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==j)throw new Error(`Version 0 CID must use dag-pb (code: ${j}) block encoding`);return new B(e,t,r,r.bytes);case 1:{const n=$(e,t,r.bytes);return new B(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return B.create(0,j,e)}static createV1(e,t){return B.create(1,e,t)}static decode(e){const[t,r]=B.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=B.inspectBytes(e),r=t.size-t.multihashSize,n=s(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new D(t.multihashCode,t.digestSize,i,n);return[0===t.version?B.createV0(o):B.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=x(e.subarray(t));return t+=n,r};let n=r(),s=j;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=M(e,t),s=B.decode(n);return U(s).set(r,e),s}}const M=(e,t)=>{switch(e[0]){case"Q":{const r=t||O;return[O.prefix,r.decode(`${O.prefix}${e}`)]}case O.prefix:{const r=t||O;return[O.prefix,r.decode(e)]}case N.prefix:{const r=t||N;return[N.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},V=(e,t,r)=>{const{prefix:n}=r;if(n!==O.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},z=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},j=112,F=18,$=(e,t,r)=>{const n=P(e),s=n+P(t),i=new Uint8Array(s+r.byteLength);return R(e,i,0),R(t,i,n),i.set(r,s),i},q=Symbol.for("@ipld/js-cid/CID");function K(e){const t={signature:y(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=y(e.protected)),t}function H(e){const t={signature:p(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=p(e.protected)),t}function G(e){const t={};return e.encrypted_key&&(t.encrypted_key=y(e.encrypted_key)),e.header&&(t.header=e.header),t}function W(e){const t={};return e.encrypted_key&&(t.encrypted_key=p(e.encrypted_key)),e.header&&(t.header=e.header),t}var J=r(34219);const Y="dag-jose",Q=133;function Z(e){return"payload"in e&&"string"==typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function X(e){return"ciphertext"in e&&"string"==typeof e.ciphertext&&"iv"in e&&"string"==typeof e.iv&&"protected"in e&&"string"==typeof e.protected&&"tag"in e&&"string"==typeof e.tag}function ee(e){if("string"==typeof e){const t=e.split(".");if(3===t.length)return function(e){const[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:B.decode(y(r))}}(t);if(5===t.length)return function(e){const[t,r,n,s,i]=e,o={ciphertext:s,iv:n,protected:t,tag:i};return r&&(o.recipients=[{encrypted_key:r}]),o}(t);throw new Error("Not a valid JOSE string")}if(Z(e)||X(e))return e;throw new Error("Not a valid unencoded JOSE object")}function te(e){let t;if("string"==typeof e&&(e=ee(e)),Z(e))t=function(e){const t=y(e.payload);try{B.decode(t)}catch(e){throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(K)}}(e);else{if(!X(e))throw new Error("Not a valid JOSE object");t=function(e){const t={ciphertext:y(e.ciphertext),protected:y(e.protected),iv:y(e.iv),tag:y(e.tag)};return e.aad&&(t.aad=y(e.aad)),e.recipients&&(t.recipients=e.recipients.map(G)),e.unprotected&&(t.unprotected=e.unprotected),t}(e)}return new Uint8Array(J.encode(t))}function re(e){let t;try{t=J.decode(e)}catch(e){throw new Error("Not a valid DAG-JOSE object")}if("payload"in(r=t)&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures))return function(e){const t={payload:p(e.payload),signatures:e.signatures.map(H)};return t.link=B.decode(new Uint8Array(e.payload)),t}(t);if(function(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}(t))return function(e){const t={ciphertext:p(e.ciphertext),protected:p(e.protected),iv:p(e.iv),tag:p(e.tag)};return e.aad&&(t.aad=p(e.aad)),e.recipients&&(t.recipients=e.recipients.map(W)),e.unprotected&&(t.unprotected=e.unprotected),t}(t);throw new Error("Not a valid DAG-JOSE object");var r}},64067:(e,t,r)=>{"use strict";r.d(t,{e:()=>a});var n=r(91549),s=r(9756),i=r(24162),o=r(59481);class a{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,r){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:r,value:n}of e)await this.put(r,n,t),yield{key:r,value:n}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}async*deleteMany(e,t={}){for await(const r of e)await this.delete(r,t),yield r}batch(){let e=[],t=[];return{put(t,r){e.push({key:t,value:r})},delete(e){t.push(e)},commit:async r=>{await s(this.putMany(e,r)),e=[],await s(this.deleteMany(t,r)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let r=this._all(e,t);if(null!=e.prefix&&(r=i(r,(t=>t.key.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>i(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>(0,n.W)(e,t)),r)),null!=e.offset){let t=0;r=i(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=o(r,e.limit)),r}queryKeys(e,t){let r=this._allKeys(e,t);if(null!=e.prefix&&(r=i(r,(t=>t.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(r=e.filters.reduce(((e,t)=>i(e,t)),r)),Array.isArray(e.orders)&&(r=e.orders.reduce(((e,t)=>(0,n.W)(e,t)),r)),null!=e.offset){let t=0;r=i(r,(()=>t++>=e.offset))}return null!=e.limit&&(r=o(r,e.limit)),r}}},40668:(e,t,r)=>{"use strict";r.r(t),r.d(t,{abortedError:()=>c,dbDeleteFailedError:()=>i,dbOpenFailedError:()=>s,dbWriteFailedError:()=>o,notFoundError:()=>a});var n=r(32114);function s(e){return e=e||new Error("Cannot open database"),n(e,"ERR_DB_OPEN_FAILED")}function i(e){return e=e||new Error("Delete failed"),n(e,"ERR_DB_DELETE_FAILED")}function o(e){return e=e||new Error("Write failed"),n(e,"ERR_DB_WRITE_FAILED")}function a(e){return e=e||new Error("Not Found"),n(e,"ERR_NOT_FOUND")}function c(e){return e=e||new Error("Aborted"),n(e,"ERR_ABORTED")}},78602:(e,t,r)=>{"use strict";r.d(t,{eF:()=>i.e,D1:()=>n});var n=r(40668);r(42837);const s="SHARDING";var i=r(64067);r(85404),r(9673),r(88211);var o=r(64348);new o.s(s),new o.s("_README");r(24162),r(59481),r(65612),r(91549);r(97947)},85404:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});var n=r(64067),s=r(42837),i=r(40668);class o extends n.e{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw i.notFoundError();return this.data[e.toString()]}async has(e){return void 0!==this.data[e.toString()]}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map((([e,t])=>({key:new s.s(e),value:t})))}async*_allKeys(){yield*Object.entries(this.data).map((([e])=>new s.s(e)))}}},97947:(e,t,r)=>{"use strict";r.d(t,{z:()=>h});var n=r(64067),s=r(40668),i=r(38461),o=r(37430),a=r(9756);const c=(0,i.kg)("datastore:core:tiered");class h extends n.e{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map((e=>e.open())))}catch(e){throw s.dbOpenFailedError()}}async put(e,t,r){try{await Promise.all(this.stores.map((n=>n.put(e,t,r))))}catch(e){throw s.dbWriteFailedError()}}async get(e,t){for(const r of this.stores)try{const n=await r.get(e,t);if(n)return n}catch(e){c.error(e)}throw s.notFoundError()}async has(e,t){for(const r of this.stores)if(await r.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map((r=>r.delete(e,t))))}catch(e){throw s.dbDeleteFailedError()}}async*putMany(e,t={}){let r;const n=this.stores.map((e=>{const n=(0,o.d)({objectMode:!0});return a(e.putMany(n,t)).catch((e=>{r=e})),n}));try{for await(const t of e){if(r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}async*deleteMany(e,t={}){let r;const n=this.stores.map((e=>{const n=(0,o.d)({objectMode:!0});return a(e.deleteMany(n,t)).catch((e=>{r=e})),n}));try{for await(const t of e){if(r)throw r;n.forEach((e=>e.push(t))),yield t}}finally{n.forEach((e=>e.end()))}}async close(){await Promise.all(this.stores.map((e=>e.close())))}batch(){const e=this.stores.map((e=>e.batch()));return{put:(t,r)=>{e.forEach((e=>e.put(t,r)))},delete:t=>{e.forEach((e=>e.delete(t)))},commit:async t=>{for(const r of e)await r.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}},91549:(e,t,r)=>{"use strict";r.d(t,{W:()=>s});var n=r(56090);const s=(e,t)=>async function*(){const r=await n(e);yield*r.sort(t)}()},26091:(e,t,r)=>{"use strict";r.d(t,{R:()=>Qe});var n={};r.r(n),r.d(n,{identity:()=>P});var s={};r.r(s),r.d(s,{base2:()=>D});var i={};r.r(i),r.d(i,{base8:()=>O});var o={};r.r(o),r.d(o,{base10:()=>N});var a={};r.r(a),r.d(a,{base16:()=>L,base16upper:()=>U});var c={};r.r(c),r.d(c,{base32:()=>B,base32hex:()=>j,base32hexpad:()=>$,base32hexpadupper:()=>q,base32hexupper:()=>F,base32pad:()=>V,base32padupper:()=>z,base32upper:()=>M,base32z:()=>K});var h={};r.r(h),r.d(h,{base36:()=>H,base36upper:()=>G});var l={};r.r(l),r.d(l,{base58btc:()=>W,base58flickr:()=>J});var u={};r.r(u),r.d(u,{base64:()=>Y,base64pad:()=>Q,base64url:()=>Z,base64urlpad:()=>X});var d={};r.r(d),r.d(d,{base256emoji:()=>ne});var f={};r.r(f),r.d(f,{sha256:()=>_e,sha512:()=>Ce});var p={};r.r(p),r.d(p,{identity:()=>Ie});var y={};r.r(y),r.d(y,{code:()=>xe,decode:()=>Pe,encode:()=>Re,name:()=>Te});var g={};r.r(g),r.d(g,{code:()=>Le,decode:()=>Be,encode:()=>Ue,name:()=>Ne});var b=r(64348),m=r(78602),w=r(32114);var v=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const E=v,A=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class S{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return k(this,e)}}class C{constructor(e){this.decoders=e}or(e){return k(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const k=(e,t)=>new C({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class I{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new S(e,t,r),this.decoder=new _(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const T=({name:e,prefix:t,encode:r,decode:n})=>new I(e,t,r,n),x=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=E(r,t);return T({prefix:e,name:t,encode:n,decode:e=>A(s(e))})},R=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>T({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),P=T({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),D=R({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),O=R({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),N=x({prefix:"9",name:"base10",alphabet:"0123456789"}),L=R({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),U=R({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),B=R({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M=R({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),V=R({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),z=R({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j=R({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),F=R({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$=R({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),q=R({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),K=R({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),H=x({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),G=x({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),W=x({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),J=x({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Y=R({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Q=R({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Z=R({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),X=R({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ee=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),te=ee.reduce(((e,t,r)=>(e[r]=t,e)),[]),re=ee.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const ne=T({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=te[t]),"")},decode:function(e){const t=[];for(const r of e){const e=re[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var se=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ie;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ie=Math.pow(2,31);var oe=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var ae=Math.pow(2,7),ce=Math.pow(2,14),he=Math.pow(2,21),le=Math.pow(2,28),ue=Math.pow(2,35),de=Math.pow(2,42),fe=Math.pow(2,49),pe=Math.pow(2,56),ye=Math.pow(2,63);const ge={encode:se,decode:oe,encodingLength:function(e){return e<ae?1:e<ce?2:e<he?3:e<le?4:e<ue?5:e<de?6:e<fe?7:e<pe?8:e<ye?9:10}},be=(e,t,r=0)=>(ge.encode(e,t,r),t),me=e=>ge.encodingLength(e),we=(e,t)=>{const r=t.byteLength,n=me(e),s=n+me(r),i=new Uint8Array(s+r);return be(e,i,0),be(r,i,n),i.set(t,s),new ve(e,r,t,i)};class ve{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Ee=({name:e,code:t,encode:r})=>new Ae(e,t,r);class Ae{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?we(this.code,t):t.then((e=>we(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Se=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),_e=Ee({name:"sha2-256",code:18,encode:Se("SHA-256")}),Ce=Ee({name:"sha2-512",code:19,encode:Se("SHA-512")}),ke=A,Ie={code:0,name:"identity",encode:ke,digest:e=>we(0,ke(e))},Te="raw",xe=85,Re=e=>A(e),Pe=e=>A(e),De=new TextEncoder,Oe=new TextDecoder,Ne="json",Le=512,Ue=e=>De.encode(JSON.stringify(e)),Be=e=>JSON.parse(Oe.decode(e));new WeakMap;class Me{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Me.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Me.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Me.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Me)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Me(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Me.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Me(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Me(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Me.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Me.create(1,e,t)}static decode(e){const[t,r]=Me.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Me.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Me.createV0(i):Me.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Me.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Ve={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function ze(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function je(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Fe=je("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),$e=je("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?ze(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),qe={utf8:Fe,"utf-8":Fe,hex:Ve.base16,latin1:$e,ascii:$e,binary:$e,...Ve};function Ke(e,t="utf8"){const r=qe[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function He(e,t="utf8"){const r=qe[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):ze(globalThis.Buffer.from(e,"utf-8"))}const Ge="/record/";function We(e){return Ke(e,"base32")}function Je(e){("string"==typeof e||e instanceof String)&&(e=He(e.toString()));return`/record/${Ke(e,"base64url")}`}const Ye=(0,r(38461).kg)("datastore-pubsub:publisher");class Qe extends m.eF{constructor(e,t,r,n,s,i){if(super(),!n)throw w(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if("function"!=typeof n)throw w(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if("function"!=typeof s)throw w(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(i&&"function"!=typeof i)throw w(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=r,this._validator=n,this._selector=s,this._handleSubscriptionKeyFn=i,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,t,r){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw Ye.error(e),w(new Error(e),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const e="received value is not a Uint8Array";throw Ye.error(e),w(new Error(e),"ERR_INVALID_VALUE_RECEIVED")}const n=Je(e);Ye(`publish value for topic ${n}`),await this._pubsub.publish(n,t)}async get(e,t){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw Ye.error(e),w(new Error(e),"ERR_INVALID_DATASTORE_KEY")}const r=Je(e),n=await this._pubsub.getTopics();if(n&&Array.isArray(n)&&n.indexOf(r)>-1)return this._getLocal(e,t);try{await this._pubsub.subscribe(r)}catch(e){const t=`cannot subscribe topic ${r}`;throw Ye.error(t),w(new Error(t),"ERR_SUBSCRIBING_TOPIC")}return Ye(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){const t=Je(e);return this._pubsub.unsubscribe(t)}async _getLocal(e,t){const r=new b.s("/"+We(e),!1);let n;try{n=await this._datastore.get(r,t)}catch(e){if("ERR_NOT_FOUND"!==e.code){const e=`unexpected error getting the ipns record for ${r.toString()}`;throw Ye.error(e),w(new Error(e),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const t=`local record requested was not found for ${r.toString()}`;throw Ye.error(t),w(new Error(t),"ERR_NOT_FOUND")}if(!(n instanceof Uint8Array)){const e="found record that we couldn't convert to a value";throw Ye.error(e),w(new Error(e),"ERR_INVALID_RECORD_RECEIVED")}return n}async _onMessage(e){const t=e.detail;if("signed"!==t.type)return void Ye.error("unsigned message received, this module can only work with signed messages");const{data:r,from:n,topic:s}=t;let i;try{i=function(e){if(e.substring(0,Ge.length)!==Ge)throw w(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");return He(e.substring(Ge.length),"base64url")}(s)}catch(e){return void Ye.error(e)}if(Ye(`message received for topic ${s}`),this._peerId.equals(n))Ye("message discarded as it is from the same peer");else{if(this._handleSubscriptionKeyFn){let e;try{e=await this._handleSubscriptionKeyFn(i)}catch(e){return void Ye.error("message discarded by the subscriptionKeyFn")}i=e}try{await this._storeIfSubscriptionIsBetter(i,r)}catch(e){Ye.error(e)}}}async _storeIfSubscriptionIsBetter(e,t,r){let n=!1;try{n=await this._isBetter(e,t)}catch(e){if("ERR_NOT_VALID_RECORD"!==e.code)throw e}n&&await this._storeRecord(e,t,r)}async _validateRecord(e,t){return this._validator(e,t)}async _selectRecord(e,t){return 0===await this._selector(e,t)}async _isBetter(e,t){try{await this._validateRecord(e,t)}catch(e){const t="record received through pubsub is not valid";throw Ye.error(t),w(new Error(t),"ERR_NOT_VALID_RECORD")}const r=new b.s(e);let n;try{n=await this._getLocal(r.uint8Array())}catch(e){return!0}return!function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(n,t)&&this._selectRecord(e,[n,t])}async _storeRecord(e,t,r){const n=new b.s("/"+We(e),!1);await this._datastore.put(n,t,r),Ye(`record for ${Je(e)} was stored in the datastore`)}}},52090:(e,t,r)=>{"use strict";r.d(t,{r:()=>qe,$:()=>et});var n={};r.r(n),r.d(n,{identity:()=>x});var s={};r.r(s),r.d(s,{base2:()=>R});var i={};r.r(i),r.d(i,{base8:()=>P});var o={};r.r(o),r.d(o,{base10:()=>D});var a={};r.r(a),r.d(a,{base16:()=>O,base16upper:()=>N});var c={};r.r(c),r.d(c,{base32:()=>L,base32hex:()=>V,base32hexpad:()=>j,base32hexpadupper:()=>F,base32hexupper:()=>z,base32pad:()=>B,base32padupper:()=>M,base32upper:()=>U,base32z:()=>$});var h={};r.r(h),r.d(h,{base36:()=>q,base36upper:()=>K});var l={};r.r(l),r.d(l,{base58btc:()=>H,base58flickr:()=>G});var u={};r.r(u),r.d(u,{base64:()=>W,base64pad:()=>J,base64url:()=>Y,base64urlpad:()=>Q});var d={};r.r(d),r.d(d,{base256emoji:()=>te});var f={};r.r(f),r.d(f,{sha256:()=>Ae,sha512:()=>Se});var p={};r.r(p),r.d(p,{identity:()=>Ce});var y={};r.r(y),r.d(y,{code:()=>Ie,decode:()=>xe,encode:()=>Te,name:()=>ke});var g={};r.r(g),r.d(g,{code:()=>Oe,decode:()=>Le,encode:()=>Ne,name:()=>De});var b=r(20544);var m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const w=m,v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class E{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _(this,e)}}class S{constructor(e){this.decoders=e}or(e){return _(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _=(e,t)=>new S({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class C{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new E(e,t,r),this.decoder=new A(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const k=({name:e,prefix:t,encode:r,decode:n})=>new C(e,t,r,n),I=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=w(r,t);return k({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},T=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>k({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),x=k({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),R=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),P=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),D=I({prefix:"9",name:"base10",alphabet:"0123456789"}),O=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),L=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),U=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),q=I({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K=I({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),H=I({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G=I({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Q=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Z=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),X=Z.reduce(((e,t,r)=>(e[r]=t,e)),[]),ee=Z.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const te=k({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=X[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ee[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var re=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ne;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ne=Math.pow(2,31);var se=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var ie=Math.pow(2,7),oe=Math.pow(2,14),ae=Math.pow(2,21),ce=Math.pow(2,28),he=Math.pow(2,35),le=Math.pow(2,42),ue=Math.pow(2,49),de=Math.pow(2,56),fe=Math.pow(2,63);const pe={encode:re,decode:se,encodingLength:function(e){return e<ie?1:e<oe?2:e<ae?3:e<ce?4:e<he?5:e<le?6:e<ue?7:e<de?8:e<fe?9:10}},ye=(e,t,r=0)=>(pe.encode(e,t,r),t),ge=e=>pe.encodingLength(e),be=(e,t)=>{const r=t.byteLength,n=ge(e),s=n+ge(r),i=new Uint8Array(s+r);return ye(e,i,0),ye(r,i,n),i.set(t,s),new me(e,r,t,i)};class me{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const we=({name:e,code:t,encode:r})=>new ve(e,t,r);class ve{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?be(this.code,t):t.then((e=>be(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ee=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ae=we({name:"sha2-256",code:18,encode:Ee("SHA-256")}),Se=we({name:"sha2-512",code:19,encode:Ee("SHA-512")}),_e=v,Ce={code:0,name:"identity",encode:_e,digest:e=>be(0,_e(e))},ke="raw",Ie=85,Te=e=>v(e),xe=e=>v(e),Re=new TextEncoder,Pe=new TextDecoder,De="json",Oe=512,Ne=e=>Re.encode(JSON.stringify(e)),Le=e=>JSON.parse(Pe.decode(e));new WeakMap;class Ue{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ue.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Ue.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ue.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ue)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Ue(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Ue.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Ue(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Ue(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ue.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Ue.create(1,e,t)}static decode(e){const[t,r]=Ue.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ue.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Ue.createV0(i):Ue.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Ue.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Be={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Me(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ve(e=0){return null!=globalThis.Buffer?.allocUnsafe?Me(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ze(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const je=ze("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Fe=ze("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Ve((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),$e={utf8:je,"utf-8":je,hex:Be.base16,latin1:Fe,ascii:Fe,binary:Fe,...Be};class qe{constructor(e,t,r=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new b,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);await r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);null!=r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof qe?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof qe?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce(((r,n,s)=>(null!=n&&(n instanceof qe?r.push(n.serialize(e,t)):r.push(e(n,s))),r)),[]))}async asyncTransform(e,t){return await We(this,e,t)}toJSON(){return this.serialize(He,Ge)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof qe))return null!=r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"==typeof e?function(e,t="utf8"){const r=$e[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Me(globalThis.Buffer.from(e,"utf-8"))}(e):e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof qe?await n._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:n}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new qe(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),await e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(Ke);if(null!=e&&!(e instanceof qe)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function Ke(e){return Boolean(e)}function He(e,t){return e.key}function Ge(e){return e}async function We(e,t,r){const n=[];for(const s of e._children.compactArray())if(s instanceof qe)await We(s,t,r);else{const r=await t(s);n.push({bitField:e._children.bitField(),children:r})}return await r(n)}const Je=[255,254,252,248,240,224,192,128],Ye=[1,3,7,15,31,63,127,255];class Qe{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,s=Math.min(n,t);r=(r<<s)+Ze(e,n-s,s),t-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function Ze(e,t,r){const n=function(e,t){return Je[e]&Ye[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}class Xe{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?function(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=Ve(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Me(r)}([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new Qe(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}function et(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:(r=e.hashFn,function(e){return e instanceof Xe?e:new Xe(e,r)})};var r;return new qe(t)}},64348:(e,t,r)=>{"use strict";r.d(t,{s:()=>n.s});var n=r(42837)},42837:(e,t,r)=>{"use strict";r.d(t,{s:()=>Ke});var n={};r.r(n),r.d(n,{identity:()=>T});var s={};r.r(s),r.d(s,{base2:()=>x});var i={};r.r(i),r.d(i,{base8:()=>R});var o={};r.r(o),r.d(o,{base10:()=>P});var a={};r.r(a),r.d(a,{base16:()=>D,base16upper:()=>O});var c={};r.r(c),r.d(c,{base32:()=>N,base32hex:()=>M,base32hexpad:()=>z,base32hexpadupper:()=>j,base32hexupper:()=>V,base32pad:()=>U,base32padupper:()=>B,base32upper:()=>L,base32z:()=>F});var h={};r.r(h),r.d(h,{base36:()=>$,base36upper:()=>q});var l={};r.r(l),r.d(l,{base58btc:()=>K,base58flickr:()=>H});var u={};r.r(u),r.d(u,{base64:()=>G,base64pad:()=>W,base64url:()=>J,base64urlpad:()=>Y});var d={};r.r(d),r.d(d,{base256emoji:()=>ee});var f={};r.r(f),r.d(f,{sha256:()=>Ee,sha512:()=>Ae});var p={};r.r(p),r.d(p,{identity:()=>_e});var y={};r.r(y),r.d(y,{code:()=>ke,decode:()=>Te,encode:()=>Ie,name:()=>Ce});var g={};r.r(g),r.d(g,{code:()=>De,decode:()=>Ne,encode:()=>Oe,name:()=>Pe});var b=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const m=b,w=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class v{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class E{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return S(this,e)}}class A{constructor(e){this.decoders=e}or(e){return S(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const S=(e,t)=>new A({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class _{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new v(e,t,r),this.decoder=new E(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const C=({name:e,prefix:t,encode:r,decode:n})=>new _(e,t,r,n),k=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=m(r,t);return C({prefix:e,name:t,encode:n,decode:e=>w(s(e))})},I=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>C({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),T=C({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),x=I({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),R=I({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),P=k({prefix:"9",name:"base10",alphabet:"0123456789"}),D=I({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O=I({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),N=I({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),L=I({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),U=I({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),B=I({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),M=I({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),V=I({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),z=I({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j=I({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),F=I({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),$=k({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),q=k({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),K=k({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),H=k({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),G=I({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W=I({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),J=I({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y=I({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Q=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Z=Q.reduce(((e,t,r)=>(e[r]=t,e)),[]),X=Q.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const ee=C({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Z[t]),"")},decode:function(e){const t=[];for(const r of e){const e=X[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var te=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=re;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},re=Math.pow(2,31);var ne=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var se=Math.pow(2,7),ie=Math.pow(2,14),oe=Math.pow(2,21),ae=Math.pow(2,28),ce=Math.pow(2,35),he=Math.pow(2,42),le=Math.pow(2,49),ue=Math.pow(2,56),de=Math.pow(2,63);const fe={encode:te,decode:ne,encodingLength:function(e){return e<se?1:e<ie?2:e<oe?3:e<ae?4:e<ce?5:e<he?6:e<le?7:e<ue?8:e<de?9:10}},pe=(e,t,r=0)=>(fe.encode(e,t,r),t),ye=e=>fe.encodingLength(e),ge=(e,t)=>{const r=t.byteLength,n=ye(e),s=n+ye(r),i=new Uint8Array(s+r);return pe(e,i,0),pe(r,i,n),i.set(t,s),new be(e,r,t,i)};class be{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const me=({name:e,code:t,encode:r})=>new we(e,t,r);class we{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ge(this.code,t):t.then((e=>ge(this.code,e)))}throw Error("Unknown type, must be binary type")}}const ve=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ee=me({name:"sha2-256",code:18,encode:ve("SHA-256")}),Ae=me({name:"sha2-512",code:19,encode:ve("SHA-512")}),Se=w,_e={code:0,name:"identity",encode:Se,digest:e=>ge(0,Se(e))},Ce="raw",ke=85,Ie=e=>w(e),Te=e=>w(e),xe=new TextEncoder,Re=new TextDecoder,Pe="json",De=512,Oe=e=>xe.encode(JSON.stringify(e)),Ne=e=>JSON.parse(Re.decode(e));new WeakMap;class Le{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Le.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Le.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Le.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Le)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Le(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Le.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Le(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Le(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Le.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Le.create(1,e,t)}static decode(e){const[t,r]=Le.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Le.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Le.createV0(i):Le.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Le.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Ue={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Be(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Me(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ve=Me("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ze=Me("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Be(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),je={utf8:Ve,"utf-8":Ve,hex:Ue.base16,latin1:ze,ascii:ze,binary:ze,...Ue};const Fe="/",$e=(new TextEncoder).encode(Fe),qe=$e[0];class Ke{constructor(e,t){if("string"==typeof e)this._buf=function(e,t="utf8"){const r=je[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Be(globalThis.Buffer.from(e,"utf-8"))}(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==qe)throw new Error("Invalid key")}toString(e="utf8"){return function(e,t="utf8"){const r=je[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ke(e.join(Fe))}static random(){return new Ke(((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"==typeof e?new Ke(e):"function"==typeof e.uint8Array?new Ke(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=$e),this._buf[0]!==qe){const e=new Uint8Array(this._buf.byteLength+1);e.fill(qe,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===qe;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),r=e.list();for(let e=0;e<t.length;e++){if(r.length<e+1)return!1;const n=t[e],s=r[e];if(n<s)return!0;if(n>s)return!1}return t.length<r.length}reverse(){return Ke.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Fe).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new Ke(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Fe)||(e+=Fe),e+=this.type(),new Ke(e)}parent(){const e=this.list();return 1===e.length?new Ke(Fe):new Ke(e.slice(0,-1).join(Fe))}child(e){return this.toString()===Fe?e:e.toString()===Fe?this:new Ke(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return Ke.withNamespaces([...this.namespaces(),...(t=e.map((e=>e.namespaces())),[].concat(...t))]);var t}}},99806:(e,t,r)=>{"use strict";r.d(t,{n:()=>rr});var n={};r.r(n),r.d(n,{base58btc:()=>H,base58flickr:()=>G});var s={};r.r(s),r.d(s,{base32:()=>W,base32hex:()=>Z,base32hexpad:()=>ee,base32hexpadupper:()=>te,base32hexupper:()=>X,base32pad:()=>Y,base32padupper:()=>Q,base32upper:()=>J,base32z:()=>re});var i={};r.r(i),r.d(i,{sha256:()=>ge,sha512:()=>be});var o={};r.r(o),r.d(o,{identity:()=>ht});var a={};r.r(a),r.d(a,{base2:()=>lt});var c={};r.r(c),r.d(c,{base8:()=>ut});var h={};r.r(h),r.d(h,{base10:()=>dt});var l={};r.r(l),r.d(l,{base16:()=>ft,base16upper:()=>pt});var u={};r.r(u),r.d(u,{base36:()=>yt,base36upper:()=>gt});var d={};r.r(d),r.d(d,{base64:()=>bt,base64pad:()=>mt,base64url:()=>wt,base64urlpad:()=>vt});var f={};r.r(f),r.d(f,{base256emoji:()=>_t});var p={};r.r(p),r.d(p,{identity:()=>kt});var y={};r.r(y),r.d(y,{code:()=>Tt,decode:()=>Rt,encode:()=>xt,name:()=>It});var g={};r.r(g),r.d(g,{code:()=>Nt,decode:()=>Ut,encode:()=>Lt,name:()=>Ot});var b=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=m;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},m=Math.pow(2,31);var w=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var v=Math.pow(2,7),E=Math.pow(2,14),A=Math.pow(2,21),S=Math.pow(2,28),_=Math.pow(2,35),C=Math.pow(2,42),k=Math.pow(2,49),I=Math.pow(2,56),T=Math.pow(2,63);const x={encode:b,decode:w,encodingLength:function(e){return e<v?1:e<E?2:e<A?3:e<S?4:e<_?5:e<C?6:e<k?7:e<I?8:e<T?9:10}},R=(e,t=0)=>[x.decode(e,t),x.decode.bytes],P=(e,t,r=0)=>(x.encode(e,t,r),t),D=e=>x.encodingLength(e),O=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),N=(e,t)=>{const r=t.byteLength,n=D(e),s=n+D(r),i=new Uint8Array(s+r);return P(e,i,0),P(r,i,n),i.set(t,s),new L(e,r,t,i)};class L{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}var U=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const B=U;class M{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class V{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return j(this,e)}}class z{constructor(e){this.decoders=e}or(e){return j(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const j=(e,t)=>new z({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class F{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new M(e,t,r),this.decoder=new V(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const $=({name:e,prefix:t,encode:r,decode:n})=>new F(e,t,r,n),q=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=B(r,t);return $({prefix:e,name:t,encode:n,decode:e=>O(s(e))})},K=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>$({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),H=q({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G=q({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=K({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),J=K({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Y=K({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Q=K({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Z=K({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),X=K({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ee=K({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),te=K({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),re=K({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ne=new WeakMap,se=e=>{const t=ne.get(e);if(null==t){const t=new Map;return ne.set(e,t),t}return t};class ie{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==he)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==le)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ie.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=N(e,t);return ie.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ie.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?ae(r,se(e),t||H.encoder):ce(r,se(e),t||W.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof ie)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new ie(e,r,n,s||ue(e,r,n.bytes))}if(!0===t[de]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=O(e),[r,n]=R(t),[s,i]=R(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new L(r,s,o,t)})(r);return ie.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==he)throw new Error(`Version 0 CID must use dag-pb (code: ${he}) block encoding`);return new ie(e,t,r,r.bytes);case 1:{const n=ue(e,t,r.bytes);return new ie(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return ie.create(0,he,e)}static createV1(e,t){return ie.create(1,e,t)}static decode(e){const[t,r]=ie.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=ie.inspectBytes(e),r=t.size-t.multihashSize,n=O(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new L(t.multihashCode,t.digestSize,s,n);return[0===t.version?ie.createV0(i):ie.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=R(e.subarray(t));return t+=n,r};let n=r(),s=he;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=oe(e,t),s=ie.decode(n);return se(s).set(r,e),s}}const oe=(e,t)=>{switch(e[0]){case"Q":{const r=t||H;return[H.prefix,r.decode(`${H.prefix}${e}`)]}case H.prefix:{const r=t||H;return[H.prefix,r.decode(e)]}case W.prefix:{const r=t||W;return[W.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ae=(e,t,r)=>{const{prefix:n}=r;if(n!==H.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},ce=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},he=112,le=18,ue=(e,t,r)=>{const n=D(e),s=n+D(t),i=new Uint8Array(s+r.byteLength);return P(e,i,0),P(t,i,n),i.set(r,s),i},de=Symbol.for("@ipld/js-cid/CID"),fe=({name:e,code:t,encode:r})=>new pe(e,t,r);class pe{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?N(this.code,t):t.then((e=>N(this.code,e)))}throw Error("Unknown type, must be binary type")}}const ye=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ge=fe({name:"sha2-256",code:18,encode:ye("SHA-256")}),be=fe({name:"sha2-512",code:19,encode:ye("SHA-512")});var me=r(82838),we=r(94676);const ve=function(e){let t=new Uint8Array(e.reduce(((e,t)=>e+we.encodingLength(t)),0)),r=0;for(const n of e)t=we.encode(n,t,r),r+=we.encodingLength(n);return t};var Ee=r(11227);function Ae(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}class Se{constructor(e,t,r){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=r}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(H)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}var _e=r(62100);const Ce=_e.Reader,ke=_e.Writer,Ie=_e.util,Te=_e.roots["ipfs-bitswap"]||(_e.roots["ipfs-bitswap"]={}),xe=Te.Message=(()=>{function e(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.wantlist=null,e.prototype.blocks=Ie.emptyArray,e.prototype.payload=Ie.emptyArray,e.prototype.blockPresences=Ie.emptyArray,e.prototype.pendingBytes=0,e.encode=function(e,t){if(t||(t=ke.create()),null!=e.wantlist&&Object.hasOwnProperty.call(e,"wantlist")&&Te.Message.Wantlist.encode(e.wantlist,t.uint32(10).fork()).ldelim(),null!=e.blocks&&e.blocks.length)for(var r=0;r<e.blocks.length;++r)t.uint32(18).bytes(e.blocks[r]);if(null!=e.payload&&e.payload.length)for(r=0;r<e.payload.length;++r)Te.Message.Block.encode(e.payload[r],t.uint32(26).fork()).ldelim();if(null!=e.blockPresences&&e.blockPresences.length)for(r=0;r<e.blockPresences.length;++r)Te.Message.BlockPresence.encode(e.blockPresences[r],t.uint32(34).fork()).ldelim();return null!=e.pendingBytes&&Object.hasOwnProperty.call(e,"pendingBytes")&&t.uint32(40).int32(e.pendingBytes),t},e.decode=function(e,t){e instanceof Ce||(e=Ce.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Te.Message;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.wantlist=Te.Message.Wantlist.decode(e,e.uint32());break;case 2:n.blocks&&n.blocks.length||(n.blocks=[]),n.blocks.push(e.bytes());break;case 3:n.payload&&n.payload.length||(n.payload=[]),n.payload.push(Te.Message.Block.decode(e,e.uint32()));break;case 4:n.blockPresences&&n.blockPresences.length||(n.blockPresences=[]),n.blockPresences.push(Te.Message.BlockPresence.decode(e,e.uint32()));break;case 5:n.pendingBytes=e.int32();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Te.Message)return e;var t=new Te.Message;if(null!=e.wantlist){if("object"!=typeof e.wantlist)throw TypeError(".Message.wantlist: object expected");t.wantlist=Te.Message.Wantlist.fromObject(e.wantlist)}if(e.blocks){if(!Array.isArray(e.blocks))throw TypeError(".Message.blocks: array expected");t.blocks=[];for(var r=0;r<e.blocks.length;++r)"string"==typeof e.blocks[r]?Ie.base64.decode(e.blocks[r],t.blocks[r]=Ie.newBuffer(Ie.base64.length(e.blocks[r])),0):e.blocks[r].length>=0&&(t.blocks[r]=e.blocks[r])}if(e.payload){if(!Array.isArray(e.payload))throw TypeError(".Message.payload: array expected");t.payload=[];for(r=0;r<e.payload.length;++r){if("object"!=typeof e.payload[r])throw TypeError(".Message.payload: object expected");t.payload[r]=Te.Message.Block.fromObject(e.payload[r])}}if(e.blockPresences){if(!Array.isArray(e.blockPresences))throw TypeError(".Message.blockPresences: array expected");t.blockPresences=[];for(r=0;r<e.blockPresences.length;++r){if("object"!=typeof e.blockPresences[r])throw TypeError(".Message.blockPresences: object expected");t.blockPresences[r]=Te.Message.BlockPresence.fromObject(e.blockPresences[r])}}return null!=e.pendingBytes&&(t.pendingBytes=0|e.pendingBytes),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocks=[],r.payload=[],r.blockPresences=[]),t.defaults&&(r.wantlist=null,r.pendingBytes=0),null!=e.wantlist&&e.hasOwnProperty("wantlist")&&(r.wantlist=Te.Message.Wantlist.toObject(e.wantlist,t)),e.blocks&&e.blocks.length){r.blocks=[];for(var n=0;n<e.blocks.length;++n)r.blocks[n]=t.bytes===String?Ie.base64.encode(e.blocks[n],0,e.blocks[n].length):t.bytes===Array?Array.prototype.slice.call(e.blocks[n]):e.blocks[n]}if(e.payload&&e.payload.length){r.payload=[];for(n=0;n<e.payload.length;++n)r.payload[n]=Te.Message.Block.toObject(e.payload[n],t)}if(e.blockPresences&&e.blockPresences.length){r.blockPresences=[];for(n=0;n<e.blockPresences.length;++n)r.blockPresences[n]=Te.Message.BlockPresence.toObject(e.blockPresences[n],t)}return null!=e.pendingBytes&&e.hasOwnProperty("pendingBytes")&&(r.pendingBytes=e.pendingBytes),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,_e.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message"},e.Wantlist=function(){function e(e){if(this.entries=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.entries=Ie.emptyArray,e.prototype.full=!1,e.encode=function(e,t){if(t||(t=ke.create()),null!=e.entries&&e.entries.length)for(var r=0;r<e.entries.length;++r)Te.Message.Wantlist.Entry.encode(e.entries[r],t.uint32(10).fork()).ldelim();return null!=e.full&&Object.hasOwnProperty.call(e,"full")&&t.uint32(16).bool(e.full),t},e.decode=function(e,t){e instanceof Ce||(e=Ce.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Te.Message.Wantlist;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.entries&&n.entries.length||(n.entries=[]),n.entries.push(Te.Message.Wantlist.Entry.decode(e,e.uint32()));break;case 2:n.full=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Te.Message.Wantlist)return e;var t=new Te.Message.Wantlist;if(e.entries){if(!Array.isArray(e.entries))throw TypeError(".Message.Wantlist.entries: array expected");t.entries=[];for(var r=0;r<e.entries.length;++r){if("object"!=typeof e.entries[r])throw TypeError(".Message.Wantlist.entries: object expected");t.entries[r]=Te.Message.Wantlist.Entry.fromObject(e.entries[r])}}return null!=e.full&&(t.full=Boolean(e.full)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.entries=[]),t.defaults&&(r.full=!1),e.entries&&e.entries.length){r.entries=[];for(var n=0;n<e.entries.length;++n)r.entries[n]=Te.Message.Wantlist.Entry.toObject(e.entries[n],t)}return null!=e.full&&e.hasOwnProperty("full")&&(r.full=e.full),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,_e.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist"},e.WantType=function(){const e={},t=Object.create(e);return t[e[0]="Block"]=0,t[e[1]="Have"]=1,t}(),e.Entry=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.block=Ie.newBuffer([]),e.prototype.priority=0,e.prototype.cancel=!1,e.prototype.wantType=0,e.prototype.sendDontHave=!1,e.encode=function(e,t){return t||(t=ke.create()),null!=e.block&&Object.hasOwnProperty.call(e,"block")&&t.uint32(10).bytes(e.block),null!=e.priority&&Object.hasOwnProperty.call(e,"priority")&&t.uint32(16).int32(e.priority),null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(24).bool(e.cancel),null!=e.wantType&&Object.hasOwnProperty.call(e,"wantType")&&t.uint32(32).int32(e.wantType),null!=e.sendDontHave&&Object.hasOwnProperty.call(e,"sendDontHave")&&t.uint32(40).bool(e.sendDontHave),t},e.decode=function(e,t){e instanceof Ce||(e=Ce.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Te.Message.Wantlist.Entry;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.block=e.bytes();break;case 2:n.priority=e.int32();break;case 3:n.cancel=e.bool();break;case 4:n.wantType=e.int32();break;case 5:n.sendDontHave=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Te.Message.Wantlist.Entry)return e;var t=new Te.Message.Wantlist.Entry;switch(null!=e.block&&("string"==typeof e.block?Ie.base64.decode(e.block,t.block=Ie.newBuffer(Ie.base64.length(e.block)),0):e.block.length>=0&&(t.block=e.block)),null!=e.priority&&(t.priority=0|e.priority),null!=e.cancel&&(t.cancel=Boolean(e.cancel)),e.wantType){case"Block":case 0:t.wantType=0;break;case"Have":case 1:t.wantType=1}return null!=e.sendDontHave&&(t.sendDontHave=Boolean(e.sendDontHave)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.block="":(r.block=[],t.bytes!==Array&&(r.block=Ie.newBuffer(r.block))),r.priority=0,r.cancel=!1,r.wantType=t.enums===String?"Block":0,r.sendDontHave=!1),null!=e.block&&e.hasOwnProperty("block")&&(r.block=t.bytes===String?Ie.base64.encode(e.block,0,e.block.length):t.bytes===Array?Array.prototype.slice.call(e.block):e.block),null!=e.priority&&e.hasOwnProperty("priority")&&(r.priority=e.priority),null!=e.cancel&&e.hasOwnProperty("cancel")&&(r.cancel=e.cancel),null!=e.wantType&&e.hasOwnProperty("wantType")&&(r.wantType=t.enums===String?Te.Message.Wantlist.WantType[e.wantType]:e.wantType),null!=e.sendDontHave&&e.hasOwnProperty("sendDontHave")&&(r.sendDontHave=e.sendDontHave),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,_e.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist.Entry"},e}(),e}(),e.Block=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.prefix=Ie.newBuffer([]),e.prototype.data=Ie.newBuffer([]),e.encode=function(e,t){return t||(t=ke.create()),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(10).bytes(e.prefix),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof Ce||(e=Ce.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Te.Message.Block;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.prefix=e.bytes();break;case 2:n.data=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Te.Message.Block)return e;var t=new Te.Message.Block;return null!=e.prefix&&("string"==typeof e.prefix?Ie.base64.decode(e.prefix,t.prefix=Ie.newBuffer(Ie.base64.length(e.prefix)),0):e.prefix.length>=0&&(t.prefix=e.prefix)),null!=e.data&&("string"==typeof e.data?Ie.base64.decode(e.data,t.data=Ie.newBuffer(Ie.base64.length(e.data)),0):e.data.length>=0&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.prefix="":(r.prefix=[],t.bytes!==Array&&(r.prefix=Ie.newBuffer(r.prefix))),t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=Ie.newBuffer(r.data)))),null!=e.prefix&&e.hasOwnProperty("prefix")&&(r.prefix=t.bytes===String?Ie.base64.encode(e.prefix,0,e.prefix.length):t.bytes===Array?Array.prototype.slice.call(e.prefix):e.prefix),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?Ie.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,_e.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Block"},e}(),e.BlockPresenceType=function(){const e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),e.BlockPresence=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cid=Ie.newBuffer([]),e.prototype.type=0,e.encode=function(e,t){return t||(t=ke.create()),null!=e.cid&&Object.hasOwnProperty.call(e,"cid")&&t.uint32(10).bytes(e.cid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),t},e.decode=function(e,t){e instanceof Ce||(e=Ce.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Te.Message.BlockPresence;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.cid=e.bytes();break;case 2:n.type=e.int32();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Te.Message.BlockPresence)return e;var t=new Te.Message.BlockPresence;switch(null!=e.cid&&("string"==typeof e.cid?Ie.base64.decode(e.cid,t.cid=Ie.newBuffer(Ie.base64.length(e.cid)),0):e.cid.length>=0&&(t.cid=e.cid)),e.type){case"Have":case 0:t.type=0;break;case"DontHave":case 1:t.type=1}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.cid="":(r.cid=[],t.bytes!==Array&&(r.cid=Ie.newBuffer(r.cid))),r.type=t.enums===String?"Have":0),null!=e.cid&&e.hasOwnProperty("cid")&&(r.cid=t.bytes===String?Ie.base64.encode(e.cid,0,e.cid.length):t.bytes===Array?Array.prototype.slice.call(e.cid):e.cid),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?Te.Message.BlockPresenceType[e.type]:e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,_e.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.BlockPresence"},e}(),e})();var Re=r(20199);const Pe=xe.Wantlist.WantType.Block,De=xe.Wantlist.WantType.Have;class Oe{constructor(e,t){this.set=t?(0,Re.s)({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,r){const n=e.toString(H),s=this.set.get(n);s?(s.inc(),s.priority=t,s.wantType===De&&r===Pe&&(s.wantType=r)):(this.set.set(n,new Se(e,t,r)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){const t=e.toString(H),r=this.set.get(t);r&&(r.dec(),r.hasRefs()||(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map((e=e=>e[1].key,t=Array.from(this.set.entries()),Array.prototype.slice.call(t,0).sort(((t,r)=>{const n=e(t),s=e(r);return n<s?-1:n>s?1:0}))));var e,t}contains(e){const t=e.toString(H);return this.set.has(t)}get(e){const t=e.toString(H);return this.set.get(t)}}Oe.Entry=Se;const Ne=Oe.Entry;class Le{constructor(e,t,r,n,s){this.entry=new Ne(e,t,r),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(H)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}const Ue=(e,t)=>{const r=["bitswap"];return t&&r.push(t),e&&r.push(`${e.toString().slice(0,8)}`),Object.assign(Ee(r.join(":")),{error:Ee(r.concat(["error"]).join(":"))})},Be=(e,t)=>{if(e.size!==t.size)return!1;for(const[r,n]of e){const e=t.get(r);if(void 0===e)return!1;if(n instanceof Uint8Array&&e instanceof Uint8Array&&!Ae(n,e))return!1;if(n instanceof Le&&e instanceof Le&&!n.equals(e))return!1}return!0};var Me=r(32114);class Ve{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,r,n,s){null==r&&(r=Ve.WantType.Block);const i=e.toString(H),o=this.wantlist.get(i);o?(o.wantType===r&&(o.priority=t),n&&(o.cancel=Boolean(n)),s&&(o.sendDontHave=Boolean(s)),r===Ve.WantType.Block&&o.wantType===Ve.WantType.Have&&(o.wantType=r)):this.wantlist.set(i,new Le(e,t,r,n,s))}addBlock(e,t){const r=e.toString(H);this.blocks.set(r,t)}addHave(e){const t=e.toString(H);this.blockPresences.has(t)||this.blockPresences.set(t,Ve.BlockPresenceType.Have)}addDontHave(e){const t=e.toString(H);this.blockPresences.has(t)||this.blockPresences.set(t,Ve.BlockPresenceType.DontHave)}cancel(e){const t=e.toString(H);this.wantlist.delete(t),this.addEntry(e,0,Ve.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel)}))),full:!!this.full||void 0},blocks:Array.from(this.blocks.values())};return xe.encode(e).finish()}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)}))),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[t,r]of this.blocks.entries()){const n=ie.parse(t),s=n.version,i=n.code,o=n.multihash.code,a=n.multihash.digest.length,c=ve([s,i,o,a]);e.payload.push(new xe.Block({prefix:c,data:r}))}for(const[t,r]of this.blockPresences)e.blockPresences.push(new xe.BlockPresence({cid:ie.parse(t).bytes,type:r}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),xe.encode(e).finish()}equals(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&Be(this.wantlist,e.wantlist)&&Be(this.blocks,e.blocks)&&Be(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}Ve.deserialize=async(e,t)=>{const r=xe.decode(e),n=r.wantlist&&r.wantlist.full||!1,s=new Ve(n);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach((e=>{if(!e.block)return;const t=ie.decode(e.block);s.addEntry(t,e.priority||0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))})),r.blockPresences&&r.blockPresences.forEach((e=>{if(!e.cid)return;const t=ie.decode(e.cid);e.type===Ve.BlockPresenceType.Have?s.addHave(t):s.addDontHave(t)})),r.blocks.length>0?(await Promise.all(r.blocks.map((async e=>{const t=await ge.digest(e),r=ie.createV0(t);s.addBlock(r,e)}))),s):r.payload.length>0?(await Promise.all(r.payload.map((async e=>{if(!e.prefix||!e.data)return;const r=me(e.prefix),n=r[0],i=r[1],o=r[2],a=o===ge.code?ge:t&&await t.getHasher(o);if(!a)throw Me(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");const c=await a.digest(e.data),h=ie.create(n,i,c);s.addBlock(h,e.data)}))),s.setPendingBytes(r.pendingBytes),s):s},Ve.blockPresenceSize=e=>e.bytes.length+1,Ve.Entry=Le,Ve.WantType={Block:xe.Wantlist.WantType.Block,Have:xe.Wantlist.WantType.Have},Ve.BlockPresenceType={Have:xe.BlockPresenceType.Have,DontHave:xe.BlockPresenceType.DontHave};const ze=Math.pow(2,31)-1;var je=function(e,t,r){var n=null,s=null,i=function(){n&&(clearTimeout(n),s=null,n=null)},o=function(){if(!t)return e.apply(this,arguments);var o=this,a=arguments,c=r&&!n;return i(),s=function(){e.apply(o,a)},n=setTimeout((function(){if(n=null,!c){var e=s;return s=null,e()}}),t),c?s():void 0};return o.cancel=i,o.flush=function(){var e=s;i(),e&&e()},o};class Fe{constructor(e,t,r){this.peerId=t,this.network=r,this.refcnt=1,this._entries=[],this._log=Ue(e,"msgqueue"),this.sendEntries=je(this._sendEntries.bind(this),1)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new Ve(!1);this._entries.forEach((t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)})),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(e){return void this._log.error("cant connect to peer %s: %s",this.peerId.toString(),e.message)}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,e).catch((e=>{this._log.error("send error: %s",e.message)}))}}class $e{constructor(e,t,r,n){this.peers=(0,Re.s)({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:n.metrics}),this.wantlist=new Oe(r,n),this.network=t,this._stats=r,this._peerId=e,this._log=Ue(e,"want")}_addEntries(e,t,r){const n=e.map(((e,r)=>new Ve.Entry(e,ze-r,Ve.WantType.Block,t)));n.forEach((e=>{e.cancel?r?this.wantlist.removeForce(e.cid.toString(H)):this.wantlist.remove(e.cid):(this._log("adding to wl"),this.wantlist.add(e.cid,e.priority))}));for(const e of this.peers.values())e.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t)return void t.refcnt++;t=new Fe(this._peerId,e,this.network);const r=new Ve(!0);for(const e of this.wantlist.entries())r.addEntry(e[1].cid,e[1].priority);return t.addMessage(r),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toString());t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.cancelWants(e)}))}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach((e=>this.disconnected(e.peerId)))}}var qe=r(55150),Ke=r(88211),He=r(21466),Ge=r(10715),We=r(73861);const Je="/ipfs/bitswap/1.0.0",Ye="/ipfs/bitswap/1.1.0",Qe="/ipfs/bitswap/1.2.0";class Ze{constructor(e,t,r,n={}){this._log=Ue(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[Je],n.b100Only||(this._protocols.unshift(Ye),this._protocols.unshift(Qe)),this._stats=r,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=n.hashLoader,this._maxInboundStreams=n.maxInboundStreams??32,this._maxOutboundStreams=n.maxOutboundStreams??128,this._incomingStreamTimeout=n.incomingStreamTimeout??3e4}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const e=(0,He.a)({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(const t of this._protocols)this._registrarIds.push(await this._libp2p.registrar.register(t,e));this._libp2p.getConnections().forEach((e=>{this._onPeerConnect(e.remotePeer)}))}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),null!=this._registrarIds){for(const e of this._registrarIds)this._libp2p.registrar.unregister(e);this._registrarIds=[]}}_onConnection({stream:e,connection:t}){if(!this._running)return;const r=new Ge.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((async()=>{this._log("incoming new bitswap %s connection from %p",e.stat.protocol,t.remotePeer),await(0,Ke.zG)((0,We.wJ)(e.source,r.signal),qe.J(),(async e=>{for await(const n of e){try{const e=await Ve.deserialize(n.subarray(),this._hashLoader);await this._bitswap._receiveMessage(t.remotePeer,e)}catch(e){this._bitswap._receiveError(e);break}r.reset()}}))})).catch((t=>{this._log(t),e.abort(t)})).finally((()=>{r.clear(),e.close()}))}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){const r=[];let n=0;for await(const s of this.findProviders(e,t))if(this._log(`connecting to provider ${s.id}`),r.push(this.connectTo(s.id,t).catch((e=>{this._log.error(e)}))),n++,3===n)break;await Promise.all(r)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");const r=e.toString();this._log("sendMessage to %s",r,t);const n=await this._libp2p.dial(e),s=await n.newStream([Qe,Ye,Je]);await async function(e,t,r){try{let r;switch(e.stat.protocol){case Je:r=t.serializeToBitswap100();break;case Ye:case Qe:r=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+e.stat.protocol)}await(0,Ke.zG)([r],qe.c(),e)}catch(e){r(e)}finally{e.close()}}(s,t,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){const r=e.toString();if(this._stats){for(const e of t.values())this._stats.push(r,"dataSent",e.length);this._stats.push(r,"blocksSent",t.size)}}}class Xe{constructor(e){this.partner=e,this.wantlist=new Oe,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,r){this.wantlist.add(e,t,r)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class et extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(const[t,r]of e||[])this.set(t,r)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const r=this._find(t);this._keys.splice(r,0,t)}set(e,t){if(this.has(e)){const t=this.indexOf(e);this._keys.splice(t,1)}super.set(e,t);const r=this._find(e);return this._keys.splice(r,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let r=1;r<this._keys.length;r++){if(this._keys[t+r]===e)return t+r;if(this._keys[t-r]===e)return t-r}return-1}_find(e){let t=0,r=this._keys.length;for(;t<r;){const n=t+r>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else{if(!(s>0))return n;r=n}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(const r of this._keys)e.apply(t,[[r,this.get(r)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}const tt={hasNewInfo:()=>!1,merge(){}};class rt{constructor(e=tt){this._taskMerger=e,this._byPeer=new et([],nt.compare)}pushTasks(e,t){let r=this._byPeer.get(e.toString());r||(r=new nt(e,this._taskMerger)),r.pushTasks(t),this._byPeer.set(e.toString(),r)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:r,pendingSize:n}=t.popTasks(e);if(0===r.length)return{tasks:r,pendingSize:n};const s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toString()):this._byPeer.update(0),{peerId:s,tasks:r,pendingSize:n}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const r=this._byPeer.get(t.toString());r&&r.remove(e)}tasksDone(e,t){const r=this._byPeer.get(e.toString());if(!r)return;const n=this._byPeer.indexOf(e.toString());for(const e of t)r.taskDone(e);this._byPeer.update(n)}}class nt{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new st,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const r of this._active)r.topic===e.topic&&t.push(r);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const r=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){const e=n[s];r.push(e),t+=e.size,this._pending.delete(e.topic),this._activeTotalSize+=e.size,this._active.add(e)}return{tasks:r,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class st{constructor(){this._tasks=new et([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce(((e,t)=>e+t.task.size),0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map((e=>e.task))}updatePriority(e,t){const r=this._tasks.get(e);if(!r)return;const n=this._tasks.indexOf(e);r.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}const it={hasNewInfo(e,t){let r=!1,n=!1;for(const e of t)e.data.haveBlock&&(r=!0),e.data.isWantBlock&&(n=!0);return!(n||!e.data.isWantBlock)||!(r||!e.data.haveBlock)},merge(e,t){const r=e.data,n=t.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,n.haveBlock&&!r.haveBlock||(n.haveBlock=r.haveBlock,t.size=e.size)),n.isWantBlock&&n.haveBlock&&(t.size=n.blockSize)}},ot=Ve.WantType;class at{constructor(e,t,r,n,s,i={}){this._log=Ue(e,"engine"),this.blockstore=t,this.network=r,this._stats=n,this._opts=this._processOpts(i),this.ledgerMap=(0,Re.s)({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:s.metrics}),this._running=!1,this._requestQueue=new rt(it)}_processOpts(e){return{maxSizeReplaceHasWithBlock:1024,targetMessageSize:16384,...e}}_scheduleProcessTasks(){setTimeout((()=>{this._processTasks()}))}async _processTasks(){if(!this._running)return;const{peerId:e,tasks:t,pendingSize:r}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===t.length)return;const n=new Ve(!1);n.setPendingBytes(r);const s=[],i=new Map;for(const e of t){const t=ie.parse(e.topic);e.data.haveBlock?e.data.isWantBlock?(s.push(t),i.set(e.topic,e.data)):n.addHave(t):n.addDontHave(t)}const o=await this._getBlocks(s);for(const[e,t]of i){const r=ie.parse(e),s=o.get(e);s?n.addBlock(r,s):t.sendDontHave&&n.addDontHave(r)}if(n.empty)return e&&this._requestQueue.tasksDone(e,t),void this._scheduleProcessTasks();try{e&&await this.network.sendMessage(e,n);for(const[t,r]of o.entries())e&&this.messageSent(e,ie.parse(t),r)}catch(e){this._log.error(e)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){const t=e.toString(),r=this.ledgerMap.get(t);return r?r.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toString(),r=this.ledgerMap.get(t);return r?{peer:r.partner,value:r.debtRatio(),sent:r.accounting.bytesSent,recv:r.accounting.bytesRecv,exchanged:r.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.partner))}receivedBlocks(e){if(e.length){for(const t of this.ledgerMap.values())for(const r of e){const e=t.wantlistContains(r.cid);if(!e)continue;const n=r.data.length,s=this._sendAsBlock(e.wantType,n);let i=n;s||(i=Ve.blockPresenceSize(e.cid)),this._requestQueue.pushTasks(t.partner,[{topic:e.cid.toString(H),priority:e.priority,size:i,data:{blockSize:n,isWantBlock:s,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){const r=this._findOrCreate(e);if(t.empty)return;if(t.full&&(r.wantlist=new Oe),this._updateBlockAccounting(t.blocks,r),0===t.wantlist.size)return void this._scheduleProcessTasks();const n=[],s=[];t.wantlist.forEach((e=>{e.cancel?(r.cancelWant(e.cid),n.push(e.cid)):(r.wants(e.cid,e.priority,e.wantType),s.push(e))})),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(const r of t)this._requestQueue.remove(r.toString(H),e)}async _addWants(e,t){const r=await this._getBlockSizes(t.map((e=>e.cid))),n=[];for(const s of t){const t=s.cid.toString(H),i=r.get(t);if(null==i)s.sendDontHave&&n.push({topic:t,priority:s.priority,size:Ve.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===ot.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{const e=this._sendAsBlock(s.wantType,i);let r=i;e||(r=Ve.blockPresenceSize(s.cid)),n.push({topic:t,priority:s.priority,size:r,data:{isWantBlock:e,blockSize:i,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===ot.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){const t=await this._getBlocks(e);return new Map([...t].map((([e,t])=>[e,t.length])))}async _getBlocks(e){const t=new Map;return await Promise.all(e.map((async e=>{try{const r=await this.blockstore.get(e);t.set(e.toString(H),r)}catch(t){"ERR_NOT_FOUND"!==t.code&&this._log.error("failed to query blockstore for %s: %s",e,t)}}))),t}_updateBlockAccounting(e,t){for(const r of e.values())this._log("got block (%s bytes)",r.length),t.receivedBytes(r.length)}messageSent(e,t,r){const n=this._findOrCreate(e);n.sentBytes(r.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){const t=e.toString(),r=this.ledgerMap.get(t);if(r)return r;const n=new Xe(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}}var ct=r(17187);const ht=$({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),lt=K({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ut=K({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),dt=q({prefix:"9",name:"base10",alphabet:"0123456789"}),ft=K({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pt=K({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),yt=q({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gt=q({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),bt=K({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),mt=K({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wt=K({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vt=K({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Et=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),At=Et.reduce(((e,t,r)=>(e[r]=t,e)),[]),St=Et.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const _t=$({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=At[t]),"")},decode:function(e){const t=[];for(const r of e){const e=St[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Ct=O,kt={code:0,name:"identity",encode:Ct,digest:e=>N(0,Ct(e))},It="raw",Tt=85,xt=e=>O(e),Rt=e=>O(e),Pt=new TextEncoder,Dt=new TextDecoder,Ot="json",Nt=512,Lt=e=>Pt.encode(JSON.stringify(e)),Ut=e=>JSON.parse(Dt.decode(e)),Bt={...o,...a,...c,...h,...l,...s,...u,...n,...d,...f};function Mt(e=0){return null!=globalThis.Buffer?.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e);var t}function Vt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const zt=Vt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),jt=Vt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Mt((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Ft={utf8:zt,"utf-8":zt,hex:Bt.base16,latin1:jt,ascii:jt,binary:jt,...Bt};function $t(e,t="utf8"){const r=Ft[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const qt=e=>`unwant:${$t(e.multihash.bytes,"base64")}`,Kt=e=>`block:${$t(e.multihash.bytes,"base64")}`;class Ht extends ct.EventEmitter{constructor(e){super(),this.setMaxListeners(1e3),this._log=Ue(e,"notif")}hasBlock(e,t){const r=Kt(e);this._log(r),this.emit(r,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");const r=Kt(e),n=qt(e);return this._log(`wantBlock:${e}`),new Promise(((s,i)=>{const o=()=>{this.removeListener(r,a),i(new Error(`Block for ${e} unwanted`))},a=e=>{this.removeListener(n,o),s(e)};this.once(n,o),this.once(r,a),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.removeListener(r,a),this.removeListener(n,o),i(new Error(`Want for ${e} aborted`))}))}))}unwantBlock(e){const t=qt(e);this._log(t),this.emit(t)}}var Gt=r(63573);class Wt extends ct.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach((e=>{this._stats[e]=BigInt(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach((t=>{(this._movingAverages[e][t]=Gt(t)).push(this._frequencyLastTime,0)}))})),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){const t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach((r=>{this._updateFrequencyFor(r,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){const n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const s=n/t*1e3;let i=this._movingAverages[e];i||(i=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((e=>{let t=i[e];t||(t=i[e]=Gt(e)),t.push(r,s)}))}_applyOp(e){const t=e[0],r=e[1];if("number"!=typeof r)throw new Error(`invalid increment number: ${r}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}const Jt={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class Yt extends ct.EventEmitter{constructor(e,t=[],r=Jt){super();const n=Object.assign({},Jt,r);if("number"!=typeof n.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!=typeof n.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=n,this._enabled=this._options.enabled,this._global=new Wt(t,n),this._global.on("update",(e=>this.emit("update",e))),this._peers=(0,Re.s)({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t="string"!=typeof e&&e.toString?e.toString():`${e}`;return this._peers.get(t)}push(e,t,r){if(this._enabled&&(this._global.push(t,r),e)){let n=this._peers.get(e);n||(n=new Wt(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,r)}}disconnected(e){const t=e.toString(),r=this._peers.get(t);r&&(r.stop(),this._peers.delete(t))}}var Qt=r(32044),Zt=r(64591);const Xt={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},er=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class tr extends Zt.E{constructor(e,t,r={}){super(),this._libp2p=e,this._log=Ue(this.peerId),this._options=Object.assign({},Xt,r),this._stats=new Yt(e,er,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new Ze(e,this,this._stats,{hashLoader:r.hashLoader,maxInboundStreams:r.maxInboundStreams,maxOutboundStreams:r.maxOutboundStreams,incomingStreamTimeout:r.incomingStreamTimeout}),this.blockstore=t,this.engine=new at(this.peerId,t,this.network,this._stats,e),this.wm=new $e(this.peerId,this.network,this._stats,e),this.notifications=new Ht(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(e){this._log("failed to receive message",t)}if(0===t.blocks.size)return;const r=[];for(const[e,n]of t.blocks.entries()){const t=ie.parse(e);r.push({wasWanted:this.wm.wantlist.contains(t),cid:t,data:n})}this.wm.cancelWants(r.filter((({wasWanted:e})=>e)).map((({cid:e})=>e))),await Promise.all(r.map((({cid:t,wasWanted:r,data:n})=>this._handleReceivedBlock(e,t,n,r))))}async _handleReceivedBlock(e,t,r,n){this._log("received block");const s=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,r,s),n&&await this.put(t,r)}_updateReceiveCounters(e,t,r,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",r.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",r.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){const r=(e,t)=>(this.wm.wantBlocks([e],t),this.notifications.wantBlock(e,t));let n=!1;const s=async(e,t)=>{try{return await this.blockstore.get(e,t)}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s;return n||(n=!0,this.network.findAndConnect(e,t).catch((e=>this._log.error(e)))),r(e,t)}},i=new AbortController,o=t.signal?(0,Qt.anySignal)([t.signal,i.signal]):i.signal;try{return await Promise.race([this.notifications.wantBlock(e,{signal:o}),s(e,{signal:o})])}finally{i.abort()}}async*getMany(e,t={}){for await(const r of e)yield this.get(r,t)}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach((e=>this.notifications.unwantBlock(e)))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,r){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(const{key:r,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(r,n),yield{key:r,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch((e=>{this._log.error("Failed to provide: %s",e.message)}))}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}}const rr=(e,t,r={})=>new tr(e,t,r)},71115:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}})},1325:(e,t,r)=>{"use strict";r.d(t,{D:()=>h});var n=r(70248);var s=r(57665),i=r(67137);const o=new class{constructor(e){this.lru=n(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,r){this.lru.set(e,{value:t,expire:Date.now()+r})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}(1e3),a=new(s.Z.default?s.Z.default:s.Z)({concurrency:4}),c=e=>{if(e.Path)return e.Path;throw new Error(e.Message)};async function h(e,t){return(async(e,t={})=>{const r=new URLSearchParams(t);r.set("arg",e);const n=r.toString();if(!t.nocache&&o.has(n)){const e=o.get(n);return c(e)}const s=await a.add((async()=>{const e=await i.get("https://ipfs.io/api/v0/dns",{searchParams:r}),t=new URL(e.url).search.slice(1),n=await e.json();return o.set(t,n,6e4),n}));return c(s)})(e,t)}},49260:(e,t,r)=>{"use strict";function n(){}r.d(t,{L:()=>n})},35719:(e,t,r)=>{"use strict";r.d(t,{M:()=>me});var n=r(88211),s=r(92713),i=r(93203),o=r(38461),a=r(21466),c=r(46857);class h{constructor(e,t,r){this.gossip=e,this.msgs=new Map,this.history=[],this.msgIdToStrFn=r;for(let e=0;e<t;e++)this.history[e]=[]}get size(){return this.msgs.size}put(e,t,r=!1){const{msgIdStr:n}=e;return!this.msgs.has(n)&&(this.msgs.set(n,{message:t,validated:r,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),!0)}observeDuplicate(e,t){const r=this.msgs.get(e);r&&!r.validated&&r.originatingPeers.add(t)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,t){const r=this.msgs.get(e);if(!r)return null;const n=(r.iwantCounts.get(t)??0)+1;return r.iwantCounts.set(t,n),{msg:r.message,count:n}}getGossipIDs(e){const t=new Map;for(let r=0;r<this.gossip;r++)this.history[r].forEach((r=>{const n=this.msgs.get(r.msgIdStr);if(n&&n.validated&&e.has(r.topic)){let e=t.get(r.topic);e||(e=[],t.set(r.topic,e)),e.push(r.msgId)}}));return t}validate(e){const t=this.msgs.get(e);if(!t)return null;const{message:r,originatingPeers:n}=t;return t.validated=!0,t.originatingPeers=new Set,{message:r,originatingPeers:n}}shift(){this.history[this.history.length-1].forEach((e=>{this.msgs.delete(e.msgIdStr)})),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}var l=r(64482);const{RPC:u}=l,d="/floodsub/1.0.0",f="/meshsub/1.0.0",p="/meshsub/1.1.0",y=5e3;function g(e=[],t){return{subscriptions:[],messages:e,control:t?{graft:t.graft||[],prune:t.prune||[],ihave:t.ihave||[],iwant:t.iwant||[]}:void 0}}function b(e){if(e.length<=1)return e;for(let t=0;t<e.length;t++){const r=Math.floor(Math.random()*Math.floor(e.length)),n=e[t];e[t]=e[r],e[r]=n}return e}var m=r(92263);function w(e){return(0,m.toString)(e,"base64")}var v=r(51988);const E="StrictSign",A="StrictNoSign";var S,_,C,k,I,T;function x(e){switch(e){case C.Ignore:return k.Ignore;case C.Reject:return k.Reject}}!function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"}(S||(S={})),function(e){e[e.Signing=0]="Signing",e[e.Anonymous=1]="Anonymous"}(_||(_={})),function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(C||(C={})),function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"}(k||(k={})),function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"}(I||(I={})),function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"}(T||(T={}));const R="ERR_INVALID_PEER_SCORE_PARAMS";var P=r(32114);const D={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},O={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function N(e={}){return{...D,...e,topics:e.topics?Object.entries(e.topics).reduce(((e,[t,r])=>(e[t]=function(e={}){return{...O,...e}}(r),e)),{}):{}}}function L(e){if(e.topicWeight<0)throw P(new Error("invalid topic weight; must be >= 0"),R);if(0===e.timeInMeshQuantum)throw P(new Error("invalid TimeInMeshQuantum; must be non zero"),R);if(e.timeInMeshWeight<0)throw P(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),R);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw P(new Error("invalid TimeInMeshQuantum; must be positive"),R);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw P(new Error("invalid TimeInMeshCap; must be positive"),R);if(e.firstMessageDeliveriesWeight<0)throw P(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),R);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw P(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),R);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw P(new Error("invalid FirstMessageDeliveriesCap; must be positive"),R);if(e.meshMessageDeliveriesWeight>0)throw P(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),R);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw P(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),R);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw P(new Error("invalid MeshMessageDeliveriesCap; must be positive"),R);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw P(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),R);if(e.meshMessageDeliveriesWindow<0)throw P(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),R);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw P(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),R);if(e.meshFailurePenaltyWeight>0)throw P(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),R);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw P(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),R);if(e.invalidMessageDeliveriesWeight>0)throw P(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),R);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw P(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),R)}const U={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function B(e={}){return{...U,...e}}function M(e,t,r,n){let s=0;Object.entries(t.topics).forEach((([e,t])=>{const n=r.topics[e];if(void 0===n)return;let i=0;if(t.inMesh){let e=t.meshTime/n.timeInMeshQuantum;e>n.timeInMeshCap&&(e=n.timeInMeshCap),i+=e*n.timeInMeshWeight}let o=t.firstMessageDeliveries;if(o>n.firstMessageDeliveriesCap&&(o=n.firstMessageDeliveriesCap),i+=o*n.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<n.meshMessageDeliveriesThreshold){const e=n.meshMessageDeliveriesThreshold-t.meshMessageDeliveries;i+=e*e*n.meshMessageDeliveriesWeight}i+=t.meshFailurePenalty*n.meshFailurePenaltyWeight;i+=t.invalidMessageDeliveries*t.invalidMessageDeliveries*n.invalidMessageDeliveriesWeight,s+=i*n.topicWeight})),r.topicScoreCap>0&&s>r.topicScoreCap&&(s=r.topicScoreCap);const i=r.appSpecificScore(e);if(s+=i*r.appSpecificWeight,t.ips.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),i=t?t.size:0;if(i>r.IPColocationFactorThreshold){const e=i-r.IPColocationFactorThreshold;s+=e*e*r.IPColocationFactorWeight}})),t.behaviourPenalty>r.behaviourPenaltyThreshold){const e=t.behaviourPenalty-r.behaviourPenaltyThreshold;s+=e*e*r.behaviourPenaltyWeight}return s}var V,z=r(45001);!function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"}(V||(V={}));class j{constructor(){this.records=new Map,this.queue=new z}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:V.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const r={msgId:e,expire:Date.now()+12e4};return this.queue.push(r),t}gc(){const e=Date.now();let t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}var F=r(57447);function $(e){return null!=e&&"function"==typeof e.init}class q{constructor(e={}){this.started=!1,null!=e.peerId&&this.setPeerId(e.peerId),null!=e.addressManager&&this.setAddressManager(e.addressManager),null!=e.peerStore&&this.setPeerStore(e.peerStore),null!=e.upgrader&&this.setUpgrader(e.upgrader),null!=e.metrics&&this.setMetrics(e.metrics),null!=e.registrar&&this.setRegistrar(e.registrar),null!=e.connectionManager&&this.setConnectionManager(e.connectionManager),null!=e.transportManager&&this.setTransportManager(e.transportManager),null!=e.connectionGater&&this.setConnectionGater(e.connectionGater),null!=e.contentRouting&&this.setContentRouting(e.contentRouting),null!=e.peerRouting&&this.setPeerRouting(e.peerRouting),null!=e.datastore&&this.setDatastore(e.datastore),null!=e.connectionProtector&&this.setConnectionProtector(e.connectionProtector),null!=e.dht&&this.setDHT(e.dht),null!=e.pubsub&&this.setPubSub(e.pubsub),null!=e.dialer&&this.setDialer(e.dialer)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter((e=>(0,F.qK)(e))).map((async e=>{null!=e.beforeStart&&await e.beforeStart()})))}async start(){await Promise.all(Object.values(this).filter((e=>(0,F.qK)(e))).map((async e=>{await e.start()}))),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter((e=>(0,F.qK)(e))).map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async beforeStop(){await Promise.all(Object.values(this).filter((e=>(0,F.qK)(e))).map((async e=>{null!=e.beforeStop&&await e.beforeStop()})))}async stop(){await Promise.all(Object.values(this).filter((e=>(0,F.qK)(e))).map((async e=>{await e.stop()}))),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter((e=>(0,F.qK)(e))).map((async e=>{null!=e.afterStop&&await e.afterStop()})))}setPeerId(e){return this.peerId=e,e}getPeerId(){if(null==this.peerId)throw P(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,$(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,$(e)&&e.init(this),e}getAddressManager(){if(null==this.addressManager)throw P(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,$(e)&&e.init(this),e}getPeerStore(){if(null==this.peerStore)throw P(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,$(e)&&e.init(this),e}getUpgrader(){if(null==this.upgrader)throw P(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,$(e)&&e.init(this),e}getRegistrar(){if(null==this.registrar)throw P(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,$(e)&&e.init(this),e}getConnectionManager(){if(null==this.connectionManager)throw P(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,$(e)&&e.init(this),e}getTransportManager(){if(null==this.transportManager)throw P(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,$(e)&&e.init(this),e}getConnectionGater(){if(null==this.connectionGater)throw P(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,$(e)&&e.init(this),e}getContentRouting(){if(null==this.contentRouting)throw P(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,$(e)&&e.init(this),e}getPeerRouting(){if(null==this.peerRouting)throw P(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,$(e)&&e.init(this),e}getDatastore(){if(null==this.datastore)throw P(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,$(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,$(e)&&e.init(this),e}getDHT(){if(null==this.dht)throw P(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,$(e)&&e.init(this),e}getPubSub(){if(null==this.pubsub)throw P(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}setDialer(e){return this.dialer=e,$(e)&&e.init(this),e}getDialer(){if(null==this.dialer)throw P(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this.dialer}}const K=(0,o.kg)("libp2p:gossipsub:score");class H{constructor(e,t,r){this.params=e,this.metrics=t,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new j,this.components=new q,function(e){for(const[t,r]of Object.entries(e.topics))try{L(r)}catch(e){throw P(new Error(`invalid score parameters for topic ${t}: ${e.message}`),R)}if(e.topicScoreCap<0)throw P(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),R);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw P(new Error("missing application specific score function"),R);if(e.IPColocationFactorWeight>0)throw P(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),R);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw P(new Error("invalid IPColocationFactorThreshold; must be at least 1"),R);if(e.behaviourPenaltyWeight>0)throw P(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),R);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw P(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),R);if(e.decayInterval<1e3)throw P(new Error("invalid DecayInterval; must be at least 1s"),R);if(e.decayToZero<=0||e.decayToZero>=1)throw P(new Error("invalid DecayToZero; must be between 0 and 1"),R)}(e),this.scoreCacheValidityMs=r.scoreCacheValidityMs,this.computeScore=r.computeScore??M}init(e){this.components=e}get size(){return this.peerStats.size}start(){this._backgroundInterval?K("Peer score already running"):(this._backgroundInterval=setInterval((()=>this.background()),this.params.decayInterval),K("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),K("stopped")):K("Peer score already stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((([e,t])=>[e,t])))}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach(((r,n)=>{r.connected?(Object.entries(r.topics).forEach((([r,n])=>{const s=this.params.topics[r];void 0!==s&&(n.firstMessageDeliveries*=s.firstMessageDeliveriesDecay,n.firstMessageDeliveries<t&&(n.firstMessageDeliveries=0),n.meshMessageDeliveries*=s.meshMessageDeliveriesDecay,n.meshMessageDeliveries<t&&(n.meshMessageDeliveries=0),n.meshFailurePenalty*=s.meshFailurePenaltyDecay,n.meshFailurePenalty<t&&(n.meshFailurePenalty=0),n.invalidMessageDeliveries*=s.invalidMessageDeliveriesDecay,n.invalidMessageDeliveries<t&&(n.invalidMessageDeliveries=0),n.inMesh&&(n.meshTime=e-n.graftTime,n.meshTime>s.meshMessageDeliveriesActivation&&(n.meshMessageDeliveriesActive=!0)))})),r.behaviourPenalty*=this.params.behaviourPenaltyDecay,r.behaviourPenalty<t&&(r.behaviourPenalty=0)):e>r.expire&&(this.removeIPs(n,r.ips),this.peerStats.delete(n),this.scoreCache.delete(n))}))}score(e){this.metrics?.scoreFnCalls.inc();const t=this.peerStats.get(e);if(!t)return 0;const r=Date.now(),n=this.scoreCache.get(e);if(n&&n.cacheUntil>r)return n.score;this.metrics?.scoreFnRuns.inc();const s=this.computeScore(e,t,this.params,this.peerIPs),i=r+this.scoreCacheValidityMs;return n?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-n.score)),n.score=s,n.cacheUntil=i):this.scoreCache.set(e,{score:s,cacheUntil:i}),s}addPenalty(e,t,r){const n=this.peerStats.get(e);n&&(n.behaviourPenalty+=t,this.metrics?.onScorePenalty(r))}addPeer(e){const t={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,t);const r=this.getIPs(e);this.setIPs(e,r,t.ips),t.ips=r}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this.removeIPs(e,t.ips),void this.peerStats.delete(e);Object.entries(t.topics).forEach((([e,t])=>{t.firstMessageDeliveries=0;const r=this.params.topics[e].meshMessageDeliveriesThreshold;if(t.inMesh&&t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<r){const e=r-t.meshMessageDeliveries;t.meshFailurePenalty+=e*e}t.inMesh=!1,t.meshMessageDeliveriesActive=!1})),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.inMesh=!0,e.graftTime=Date.now(),e.meshTime=0,e.meshMessageDeliveriesActive=!1)}}prune(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){const r=this.params.topics[t].meshMessageDeliveriesThreshold;if(e.meshMessageDeliveriesActive&&e.meshMessageDeliveries<r){const t=r-e.meshMessageDeliveries;e.meshFailurePenalty+=t*t}e.meshMessageDeliveriesActive=!1,e.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,r){this.markFirstMessageDelivery(e,r);const n=this.deliveryRecords.ensureRecord(t),s=Date.now();n.status===V.unknown?(n.status=V.valid,n.validated=s,n.peers.forEach((t=>{t!==e.toString()&&this.markDuplicateMessageDelivery(t,r)}))):K("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,s-n.firstSeen,V[n.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,r,n){switch(n){case k.Error:return void this.markInvalidMessageDelivery(e,r);case k.Blacklisted:return}const s=this.deliveryRecords.ensureRecord(t);if(s.status===V.unknown){if(n===k.Ignore)return s.status=V.ignored,void s.peers.clear();s.status=V.invalid,this.markInvalidMessageDelivery(e,r),s.peers.forEach((e=>{this.markInvalidMessageDelivery(e,r)})),s.peers.clear()}else K("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeen,V[s.status])}duplicateMessage(e,t,r){const n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(e))switch(n.status){case V.unknown:n.peers.add(e);break;case V.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,r,n.validated);break;case V.invalid:this.markInvalidMessageDelivery(e,r);case V.ignored:}}markInvalidMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);e&&(e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const r=this.peerStats.get(e);if(r){const e=this.getPtopicStats(r,t);if(e){let r=this.params.topics[t].firstMessageDeliveriesCap;e.firstMessageDeliveries=Math.min(r,e.firstMessageDeliveries+1),e.inMesh&&(r=this.params.topics[t].meshMessageDeliveriesCap,e.meshMessageDeliveries=Math.min(r,e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,r){const n=this.peerStats.get(e);if(n){const e=void 0!==r?Date.now():0,s=this.getPtopicStats(n,t);if(s&&s.inMesh){const n=this.params.topics[t];if(void 0!==r){const s=e-r,i=s>n.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(t,s,i),i)return}const i=n.meshMessageDeliveriesCap;s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections((0,i.jE)(e)).map((e=>e.remoteAddr.toOptions().host))}setIPs(e,t,r){e:for(const n of t){for(const e of r)if(n===e)continue e;let t=this.peerIPs.get(n);t||(t=new Set,this.peerIPs.set(n,t)),t.add(e)}e:for(const n of r){for(const e of t)if(n===e)continue e;const r=this.peerIPs.get(n);r&&(r.delete(e),r.size||this.peerIPs.delete(n))}}removeIPs(e,t){t.forEach((t=>{const r=this.peerIPs.get(t);r&&(r.delete(e),r.size||this.peerIPs.delete(t))}))}updateIPs(){this.peerStats.forEach(((e,t)=>{const r=this.getIPs(t);this.setIPs(t,r,e.ips),e.ips=r}))}getPtopicStats(e,t){let r=e.topics[t];return void 0!==r?r:void 0!==this.params.topics[t]?(r={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=r,r):null}}class G{constructor(e,t,r){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=r,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const r=t[Math.floor(Math.random()*t.length)],n=this.msgIdToStrFn(r);let s=this.promises.get(n);s||(s=new Map,this.promises.set(n,s));const i=Date.now();s.has(e)||(s.set(e,i+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(n)||this.requestMsByMsg.set(n,i)))}getBrokenPromises(){const e=Date.now(),t=new Map;let r=0;return this.promises.forEach(((n,s)=>{n.forEach(((s,i)=>{s<e&&(t.set(i,(t.get(i)??0)+1),n.delete(i),r++)})),n.size||this.promises.delete(s)})),this.metrics?.iwantPromiseBroken.inc(r),t}deliverMessage(e){this.trackMessage(e);const t=this.promises.get(e);t&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(t.size)))}rejectMessage(e,t){this.trackMessage(e),t!==k.Error&&this.promises.delete(e)}clear(){this.promises.clear()}prune(){const e=Date.now()-this.requestMsByMsgExpire;for(const[t,r]of this.requestMsByMsg.entries()){if(!(r<e))break;this.requestMsByMsg.delete(t)}}trackMessage(e){if(this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}class W{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs})}prune(){const e=Date.now();for(const[t,r]of this.entries.entries()){if(!(r.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var J,Y,Q,Z,X,ee;!function(e){e.forward="forward",e.publish="publish"}(J||(J={})),function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"}(Y||(Y={})),function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Unsub="unsubscribed",e.Excess="excess"}(Q||(Q={})),function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"}(Z||(Z={})),function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"}(X||(X={})),function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"}(ee||(ee={}));var te=r(20605),re=r(52217),ne=r(79944),se=r(19588);const ie=(0,re.fromString)("libp2p-pubsub:");var oe=r(56155);function ae(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return((e,t)=>{const r=(0,re.fromString)(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n})(e.from.toBytes(),e.sequenceNumber)}async function ce(e){return await oe.sha256.encode(e.data)}function he(e,t,r,n,s){let i=0;const o=new Map;if(Object.entries(t.topics).forEach((([e,t])=>{const n=s.get(e)??"unknown",a=r.topics[e];if(void 0===a)return;let c=o.get(n);c||(c={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(n,c));let h=0,l=0,u=0,d=0,f=0;if(t.inMesh){h+=Math.max(t.meshTime/a.timeInMeshQuantum,a.timeInMeshCap)*a.timeInMeshWeight}let p=t.firstMessageDeliveries;if(p>a.firstMessageDeliveriesCap&&(p=a.firstMessageDeliveriesCap),l+=p*a.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<a.meshMessageDeliveriesThreshold){const e=a.meshMessageDeliveriesThreshold-t.meshMessageDeliveries;u+=e*e*a.meshMessageDeliveriesWeight}d+=t.meshFailurePenalty*a.meshFailurePenaltyWeight;f+=t.invalidMessageDeliveries*t.invalidMessageDeliveries*a.invalidMessageDeliveriesWeight,i+=(h+l+u+d+f)*a.topicWeight,c.p1w+=h,c.p2w+=l,c.p3w+=u,c.p3bw+=d,c.p4w+=f})),r.topicScoreCap>0&&i>r.topicScoreCap){i=r.topicScoreCap;const e=r.topicScoreCap/i;for(const t of o.values())t.p1w*=e,t.p2w*=e,t.p3w*=e,t.p3bw*=e,t.p4w*=e}let a=0,c=0,h=0;a+=r.appSpecificScore(e)*r.appSpecificWeight,t.ips.forEach((e=>{if(r.IPColocationFactorWhitelist.has(e))return;const t=n.get(e),s=t?t.size:0;if(s>r.IPColocationFactorThreshold){const e=s-r.IPColocationFactorThreshold;c+=e*e*r.IPColocationFactorWeight}}));return h+=t.behaviourPenalty*t.behaviourPenalty*r.behaviourPenaltyWeight,i+=a+c+h,{byTopic:o,p5w:a,p6w:c,p7w:h,score:i}}function le(e,t,r=(()=>!0)){const n=new Set;if(t<=0)return n;for(const s of e){if(n.size>=t)break;r(s)&&(n.add(s),e.delete(s))}return n}var ue=r(37430),de=r(73861),fe=r(55150);class pe{constructor(e,t,r){this.rawStream=e,this.pushable=(0,ue.d)({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=r.maxBufferSize??1/0,(0,n.zG)((0,de.wJ)(this.pushable,this.closeController.signal,{returnOnAbort:!0}),(0,fe.c)(),this.rawStream).catch(t)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class ye{constructor(e){this.rawStream=e,this.closeController=new AbortController,this.source=(0,de.wJ)((0,n.zG)(this.rawStream,(0,fe.J)()),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var ge;!function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"}(ge||(ge={}));class be extends c.v{constructor(e={}){super(),this.multicodecs=[p,f],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=(0,ue.d)({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new q,this.directPeerInitial=null,this.status={code:ge.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{const e=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch((e=>{this.log("Error running heartbeat",e)})).finally((()=>{if(null!=e&&e(),this.status.code===ge.started){clearTimeout(this.status.heartbeatTimeout);let e=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;e<.25*this.opts.heartbeatInterval&&(e+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,e)}}))};const t={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...e,scoreParams:N(e.scoreParams),scoreThresholds:B(e.scoreThresholds)};if(this.globalSignaturePolicy=t.globalSignaturePolicy??E,t.fallbackToFloodsub&&this.multicodecs.push(d),this.log=(0,o.kg)(t.debugName??"libp2p:gossipsub"),this.opts=t,this.direct=new Set(t.directPeers.map((e=>e.id.toString()))),this.seenCache=new W({validityMs:t.seenTTL}),this.publishedMessageIds=new W({validityMs:t.seenTTL}),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case E:this.msgIdFn=ae;break;case A:this.msgIdFn=ce}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new W({validityMs:t.seenTTL})),this.msgIdToStrFn=e.msgIdToStrFn??w,this.mcache=e.messageCache||new h(t.mcacheGossip,t.mcacheLength,this.msgIdToStrFn),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const r=Math.max(...Object.values(t.scoreParams.topics).map((e=>e.meshMessageDeliveriesWindow)),1e3),n=function(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:e.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:e.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:e.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:e.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:t,toTopic(e){return this.topicStrToLabel.get(e)??e},onJoin(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh(e,t,r){const n=this.toTopic(e);this.meshPeerInclusionEvents.inc({topic:n,reason:t},r)},onRemoveFromMesh(e,t,r){const n=this.toTopic(e);this.meshPeerChurnEvents.inc({topic:n,reason:t},r)},onReportValidationMcacheHit(e){this.asyncValidationMcacheHit.inc({hit:e?"hit":"miss"})},onReportValidation(e,t){const r=this.toTopic(e);this.asyncValidationResult.inc({topic:r,acceptance:t})},onScorePenalty(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv(e,t,r){const n=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:n},t),this.ihaveRcvNotSeenMsgids.inc({topic:n},r)},onIwantRcv(e,t){for(const[t,r]of e){const e=this.toTopic(t);this.iwantRcvMsgids.inc({topic:e},r)}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg(e,t){const r=this.toTopic(e);this.msgForwardCount.inc({topic:r},1),this.msgForwardPeers.inc({topic:r},t)},onPublishMsg(e,t,r,n){const s=this.toTopic(e);this.msgPublishCount.inc({topic:s},1),this.msgPublishBytes.inc({topic:s},r*n),this.msgPublishPeers.inc({topic:s},r),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"direct"},t.direct),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"floodsub"},t.floodsub),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"mesh"},t.mesh),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"fanout"},t.fanout)},onMsgRecvPreValidation(e){const t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvResult(e,t){const r=this.toTopic(e);this.msgReceivedStatus.inc({topic:r,status:t})},onMsgRecvInvalid(e,t){const r=this.toTopic(e),n=t.reason===k.Error?t.error:t.reason;this.msgReceivedInvalid.inc({topic:r,error:n},1)},onDuplicateMsgDelivery(e,t,r){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),r){const t=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:t},1)}},onRpcRecv(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),e.messages&&this.rpcRecvMessage.inc(e.messages.length),e.control&&(this.rpcRecvControl.inc(1),e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),e.messages&&this.rpcSentMessage.inc(e.messages.length),e.control){const t=e.control.ihave?.length??0,r=e.control.iwant?.length??0,n=e.control.graft?.length??0,s=e.control.prune?.length??0;t>0&&this.rpcSentIHave.inc(t),r>0&&this.rpcSentIWant.inc(r),n>0&&this.rpcSentGraft.inc(n),s>0&&this.rpcSentPrune.inc(s),(t>0||r>0||n>0||s>0)&&this.rpcSentControl.inc(1)}},registerScores(e,t){let r=0,n=0,s=0,i=0;for(const o of e)o>=t.graylistThreshold&&r++,o>=t.publishThreshold&&n++,o>=t.gossipThreshold&&s++,o>=0&&i++;this.peersByScoreThreshold.set({threshold:ee.graylist},r),this.peersByScoreThreshold.set({threshold:ee.publish},n),this.peersByScoreThreshold.set({threshold:ee.gossip},s),this.peersByScoreThreshold.set({threshold:ee.mesh},i),this.score.set(e)},registerScoreWeights(e){for(const[t,r]of e.byTopic)this.scoreWeights.set({topic:t,p:"p1"},r.p1w),this.scoreWeights.set({topic:t,p:"p2"},r.p2w),this.scoreWeights.set({topic:t,p:"p3"},r.p3w),this.scoreWeights.set({topic:t,p:"p3b"},r.p3bw),this.scoreWeights.set({topic:t,p:"p4"},r.p4w);this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh(e,t){const r=new Map;e.forEach(((e,t)=>{const n=this.topicStrToLabel.get(t)??"unknown";let s=r.get(n);s||(s=new Set,r.set(n,s)),e.forEach((e=>s?.add(e)))}));for(const[e,n]of r){const r=[];n.forEach((e=>{r.push(t.get(e)??0)})),this.scorePerMesh.set({topic:e},r)}}}}(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:t.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:r/1e3});n.mcacheSize.addCollect((()=>this.onScrapeMetrics(n)));for(const e of this.multicodecs)n.protocolsEnabled.set({protocol:e},1);this.metrics=n}else this.metrics=null;this.gossipTracer=new G(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new H(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:t.heartbeatInterval}),this.maxInboundStreams=e.maxInboundStreams,this.maxOutboundStreams=e.maxOutboundStreams}getPeers(){return[...this.peers.keys()].map((e=>(0,i.jE)(e)))}isStarted(){return this.status.code===ge.started}async init(e){this.components=e,this.score.init(e)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await async function(e,t){switch(e){case E:{if(!t)throw Error("Must provide PeerId");if(null==t.privateKey)throw Error("Cannot sign message, no private key present");if(null==t.publicKey)throw Error("Cannot sign message, no public key present");const e=await(0,v.unmarshalPrivateKey)(t.privateKey);return{type:_.Signing,author:t,key:t.publicKey,privateKey:e}}case A:return{type:_.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}(this.globalSignaturePolicy,this.components.getPeerId()),this.outboundInflightQueue=(0,ue.d)({objectMode:!0}),(0,n.zG)(this.outboundInflightQueue,(async e=>{for await(const{peerId:t,connection:r}of e)await this.createOutboundStream(t,r)})).catch((e=>this.log.error("outbound inflight queue error",e))),await Promise.all(this.opts.directPeers.map((async e=>{await this.components.getPeerStore().addressBook.add(e.id,e.addrs)})));const e=this.components.getRegistrar();await Promise.all(this.multicodecs.map((t=>e.handle(t,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))));const t=(0,a.a)({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),r=await Promise.all(this.multicodecs.map((r=>e.register(r,t)))),s=setTimeout(this.runHeartbeat,100);this.status={code:ge.started,registrarTopologyIds:r,heartbeatTimeout:s,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout((()=>{Promise.resolve().then((async()=>{await Promise.all(Array.from(this.direct).map((async e=>await this.connect(e))))})).catch((e=>{this.log(e)}))}),1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==ge.started)return;const{registrarTopologyIds:e}=this.status;this.status={code:ge.stopped};const t=this.components.getRegistrar();e.forEach((e=>t.unregister(e))),this.outboundInflightQueue.end();for(const e of this.streamsOutbound.values())e.close();this.streamsOutbound.clear();for(const e of this.streamsInbound.values())e.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:t}){if(!this.isStarted())return;const r=t.remotePeer;this.addPeer(r,t.stat.direction),this.createInboundStream(r,e),this.outboundInflightQueue.push({peerId:r,connection:t})}onPeerConnected(e,t){this.isStarted()&&(this.addPeer(e,t.stat.direction),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(this.peers.has(r)&&!this.streamsOutbound.has(r))try{const n=new pe(await t.newStream(this.multicodecs),(e=>this.log.error("outbound pipe error",e)),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(r,n);const s=n.protocol;s===d&&this.floodsubPeers.add(r),this.metrics?.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",r),this.sendSubscriptions(r,Array.from(this.subscriptions),!0))}catch(e){this.log.error("createOutboundStream error",e)}}async createInboundStream(e,t){if(!this.isStarted())return;const r=e.toString();if(!this.peers.has(r))return;const n=this.streamsInbound.get(r);void 0!==n&&(this.log("replacing existing inbound steam %s",r),n.close()),this.log("create inbound stream %s",r);const s=new ye(t);this.streamsInbound.set(r,s),this.pipePeerReadStream(e,s.source).catch((e=>this.log(e)))}addPeer(e,t){const r=e.toString();this.peers.has(r)||(this.log("new peer %p",e),this.peers.add(r),this.score.addPeer(r),this.outbound.has(r)||this.outbound.set(r,"outbound"===t))}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const r=this.streamsOutbound.get(t),n=this.streamsInbound.get(t);r&&this.metrics?.peersPerProtocol.inc({protocol:r.protocol},-1),r?.close(),n?.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const e of this.topics.values())e.delete(t);for(const[e,r]of this.mesh)!0===r.delete(t)&&this.metrics?.onRemoveFromMesh(e,Q.Dc,1);for(const e of this.fanout.values())e.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===ge.started}getMeshPeers(e){const t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(t?Array.from(t):[]).map((e=>(0,i.jE)(e)))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await(0,n.zG)(t,(async t=>{for await(const r of t)try{const t=r.subarray(),n=u.decode(t);this.metrics?.onRpcRecv(n,t.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,n):this.handleReceivedRpc(e,n).catch((e=>this.log(e)))}catch(e){this.log(e)}}))}catch(t){this.log.error(t),this.onPeerDisconnected(e)}}async handleReceivedRpc(e,t){if(!this.acceptFrom(e.toString()))return this.log("received message from unacceptable peer %p",e),void this.metrics?.rpcRecvNotAccepted.inc();if(this.log("rpc from %p",e),t.subscriptions&&t.subscriptions.length>0&&(t.subscriptions.forEach((t=>{this.handleReceivedSubscription(e,t)})),this.dispatchEvent(new c.A("subscription-change",{detail:{peerId:e,subscriptions:t.subscriptions.filter((e=>null!==e.topic)).map((e=>({topic:e.topic??"",subscribe:Boolean(e.subscribe)})))}}))),t.messages)for(const r of t.messages){const t=this.handleReceivedMessage(e,r).catch((e=>this.log(e)));this.opts.awaitRpcMessageHandler&&await t}t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t){if(null==t.topic)return;this.log("subscription update from %p topic %s",e,t.topic);let r=this.topics.get(t.topic);null==r&&(r=new Set,this.topics.set(t.topic,r)),t.subscribe?r.add(e.toString()):r.delete(e.toString())}async handleReceivedMessage(e,t){this.metrics?.onMsgRecvPreValidation(t.topic);const r=await this.validateReceivedMessage(e,t);switch(this.metrics?.onMsgRecvResult(t.topic,r.code),r.code){case T.duplicate:return this.score.duplicateMessage(e.toString(),r.msgIdStr,t.topic),void this.mcache.observeDuplicate(r.msgIdStr,e.toString());case T.invalid:if(r.msgIdStr){const n=r.msgIdStr;this.score.rejectMessage(e.toString(),n,t.topic,r.reason),this.gossipTracer.rejectMessage(n,r.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);return void this.metrics?.onMsgRecvInvalid(t.topic,r);case T.valid:if(this.score.validateMessage(r.messageId.msgIdStr),this.gossipTracer.deliverMessage(r.messageId.msgIdStr),this.mcache.put(r.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)){this.components.getPeerId().equals(e)&&!this.opts.emitSelf||(super.dispatchEvent(new c.A("gossipsub:message",{detail:{propagationSource:e,msgId:r.messageId.msgIdStr,msg:r.msg}})),super.dispatchEvent(new c.A("message",{detail:r.msg})))}this.opts.asyncValidation||this.forwardMessage(r.messageId.msgIdStr,t,e.toString())}}async validateReceivedMessage(e,t){const r=this.fastMsgIdFn?.(t),n=r?this.fastMsgIdCache?.get(r):void 0;if(n)return{code:T.duplicate,msgIdStr:n};const s=await async function(e,t){switch(e){case A:return null!=t.signature?{valid:!1,error:I.SignaturePresent}:null!=t.seqno?{valid:!1,error:I.SeqnoPresent}:null!=t.key?{valid:!1,error:I.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:t.data??new Uint8Array(0)}};case E:{if(null==t.seqno)return{valid:!1,error:I.InvalidSeqno};if(8!==t.seqno.length)return{valid:!1,error:I.InvalidSeqno};if(null==t.signature)return{valid:!1,error:I.InvalidSignature};if(null==t.from)return{valid:!1,error:I.InvalidPeerId};let e,r;try{e=(0,i.cv)(t.from)}catch(e){return{valid:!1,error:I.InvalidPeerId}}if(t.key){if(r=(0,v.unmarshalPublicKey)(t.key),void 0!==e.publicKey&&!(0,se.equals)(r.bytes,e.publicKey))return{valid:!1,error:I.InvalidPeerId}}else{if(null==e.publicKey)return{valid:!1,error:I.InvalidPeerId};r=(0,v.unmarshalPublicKey)(e.publicKey)}const n={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},s=(0,te.concat)([ie,u.Message.encode(n).finish()]);return await r.verify(s,t.signature)?{valid:!0,message:{type:"signed",from:e,data:t.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${(0,m.toString)(t.seqno,"base16")}`),topic:t.topic,signature:t.signature,key:t.key??(0,v.marshalPublicKey)(r)}}:{valid:!1,error:I.InvalidSignature}}}}(this.globalSignaturePolicy,t);if(!s.valid)return{code:T.invalid,reason:k.Error,error:s.error};const o=s.message;try{this.dataTransform&&(o.data=this.dataTransform.inboundTransform(t.topic,o.data))}catch(e){return this.log("Invalid message, transform failed",e),{code:T.invalid,reason:k.Error,error:I.TransformFailed}}const a=await this.msgIdFn(o),c=this.msgIdToStrFn(a),h={msgId:a,msgIdStr:c};if(r&&this.fastMsgIdCache?.put(r,c),this.seenCache.has(c))return{code:T.duplicate,msgIdStr:c};this.seenCache.put(c);const l=this.topicValidators.get(t.topic);if(null!=l){let t;try{t=await l(o.topic,o,e)}catch(e){const r=e.code;"ERR_TOPIC_VALIDATOR_IGNORE"===r&&(t=C.Ignore),t="ERR_TOPIC_VALIDATOR_REJECT"===r?C.Reject:C.Ignore}if(t!==C.Accept)return{code:T.invalid,reason:x(t),msgIdStr:c}}return{code:T.valid,messageId:h,msg:o}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,r){this.sendRpc(e,{subscriptions:t.map((e=>({topic:e,subscribe:r}))),messages:[]})}async handleControlMessage(e,t){if(void 0===t)return;const r=t.ihave?this.handleIHave(e,t.ihave):[],n=t.iwant?this.handleIWant(e,t.iwant):[],s=t.graft?await this.handleGraft(e,t.graft):[];t.prune&&await this.handlePrune(e,t.prune),(r.length||n.length||s.length)&&this.sendRpc(e,g(n,{iwant:r,prune:s}))}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),r=this.acceptFromWhitelist.get(e);if(r&&r.messagesAccepted<128&&r.acceptUntil>=t)return r.messagesAccepted+=1,!0;const n=this.score.score(e);return n>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,r),this.metrics?.ihaveRcvIgnored.inc({reason:X.LowScore}),[];const n=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,n),n>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:X.MaxIhave}),[];const s=this.iasked.get(e)??0;if(s>=y)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:X.MaxIasked}),[];const i=new Map;if(t.forEach((({topicID:e,messageIDs:t})=>{if(!e||!t||!this.mesh.has(e))return;let r=0;t.forEach((e=>{const t=this.msgIdToStrFn(e);this.seenCache.has(t)||(i.set(t,e),r++)})),this.metrics?.onIhaveRcv(e,t.length,r)})),!i.size)return[];let o=i.size;o+s>y&&(o=y-s),this.log("IHAVE: Asking for %d out of %d messages from %s",o,i.size,e);let a=Array.from(i.values());return b(a),a=a.slice(0,o),this.iasked.set(e,s+o),this.gossipTracer.addPromise(e,a),[{messageIDs:a}]}handleIWant(e,t){if(!t.length)return[];const r=this.score.score(e);if(r<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,r),[];const n=new Map,s=new Map;let i=0;return t.forEach((({messageIDs:t})=>{t&&t.forEach((t=>{const r=this.msgIdToStrFn(t),o=this.mcache.getWithIWantCount(r,e);null!=o?(s.set(o.msg.topic,1+(s.get(o.msg.topic)??0)),o.count>3?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):n.set(r,o.msg)):i++}))})),this.metrics?.onIwantRcv(s,i),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,t){const r=[],n=this.score.score(e),s=Date.now();let i=this.opts.doPX;return t.forEach((({topicID:t})=>{if(!t)return;const o=this.mesh.get(t);if(!o)return void(i=!1);if(o.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),r.push(t),void(i=!1);const a=this.backoff.get(t)?.get(e);if("number"==typeof a&&s<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,Z.GraftBackoff),i=!1;const n=a+this.opts.graftFloodThreshold-this.opts.pruneBackoff;return s<n&&this.score.addPenalty(e,1,Z.GraftBackoff),this.addBackoff(e,t),void r.push(t)}return n<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,t),r.push(t),i=!1,void this.addBackoff(e,t)):o.size>=this.opts.Dhi&&!this.outbound.get(e)?(r.push(t),void this.addBackoff(e,t)):(this.log("GRAFT: Add mesh link from %s in %s",e,t),this.score.graft(e,t),o.add(e),void this.metrics?.onAddToMesh(t,Y.Subscribed,1))})),r.length?await Promise.all(r.map((t=>this.makePrune(e,t,i)))):[]}async handlePrune(e,t){const r=this.score.score(e);for(const{topicID:n,backoff:s,peers:i}of t){if(null==n)continue;const t=this.mesh.get(n);if(!t)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),t.has(e)&&(t.delete(e),this.metrics?.onRemoveFromMesh(n,Q.Unsub,1)),"number"==typeof s&&s>0?this.doAddBackoff(e,n,1e3*s):this.addBackoff(e,n),i&&i.length){if(r<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,r,n);continue}await this.pxConnect(i)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,r){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));const s=Date.now()+r;(n.get(e)??0)<s&&n.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach(((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,Z.BrokenPromise)}))}clearBackoff(){if(this.heartbeatTicks%15!=0)return;const e=Date.now();this.backoff.forEach(((t,r)=>{t.forEach(((r,n)=>{r<e&&t.delete(n)})),0===t.size&&this.backoff.delete(r)}))}async directConnect(){const e=[];this.direct.forEach((t=>{this.streamsOutbound.has(t)||e.push(t)})),await Promise.all(e.map((async e=>await this.connect(e))))}async pxConnect(e){e.length>this.opts.prunePeers&&(b(e),e=e.slice(0,this.opts.prunePeers));const t=[];await Promise.all(e.map((async e=>{if(!e.peerID)return;const r=(0,i.cv)(e.peerID).toString();if(!this.peers.has(r))if(e.signedPeerRecord)try{const n=await s.X.openAndCertify(e.signedPeerRecord,"libp2p-peer-record"),i=n.peerId;if(!n.peerId.equals(r))return void this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",i,r);if(!await this.components.getPeerStore().addressBook.consumePeerRecord(n))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(r)}catch(e){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(r)}))),t.length&&await Promise.all(t.map((async e=>await this.connect(e))))}async connect(e){this.log("Initiating connection with %s",e);const t=(0,i.jE)(e),r=await this.components.getConnectionManager().openConnection(t);for(const e of this.multicodecs)for(const n of this.components.getRegistrar().getTopologies(e))n.onConnect(t,r)}subscribe(e){if(this.status.code!==ge.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==ge.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!1);this.leave(e).catch((e=>{this.log(e)}))}join(e){if(this.status.code!==ge.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);const t=new Set,r=this.fanout.get(e);if(r&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),r.forEach((e=>{!this.direct.has(e)&&this.score.score(e)>=0&&t.add(e)})),this.metrics?.onAddToMesh(e,Y.Fanout,t.size)),t.size<this.opts.D){const r=t.size;this.getRandomGossipPeers(e,this.opts.D,(e=>!t.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0)).forEach((e=>{t.add(e)})),this.metrics?.onAddToMesh(e,Y.Random,t.size-r)}this.mesh.set(e,t),t.forEach((t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this.sendGraft(t,e)}))}async leave(e){if(this.status.code!==ge.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);const t=this.mesh.get(e);t&&(await Promise.all(Array.from(t).map((async t=>(this.log("LEAVE: Remove mesh link to %s in %s",t,e),await this.sendPrune(t,e))))),this.mesh.delete(e))}selectPeersToForward(e,t,r){const n=new Set,s=this.topics.get(e);s&&(this.direct.forEach((e=>{s.has(e)&&t!==e&&!r?.has(e)&&n.add(e)})),this.floodsubPeers.forEach((e=>{s.has(e)&&t!==e&&!r?.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&n.add(e)})));const i=this.mesh.get(e);return i&&i.size>0&&i.forEach((e=>{t===e||r?.has(e)||n.add(e)})),n}selectPeersToPublish(e){const t=new Set,r={direct:0,floodsub:0,mesh:0,fanout:0},n=this.topics.get(e);if(n)if(this.opts.floodPublish)n.forEach((e=>{this.direct.has(e)?(t.add(e),r.direct++):this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));else{this.direct.forEach((e=>{n.has(e)&&(t.add(e),r.direct++)})),this.floodsubPeers.forEach((e=>{n.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),r.floodsub++)}));const s=this.mesh.get(e);if(s&&s.size>0)s.forEach((e=>{t.add(e),r.mesh++}));else{const n=this.fanout.get(e);if(n&&n.size>0)n.forEach((e=>{t.add(e),r.fanout++}));else{const n=this.getRandomGossipPeers(e,this.opts.D,(e=>this.score.score(e)>=this.opts.scoreThresholds.publishThreshold));n.size>0&&(this.fanout.set(e,n),n.forEach((e=>{t.add(e),r.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:r}}forwardMessage(e,t,r,n){r&&this.score.deliverMessage(r,e,t.topic);const s=this.selectPeersToForward(t.topic,r,n),i=g([t]);s.forEach((e=>{this.sendRpc(e,i)})),this.metrics?.onForwardMsg(t.topic,s.size)}async publish(e,t){const r=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");const{raw:n,msg:s}=await async function(e,t,r,n){switch(e.type){case _.Signing:{const s={from:e.author.toBytes(),data:n,seqno:(0,ne.O6)(8),topic:t,signature:void 0,key:void 0},i=(0,te.concat)([ie,u.Message.encode(s).finish()]);return s.signature=await e.privateKey.sign(i),s.key=e.key,{raw:s,msg:{type:"signed",from:e.author,data:r,sequenceNumber:BigInt(`0x${(0,m.toString)(s.seqno,"base16")}`),topic:t,signature:s.signature,key:s.key}}}case _.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:t}}}}(this.publishConfig,e,t,r),o=await this.msgIdFn(s),a=this.msgIdToStrFn(o);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");const{tosend:h,tosendCount:l}=this.selectPeersToPublish(e),d=!0===this.opts.emitSelf&&this.subscriptions.has(e);if(0===h.size&&!this.opts.allowPublishToZeroPeers&&!d)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:o,msgIdStr:a},n,!0),this.publishedMessageIds.put(a);const f=g([n]);for(const e of h){this.sendRpc(e,f)||h.delete(e)}return this.metrics?.onPublishMsg(e,l,h.size,null!=n.data?n.data.length:0),d&&(h.add(this.components.getPeerId().toString()),super.dispatchEvent(new c.A("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:a,msg:s}})),super.dispatchEvent(new c.A("message",{detail:s}))),{recipients:Array.from(h.values()).map((e=>(0,i.jE)(e)))}}reportMessageValidationResult(e,t,r){if(r===C.Accept){const n=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(null!==n),null!=n){const{message:s,originatingPeers:i}=n;this.score.deliverMessage(t.toString(),e,s.topic),this.forwardMessage(e,n.message,t.toString(),i),this.metrics?.onReportValidation(s.topic,r)}}else{const n=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(null!==n),n){const s=x(r),{message:i,originatingPeers:o}=n;this.score.rejectMessage(t.toString(),e,i.topic,s);for(const t of o)this.score.rejectMessage(t,e,i.topic,s);this.metrics?.onReportValidation(i.topic,r)}}}sendGraft(e,t){const r=g([],{graft:[{topicID:t}]});this.sendRpc(e,r)}async sendPrune(e,t){const r=g([],{prune:[await this.makePrune(e,t,this.opts.doPX)]});this.sendRpc(e,r)}sendRpc(e,t){const r=this.streamsOutbound.get(e);if(!r)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;const n=this.control.get(e);n&&(this.piggybackControl(e,t,n),this.control.delete(e));const s=this.gossip.get(e);s&&(this.piggybackGossip(e,t,s),this.gossip.delete(e));const i=u.encode(t).finish();try{r.push(i)}catch(t){return this.log.error(`Cannot send rpc to ${e}`,t),n&&this.control.set(e,n),s&&this.gossip.set(e,s),!1}return this.metrics?.onRpcSent(t,i.length),!0}piggybackControl(e,t,r){const n=(r.graft||[]).filter((({topicID:t})=>(t&&this.mesh.get(t)||new Set).has(e))),s=(r.prune||[]).filter((({topicID:t})=>!(t&&this.mesh.get(t)||new Set).has(e)));(n.length||s.length)&&(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(s)):t.control={graft:n,prune:s,ihave:[],iwant:[]})}piggybackGossip(e,t,r){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=r}async sendGraftPrune(e,t,r){const n=this.opts.doPX;for(const[s,i]of e){const e=i.map((e=>({topicID:e})));let o=[];const a=t.get(s);a&&(o=await Promise.all(a.map((async e=>await this.makePrune(s,e,n&&!r.get(s))))),t.delete(s));const c=g([],{graft:e,prune:o});this.sendRpc(s,c)}for(const[e,s]of t){const t=g([],{prune:await Promise.all(s.map((async t=>await this.makePrune(e,t,n&&!r.get(e)))))});this.sendRpc(e,t)}}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[r,n]of e)this.doEmitGossip(r,n,t.get(r)??[])}doEmitGossip(e,t,r){if(!r.length)return;if(b(r),r.length>y&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length),!t.size)return;let n=this.opts.Dlazy;const s=.25*t.size;let i=t;s>n&&(n=s),n>i.size?n=i.size:i=b(Array.from(i)).slice(0,n),i.forEach((t=>{let n=r;r.length>y&&(n=b(n.slice()).slice(0,y)),this.pushGossip(t,{topicID:e,messageIDs:n})}))}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,g([],{ihave:t}));for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,g([],{graft:t.graft,prune:t.prune}))}pushGossip(e,t){this.log("Add gossip to %s",e);const r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}async makePrune(e,t,r){if(this.score.prune(e,t),this.streamsOutbound.get(e).protocol===f)return{topicID:t,peers:[]};const n=this.opts.pruneBackoff/1e3;if(!r)return{topicID:t,peers:[],backoff:n};const s=this.getRandomGossipPeers(t,this.opts.prunePeers,(t=>t!==e&&this.score.score(t)>=0)),o=await Promise.all(Array.from(s).map((async e=>{const t=(0,i.jE)(e);return{peerID:t.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(t)}})));return{topicID:t,peers:o,backoff:n}}async heartbeat(){const{D:e,Dlo:t,Dhi:r,Dscore:n,Dout:s,fanoutTTL:i}=this.opts;this.heartbeatTicks++;const o=new Map,a=e=>{let t=o.get(e);return void 0===t&&(t=this.score.score(e),o.set(e,t)),t},h=new Map,l=new Map,u=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks==0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const d=new Map;this.mesh.forEach(((i,o)=>{const c=this.topics.get(o),f=new Set,p=new Set;if(d.set(o,p),c){const e=b(Array.from(c)),t=this.backoff.get(o);for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!i.has(r)&&!this.direct.has(r)){const e=a(r);t&&t.has(r)||!(e>=0)||f.add(r),e>=this.opts.scoreThresholds.gossipThreshold&&p.add(r)}}}const y=(e,t)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",e,o),this.addBackoff(e,o),i.delete(e),a(e)>=this.opts.scoreThresholds.gossipThreshold&&p.add(e),this.metrics?.onRemoveFromMesh(o,t,1);const r=l.get(e);r?r.push(o):l.set(e,[o])},g=(e,t)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",e,o),this.score.graft(e,o),i.add(e),p.delete(e),this.metrics?.onAddToMesh(o,t,1);const r=h.get(e);r?r.push(o):h.set(e,[o])};if(i.forEach((e=>{const t=a(e);t<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,t,o),y(e,Q.BadScore),u.set(e,!0))})),i.size<t){const t=function(e,t){return le(e,t,(()=>!0))}(f,e-i.size);t.forEach((e=>{g(e,Y.NotEnough)}))}if(i.size>r){let t=Array.from(i);t.sort(((e,t)=>a(t)-a(e))),t=t.slice(0,n).concat(b(t.slice(n)));let r=0;if(t.slice(0,e).forEach((e=>{this.outbound.get(e)&&r++})),r<s){const n=e=>{const r=t[e];for(let r=e;r>0;r--)t[r]=t[r-1];t[0]=r};if(r>0){let s=r;for(let r=1;r<e&&s>0;r++)this.outbound.get(t[r])&&(n(r),s--)}let s=e-r;for(let r=e;r<t.length&&s>0;r++)this.outbound.get(t[r])&&(n(r),s--)}t.slice(e).forEach((e=>{y(e,Q.Excess)}))}if(i.size>=t){let e=0;if(i.forEach((t=>{this.outbound.get(t)&&e++})),e<s){le(f,s-e,(e=>!0===this.outbound.get(e))).forEach((e=>{g(e,Y.Outbound)}))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks==0&&i.size>1){const e=Array.from(i).sort(((e,t)=>a(e)-a(t))),t=Math.floor(i.size/2),r=a(e[t]);if(r<this.opts.scoreThresholds.opportunisticGraftThreshold){const e=le(f,this.opts.opportunisticGraftPeers,(e=>a(e)>r));for(const t of e)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",t,o),g(t,Y.Opportunistic)}}}));const f=Date.now();this.fanoutLastpub.forEach(((e,t)=>{e+i<f&&(this.fanout.delete(t),this.fanoutLastpub.delete(t))})),this.fanout.forEach(((t,r)=>{const n=this.topics.get(r);t.forEach((e=>{(!n.has(e)||a(e)<this.opts.scoreThresholds.publishThreshold)&&t.delete(e)}));const s=this.topics.get(r),i=[],o=new Set;if(d.set(r,o),s){const e=b(Array.from(s));for(const r of e){const e=this.streamsOutbound.get(r);if(e&&this.multicodecs.includes(e.protocol)&&!t.has(r)&&!this.direct.has(r)){const e=a(r);e>=this.opts.scoreThresholds.publishThreshold&&i.push(r),e>=this.opts.scoreThresholds.gossipThreshold&&o.add(r)}}}if(t.size<e){const r=e-t.size;i.slice(0,r).forEach((e=>{t.add(e),o?.delete(e)}))}})),this.emitGossip(d),await this.sendGraftPrune(h,l,u),this.flush(),this.mcache.shift(),this.dispatchEvent(new c.A("gossipsub:heartbeat"))}getRandomGossipPeers(e,t,r=(()=>!0)){const n=this.topics.get(e);if(!n)return new Set;let s=[];return n.forEach((e=>{const t=this.streamsOutbound.get(e);t&&this.multicodecs.includes(t.protocol)&&r(e)&&s.push(e)})),s=b(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let t=0;for(const e of this.backoff.values())t+=e.size;e.cacheSize.set({cache:"backoff"},t);for(const[t,r]of this.topics)e.topicPeersCount.set({topicStr:t},r.size);for(const[t,r]of this.mesh)e.meshPeerCounts.set({topicStr:t},r.size);const r=[],n=new Map;e.behaviourPenalty.reset();for(const t of this.peers.keys()){const s=this.score.score(t);r.push(s),n.set(t,s),e.behaviourPenalty.observe(this.score.peerStats.get(t)?.behaviourPenalty??0)}e.registerScores(r,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,n);const s=function(e,t,r,n,s){const i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const o of e){const e=t.get(o);if(e){const t=he(o,e,r,n,s);for(const[e,r]of t.byTopic){let t=i.byTopic.get(e);t||(t={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(e,t)),t.p1w.push(r.p1w),t.p2w.push(r.p2w),t.p3w.push(r.p3w),t.p3bw.push(r.p3bw),t.p4w.push(r.p4w)}i.p5w.push(t.p5w),i.p6w.push(t.p6w),i.p7w.push(t.p7w),i.score.push(t.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}}be.multicodec=p;const me=()=>({gossipsub:e=>{const t=new be({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128});return t.init({getPeerId:()=>e.peerId,getPeerStore:()=>e.peerStore,getRegistrar:()=>e.registrar,getConnectionManager:()=>e.connectionManager}),t}})},43980:(e,t,r)=>{"use strict";r.d(t,{s:()=>Ds});var n={};r.r(n),r.d(n,{Decoder:()=>je,Encoder:()=>ze,PacketType:()=>Ve,protocol:()=>Me});var s={};r.r(s),r.d(s,{identity:()=>lt});var i={};r.r(i),r.d(i,{base2:()=>ut});var o={};r.r(o),r.d(o,{base8:()=>dt});var a={};r.r(a),r.d(a,{base10:()=>ft});var c={};r.r(c),r.d(c,{base16:()=>pt,base16upper:()=>yt});var h={};r.r(h),r.d(h,{base32:()=>gt,base32hex:()=>vt,base32hexpad:()=>At,base32hexpadupper:()=>St,base32hexupper:()=>Et,base32pad:()=>mt,base32padupper:()=>wt,base32upper:()=>bt,base32z:()=>_t});var l={};r.r(l),r.d(l,{base36:()=>Ct,base36upper:()=>kt});var u={};r.r(u),r.d(u,{base58btc:()=>It,base58flickr:()=>Tt});var d={};r.r(d),r.d(d,{base64:()=>xt,base64pad:()=>Rt,base64url:()=>Pt,base64urlpad:()=>Dt});var f={};r.r(f),r.d(f,{base256emoji:()=>Ut});var p={};r.r(p),r.d(p,{sha256:()=>sr,sha512:()=>ir});var y={};r.r(y),r.d(y,{identity:()=>ar});var g={};r.r(g),r.d(g,{code:()=>hr,decode:()=>ur,encode:()=>lr,name:()=>cr});var b={};r.r(b),r.d(b,{code:()=>yr,decode:()=>br,encode:()=>gr,name:()=>pr});var m={};r.r(m),r.d(m,{identity:()=>hn});var w={};r.r(w),r.d(w,{base2:()=>ln});var v={};r.r(v),r.d(v,{base8:()=>un});var E={};r.r(E),r.d(E,{base10:()=>dn});var A={};r.r(A),r.d(A,{base16:()=>fn,base16upper:()=>pn});var S={};r.r(S),r.d(S,{base32:()=>yn,base32hex:()=>wn,base32hexpad:()=>En,base32hexpadupper:()=>An,base32hexupper:()=>vn,base32pad:()=>bn,base32padupper:()=>mn,base32upper:()=>gn,base32z:()=>Sn});var _={};r.r(_),r.d(_,{base36:()=>_n,base36upper:()=>Cn});var C={};r.r(C),r.d(C,{base58btc:()=>kn,base58flickr:()=>In});var k={};r.r(k),r.d(k,{base64:()=>Tn,base64pad:()=>xn,base64url:()=>Rn,base64urlpad:()=>Pn});var I={};r.r(I),r.d(I,{base256emoji:()=>Ln});var T={};r.r(T),r.d(T,{sha256:()=>ns,sha512:()=>ss});var x={};r.r(x),r.d(x,{identity:()=>os});var R={};r.r(R),r.d(R,{code:()=>cs,decode:()=>ls,encode:()=>hs,name:()=>as});var P={};r.r(P),r.d(P,{code:()=>ps,decode:()=>gs,encode:()=>ys,name:()=>fs});var D=r(38461),O=r(32114),N=r(73861),L=r(94306),U=r(76237);const B=Object.create(null);B.open="0",B.close="1",B.ping="2",B.pong="3",B.message="4",B.upgrade="5",B.noop="6";const M=Object.create(null);Object.keys(B).forEach((e=>{M[B[e]]=e}));const V={type:"error",data:"parser error"},z="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),j="function"==typeof ArrayBuffer,F=(e,t)=>{const r=new FileReader;return r.onload=function(){const e=r.result.split(",")[1];t("b"+e)},r.readAsDataURL(e)},$=({type:e,data:t},r,n)=>{return z&&t instanceof Blob?r?n(t):F(t,n):j&&(t instanceof ArrayBuffer||(s=t,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer))?r?n(t):F(new Blob([t]),n):n(B[e]+(t||""));var s},q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<q.length;e++)K[q.charCodeAt(e)]=e;const H="function"==typeof ArrayBuffer,G=(e,t)=>{if(H){const r=(e=>{let t,r,n,s,i,o=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const h=new ArrayBuffer(o),l=new Uint8Array(h);for(t=0;t<a;t+=4)r=K[e.charCodeAt(t)],n=K[e.charCodeAt(t+1)],s=K[e.charCodeAt(t+2)],i=K[e.charCodeAt(t+3)],l[c++]=r<<2|n>>4,l[c++]=(15&n)<<4|s>>2,l[c++]=(3&s)<<6|63&i;return h})(e);return W(r,t)}return{base64:!0,data:e}},W=(e,t)=>"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e,J=(e,t)=>{if("string"!=typeof e)return{type:"message",data:W(e,t)};const r=e.charAt(0);if("b"===r)return{type:"message",data:G(e.substring(1),t)};return M[r]?e.length>1?{type:M[r],data:e.substring(1)}:{type:M[r]}:V},Y=String.fromCharCode(30);var Q=r(43063);const Z="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function X(e,...t){return t.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const ee=setTimeout,te=clearTimeout;function re(e,t){t.useNativeTimers?(e.setTimeoutFn=ee.bind(Z),e.clearTimeoutFn=te.bind(Z)):(e.setTimeoutFn=setTimeout.bind(Z),e.clearTimeoutFn=clearTimeout.bind(Z))}class ne extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class se extends Q.Q{constructor(e){super(),this.writable=!1,re(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new ne(e,t,r)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=J(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}}const ie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),oe={};let ae,ce=0,he=0;function le(e){let t="";do{t=ie[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function ue(){const e=le(+new Date);return e!==ae?(ce=0,ae=e):e+"."+le(ce++)}for(;he<64;he++)oe[ie[he]]=he;function de(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}let fe=!1;try{fe="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}const pe=fe;function ye(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||pe))return new XMLHttpRequest}catch(e){}if(!t)try{return new(Z[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function ge(){}const be=null!=new ye({xdomain:!1}).responseType;class me extends Q.Q{constructor(e,t){super(),re(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=X(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new ye(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{4===t.readyState&&(200===t.status||1223===t.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=me.requestsCount++,me.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=ge,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete me.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(me.requestsCount=0,me.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",we);else if("function"==typeof addEventListener){addEventListener("onpagehide"in Z?"pagehide":"unload",we,!1)}function we(){for(let e in me.requests)me.requests.hasOwnProperty(e)&&me.requests[e].abort()}const ve="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Ee=Z.WebSocket||Z.MozWebSocket;r(48764).Buffer;const Ae="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const Se={websocket:class extends se{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=Ae?{}:X(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Ae?new Ee(e,t,r):t?new Ee(e,t):new Ee(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],n=t===e.length-1;$(r,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}n&&ve((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=ue()),this.supportsBinary||(e.b64=1);const n=de(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!Ee}},polling:class extends se{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let r=location.port;r||(r=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=be&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const r=e.split(Y),n=[];for(let e=0;e<r.length;e++){const s=J(r[e],t);if(n.push(s),"error"===s.type)break}return n})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach(((e,i)=>{$(e,!1,(e=>{n[i]=e,++s===r&&t(n.join(Y))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=ue()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(r=":"+this.opts.port);const n=de(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new me(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},_e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ce=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ke(e){const t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=_e.exec(e||""),i={},o=14;for(;o--;)i[Ce[o]]=s[o]||"";return-1!=r&&-1!=n&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,i.path),i.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,i.query),i}class Ie extends Q.Q{constructor(e,t={}){super(),e&&"object"==typeof e&&(t=e,e=null),e?(e=ke(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=ke(t.host).host),re(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},r=e.split("&");for(let e=0,n=r.length;e<n;e++){let n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Se[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Ie.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),r=!1;Ie.priorWebsocketSuccess=!1;const n=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!r)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ie.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{r||"closed"!==this.readyState&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function s(){r||(r=!0,h(),t.close(),t=null)}const i=e=>{const r=new Error("probe error: "+e);r.transport=t.name,s(),this.emitReserved("upgradeError",r)};function o(){i("transport closed")}function a(){i("socket closed")}function c(e){t&&e.name!==t.name&&s()}const h=()=>{t.removeListener("open",n),t.removeListener("error",i),t.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};t.once("open",n),t.once("error",i),t.once("close",o),this.once("close",a),this.once("upgrading",c),t.open()}onOpen(){if(this.readyState="open",Ie.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(e+="string"==typeof(t=n)?function(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(t):Math.ceil(1.33*(t.byteLength||t.size))),r>0&&e>this.maxPayload)return this.writeBuffer.slice(0,r);e+=2}var t;return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?r():e()})):this.upgrading?r():e()),this}onError(e){Ie.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}Ie.protocol=4;Ie.protocol;const Te="function"==typeof ArrayBuffer,xe=Object.prototype.toString,Re="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===xe.call(Blob),Pe="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===xe.call(File);function De(e){return Te&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Re&&e instanceof Blob||Pe&&e instanceof File}function Oe(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(Oe(e[t]))return!0;return!1}if(De(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Oe(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&Oe(e[t]))return!0;return!1}function Ne(e){const t=[],r=e.data,n=e;return n.data=Le(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Le(e,t){if(!e)return e;if(De(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Le(e[n],t);return r}if("object"==typeof e&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Le(e[n],t));return r}return e}function Ue(e,t){return e.data=Be(e.data,t),e.attachments=void 0,e}function Be(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Be(e[r],t);else if("object"==typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Be(e[r],t));return e}const Me=5;var Ve;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Ve||(Ve={}));class ze{constructor(e){this.replacer=e}encode(e){return e.type!==Ve.EVENT&&e.type!==Ve.ACK||!Oe(e)?[this.encodeAsString(e)]:(e.type=e.type===Ve.EVENT?Ve.BINARY_EVENT:Ve.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return e.type!==Ve.BINARY_EVENT&&e.type!==Ve.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Ne(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}class je extends Q.Q{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e),t.type===Ve.BINARY_EVENT||t.type===Ve.BINARY_ACK?(this.reconstructor=new Fe(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!De(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(void 0===Ve[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Ve.BINARY_EVENT||r.type===Ve.BINARY_ACK){const n=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const s=e.substring(n,t);if(s!=Number(s)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(s)}if("/"===e.charAt(t+1)){const n=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(n,t)}else r.nsp="/";const n=e.charAt(t+1);if(""!==n&&Number(n)==n){const n=t+1;for(;++t;){const r=e.charAt(t);if(null==r||Number(r)!=r){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){const n=this.tryParse(e.substr(t));if(!je.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case Ve.CONNECT:return"object"==typeof t;case Ve.DISCONNECT:return void 0===t;case Ve.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case Ve.EVENT:case Ve.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Ve.ACK:case Ve.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class Fe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=Ue(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function $e(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const qe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ke extends Q.Q{constructor(e,t,r){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[$e(e,"open",this.onopen.bind(this)),$e(e,"packet",this.onpacket.bind(this)),$e(e,"error",this.onerror.bind(this)),$e(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(qe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');t.unshift(e);const r={type:Ve.EVENT,data:t,options:{}};if(r.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,n=t.pop();this._registerAckCallback(e,n),r.id=e}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){const r=this.flags.timeout;if(void 0===r)return void(this.acks[e]=t);const n=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...e])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this.packet({type:Ve.CONNECT,data:e})})):this.packet({type:Ve.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Ve.CONNECT:if(e.data&&e.data.sid){const t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ve.EVENT:case Ve.BINARY_EVENT:this.onevent(e);break;case Ve.ACK:case Ve.BINARY_ACK:this.onack(e);break;case Ve.DISCONNECT:this.ondisconnect();break;case Ve.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let r=!1;return function(...n){r||(r=!0,t.packet({type:Ve.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ve.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function He(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}He.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},He.prototype.reset=function(){this.attempts=0},He.prototype.setMin=function(e){this.ms=e},He.prototype.setMax=function(e){this.max=e},He.prototype.setJitter=function(e){this.jitter=e};class Ge extends Q.Q{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,re(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=t.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new He({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const s=t.parser||n;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Ie(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=$e(t,"open",(function(){r.onopen(),e&&e()})),s=$e(t,"error",(t=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",t),e?e(t):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;0===e&&n();const r=this.setTimeoutFn((()=>{n(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push($e(e,"ping",this.onping.bind(this)),$e(e,"data",this.ondata.bind(this)),$e(e,"error",this.onerror.bind(this)),$e(e,"close",this.onclose.bind(this)),$e(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){ve((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r||(r=new Ke(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const We={};function Je(e,t){"object"==typeof e&&(t=e,e=void 0);const r=function(e,t="",r){let n=e;r=r||"undefined"!=typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=ke(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+t,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),n=r.source,s=r.id,i=r.path,o=We[s]&&i in We[s].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?a=new Ge(n,t):(We[s]||(We[s]=new Ge(n,t)),a=We[s]),r.query&&!t.query&&(t.query=r.queryKey),a.socket(r.path,t)}Object.assign(Je,{Manager:Ge,Socket:Ke,io:Je,connect:Je});var Ye=r(85275),Qe=r(46857),Ze=r(1914);var Xe=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const et=Xe,tt=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class rt{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class nt{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return it(this,e)}}class st{constructor(e){this.decoders=e}or(e){return it(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const it=(e,t)=>new st({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ot{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new rt(e,t,r),this.decoder=new nt(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const at=({name:e,prefix:t,encode:r,decode:n})=>new ot(e,t,r,n),ct=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=et(r,t);return at({prefix:e,name:t,encode:n,decode:e=>tt(s(e))})},ht=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>at({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),lt=at({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),ut=ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),dt=ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ft=ct({prefix:"9",name:"base10",alphabet:"0123456789"}),pt=ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),yt=ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),gt=ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bt=ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mt=ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wt=ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vt=ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Et=ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),At=ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),St=ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_t=ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ct=ct({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kt=ct({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),It=ct({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Tt=ct({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),xt=ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Rt=ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pt=ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Dt=ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ot=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Nt=Ot.reduce(((e,t,r)=>(e[r]=t,e)),[]),Lt=Ot.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Ut=at({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Nt[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Lt[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var Bt=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Mt;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Mt=Math.pow(2,31);var Vt=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var zt=Math.pow(2,7),jt=Math.pow(2,14),Ft=Math.pow(2,21),$t=Math.pow(2,28),qt=Math.pow(2,35),Kt=Math.pow(2,42),Ht=Math.pow(2,49),Gt=Math.pow(2,56),Wt=Math.pow(2,63),Jt={encode:Bt,decode:Vt,encodingLength:function(e){return e<zt?1:e<jt?2:e<Ft?3:e<$t?4:e<qt?5:e<Kt?6:e<Ht?7:e<Gt?8:e<Wt?9:10}};const Yt=Jt,Qt=(e,t,r=0)=>(Yt.encode(e,t,r),t),Zt=e=>Yt.encodingLength(e),Xt=(e,t)=>{const r=t.byteLength,n=Zt(e),s=n+Zt(r),i=new Uint8Array(s+r);return Qt(e,i,0),Qt(r,i,n),i.set(t,s),new er(e,r,t,i)};class er{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const tr=({name:e,code:t,encode:r})=>new rr(e,t,r);class rr{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Xt(this.code,t):t.then((e=>Xt(this.code,e)))}throw Error("Unknown type, must be binary type")}}const nr=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),sr=tr({name:"sha2-256",code:18,encode:nr("SHA-256")}),ir=tr({name:"sha2-512",code:19,encode:nr("SHA-512")}),or=tt,ar={code:0,name:"identity",encode:or,digest:e=>Xt(0,or(e))},cr="raw",hr=85,lr=e=>tt(e),ur=e=>tt(e),dr=new TextEncoder,fr=new TextDecoder,pr="json",yr=512,gr=e=>dr.encode(JSON.stringify(e)),br=e=>JSON.parse(fr.decode(e));new WeakMap;class mr{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return mr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return mr.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return mr.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof mr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new mr(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return mr.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new mr(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new mr(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return mr.create(0,DAG_PB_CODE,e)}static createV1(e,t){return mr.create(1,e,t)}static decode(e){const[t,r]=mr.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=mr.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?mr.createV0(i):mr.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=mr.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const wr={...s,...i,...o,...a,...c,...h,...l,...u,...d,...f};function vr(e=0){return null!=globalThis.Buffer?.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e);var t}function Er(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ar=Er("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Sr=Er("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=vr((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),_r={utf8:Ar,"utf-8":Ar,hex:wr.base16,latin1:Sr,ascii:Sr,binary:Sr,...wr};function Cr(e,t="utf8"){const r=_r[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var kr=r(37430);class Ir{constructor(e,t){this.label=e.label,this.open=(0,Ye.Z)(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,"number"==typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=65536),e.addEventListener("message",(e=>{t.onMessage(e)})),e.addEventListener("bufferedamountlow",(()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()})),e.addEventListener("open",(()=>{this.open.resolve(),t.onOpen()})),e.addEventListener("close",(()=>{t.onClose()})),e.addEventListener("error",(r=>{if("Transport channel closed"===r.error?.message)return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,r.error?.message,r.error?.errorDetail);const n=r.error instanceof Error?r.error:new Error(`datachannel error: ${r.error?.message} ${r.error?.errorDetail}`);t.onError(O(n,"ERR_DATA_CHANNEL"))}));let r=!1;this.closingInterval=setInterval((()=>{"closing"===e.readyState?(r&&t.onClose(),r=!0):r=!1}),5e3)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>65536&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=(0,Ye.Z)())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var Tr=r(65780);const xr={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};class Rr extends Qe.v{constructor(e){super(),this.id=e.id??Cr(Ze(4),"hex").slice(0,7),this.log=(0,D.kg)(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??function(){if("undefined"==typeof globalThis)throw O(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(null==e.RTCPeerConnection)throw O(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},xr,e.peerConnectionConfig)),this.closed=!1,this.connected=(0,Ye.Z)(),this.source=(0,kr.d)(),this.sink=async e=>{if(await this.connected.promise,null==this.channel)throw O(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const t of e)await this.channel.send(t);await this.close()}}handleDataChannelEvent(e){const t=e.channel;null!=t?this.channel=new Ir(t,{log:this.log,onMessage:e=>{this.source.push(new Uint8Array(e.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new Qe.A("ready"))},onClose:()=>{this.close().catch((e=>{this.log("error closing connection after channel close",e)}))},onError:e=>{this.close(e).catch((e=>{this.log("error closing connection after channel error",e)}))}}):this.close(O(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch((e=>{this.log("Error closing after event channel was found to be null",e)}))}async close(e){if(this.closed=!0,null==e&&null!=this.channel)for(;this.channel.bufferedAmount>0;)await Tr(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new Qe.A("close"))}}class Pr extends Qe.v{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",(()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch((e=>{this.log.error("could not renegotiate %o",e)}))}))}async handleSignal(e){return this.log('incoming signal "%s"',e.type),"offer"===e.type?await this.handleOffer(e):"answer"===e.type?await this.handleAnswer(e):"candidate"===e.type?await this.handleCandidate(e):"renegotiate"===e.type?await this.handleRenegotiate(e):"goodbye"===e.type?await this.handleGoodye(e):void this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){const t=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(t)}catch(e){if(null!=t.address&&!t.address.endsWith(".local"))throw O(e,"ERR_ADD_ICE_CANDIDATE");this.log("ignoring unsupported ICE candidate.")}}}const Dr=(0,D.kg)("libp2p:webrtc-peer:receiver");class Or extends Rr{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new Nr({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",(e=>this.dispatchEvent(new Qe.A("signal",{detail:e.detail})))),this.peerConnection.addEventListener("datachannel",(e=>{this.handleDataChannelEvent(e)}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class Nr extends Pr{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){Dr.trace("renegotiate"),this.dispatchEvent(new Qe.A("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(const e of this.iceCandidates)await this.handleCandidate(e);this.iceCandidates=[];const t=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(t),Dr.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new Qe.A("signal",{detail:this.peerConnection.localDescription??t}))}async handleCandidate(e){null!=this.peerConnection.remoteDescription&&null!=this.peerConnection.remoteDescription.type?await super.handleCandidate(e):this.iceCandidates.push(e)}}class Lr extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Ur extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Br=e=>void 0===globalThis.DOMException?new Ur(e):new DOMException(e),Mr=e=>{const t=void 0===e.reason?Br("This operation was aborted."):e.reason;return t instanceof Error?t:Br(t)};const Vr=e=>{const t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function zr(e,t,r){let n;const s=new Promise(((s,i)=>{if(!((r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r}).count>=0)||r.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(r.count))throw new TypeError("The `count` option should be at least 0 or more");const o=[t].flat(),a=[],{addListener:c,removeListener:h}=Vr(e),l=(...e)=>{const t=r.multiArgs?e:e[0];r.filter&&!r.filter(t)||(a.push(t),r.count===a.length&&(n(),s(a)))},u=e=>{n(),i(e)};n=()=>{for(const e of o)h(e,l);for(const e of r.rejectionEvents)h(e,u)};for(const e of o)c(e,l);for(const e of r.rejectionEvents)c(e,u);r.resolveImmediately&&s(a)}));if(s.cancel=n,"number"==typeof r.timeout){const e=function(e,t,r,n){let s;const i=new Promise(((i,o)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout,clearTimeout},...n}).signal){const{signal:e}=n;e.aborted&&o(Mr(e)),e.addEventListener("abort",(()=>{o(Mr(e))}))}s=n.customTimers.setTimeout.call(void 0,(()=>{if("function"==typeof r){try{i(r())}catch(e){o(e)}return}const n=r instanceof Error?r:new Lr("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),o(n)}),t),(async()=>{try{i(await e)}catch(e){o(e)}finally{n.customTimers.clearTimeout.call(void 0,s)}})()}else i(e)}));return i.clear=()=>{clearTimeout(s),s=void 0},i}(s,r.timeout);return e.cancel=n,e}return s}const jr=(0,D.kg)("libp2p:webrtc-peer:initator");class Fr extends Rr{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??Cr(Ze(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new $r({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",(e=>{this.dispatchEvent(new Qe.A("signal",{detail:e.detail}))}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class $r extends Pr{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",(e=>{if(null==e.candidate)return;const t={type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}};jr.trace("create candidate",t),this.dispatchEvent(new Qe.A("signal",{detail:t})),this.dispatchEvent(new Qe.A("ice-candidate"))}))}async handleRenegotiate(){if("negotiating"===this.status)return void this.log("already negotiating, queueing");this.status="negotiating";const e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await function(e,t,r){"function"==typeof r&&(r={filter:r});const n=zr(e,t,r={...r,count:1,resolveImmediately:!1}),s=n.then((e=>e[0]));return s.cancel=n.cancel,s}(this,"ice-candidate"),await Tr(1e3),jr.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new Qe.A("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){jr.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}}const qr=(0,D.kg)("libp2p:webrtc-star:socket");function Kr(e,t){const{sink:r,source:n}=e,s={remoteAddr:t.remoteAddr,async sink(e){null!=t.signal&&(e=(0,N.wJ)(e,t.signal));try{await r(e)}catch(e){"aborted"!==e.type&&qr.error(e)}},source:null!=t.signal?(0,N.wJ)(n,t.signal):n,timeline:{open:Date.now()},async close(){if(e.closed)return;const t=Date.now(),r=setTimeout((()=>{if(null!=s.remoteAddr){const{host:e,port:r}=s.remoteAddr.toOptions();qr("timeout closing socket to %s:%s after %dms, destroying it manually",e,r,Date.now()-t)}e.closed||e.close().catch((e=>{qr.error("could not close socket",e)}))}),2e3);try{await e.close()}finally{clearTimeout(r)}}};return e.addEventListener("close",(()=>{null==s.timeline.close&&(s.timeline.close=Date.now())}),{once:!0}),s}function Hr(e){const t=e.toString().split("/"),r=e.protos()[1].name,n=e.protos()[2].name,s=e.stringTuples()[1][1];if("tcp"!==r||"ws"!==n&&"wss"!==n)throw new Error(`invalid multiaddr: ${e.toString()}`);if(!(0,L.K9)(e))return`http://${t[2]}:${t[4]}`;if("ws"===n)return`http://${t[2]}${null==s||"80"===s?"":`:${s}`}`;if("wss"===n)return`https://${t[2]}${null==s||"443"===s?"":`:${s}`}`;throw new Error("invalid multiaddr: "+e.toString())}const Gr=(0,D.kg)("libp2p:webrtc-star:listener"),Wr={transports:["websocket"],path:"/socket.io-next/"};class Jr extends Qe.v{constructor(e,t,r,n,s){super(),this.signallingAddr=t,this.socket=Je(e,Wr),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=r,this.handler=n,this.channelOptions=s,this.handleWsHandshake=this.handleWsHandshake.bind(this);let i=!1;this.socket.on("connect_error",(e=>{i&&"TransportError"===e.type||this.dispatchEvent(new Qe.A("error",{detail:e}))})),this.socket.on("error",(e=>{this.dispatchEvent(new Qe.A("error",{detail:e}))})),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",(e=>{this.dispatchEvent(new Qe.A("peer",{detail:e}))})),this.socket.on("connect",(()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),i&&this.dispatchEvent(new Qe.A("reconnect"))})),this.socket.once("connect",(()=>{i=!0,this.dispatchEvent(new Qe.A("listening"))})),this.socket.on("disconnect",(()=>{this.dispatchEvent(new Qe.A("disconnect"))}))}_createChannel(e,t,r){const n={...this.channelOptions},s=new Or(n),i=e=>{const t=e.detail;Gr.error("incoming connection errored",t)};return s.addEventListener("error",i),s.addEventListener("close",(()=>{s.removeEventListener("error",i)}),{once:!0}),s.addEventListener("signal",(n=>{const s=n.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:r,answer:!0,signal:s})})),s.addEventListener("ready",(()=>{const t=Kr(s,{remoteAddr:this.signallingAddr});Gr("new inbound connection %s",t.remoteAddr);try{this.upgrader.upgradeInbound(t).then((r=>{Gr("inbound connection %s upgraded",t.remoteAddr),this.connections.push(t);s.addEventListener("close",(()=>{this.connections=this.connections.filter((e=>e!==t)),this.channels.delete(e),this.pendingSignals.delete(e)}),{once:!0}),this.dispatchEvent(new Qe.A("connection",{detail:r})),this.handler(r)})).catch((e=>{Gr.error("inbound connection failed to upgrade",e),t.close().catch((e=>{Gr.error("inbound connection failed to close after failing to upgrade",e)}))}))}catch(e){Gr.error("inbound connection failed to upgrade",e),t.close().catch((e=>{Gr.error("inbound connection failed to close after failing to upgrade",e)}))}}),{once:!0}),s}handleWsHandshake(e){if(Gr('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0===e.answer||null!=e.err||null==e.intentId)return;const t=e.intentId;let r=this.pendingSignals.get(t);null==r&&(r=[],this.pendingSignals.set(t,r)),r.push(e);let n=this.channels.get(t);if(null==n){if("offer"!==e.signal.type)return void Gr("handshake is not an offer and channel does not exist, buffering until we receive an offer");Gr("creating new channel to handle offer handshake"),n=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,n)}else Gr("channel already exists, using it to handle handshake");for(;r.length>0;){const e=r.shift();null!=e?.signal&&n.handleSignal(e.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map((async e=>await e.close())),...Array.from(this.channels.values()).map((async e=>await e.close()))]),this.dispatchEvent(new Qe.A("close"))}}class Yr extends Qe.v{constructor(e,t,r,n,s){super(),this.upgrader=e,this.handler=t,this.peerId=r,this.transport=n,this.options=s}async listen(e){if(null!=this.listeningAddr)throw O(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const t=(0,Ye.Z)();let r;this.listeningAddr=e,r=e.protoCodes().includes(421)?e:e.encapsulate(`/p2p/${this.peerId.toString()}`);const n=this.signallingUrl=Hr(e);Gr("connecting to signalling server on: %s",this.signallingUrl);const s=new Jr(this.signallingUrl,r,this.upgrader,this.handler,this.options.channelOptions);return s.addEventListener("error",(e=>{const r=e.detail;Gr("error connecting to signalling server %o",r),s.close().catch((e=>{Gr.error("error closing server after error",e)})),t.reject(r)})),s.addEventListener("listening",(()=>{Gr("connected to signalling server"),this.dispatchEvent(new Qe.A("listening")),t.resolve()})),s.addEventListener("peer",(e=>{this.transport.peerDiscovered(e.detail)})),s.addEventListener("connection",(t=>{const r=t.detail;if(null==r.remoteAddr)try{r.remoteAddr=e.decapsulateCode(421).encapsulate(`/p2p/${r.remotePeer.toString()}`)}catch(e){Gr.error("could not determine remote address",e)}this.dispatchEvent(new Qe.A("connection",{detail:r}))})),s.addEventListener("disconnect",(()=>{this.transport.sigServers.delete(n)})),s.addEventListener("reconnect",(()=>{this.transport.sigServers.set(n,s)})),this.transport.sigServers.set(this.signallingUrl,s),await t.promise}async close(){if(null!=this.signallingUrl){const e=this.transport.sigServers.get(this.signallingUrl);null!=e&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new Qe.A("close")),this.listeningAddr=void 0}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}var Qr=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const Zr=Qr,Xr=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class en{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class tn{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return nn(this,e)}}class rn{constructor(e){this.decoders=e}or(e){return nn(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const nn=(e,t)=>new rn({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class sn{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new en(e,t,r),this.decoder=new tn(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const on=({name:e,prefix:t,encode:r,decode:n})=>new sn(e,t,r,n),an=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=Zr(r,t);return on({prefix:e,name:t,encode:n,decode:e=>Xr(s(e))})},cn=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>on({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),hn=on({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),ln=cn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),un=cn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),dn=an({prefix:"9",name:"base10",alphabet:"0123456789"}),fn=cn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pn=cn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),yn=cn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gn=cn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bn=cn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),mn=cn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wn=cn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vn=cn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),En=cn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),An=cn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Sn=cn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),_n=an({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Cn=an({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),kn=an({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),In=an({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Tn=cn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xn=cn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Rn=cn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Pn=cn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Dn=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),On=Dn.reduce(((e,t,r)=>(e[r]=t,e)),[]),Nn=Dn.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Ln=on({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=On[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Nn[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var Un=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Bn;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Bn=Math.pow(2,31);var Mn=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var Vn=Math.pow(2,7),zn=Math.pow(2,14),jn=Math.pow(2,21),Fn=Math.pow(2,28),$n=Math.pow(2,35),qn=Math.pow(2,42),Kn=Math.pow(2,49),Hn=Math.pow(2,56),Gn=Math.pow(2,63),Wn={encode:Un,decode:Mn,encodingLength:function(e){return e<Vn?1:e<zn?2:e<jn?3:e<Fn?4:e<$n?5:e<qn?6:e<Kn?7:e<Hn?8:e<Gn?9:10}};const Jn=Wn,Yn=(e,t,r=0)=>(Jn.encode(e,t,r),t),Qn=e=>Jn.encodingLength(e),Zn=(e,t)=>{const r=t.byteLength,n=Qn(e),s=n+Qn(r),i=new Uint8Array(s+r);return Yn(e,i,0),Yn(r,i,n),i.set(t,s),new Xn(e,r,t,i)};class Xn{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const es=({name:e,code:t,encode:r})=>new ts(e,t,r);class ts{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Zn(this.code,t):t.then((e=>Zn(this.code,e)))}throw Error("Unknown type, must be binary type")}}const rs=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ns=es({name:"sha2-256",code:18,encode:rs("SHA-256")}),ss=es({name:"sha2-512",code:19,encode:rs("SHA-512")}),is=Xr,os={code:0,name:"identity",encode:is,digest:e=>Zn(0,is(e))},as="raw",cs=85,hs=e=>Xr(e),ls=e=>Xr(e),us=new TextEncoder,ds=new TextDecoder,fs="json",ps=512,ys=e=>us.encode(JSON.stringify(e)),gs=e=>JSON.parse(ds.decode(e));new WeakMap;class bs{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return bs.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return bs.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return bs.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?cid_toStringV0(r,cid_baseCache(e),t||base58btc.encoder):cid_toStringV1(r,cid_baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof bs)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new bs(e,r,n,s||cid_encodeCID(e,r,n.bytes))}if(!0===t[cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return bs.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${cid_DAG_PB_CODE}) block encoding`);return new bs(e,t,r,r.bytes);case 1:{const n=cid_encodeCID(e,t,r.bytes);return new bs(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return bs.create(0,cid_DAG_PB_CODE,e)}static createV1(e,t){return bs.create(1,e,t)}static decode(e){const[t,r]=bs.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=bs.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?bs.createV0(i):bs.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=cid_parseCIDtoBytes(e,t),s=bs.decode(n);return cid_baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const ms={...m,...w,...v,...E,...A,...S,..._,...C,...k,...I};function ws(e=0){return null!=globalThis.Buffer?.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e);var t}function vs(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Es=vs("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),As=vs("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=ws((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Ss={utf8:Es,"utf-8":Es,hex:ms.base16,latin1:As,ascii:As,binary:As,...ms};var _s=r(93203),Cs=r(12348),ks=r(59769);const Is="RTCPeerConnection"in globalThis,Ts=(0,D.kg)("libp2p:webrtc-star"),xs=()=>{};class Rs extends Qe.v{constructor(){super(...arguments),this.started=!1}get[ks.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return!!this.isStarted()&&super.dispatchEvent(e)}}class Ps{constructor(e){null!=e?.wrtc&&(this.wrtc=e.wrtc),this.sigServers=new Map,this._discovery=new Rs,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[Cs.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}async dial(e,t){const r=Kr(await this._connect(e,t),{remoteAddr:e,signal:t.signal});Ts("new outbound connection %s",r.remoteAddr);const n=await t.upgrader.upgradeOutbound(r);return Ts("outbound connection %s upgraded",r.remoteAddr),n}async _connect(e,t){if(!0===t.signal?.aborted)throw new N._L;const r={...t.channelOptions??{}};null!=this.wrtc&&(r.wrtc=this.wrtc);const n=e.toOptions(),s=function(e,t="utf8"){const r=Ss[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(Ze(36),"hex");return await new Promise(((i,o)=>{const a=this.sigServers.get(Hr(e));if(null==a?.socket)return o(O(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let c=!1;Ts("dialing %s:%s",n.host,n.port);const h=new Fr(r),l=e=>{const t=e.detail;if(!c){const e=`connection error ${n.host}:${n.port}: ${t.message}`;Ts.error(e),f(t)}},u=()=>{c=!0,Ts("connection opened %s:%s",n.host,n.port),f()},d=()=>{Ts.error("connection aborted %s:%s",n.host,n.port),h.close().finally((()=>{f(new N._L)}))},f=e=>{h.removeEventListener("ready",u),t.signal?.removeEventListener("abort",d),null==e?i(h):o(e)};h.addEventListener("ready",u,{once:!0}),h.addEventListener("close",(()=>{h.removeEventListener("error",l)})),t.signal?.addEventListener("abort",d),h.addEventListener("signal",(t=>{const r=t.detail;a.socket.emit("ss-handshake",{intentId:s,srcMultiaddr:a.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:r})})),a.socket.on("ws-handshake",(e=>{e.intentId===s&&null!=e.err&&h.close().finally((()=>{o(O(new Error(e.err),"ERR_SIGNALLING_FAILED"))})),e.intentId!==s||null==e.answer||h.closed||h.handleSignal(e.signal)}))}))}createListener(e){if(!Is&&null==this.wrtc)throw O(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(e.channelOptions=e.channelOptions??{},null!=this.wrtc&&(e.channelOptions.wrtc=this.wrtc),null==this.peerId)throw O(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return function(e,t,r,n,s){return new Yr(e,t,r,n,s)}(e.upgrader,e.handler??xs,this.peerId,this,e)}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>!e.protoCodes().includes(290)&&U.xk.matches(e)))}peerDiscovered(e){Ts("peer discovered: %s",e),e=function(e){const t="/libp2p-webrtc-star";if(e.startsWith(t)){e=e.substring(t.length,e.length);let r=(0,L.HM)(e);const n=r.stringTuples().filter((e=>421===e[0]))[0];if(null==n[1])throw new Error("invalid multiaddr: "+e);r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),e=r.toString()}return e}(e);const t=(0,L.HM)(e),r=t.getPeerId();if(null==r)return;const n=(0,_s.jE)(r);this._discovery.dispatchEvent(new Qe.A("peer",{detail:{id:n,multiaddrs:[t],protocols:[]}}))}}function Ds(){const e=function(e={}){const t=new Ps(e);return{transport:e=>(t.peerId=e.peerId,t),discovery:t.discovery}}();return{transports:[e.transport],peerDiscovery:[e.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}}}},6:(e,t,r)=>{"use strict";r.d(t,{M:()=>c});var n=r(67137),s=r(38461),i=r(57665);const o=(0,s.kg)("ipfs:preload"),a=new(i.Z.default?i.Z.default:i.Z)({concurrency:4});function c(e,t={}){return o(e),a.add((async()=>{const r=(await n.post(e,{signal:t.signal})).body.getReader();try{for(;;){const{done:e}=await r.read();if(e)return}}finally{r.releaseLock()}}))}},37730:(e,t,r)=>{"use strict";r.d(t,{x:()=>zo});var n={};r.r(n),r.d(n,{base58btc:()=>ue,base58flickr:()=>de});var s={};r.r(s),r.d(s,{base32:()=>fe,base32hex:()=>be,base32hexpad:()=>we,base32hexpadupper:()=>ve,base32hexupper:()=>me,base32pad:()=>ye,base32padupper:()=>ge,base32upper:()=>pe,base32z:()=>Ee});var i={};r.r(i),r.d(i,{code:()=>Le,decode:()=>Be,encode:()=>Ue,name:()=>Ne});var o={};r.r(o),r.d(o,{identity:()=>at});var a={};r.r(a),r.d(a,{base2:()=>ct});var c={};r.r(c),r.d(c,{base8:()=>ht});var h={};r.r(h),r.d(h,{base10:()=>lt});var l={};r.r(l),r.d(l,{base16:()=>ut,base16upper:()=>dt});var u={};r.r(u),r.d(u,{base36:()=>ft,base36upper:()=>pt});var d={};r.r(d),r.d(d,{base64:()=>yt,base64pad:()=>gt,base64url:()=>bt,base64urlpad:()=>mt});var f={};r.r(f),r.d(f,{base256emoji:()=>At});var p={};r.r(p),r.d(p,{sha256:()=>kt,sha512:()=>It});var y={};r.r(y),r.d(y,{identity:()=>xt});var g={};r.r(g),r.d(g,{code:()=>Ot,decode:()=>Lt,encode:()=>Nt,name:()=>Dt});var b={};r.r(b),r.d(b,{InvalidValueError:()=>qr,MissingRepoOptionsError:()=>Kr,NonReversibleMigrationError:()=>jr,NotInitializedRepoError:()=>Fr,RequiredParameterError:()=>$r});var m={};r.r(m),r.d(m,{identity:()=>pn});var w={};r.r(w),r.d(w,{base2:()=>yn});var v={};r.r(v),r.d(v,{base8:()=>gn});var E={};r.r(E),r.d(E,{base10:()=>bn});var A={};r.r(A),r.d(A,{base16:()=>mn,base16upper:()=>wn});var S={};r.r(S),r.d(S,{base32:()=>vn,base32hex:()=>_n,base32hexpad:()=>kn,base32hexpadupper:()=>In,base32hexupper:()=>Cn,base32pad:()=>An,base32padupper:()=>Sn,base32upper:()=>En,base32z:()=>Tn});var _={};r.r(_),r.d(_,{base36:()=>xn,base36upper:()=>Rn});var C={};r.r(C),r.d(C,{base58btc:()=>Pn,base58flickr:()=>Dn});var k={};r.r(k),r.d(k,{base64:()=>On,base64pad:()=>Nn,base64url:()=>Ln,base64urlpad:()=>Un});var I={};r.r(I),r.d(I,{base256emoji:()=>zn});var T={};r.r(T),r.d(T,{sha256:()=>hs,sha512:()=>ls});var x={};r.r(x),r.d(x,{identity:()=>ds});var R={};r.r(R),r.d(R,{code:()=>ps,decode:()=>gs,encode:()=>ys,name:()=>fs});var P={};r.r(P),r.d(P,{code:()=>vs,decode:()=>As,encode:()=>Es,name:()=>ws});var D=function(e,t,r){if(!e)return r;var n,s;Array.isArray(t)&&(n=t.slice(0));"string"==typeof t&&(n=t.split("."));"symbol"==typeof t&&(n=[t]);if(!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;){if(s=n.shift(),!e)return r;if(void 0===(e=e[s]))return r}return e};var O=r(11227),N=r(32114),L=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=U;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},U=Math.pow(2,31);var B=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var M=Math.pow(2,7),V=Math.pow(2,14),z=Math.pow(2,21),j=Math.pow(2,28),F=Math.pow(2,35),$=Math.pow(2,42),q=Math.pow(2,49),K=Math.pow(2,56),H=Math.pow(2,63);const G={encode:L,decode:B,encodingLength:function(e){return e<M?1:e<V?2:e<z?3:e<j?4:e<F?5:e<$?6:e<q?7:e<K?8:e<H?9:10}},W=(e,t=0)=>[G.decode(e,t),G.decode.bytes],J=(e,t,r=0)=>(G.encode(e,t,r),t),Y=e=>G.encodingLength(e),Q=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),Z=(e,t)=>{const r=t.byteLength,n=Y(e),s=n+Y(r),i=new Uint8Array(s+r);return J(e,i,0),J(r,i,n),i.set(t,s),new ee(e,r,t,i)},X=e=>{const t=Q(e),[r,n]=W(t),[s,i]=W(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new ee(r,s,o,t)};class ee{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}var te=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const re=te;class ne{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class se{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return oe(this,e)}}class ie{constructor(e){this.decoders=e}or(e){return oe(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const oe=(e,t)=>new ie({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ae{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ne(e,t,r),this.decoder=new se(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ce=({name:e,prefix:t,encode:r,decode:n})=>new ae(e,t,r,n),he=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=re(r,t);return ce({prefix:e,name:t,encode:n,decode:e=>Q(s(e))})},le=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>ce({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),ue=he({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),de=he({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),fe=le({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pe=le({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ye=le({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ge=le({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),be=le({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),me=le({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),we=le({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ve=le({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ee=le({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ae=new WeakMap,Se=e=>{const t=Ae.get(e);if(null==t){const t=new Map;return Ae.set(e,t),t}return t};class _e{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Te)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==xe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Z(e,t);return _e.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return _e.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?ke(r,Se(e),t||ue.encoder):Ie(r,Se(e),t||fe.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof _e)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new _e(e,r,n,s||Re(e,r,n.bytes))}if(!0===t[Pe]){const{version:e,multihash:r,code:n}=t,s=X(r);return _e.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Te)throw new Error(`Version 0 CID must use dag-pb (code: ${Te}) block encoding`);return new _e(e,t,r,r.bytes);case 1:{const n=Re(e,t,r.bytes);return new _e(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return _e.create(0,Te,e)}static createV1(e,t){return _e.create(1,e,t)}static decode(e){const[t,r]=_e.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=_e.inspectBytes(e),r=t.size-t.multihashSize,n=Q(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new ee(t.multihashCode,t.digestSize,s,n);return[0===t.version?_e.createV0(i):_e.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=W(e.subarray(t));return t+=n,r};let n=r(),s=Te;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=Ce(e,t),s=_e.decode(n);return Se(s).set(r,e),s}}const Ce=(e,t)=>{switch(e[0]){case"Q":{const r=t||ue;return[ue.prefix,r.decode(`${ue.prefix}${e}`)]}case ue.prefix:{const r=t||ue;return[ue.prefix,r.decode(e)]}case fe.prefix:{const r=t||fe;return[fe.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ke=(e,t,r)=>{const{prefix:n}=r;if(n!==ue.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},Ie=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},Te=112,xe=18,Re=(e,t,r)=>{const n=Y(e),s=n+Y(t),i=new Uint8Array(s+r.byteLength);return J(e,i,0),J(t,i,n),i.set(r,s),i},Pe=Symbol.for("@ipld/js-cid/CID");var De=r(42837),Oe=r(95918);const Ne="raw",Le=85,Ue=e=>Q(e),Be=e=>Q(e),Me=O("ipfs:repo:migrator:migration-8");function Ve(e){return e.child?Ve(e.child):e}function ze(e){try{const t=fe.decode(`b${e.toString().toLowerCase().slice(1)}`),r=_e.decode(t).multihash.bytes,n=fe.encode(r).slice(1).toUpperCase();return new De.s(`/${n}`,!1)}catch(t){return e}}function je(e){try{const t=fe.decode(`b${e.toString().toLowerCase().slice(1)}`),r=X(t),n=fe.encode(_e.createV1(Le,r).bytes).slice(1);return new De.s(`/${n.toUpperCase()}`,!1)}catch{return e}}async function Fe(e,t,r){const n=e.blocks;await n.open();const s=Ve(n),i=await(0,Oe.Z)(s.queryKeys({filters:[e=>r(e).toString()!==e.toString()]}));try{let e=0;for await(const n of s.query({})){const o=r(n.key);o.toString()!==n.key.toString()&&(e+=1,Me(`Migrating Block from ${n.key} to ${o}`,await s.has(n.key)),await s.delete(n.key),await s.put(o,n.value),t(e/i*100,`Migrated Block from ${n.key} to ${o}`))}}finally{await n.close()}}const $e={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t=(()=>{}))=>Fe(e,t,ze),revert:(e,t=(()=>{}))=>Fe(e,t,je)};var qe=r(10539),Ke=r(64936),He=r(62100);const Ge=He.Reader,We=He.Writer,Je=(He.util,He.roots.default||(He.roots.default={})),Ye=Je.ipfs=(()=>{const e={};return e.pin=function(){const e={};return e.Set=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=0,e.prototype.fanout=0,e.prototype.seed=0,e.encode=function(e,t){return t||(t=We.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(16).uint32(e.fanout),null!=e.seed&&Object.hasOwnProperty.call(e,"seed")&&t.uint32(29).fixed32(e.seed),t},e.decode=function(e,t){e instanceof Ge||(e=Ge.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Je.ipfs.pin.Set;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.version=e.uint32();break;case 2:n.fanout=e.uint32();break;case 3:n.seed=e.fixed32();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Je.ipfs.pin.Set)return e;var t=new Je.ipfs.pin.Set;return null!=e.version&&(t.version=e.version>>>0),null!=e.fanout&&(t.fanout=e.fanout>>>0),null!=e.seed&&(t.seed=e.seed>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.version=0,r.fanout=0,r.seed=0),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.fanout&&e.hasOwnProperty("fanout")&&(r.fanout=e.fanout),null!=e.seed&&e.hasOwnProperty("seed")&&(r.seed=e.seed),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e}(),e}(),e})();var Qe=r(96132),Ze=r(94676);const Xe=new De.s("/local/pins"),et=_e.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),tt="direct",rt="recursive";function nt(e){return new De.s(`/${fe.encode(e.multihash.bytes).toUpperCase().substring(1)}`)}function st(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function it(e=0){return null!=globalThis.Buffer?.allocUnsafe?st(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ot(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=it(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return st(r)}const at=ce({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),ct=le({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ht=le({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),lt=he({prefix:"9",name:"base10",alphabet:"0123456789"}),ut=le({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),dt=le({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ft=he({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pt=he({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),yt=le({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gt=le({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),bt=le({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mt=le({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),wt=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),vt=wt.reduce(((e,t,r)=>(e[r]=t,e)),[]),Et=wt.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const At=ce({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=vt[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Et[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),St=({name:e,code:t,encode:r})=>new _t(e,t,r);class _t{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Z(this.code,t):t.then((e=>Z(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ct=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),kt=St({name:"sha2-256",code:18,encode:Ct("SHA-256")}),It=St({name:"sha2-512",code:19,encode:Ct("SHA-512")}),Tt=Q,xt={code:0,name:"identity",encode:Tt,digest:e=>Z(0,Tt(e))},Rt=new TextEncoder,Pt=new TextDecoder,Dt="json",Ot=512,Nt=e=>Rt.encode(JSON.stringify(e)),Lt=e=>JSON.parse(Pt.decode(e)),Ut={...o,...a,...c,...h,...l,...s,...u,...n,...d,...f};function Bt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Mt=Bt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Vt=Bt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=it((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),zt={utf8:Mt,"utf-8":Mt,hex:Ut.base16,latin1:Vt,ascii:Vt,binary:Vt,...Ut};function jt(e,t="utf8"){const r=zt[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function Ft(e,t="utf8"){const r=zt[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):st(globalThis.Buffer.from(e,"utf-8"))}const $t=Ye.pin.Set;async function*qt(e,t){const r=function(e){const t=e.Data;if(!t)throw new Error("No data present");const r=Ze.decode(t),n=Ze.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+r>t.length)throw new Error("Impossibly large set header length");const s=t.slice(n,r+n),i=$t.toObject($t.decode(s),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==i.version)throw new Error(`Unsupported Set version: ${i.version}`);if(i.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:i,data:t.slice(r+n)}}(t);let n=0;for(const s of t.Links){if(n<r.header.fanout){const t=s.Hash;if(!et.equals(t)){const r=await e.get(t),n=qe.decode(r);yield*qt(e,n)}}else yield s.Hash;n++}}async function*Kt(e,t,r){const n=t.Links.find((e=>e.Name===r));if(!n)throw new Error("No link found with name "+r);const s=await e.get(n.Hash),i=qe.decode(s);yield*qt(e,i)}function Ht(e,t){return async function t(r,n){const s=$t.encode({version:1,fanout:256,seed:n}).finish(),i=ot([Ze.encode(s.length),s]),o=[];for(let e=0;e<256;e++)o.push({Name:"",Tsize:1,Hash:et});if(r.length<=8192){const e=r.map((e=>({link:{Name:"",Tsize:1,Hash:e.key},data:e.data||new Uint8Array}))).sort(((e,t)=>function(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}(e.link.Hash.bytes,t.link.Hash.bytes))),t=o.concat(e.map((e=>e.link)));return{Data:ot([i,...e.map((e=>e.data))]),Links:t}}{const e=r.reduce(((e,t)=>{const r=function(e,t){const r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,e,!0);const n=Ft(t.toString()),s=ot([r,n],r.byteLength+n.byteLength);return Qe(jt(s))}(n,t.key)%256;return e[r]=r in e?e[r].concat([t]):[t],e}),[]);let s=0;for(const r of e){const e=await t(r,n+1);await a(e,s),s++}return{Data:i,Links:o}}async function a(t,r){const n=qe.encode(t),s=await kt.digest(n),i=_e.createV0(s);await e.put(i,n);const a=t.Links.reduce(((e,t)=>e+(t.Tsize||0)),0)+n.length;o[r]={Name:"",Tsize:a,Hash:i}}}(t,0)}async function Gt(e,t,r){const n=await Ht(e,r.map((e=>({key:e})))),s=qe.encode(n),i=await kt.digest(s),o=_e.createV0(i);await e.put(o,s);return{Name:t,Tsize:n.Links.reduce(((e,t)=>e+t.Tsize),0)+s.length,Hash:o}}async function Wt(e,t,r,n){if(!await t.has(Xe))return;const s=await t.get(Xe),i=_e.decode(s),o=await e.get(i),a=qe.decode(o);let c=0;const h=await(0,Oe.Z)(Kt(e,a,rt))+await(0,Oe.Z)(Kt(e,a,tt));for await(const t of Kt(e,a,rt)){c++;const e={depth:1/0};0!==t.version&&(e.version=t.version),t.code!==qe.code&&(e.codec=t.code),await r.put(nt(t),Ke.cv(e)),n(c/h*100,`Migrated recursive pin ${t}`)}for await(const t of Kt(e,a,tt)){c++;const e={depth:0};0!==t.version&&(e.version=t.version),t.code!==qe.code&&(e.codec=t.code),await r.put(nt(t),Ke.cv(e)),n(c/h*100,`Migrated direct pin ${t}`)}await e.delete(i),await t.delete(Xe)}async function Jt(e,t,r,n){const s=[],i=[];let o=0;const a=await(0,Oe.Z)(r.queryKeys({}));for await(const{key:e,value:t}of r.query({})){o++;const r=Ke.Jx(t),c=_e.create(r.version||0,r.codec||qe.code,X(fe.decode("b"+e.toString().toLowerCase().split("/").pop())));0===r.depth?(n(o/a*100,`Reverted direct pin ${c}`),i.push(c)):(n(o/a*100,`Reverted recursive pin ${c}`),s.push(c))}n(100,"Updating pin root");const c={Links:[await Gt(e,tt,i),await Gt(e,rt,s)]},h=qe.encode(c),l=await kt.digest(h),u=_e.createV0(l);await e.put(u,h),await t.put(Xe,u.bytes)}async function Yt(e,t,r){const n=e.blocks,s=e.datastore,i=e.pins;await n.open(),await s.open(),await i.open();try{await r(n,s,i,t)}finally{await i.close(),await s.close(),await n.close()}}const Qt={version:9,description:"Migrates pins to datastore",migrate:(e,t=(()=>{}))=>Yt(e,t,Wt),revert:(e,t=(()=>{}))=>Yt(e,t,Jt)};var Zt=r(40668);const Xt=new De.s("/config"),er=new De.s("/version");function tr(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}function rr(e){const t=e.get.bind(e),r=e.has.bind(e);return e.get=n=>async function(e,t,r,n){if(await r(e))return t(e);const s=tr(n);if(!s)throw(0,Zt.notFoundError)();return new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{if(n.result)return t(n.result);r((0,Zt.notFoundError)())}}))}(n,t,r,e),e.has=t=>async function(e,t,r){const n=await t(e);if(n)return n;const s=tr(r);return!!s&&new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{t(Boolean(n.result))}}))}(t,r,e),e}function nr(e){return{...e,root:rr(e.root),datastore:rr(e.datastore),pins:rr(e.pins),keys:rr(e.keys)}}async function sr(e,t,r=(()=>{})){const n=tr(t);if(!n)return void r(`${e} did not need an upgrade`);r(`Upgrading ${e}`);await hr(n,((e,t)=>[{type:"del",key:e},{type:"put",key:Ft(e),value:t}]))}async function ir(e,t,r=(()=>{})){const n=tr(t);if(!n)return void r(`${e} did not need a downgrade`);r(`Downgrading ${e}`);await hr(n,((e,t)=>[{type:"del",key:e},{type:"put",key:jt(e),value:t}]))}function or(e){return e.child?or(e.child):e}async function ar(e,t,r){const n=Object.entries(e).map((([e,t])=>({key:e,backend:or(t)}))).filter((({key:e,backend:t})=>"LevelDatastore"===t.constructor.name)).map((({key:e,backend:t})=>({name:e,store:t})));t(0,`Migrating ${n.length} dbs`);let s=0;const i=e=>{t(Math.round(s/n.length*100),e)};for(const{name:e,store:t}of n){await t.open();try{await r(e,t,i)}finally{s++,await t.close()}}t(100,`Migrated ${n.length} dbs`)}const cr={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t=(()=>{}))=>ar(e,t,sr),revert:(e,t=(()=>{}))=>ar(e,t,ir)};function hr(e,t){return new Promise(((r,n)=>{const s=e.iterator();s._deserializeKey=s._deserializeValue=e=>e,function i(){const o=(o,a,c)=>{if(o||void 0===a){const e=e=>{e?n(e):r()};s.end(e)}else!function(t,r){const n=e.store("readwrite"),s=n.transaction;let i,o=0;s.onabort=()=>r(i||s.error||new Error("aborted by user")),s.oncomplete=()=>r(),function e(){const r=t[o++],a=r.key;let c;try{c="del"===r.type?n.delete(a):n.put(r.value,a)}catch(e){return i=e,void s.abort()}o<t.length&&(c.onsuccess=e)}()}(t(a,c),i)};s.next(o)}()}))}const lr=new De.s("/local/filesroot");const ur={version:11,description:"Store mfs root in the datastore",migrate:async function(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo datastore"),await e.root.open(),await e.datastore.open(),await e.root.has(lr)){const t=await e.root.get(lr);await e.datastore.put(lr,t),await e.root.delete(lr)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo datastore")},revert:async function(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo root datastore"),await e.root.open(),await e.datastore.open(),await e.datastore.has(lr)){const t=await e.datastore.get(lr);await e.root.put(lr,t),await e.datastore.delete(lr)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo root datastore")}},dr=He.Reader,fr=He.Writer,pr=He.util,yr=He.roots.default||(He.roots.default={}),gr=yr.Protocols=(()=>{function e(e){if(this.protocols=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.protocols=pr.emptyArray,e.encode=function(e,t){if(t||(t=fr.create()),null!=e.protocols&&e.protocols.length)for(var r=0;r<e.protocols.length;++r)t.uint32(10).string(e.protocols[r]);return t},e.decode=function(e,t){e instanceof dr||(e=dr.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new yr.Protocols;e.pos<r;){var s=e.uint32();if(s>>>3==1)n.protocols&&n.protocols.length||(n.protocols=[]),n.protocols.push(e.string());else e.skipType(7&s)}return n},e.fromObject=function(e){if(e instanceof yr.Protocols)return e;var t=new yr.Protocols;if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Protocols.protocols: array expected");t.protocols=[];for(var r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.protocols=[]),e.protocols&&e.protocols.length){r.protocols=[];for(var n=0;n<e.protocols.length;++n)r.protocols[n]=e.protocols[n]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e})(),br=He.Reader,mr=He.Writer,wr=He.util,vr=He.roots.default||(He.roots.default={}),Er=vr.Addresses=(()=>{function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.addrs=wr.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(e,t){if(t||(t=mr.create()),null!=e.addrs&&e.addrs.length)for(var r=0;r<e.addrs.length;++r)vr.Addresses.Address.encode(e.addrs[r],t.uint32(10).fork()).ldelim();return null!=e.certifiedRecord&&Object.hasOwnProperty.call(e,"certifiedRecord")&&vr.Addresses.CertifiedRecord.encode(e.certifiedRecord,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof br||(e=br.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new vr.Addresses;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.addrs&&n.addrs.length||(n.addrs=[]),n.addrs.push(vr.Addresses.Address.decode(e,e.uint32()));break;case 2:n.certifiedRecord=vr.Addresses.CertifiedRecord.decode(e,e.uint32());break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof vr.Addresses)return e;var t=new vr.Addresses;if(e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".Addresses.addrs: array expected");t.addrs=[];for(var r=0;r<e.addrs.length;++r){if("object"!=typeof e.addrs[r])throw TypeError(".Addresses.addrs: object expected");t.addrs[r]=vr.Addresses.Address.fromObject(e.addrs[r])}}if(null!=e.certifiedRecord){if("object"!=typeof e.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");t.certifiedRecord=vr.Addresses.CertifiedRecord.fromObject(e.certifiedRecord)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addrs=[]),t.defaults&&(r.certifiedRecord=null),e.addrs&&e.addrs.length){r.addrs=[];for(var n=0;n<e.addrs.length;++n)r.addrs[n]=vr.Addresses.Address.toObject(e.addrs[n],t)}return null!=e.certifiedRecord&&e.hasOwnProperty("certifiedRecord")&&(r.certifiedRecord=vr.Addresses.CertifiedRecord.toObject(e.certifiedRecord,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e.Address=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.multiaddr=wr.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:wr.oneOfGetter(t=["isCertified"]),set:wr.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=mr.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof br||(e=br.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new vr.Addresses.Address;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof vr.Addresses.Address)return e;var t=new vr.Addresses.Address;return null!=e.multiaddr&&("string"==typeof e.multiaddr?wr.base64.decode(e.multiaddr,t.multiaddr=wr.newBuffer(wr.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=wr.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?wr.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified,t.oneofs&&(r._isCertified="isCertified")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e}(),e.CertifiedRecord=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seq=wr.Long?wr.Long.fromBits(0,0,!0):0,e.prototype.raw=wr.newBuffer([]),e.encode=function(e,t){return t||(t=mr.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.raw&&Object.hasOwnProperty.call(e,"raw")&&t.uint32(18).bytes(e.raw),t},e.decode=function(e,t){e instanceof br||(e=br.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new vr.Addresses.CertifiedRecord;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.seq=e.uint64();break;case 2:n.raw=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof vr.Addresses.CertifiedRecord)return e;var t=new vr.Addresses.CertifiedRecord;return null!=e.seq&&(wr.Long?(t.seq=wr.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"==typeof e.seq&&(t.seq=new wr.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.raw&&("string"==typeof e.raw?wr.base64.decode(e.raw,t.raw=wr.newBuffer(wr.base64.length(e.raw)),0):e.raw.length&&(t.raw=e.raw)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(wr.Long){var n=new wr.Long(0,0,!0);r.seq=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.seq=t.longs===String?"0":0;t.bytes===String?r.raw="":(r.raw=[],t.bytes!==Array&&(r.raw=wr.newBuffer(r.raw)))}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?wr.Long.prototype.toString.call(e.seq):t.longs===Number?new wr.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.raw&&e.hasOwnProperty("raw")&&(r.raw=t.bytes===String?wr.base64.encode(e.raw,0,e.raw.length):t.bytes===Array?Array.prototype.slice.call(e.raw):e.raw),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e}(),e})(),Ar=He.Reader,Sr=He.Writer,_r=He.util,Cr=He.roots.default||(He.roots.default={}),kr=Cr.Peer=(()=>{function e(e){if(this.addresses=[],this.protocols=[],this.metadata=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.addresses=_r.emptyArray,e.prototype.protocols=_r.emptyArray,e.prototype.metadata=_r.emptyArray,e.prototype.pubKey=null,e.prototype.peerRecordEnvelope=null,Object.defineProperty(e.prototype,"_pubKey",{get:_r.oneOfGetter(t=["pubKey"]),set:_r.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_peerRecordEnvelope",{get:_r.oneOfGetter(t=["peerRecordEnvelope"]),set:_r.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=Sr.create()),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)Cr.Address.encode(e.addresses[r],t.uint32(10).fork()).ldelim();if(null!=e.protocols&&e.protocols.length)for(r=0;r<e.protocols.length;++r)t.uint32(18).string(e.protocols[r]);if(null!=e.metadata&&e.metadata.length)for(r=0;r<e.metadata.length;++r)Cr.Metadata.encode(e.metadata[r],t.uint32(26).fork()).ldelim();return null!=e.pubKey&&Object.hasOwnProperty.call(e,"pubKey")&&t.uint32(34).bytes(e.pubKey),null!=e.peerRecordEnvelope&&Object.hasOwnProperty.call(e,"peerRecordEnvelope")&&t.uint32(42).bytes(e.peerRecordEnvelope),t},e.decode=function(e,t){e instanceof Ar||(e=Ar.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Cr.Peer;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.addresses&&n.addresses.length||(n.addresses=[]),n.addresses.push(Cr.Address.decode(e,e.uint32()));break;case 2:n.protocols&&n.protocols.length||(n.protocols=[]),n.protocols.push(e.string());break;case 3:n.metadata&&n.metadata.length||(n.metadata=[]),n.metadata.push(Cr.Metadata.decode(e,e.uint32()));break;case 4:n.pubKey=e.bytes();break;case 5:n.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Cr.Peer)return e;var t=new Cr.Peer;if(e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".Peer.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!=typeof e.addresses[r])throw TypeError(".Peer.addresses: object expected");t.addresses[r]=Cr.Address.fromObject(e.addresses[r])}}if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Peer.protocols: array expected");t.protocols=[];for(r=0;r<e.protocols.length;++r)t.protocols[r]=String(e.protocols[r])}if(e.metadata){if(!Array.isArray(e.metadata))throw TypeError(".Peer.metadata: array expected");t.metadata=[];for(r=0;r<e.metadata.length;++r){if("object"!=typeof e.metadata[r])throw TypeError(".Peer.metadata: object expected");t.metadata[r]=Cr.Metadata.fromObject(e.metadata[r])}}return null!=e.pubKey&&("string"==typeof e.pubKey?_r.base64.decode(e.pubKey,t.pubKey=_r.newBuffer(_r.base64.length(e.pubKey)),0):e.pubKey.length&&(t.pubKey=e.pubKey)),null!=e.peerRecordEnvelope&&("string"==typeof e.peerRecordEnvelope?_r.base64.decode(e.peerRecordEnvelope,t.peerRecordEnvelope=_r.newBuffer(_r.base64.length(e.peerRecordEnvelope)),0):e.peerRecordEnvelope.length&&(t.peerRecordEnvelope=e.peerRecordEnvelope)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[],r.protocols=[],r.metadata=[]),e.addresses&&e.addresses.length){r.addresses=[];for(var n=0;n<e.addresses.length;++n)r.addresses[n]=Cr.Address.toObject(e.addresses[n],t)}if(e.protocols&&e.protocols.length){r.protocols=[];for(n=0;n<e.protocols.length;++n)r.protocols[n]=e.protocols[n]}if(e.metadata&&e.metadata.length){r.metadata=[];for(n=0;n<e.metadata.length;++n)r.metadata[n]=Cr.Metadata.toObject(e.metadata[n],t)}return null!=e.pubKey&&e.hasOwnProperty("pubKey")&&(r.pubKey=t.bytes===String?_r.base64.encode(e.pubKey,0,e.pubKey.length):t.bytes===Array?Array.prototype.slice.call(e.pubKey):e.pubKey,t.oneofs&&(r._pubKey="pubKey")),null!=e.peerRecordEnvelope&&e.hasOwnProperty("peerRecordEnvelope")&&(r.peerRecordEnvelope=t.bytes===String?_r.base64.encode(e.peerRecordEnvelope,0,e.peerRecordEnvelope.length):t.bytes===Array?Array.prototype.slice.call(e.peerRecordEnvelope):e.peerRecordEnvelope,t.oneofs&&(r._peerRecordEnvelope="peerRecordEnvelope")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e})(),Ir=(Cr.Address=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}let t;return e.prototype.multiaddr=_r.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:_r.oneOfGetter(t=["isCertified"]),set:_r.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=Sr.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof Ar||(e=Ar.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Cr.Address;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Cr.Address)return e;var t=new Cr.Address;return null!=e.multiaddr&&("string"==typeof e.multiaddr?_r.base64.decode(e.multiaddr,t.multiaddr=_r.newBuffer(_r.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=_r.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?_r.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(r.isCertified=e.isCertified,t.oneofs&&(r._isCertified="isCertified")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e})(),Cr.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value=_r.newBuffer([]),e.encode=function(e,t){return t||(t=Sr.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),t},e.decode=function(e,t){e instanceof Ar||(e=Ar.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Cr.Metadata;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Cr.Metadata)return e;var t=new Cr.Metadata;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&("string"==typeof e.value?_r.base64.decode(e.value,t.value=_r.newBuffer(_r.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.key="",t.bytes===String?r.value="":(r.value=[],t.bytes!==Array&&(r.value=_r.newBuffer(r.value)))),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.bytes===String?_r.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e})(),He.Reader),Tr=He.Writer,xr=He.util,Rr=He.roots.default||(He.roots.default={}),Pr=Rr.Envelope=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.publicKey=xr.newBuffer([]),e.prototype.payloadType=xr.newBuffer([]),e.prototype.payload=xr.newBuffer([]),e.prototype.signature=xr.newBuffer([]),e.encode=function(e,t){return t||(t=Tr.create()),null!=e.publicKey&&Object.hasOwnProperty.call(e,"publicKey")&&t.uint32(10).bytes(e.publicKey),null!=e.payloadType&&Object.hasOwnProperty.call(e,"payloadType")&&t.uint32(18).bytes(e.payloadType),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(26).bytes(e.payload),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),t},e.decode=function(e,t){e instanceof Ir||(e=Ir.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Rr.Envelope;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Rr.Envelope)return e;var t=new Rr.Envelope;return null!=e.publicKey&&("string"==typeof e.publicKey?xr.base64.decode(e.publicKey,t.publicKey=xr.newBuffer(xr.base64.length(e.publicKey)),0):e.publicKey.length&&(t.publicKey=e.publicKey)),null!=e.payloadType&&("string"==typeof e.payloadType?xr.base64.decode(e.payloadType,t.payloadType=xr.newBuffer(xr.base64.length(e.payloadType)),0):e.payloadType.length&&(t.payloadType=e.payloadType)),null!=e.payload&&("string"==typeof e.payload?xr.base64.decode(e.payload,t.payload=xr.newBuffer(xr.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),null!=e.signature&&("string"==typeof e.signature?xr.base64.decode(e.signature,t.signature=xr.newBuffer(xr.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.publicKey="":(r.publicKey=[],t.bytes!==Array&&(r.publicKey=xr.newBuffer(r.publicKey))),t.bytes===String?r.payloadType="":(r.payloadType=[],t.bytes!==Array&&(r.payloadType=xr.newBuffer(r.payloadType))),t.bytes===String?r.payload="":(r.payload=[],t.bytes!==Array&&(r.payload=xr.newBuffer(r.payload))),t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=xr.newBuffer(r.signature)))),null!=e.publicKey&&e.hasOwnProperty("publicKey")&&(r.publicKey=t.bytes===String?xr.base64.encode(e.publicKey,0,e.publicKey.length):t.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),null!=e.payloadType&&e.hasOwnProperty("payloadType")&&(r.payloadType=t.bytes===String?xr.base64.encode(e.payloadType,0,e.payloadType.length):t.bytes===Array?Array.prototype.slice.call(e.payloadType):e.payloadType),null!=e.payload&&e.hasOwnProperty("payload")&&(r.payload=t.bytes===String?xr.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?xr.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e})(),Dr=He.Reader,Or=He.Writer,Nr=He.util,Lr=He.roots.default||(He.roots.default={}),Ur=Lr.PeerRecord=(()=>{function e(e){if(this.addresses=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.peerId=Nr.newBuffer([]),e.prototype.seq=Nr.Long?Nr.Long.fromBits(0,0,!0):0,e.prototype.addresses=Nr.emptyArray,e.encode=function(e,t){if(t||(t=Or.create()),null!=e.peerId&&Object.hasOwnProperty.call(e,"peerId")&&t.uint32(10).bytes(e.peerId),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.addresses&&e.addresses.length)for(var r=0;r<e.addresses.length;++r)Lr.PeerRecord.AddressInfo.encode(e.addresses[r],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof Dr||(e=Dr.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Lr.PeerRecord;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.peerId=e.bytes();break;case 2:n.seq=e.uint64();break;case 3:n.addresses&&n.addresses.length||(n.addresses=[]),n.addresses.push(Lr.PeerRecord.AddressInfo.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return n},e.fromObject=function(e){if(e instanceof Lr.PeerRecord)return e;var t=new Lr.PeerRecord;if(null!=e.peerId&&("string"==typeof e.peerId?Nr.base64.decode(e.peerId,t.peerId=Nr.newBuffer(Nr.base64.length(e.peerId)),0):e.peerId.length&&(t.peerId=e.peerId)),null!=e.seq&&(Nr.Long?(t.seq=Nr.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"==typeof e.seq&&(t.seq=new Nr.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".PeerRecord.addresses: array expected");t.addresses=[];for(var r=0;r<e.addresses.length;++r){if("object"!=typeof e.addresses[r])throw TypeError(".PeerRecord.addresses: object expected");t.addresses[r]=Lr.PeerRecord.AddressInfo.fromObject(e.addresses[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.addresses=[]),t.defaults)if(t.bytes===String?r.peerId="":(r.peerId=[],t.bytes!==Array&&(r.peerId=Nr.newBuffer(r.peerId))),Nr.Long){var n=new Nr.Long(0,0,!0);r.seq=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.seq=t.longs===String?"0":0;if(null!=e.peerId&&e.hasOwnProperty("peerId")&&(r.peerId=t.bytes===String?Nr.base64.encode(e.peerId,0,e.peerId.length):t.bytes===Array?Array.prototype.slice.call(e.peerId):e.peerId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?r.seq=t.longs===String?String(e.seq):e.seq:r.seq=t.longs===String?Nr.Long.prototype.toString.call(e.seq):t.longs===Number?new Nr.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.addresses&&e.addresses.length){r.addresses=[];for(var s=0;s<e.addresses.length;++s)r.addresses[s]=Lr.PeerRecord.AddressInfo.toObject(e.addresses[s],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e.AddressInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.multiaddr=Nr.newBuffer([]),e.encode=function(e,t){return t||(t=Or.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),t},e.decode=function(e,t){e instanceof Dr||(e=Dr.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new Lr.PeerRecord.AddressInfo;e.pos<r;){var s=e.uint32();if(s>>>3==1)n.multiaddr=e.bytes();else e.skipType(7&s)}return n},e.fromObject=function(e){if(e instanceof Lr.PeerRecord.AddressInfo)return e;var t=new Lr.PeerRecord.AddressInfo;return null!=e.multiaddr&&("string"==typeof e.multiaddr?Nr.base64.decode(e.multiaddr,t.multiaddr=Nr.newBuffer(Nr.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(t.bytes===String?r.multiaddr="":(r.multiaddr=[],t.bytes!==Array&&(r.multiaddr=Nr.newBuffer(r.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(r.multiaddr=t.bytes===String?Nr.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,He.util.toJSONOptions)},e}(),e})();var Br=r(94306);He.util.Long=void 0,He.configure();const Mr={version:12,description:"Store each peerstore peer under a single datastore key",migrate:async function(e,t=(()=>{})){t(0,"Storing each peerstore key under a single datastore key"),await e.datastore.open();const r={},n=[];for await(const{key:t,value:s}of e.datastore.query({prefix:"/peers"})){n.push(t);const e=t.toString(),[,i,o,a,c]=e.split("/");if("peers"===i&&(["protos","addrs","metadata","keys"].includes(o)&&a))if(r[a]=r[a]||{addresses:[],protocols:[],metadata:[]},"protos"===o){const e=gr.decode(s);r[a].protocols=e.protocols.sort()}else if("addrs"===o){const e=Er.decode(s);r[a].addresses=e.addrs.sort(((e,t)=>(0,Br.HM)(e.multiaddr).toString().localeCompare((0,Br.HM)(t.multiaddr).toString()))),e.certifiedRecord&&e.certifiedRecord.raw&&(r[a].peerRecordEnvelope=e.certifiedRecord.raw)}else"metadata"===o?r[a].metadata.push({key:c,value:s}):"keys"===o&&(r[a].pubKey=s)}t(33,"Read peer data from store");for(const t of n)await e.datastore.delete(t);t(66,"Removed existing peer data from store");for(const t of Object.keys(r)){const n=r[t];n.metadata=n.metadata.sort(((e,t)=>e.key.localeCompare(t.key)));const s=kr.encode(n).finish();await e.datastore.put(new De.s(`/peers/${t}`),s)}await e.datastore.close(),t(100,"Stored each peerstore key under a single datastore key")},revert:async function(e,t=(()=>{})){t(0,"Storing each peerstore key under a multiple datastore keys"),await e.datastore.open();const r={},n=[];for await(const{key:t,value:s}of e.datastore.query({prefix:"/peers"})){n.push(t);const e=t.toString(),[,,i]=e.split("/");r[i]=kr.decode(s)}t(33,"Read peer data from store");for(const t of n)await e.datastore.delete(t);t(66,"Removed existing peer data from store");for(const[t,n]of Object.entries(r)){if(n.protocols&&n.protocols.length>0&&await e.datastore.put(new De.s(`/peers/protos/${t}`),gr.encode({protocols:n.protocols}).finish()),n.addresses&&n.addresses.length>0){const r=n.peerRecordEnvelope;let s;if(r){const e=Pr.decode(r);s={raw:r,seq:Ur.decode(e.payload).seq}}await e.datastore.put(new De.s(`/peers/addrs/${t}`),Er.encode({addrs:n.addresses,certifiedRecord:s}).finish())}if(n.metadata&&n.metadata.length>0)for(const{key:r,value:s}of n.metadata)await e.datastore.put(new De.s(`/peers/metadata/${t}/${r}`),s);n.pubKey&&await e.datastore.put(new De.s(`/peers/keys/${t}`),n.pubKey)}await e.datastore.close(),t(100,"Stored each peerstore key under multiple datastore keys")}},Vr={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},zr=[Object.assign({version:1},Vr),Object.assign({version:2},Vr),Object.assign({version:3},Vr),Object.assign({version:4},Vr),Object.assign({version:5},Vr),Object.assign({version:6},Vr),Object.assign({version:7},Vr),$e,Qt,cr,ur,Mr];class jr extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=jr.code,this.message=e}}jr.code="ERR_NON_REVERSIBLE_MIGRATION";class Fr extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=Fr.code,this.message=e}}Fr.code="ERR_NOT_INITIALIZED_REPO";class $r extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=$r.code,this.message=e}}$r.code="ERR_REQUIRED_PARAMETER";class qr extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=qr.code,this.message=e}}qr.code="ERR_INVALID_VALUE";class Kr extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=Kr.code,this.message=e}}Kr.code="ERR_MISSING_REPO_OPTIONS";const Hr=O("ipfs:repo:migrator:repo:init");async function Gr(e){if(!await async function(e){if(!e)throw new Kr("Please pass repo options when trying to open a repo");const t=e.root;try{await t.open();const e=await t.has(er),r=await t.has(Xt);return!(!e||!r)||(Hr(`Version entry present: ${e}`),Hr(`Config entry present: ${r}`),!1)}catch(e){return Hr("While checking if repo is initialized error was thrown: "+e.message),!1}finally{if(void 0!==t)try{await t.close()}catch{}}}(e))throw new Fr("Repo is not initialized!");const t=e.root;await t.open();try{return parseInt(jt(await t.get(er)))}finally{await t.close()}}async function Wr(e,t){if(!t)throw new Kr("Please pass repo options when trying to open a repo");const r=t.root;await r.open(),await r.put(er,Ft(String(e))),await r.close()}const Jr=O("ipfs:repo:migrator");async function Yr(e,t,r,n,s={}){const i=s.ignoreLock??!1,o=s.onProgress,a=s.isDryRun??!1,c=s.migrations??zr;if(!e)throw new Zr.RequiredParameterError("Path argument is required!");if(!r)throw new Zr.RequiredParameterError("repoOptions argument is required!");if(!n)throw new Zr.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new Zr.InvalidValueError("Version has to be positive integer!");t=nr(t);const h=await Gr(t);if(h===n)return void Jr("Nothing to migrate.");if(h>n)throw new Zr.InvalidValueError(`Current repo's version (${h}) is higher then toVersion (${n}), you probably wanted to revert it?`);let l;Qr(c,h,n),a||i||(l=await r.repoLock.lock(e));try{for(const e of c){if(void 0!==n&&e.version>n)break;if(!(e.version<=h)){Jr(`Migrating version ${e.version}`);try{if(!a){let r=()=>{};o&&(r=(t,r)=>o(e.version,t.toFixed(2),r)),await e.migrate(t,r)}}catch(r){const n=e.version-1;throw Jr(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${n}`),await Wr(n,t),new Error(`During migration to version ${e.version} exception was raised: ${r.stack||r.message||r}`)}Jr(`Migrating to version ${e.version} finished`)}}a||await Wr(n||function(e){return e=e||zr,Array.isArray(e)&&0!==e.length?e[e.length-1].version:0}(c),t),Jr("Repo successfully migrated",void 0!==n?`to version ${n}!`:"to latest version!")}finally{a||i||!l||await l.close()}}function Qr(e,t,r,n=!1){let s=0;for(const i of e){if(i.version>r)break;if(i.version>t){if(n&&!i.revert)throw new Zr.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${i.version} is not reversible. Cancelling reversion.`);s++}}if(s!==r-t)throw new Zr.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${r}`)}const Zr=b;var Xr=r(79830),en=r(40726),tn=r(45895);var rn=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const nn=rn,sn=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class on{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class an{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return hn(this,e)}}class cn{constructor(e){this.decoders=e}or(e){return hn(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hn=(e,t)=>new cn({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ln{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new on(e,t,r),this.decoder=new an(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const un=({name:e,prefix:t,encode:r,decode:n})=>new ln(e,t,r,n),dn=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=nn(r,t);return un({prefix:e,name:t,encode:n,decode:e=>sn(s(e))})},fn=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>un({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),pn=un({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),yn=fn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),gn=fn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),bn=dn({prefix:"9",name:"base10",alphabet:"0123456789"}),mn=fn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),wn=fn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),vn=fn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),En=fn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),An=fn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Sn=fn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_n=fn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cn=fn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),kn=fn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),In=fn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Tn=fn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),xn=dn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Rn=dn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Pn=dn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Dn=dn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),On=fn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nn=fn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ln=fn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Un=fn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Bn=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Mn=Bn.reduce(((e,t,r)=>(e[r]=t,e)),[]),Vn=Bn.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const zn=un({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Mn[t]),"")},decode:function(e){const t=[];for(const r of e){const e=Vn[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var jn=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Fn;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Fn=Math.pow(2,31);var $n=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var qn=Math.pow(2,7),Kn=Math.pow(2,14),Hn=Math.pow(2,21),Gn=Math.pow(2,28),Wn=Math.pow(2,35),Jn=Math.pow(2,42),Yn=Math.pow(2,49),Qn=Math.pow(2,56),Zn=Math.pow(2,63);const Xn={encode:jn,decode:$n,encodingLength:function(e){return e<qn?1:e<Kn?2:e<Hn?3:e<Gn?4:e<Wn?5:e<Jn?6:e<Yn?7:e<Qn?8:e<Zn?9:10}},es=(e,t=0)=>[Xn.decode(e,t),Xn.decode.bytes],ts=(e,t,r=0)=>(Xn.encode(e,t,r),t),rs=e=>Xn.encodingLength(e),ns=(e,t)=>{const r=t.byteLength,n=rs(e),s=n+rs(r),i=new Uint8Array(s+r);return ts(e,i,0),ts(r,i,n),i.set(t,s),new is(e,r,t,i)},ss=e=>{const t=sn(e),[r,n]=es(t),[s,i]=es(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new is(r,s,o,t)};class is{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const os=({name:e,code:t,encode:r})=>new as(e,t,r);class as{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ns(this.code,t):t.then((e=>ns(this.code,e)))}throw Error("Unknown type, must be binary type")}}const cs=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),hs=os({name:"sha2-256",code:18,encode:cs("SHA-256")}),ls=os({name:"sha2-512",code:19,encode:cs("SHA-512")}),us=sn,ds={code:0,name:"identity",encode:us,digest:e=>ns(0,us(e))},fs="raw",ps=85,ys=e=>sn(e),gs=e=>sn(e),bs=new TextEncoder,ms=new TextDecoder,ws="json",vs=512,Es=e=>bs.encode(JSON.stringify(e)),As=e=>JSON.parse(ms.decode(e)),Ss=new WeakMap,_s=e=>{const t=Ss.get(e);if(null==t){const t=new Map;return Ss.set(e,t),t}return t};class Cs{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==xs)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Rs)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Cs.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=ns(e,t);return Cs.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Cs.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?Is(r,_s(e),t||Pn.encoder):Ts(r,_s(e),t||vn.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Cs)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Cs(e,r,n,s||Ps(e,r,n.bytes))}if(!0===t[Ds]){const{version:e,multihash:r,code:n}=t,s=ss(r);return Cs.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==xs)throw new Error(`Version 0 CID must use dag-pb (code: ${xs}) block encoding`);return new Cs(e,t,r,r.bytes);case 1:{const n=Ps(e,t,r.bytes);return new Cs(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Cs.create(0,xs,e)}static createV1(e,t){return Cs.create(1,e,t)}static decode(e){const[t,r]=Cs.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Cs.inspectBytes(e),r=t.size-t.multihashSize,n=sn(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new is(t.multihashCode,t.digestSize,s,n);return[0===t.version?Cs.createV0(i):Cs.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=es(e.subarray(t));return t+=n,r};let n=r(),s=xs;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=ks(e,t),s=Cs.decode(n);return _s(s).set(r,e),s}}const ks=(e,t)=>{switch(e[0]){case"Q":{const r=t||Pn;return[Pn.prefix,r.decode(`${Pn.prefix}${e}`)]}case Pn.prefix:{const r=t||Pn;return[Pn.prefix,r.decode(e)]}case vn.prefix:{const r=t||vn;return[vn.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Is=(e,t,r)=>{const{prefix:n}=r;if(n!==Pn.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},Ts=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},xs=112,Rs=18,Ps=(e,t,r)=>{const n=rs(e),s=n+rs(t),i=new Uint8Array(s+r.byteLength);return ts(e,i,0),ts(t,i,n),i.set(r,s),i},Ds=Symbol.for("@ipld/js-cid/CID"),Os={...m,...w,...v,...E,...A,...S,..._,...C,...k,...I};function Ns(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ls(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Us=Ls("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Bs=Ls("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Ns(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Ms={utf8:Us,"utf-8":Us,hex:Os.base16,latin1:Bs,ascii:Bs,binary:Bs,...Os};function Vs(e,t="utf8"){const r=Ms[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function zs(e,t="utf8"){const r=Ms[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ns(globalThis.Buffer.from(e,"utf-8"))}var js=r(68919);async function Fs(e,t,r){const n=await t(e);if(n)return n;const s=qs(r);return!!s&&new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{t(Boolean(n.result))}}))}async function $s(e,t,r,n){if(await r(e))return t(e);const s=qs(n);if(!s)throw new js.dR;return new Promise(((t,r)=>{const n=s.store("readonly").get(e.toString());n.transaction.onabort=()=>{r(n.transaction.error)},n.transaction.oncomplete=()=>{if(n.result)return t(n.result);r(new js.dR)}}))}function qs(e){let t=e;for(;t.db||t.child;)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}const Ks=O("ipfs:repo:version"),Hs=new De.s("version");var Gs=r(57665),Ws=r(26679);const Js=Gs.Z.default?Gs.Z.default:Gs.Z,Ys=new De.s("config");var Qs=r(64348);function Zs(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)}const Xs=new Qs.s("datastore_spec");function ei(e){return{exists:()=>e.has(Xs),async get(){const t=await e.get(Xs);return JSON.parse(Vs(t))},set:async t=>e.put(Xs,zs(JSON.stringify(function(e,t={}){if(!Zs(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");const{deep:r,compare:n}=t,s=[],i=[],o=e=>{const t=s.indexOf(e);if(-1!==t)return i[t];const r=[];return s.push(e),i.push(r),r.push(...e.map((e=>Array.isArray(e)?o(e):Zs(e)?a(e):e))),r},a=e=>{const t=s.indexOf(e);if(-1!==t)return i[t];const c={},h=Object.keys(e).sort(n);s.push(e),i.push(c);for(const t of h){const n=e[t];let s;s=r&&Array.isArray(n)?o(n):r&&Zs(n)?a(n):n,Object.defineProperty(c,t,{...Object.getOwnPropertyDescriptor(e,t),value:s})}return c};return Array.isArray(e)?r?o(e):e.slice():a(e)}(t,{deep:!0}))))}}const ti=new De.s("api");var ri=r(44752),ni=r(37430),si=r(93361);function ii(e){const t=Cs.asCID(e);if(null==t)throw N(new Error("Not a valid cid"),"ERR_INVALID_CID");return t.multihash.code!==ds.code?{isIdentity:!1}:{isIdentity:!0,digest:t.multihash.digest}}const oi=O("ipfs:repo:lock:memory"),ai="repo.lock",ci={};const hi={lock:async function(e){const t=e+"/"+ai;if(oi("locking %s",t),!0===ci[t])throw new js.gg(`Lock already being held for file: ${t}`);return ci[t]=!0,{async close(){ci[t]&&delete ci[t]}}},locked:async function(e){const t=e+"/"+ai;return oi(`checking lock: ${t}`),Boolean(ci[t])}},li={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:hi},ui={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};var di=r(91486);function fi({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*pi(e,t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r],s=Cs.asCID(n);s?yield[t.join("/"),s]:"object"==typeof n&&(yield*yi(n,t))}else{const r=Cs.asCID(t);r?yield[e.join("/"),r]:yield*yi(t,e)}}function*yi(e,t){if(!(null==e||e instanceof Uint8Array))for(const[r,n]of Object.entries(e)){const e=[...t,r];yield*pi(e,n)}}function*gi(e,t){if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r];yield t.join("/"),"object"!=typeof n||Cs.asCID(n)||(yield*bi(n,t))}else yield*bi(t,e)}function*bi(e,t){if(null!=e&&"object"==typeof e)for(const[r,n]of Object.entries(e)){const e=[...t,r];yield e.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||Cs.asCID(n)||(yield*gi(e,n))}}class mi{constructor({cid:e,bytes:t,value:r}){if(!e||!t||void 0===r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:fi(),bytes:fi(),value:fi(),asBlock:fi()})}links(){return yi(this.value,[])}tree(){return bi(this.value,[])}get(e="/"){return function(e,t){let r=e;for(const[e,n]of t.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${t.slice(0,e+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const s=Cs.asCID(r);if(s)return{value:s,remaining:t.slice(e+1).join("/")}}return{value:r}}(this.value,e.split("/").filter(Boolean))}}function wi({bytes:e,cid:t,value:r,codec:n}){const s=void 0!==r?r:n&&n.decode(e);if(void 0===s)throw new Error('Missing required argument, must either provide "value" or "codec"');return new mi({cid:t,bytes:e,value:s})}function vi(e){const t=Cs.asCID(e);if(null==t)throw N(new Error("Not a valid cid"),"ERR_INVALID_CID");const r=vn.encode(t.multihash.bytes);return new De.s("/"+r.slice(1).toUpperCase(),!1)}function Ei(e){return ss(vn.decode(`b${e.toString().toLowerCase().substring(1)}`))}const Ai=O("ipfs:repo:utils:walk-dag");async function*Si(e,t,r,n){try{const s=await t.get(e,n),i=wi({bytes:s,cid:e,codec:await r(e.code)});for(const[,e]of i.links())yield e,yield*Si(e,t,r,n)}catch(t){throw Ai("Could not walk DAG for CID",e.toString(),t),t}}var _i=r(69044);class Ci extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,r]of e)this.onEviction(t,r.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const r=t.get(e);return this._getItemValue(e,r)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,r]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,r)&&(yield e)}}for(const e of this.cache){const[t,r]=e;!1===this._deleteIfExpired(t,r)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:r=this.maxAge}={}){const n="number"==typeof r&&r!==Number.POSITIVE_INFINITY?Date.now()+r:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:n}):this._set(e,{value:t,expiry:n})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],r=t.length-e;r<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(r>0&&this._emitEvictions(t.slice(0,r)),this.oldCache=new Map(t.slice(r)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,r]=e;!1===this._deleteIfExpired(t,r)&&(yield[t,r.value])}for(const e of this.oldCache){const[t,r]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,r)&&(yield[t,r.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,s]=r;!1===this._deleteIfExpired(n,s)&&(yield[n,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const r=e[t],[n,s]=r;if(!this.cache.has(n)){!1===this._deleteIfExpired(n,s)&&(yield[n,s.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[r,n]of this.entriesAscending())e.call(t,n,r,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class ki{constructor({pinstore:e,blockstore:t,loadCodec:r}){this.pinstore=e,this.blockstore=t,this.loadCodec=r,this.log=O("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);const r={depth:0};return 0!==e.version&&(r.version=e.version),e.code!==qe.code&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),this.pinstore.put(vi(e),Ke.cv(r))}unpin(e,t){return this.pinstore.delete(vi(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);const r={depth:1/0};0!==e.version&&(r.version=e.version),e.code!==qe.code&&(r.codec=e.code),t.metadata&&(r.metadata=t.metadata),await this.pinstore.put(vi(e),Ke.cv(r))}async*directKeys(e){for await(const e of this.pinstore.query({filters:[e=>0===Ke.Jx(e.value).depth]})){const t=Ke.Jx(e.value),r=t.version||0,n=null!=t.codec?t.codec:qe.code,s=Ei(e.key);yield{cid:Cs.create(r,n,s),metadata:t.metadata}}}async*recursiveKeys(e){for await(const e of this.pinstore.query({filters:[e=>Ke.Jx(e.value).depth===1/0]})){const t=Ke.Jx(e.value),r=t.version||0,n=null!=t.codec?t.codec:qe.code,s=Ei(e.key);yield{cid:Cs.create(r,n,s),metadata:t.metadata}}}async*indirectKeys(e){for await(const{cid:t}of this.recursiveKeys())for await(const r of Si(t,this.blockstore,this.loadCodec,e)){const e=[_i.R.recursive];(await this.isPinnedWithType(r,e)).pinned||(yield r)}}async isPinnedWithType(e,t,r){Array.isArray(t)||(t=[t]);const n=t.includes(_i.R.all),s=t.includes(_i.R.direct),i=t.includes(_i.R.recursive),o=t.includes(_i.R.indirect);if(i||s||n){const r=await(0,di.Z)(this.pinstore.query({prefix:vi(e).toString(),filters:[e=>{if(n)return!0;const r=Ke.Jx(e.value);return t.includes(0===r.depth?_i.R.direct:_i.R.recursive)}],limit:1}));if(r){const t=Ke.Jx(r.value);return{cid:e,pinned:!0,reason:0===t.depth?_i.R.direct:_i.R.recursive,metadata:t.metadata}}}const a=this;if(n||o){const t=await(0,di.Z)(async function*(e,t){for await(const{cid:r}of t)for await(const t of Si(r,a.blockstore,a.loadCodec))if(t.equals(e))return void(yield r)}(e,this.recursiveKeys()));if(t)return{cid:e,pinned:!0,reason:_i.R.indirect,parent:t}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){const r=new Ci({maxSize:t.cidCacheMaxSize??2048}),n=async(e,t)=>{if(r.has(e.toString()))return;r.set(e.toString(),!0);const s=wi({bytes:await this.blockstore.get(e,t),cid:e,codec:await this.loadCodec(e.code)});await Promise.all([...s.links()].map((([,e])=>n(e,t))))};await n(e,t)}static checkPinType(e){if("string"!=typeof e||!Object.keys(_i.R).includes(e))throw function(e){return N(new Error(`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`),"ERR_INVALID_PIN_TYPE")}(e);return!0}}var Ii=r(21007);async function Ti(e,t){const{pinned:r,reason:n}=await t.isPinnedWithType(e,_i.R.all);if(r)throw N(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}var xi=r(33412),Ri=r(14205);var Pi=r(88211),Di=r(52019);const Oi=O("ipfs:repo:gc"),Ni=(0,Zt.notFoundError)().code,Li=new De.s("/local/filesroot");function Ui({gcLock:e,pins:t,blockstore:r,root:n,loadCodec:s}){return async function*(){const i=Date.now();Oi("Creating set of marked blocks");const o=await e.writeLock();try{const e=await async function({pins:e,blockstore:t,loadCodec:r,root:n}){const s=async function*(){let e;try{e=await n.get(Li)}catch(e){if(e.code===Ni)return void Oi("No blocks in MFS");throw e}const s=Cs.decode(e);yield s,yield*Si(s,t,r)}(),i=(0,Di.Z)((0,Ii.Z)(e.recursiveKeys(),(({cid:e})=>e)),e.indirectKeys(),(0,Ii.Z)(e.directKeys(),(({cid:e})=>e)),s),o=new Set;for await(const e of(0,Di.Z)(i,s))o.add(vn.encode(e.multihash.bytes));return o}({pins:t,blockstore:r,root:n,loadCodec:s}),a=r.queryKeys({});yield*async function*({blockstore:e},t,r){let n=0,s=0;const i=async r=>async function(){n++;try{const n=vn.encode(r.multihash.bytes);if(t.has(n))return null;try{await e.delete(r),s++}catch(e){return{err:new Error(`Could not delete block with CID ${r}: ${e.message}`)}}return{cid:r}}catch(e){const t=`Could delete block with CID ${r}`;return Oi(t,e),{err:new Error(t+`: ${e.message}`)}}};yield*(0,Pi.zG)(async function*(e,t=1){for await(const r of(0,Ri.Z)(e,t)){const e=r.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}((0,Ii.Z)(r,i),256),(e=>(0,ri.Z)(e,Boolean))),Oi(`Marked set has ${t.size} unique blocks. Blockstore has ${n} blocks. Deleted ${s} blocks.`)}({blockstore:r},e,a),Oi(`Complete (${Date.now()-i}ms)`)}finally{o()}}}const Bi=O("ipfs:repo"),Mi=Number.MAX_SAFE_INTEGER;class Vi{constructor(e,t,r,n){if("string"!=typeof e)throw new Error("missing repo path");if("function"!=typeof t)throw new Error("missing codec loader");this.options=(0,en.Z)(li,n),this.closed=!0,this.path=e,this.root=r.root,this.datastore=r.datastore,this.keys=r.keys;const s=r.blocks,i=r.pins;this.pins=new ki({pinstore:i,blockstore:s,loadCodec:t});const o=(a=this.pins,c=s,{open:()=>c.open(),close:()=>c.close(),query:(e,t)=>c.query(e,t),queryKeys:(e,t)=>c.queryKeys(e,t),get:async(e,t)=>c.get(e,t),async*getMany(e,t){yield*c.getMany(e,t)},async put(e,t,r){await c.put(e,t,r)},async*putMany(e,t){yield*c.putMany(e,t)},has:(e,t)=>c.has(e,t),delete:async(e,t)=>(await Ti(e,a),c.delete(e,t)),deleteMany:(e,t)=>c.deleteMany((0,Ii.Z)(e,(async e=>(await Ti(e,a),e))),t),batch:()=>c.batch()});var a,c;this.blocks=function(e){return{open:()=>e.open(),close:()=>e.close(),query:(t,r)=>e.query(t,r),queryKeys:(t,r)=>e.queryKeys(t,r),async get(t,r){const n=ii(t);return n.isIdentity?Promise.resolve(n.digest):e.get(t,r)},async*getMany(e,t){for await(const r of e)yield this.get(r,t)},async put(t,r,n){const{isIdentity:s}=ii(t);s||await e.put(t,r,n)},async*putMany(t,r){const n=(0,ni.d)({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((async()=>{try{await(0,si.Z)(e.putMany(async function*(){for await(const{key:e,value:r}of t)ii(e).isIdentity||(yield{key:e,value:r}),n.push({key:e,value:r})}())),n.end()}catch(e){n.end(e)}})),yield*n},has(t,r){const{isIdentity:n}=ii(t);return n?Promise.resolve(!0):e.has(t,r)},delete(t,r){const{isIdentity:n}=ii(t);return n?Promise.resolve():e.delete(t,r)},deleteMany:(t,r)=>e.deleteMany((0,ri.Z)(t,(e=>!ii(e).isIdentity)),r),batch(){const t=e.batch();return{put(e,r){const{isIdentity:n}=ii(e);n||t.put(e,r)},delete(e){const{isIdentity:r}=ii(e);r||t.delete(e)},commit:e=>t.commit(e)}}}}(o),this.version=function(e){return{exists:async()=>Fs(Hs,e.has.bind(e),e),async get(){const t=await $s(Hs,e.get.bind(e),e.has.bind(e),e);return parseInt(Vs(t),10)},set:t=>e.put(Hs,zs(String(t))),async check(e){const t=await this.get();return Ks("comparing version: %s and %s",t,e),t===e||6===t&&7===e||6===e&&7===t}}}(this.root),this.config=function(e){const t=new Js({concurrency:1}),r={async getAll(t={}){const r=await $s(Ys,e.get.bind(e),e.has.bind(e),e);return JSON.parse(Vs(r))},async get(e,t={}){if(null==e)throw new js.dR(`Key ${e} does not exist in config`);const r=await this.getAll(t),n=D(r,e);if(void 0===n)throw new js.dR(`Key ${e} does not exist in config`);return n},set(e,r,s={}){if("string"!=typeof e&&!(e instanceof String))throw N(new Error("Invalid key type: "+typeof e),"ERR_INVALID_KEY");if(void 0===r||r instanceof Uint8Array)throw N(new Error("Invalid value type: "+typeof r),"ERR_INVALID_VALUE");return t.add((()=>n({key:e,value:r},s.signal)))},replace(e,r={}){if(!e||e instanceof Uint8Array)throw N(new Error("Invalid value type: "+typeof e),"ERR_INVALID_VALUE");return t.add((()=>n({key:void 0,value:e},r.signal)))},exists:async()=>Fs(Ys,e.has.bind(e),e)};return r;async function n(e,t){if(t&&t.aborted)return;const n=e.key,i=e.value;if(n){const e=await r.getAll();return"object"==typeof e&&null!==e&&(0,Ws.Z)(e,n,i),s(e)}return s(i)}function s(t){const r=zs(JSON.stringify(t,null,2));return e.put(Ys,r)}}(this.root),this.spec=ei(this.root),this.apiAddr=function(e){return{async get(){const t=await e.get(ti);return t&&t.toString()},set:t=>e.put(ti,zs(t.toString())),delete:()=>e.delete(ti)}}(this.root),this.gcLock=(0,xi.Z)({name:e,singleProcess:!1!==this.options.repoOwner}),this.gc=Ui({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){var t;Bi("initializing at: %s",this.path),await this._openRoot(),await this.config.replace((t=e,t.Datastore=Object.assign({},ui,D(t,"datastore")),t)),await this.spec.set(function(e){const t={...ui.Spec,...D(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map((e=>({mountpoint:e.mountpoint,type:e.child.type,path:e.child.path,shardFunc:e.child.shardFunc})))}}(e)),await this.version.set(tn._)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw N(new Error("repo is already open"),js.AJ);Bi("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),Bi("acquired repo.lock");if(!await this.version.check(tn._)){if(!await this._isAutoMigrationEnabled())throw new js.CK("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");await this._migrate(tn._,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys})}Bi("creating datastore"),await this.datastore.open(),Bi("creating blocks"),await this.blocks.open(),Bi("creating keystore"),await this.keys.open(),Bi("creating pins"),await this.pins.pinstore.open(),this.closed=!1,Bi("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(e){Bi("error removing lock",e)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if("Already open"!==e.message)throw e}}async _openLock(){const e=await this.options.repoLock.lock(this.path);if("function"!=typeof e.close)throw N(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){let e;Bi("init check");try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(e){if("ERR_NOT_FOUND"===e.code)throw N(new Error("repo is not initialized yet"),js.uF,{path:this.path});throw e}if(!e)throw N(new Error("repo is not initialized yet"),js.uF,{path:this.path})}async close(){if(this.closed)throw N(new Error("repo is already closed"),js._I);Bi("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==js.uF&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map((e=>e&&e.close()))),Bi("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[e,t,r,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),zi(this.datastore),zi(this.keys)]),i=t.size+n+s;return{repoPath:this.path,storageMax:e,version:r,numObjects:t.count,repoSize:i}}throw N(new Error("repo is not initialized yet"),js.uF,{path:this.path})}async _isAutoMigrationEnabled(){if(void 0!==this.options.autoMigrate)return this.options.autoMigrate;let e;try{e=await this.config.get("repoAutoMigrate")}catch(t){if(t.code!==js.dR.code)throw t;e=!0}return e}async _migrate(e,t){return await this.version.get()>e?(Bi(`reverting to version ${e}`),async function(e,t,r,n,s={}){const i=s.ignoreLock??!1,o=s.onProgress,a=s.isDryRun??!1,c=s.migrations??zr;if(!e)throw new Zr.RequiredParameterError("Path argument is required!");if(!r)throw new Zr.RequiredParameterError("repoOptions argument is required!");if(!n)throw new Zr.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new Zr.InvalidValueError("Version has to be positive integer!");t=nr(t);const h=await Gr(t);if(h===n)return void Jr("Nothing to revert.");if(h<n)throw new Zr.InvalidValueError(`Current repo's version (${h}) is lower then toVersion (${n}), you probably wanted to migrate it?`);let l;Qr(c,n,h,!0),a||i||(l=await r.repoLock.lock(e)),Jr(`Reverting from version ${h} to ${n}`);try{const e=c.slice().reverse();for(const r of e){if(r.version<=n)break;if(!(r.version>h)){Jr(`Reverting migration version ${r.version}`);try{if(!a){let e=()=>{};o&&(e=(e,t)=>o(r.version,e.toFixed(2),t)),await r.revert(t,e)}}catch(e){const n=r.version;throw Jr(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${n}`),await Wr(n,t),e.message=`During reversion to version ${r.version} exception was raised: ${e.message}`,e}Jr(`Reverting to version ${r.version} finished`)}}a||await Wr(n,t),Jr(`All migrations successfully reverted to version ${n}!`)}finally{a||i||!l||await l.close()}}(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(Bi(`migrating to version ${e}`),Yr(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const e=await this.config.get("Datastore.StorageMax");return BigInt(Xr(e))}catch(e){return BigInt(Mi)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(const{key:r,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(r.bytes.byteLength);return{count:e,size:t}}}async function zi(e){let t=BigInt(0);for await(const r of e.query({}))t+=BigInt(r.value.byteLength),t+=BigInt(r.key.uint8Array().byteLength);return t}var ji=r(78602),Fi=r(44363),$i=r(46380),qi=r(21301);class Ki extends ji.eF{constructor(e,t={}){super(),this.db="string"==typeof e?new qi.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(e){throw ji.D1.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(e){throw ji.D1.dbWriteFailedError(e)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(e){if(e.notFound)throw ji.D1.notFoundError(e);throw ji.D1.dbWriteFailedError(e)}return t}async has(e){try{await this.db.get(e.toString())}catch(e){if(e.notFound)return!1;throw e}return!0}async delete(e){try{await this.db.del(e.toString())}catch(e){throw ji.D1.dbDeleteFailedError(e)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,r)=>{e.push({type:"put",key:t.toString(),value:r})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>(0,ri.Z)(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>(0,$i.Z)(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=(0,ri.Z)(t,(()=>e++>=r))}return n&&(t=(0,Fi.Z)(t,n)),t}queryKeys(e){let t=(0,Ii.Z)(this._query({values:!1,prefix:e.prefix}),(({key:e})=>e));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>(0,ri.Z)(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>(0,$i.Z)(e,t)),t));const{offset:r,limit:n}=e;if(r){let e=0;t=(0,ri.Z)(t,(()=>e++>=r))}return n&&(t=(0,Fi.Z)(t,n)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(null!=e.prefix){const r=e.prefix.toString();t.gte=r,t.lt=r+"ÿ"}const r=this.db.iterator(t);if(r[Symbol.asyncIterator])return async function*(e){for await(const[t,r]of e)yield{key:new Qs.s(t,!1),value:r};await e.close()}(r);if(null!=r.next&&null!=r.end)return n=r,{[Symbol.asyncIterator]:()=>({next:()=>new Promise(((e,t)=>{n.next(((r,s,i)=>r?t(r):null==s?n.end((r=>{if(r)return t(r);e({done:!0,value:void 0})})):void e({done:!1,value:{key:new Qs.s(s,!1),value:i}})))})),return:()=>new Promise(((e,t)=>{n.end((r=>{if(r)return t(r);e({done:!0,value:void 0})}))}))})};var n;throw new Error("Level returned incompatible iterator")}}var Hi=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Gi;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Gi=Math.pow(2,31);var Wi=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var Ji=Math.pow(2,7),Yi=Math.pow(2,14),Qi=Math.pow(2,21),Zi=Math.pow(2,28),Xi=Math.pow(2,35),eo=Math.pow(2,42),to=Math.pow(2,49),ro=Math.pow(2,56),no=Math.pow(2,63);const so={encode:Hi,decode:Wi,encodingLength:function(e){return e<Ji?1:e<Yi?2:e<Qi?3:e<Zi?4:e<Xi?5:e<eo?6:e<to?7:e<ro?8:e<no?9:10}},io=(e,t=0)=>[so.decode(e,t),so.decode.bytes],oo=(e,t,r=0)=>(so.encode(e,t,r),t),ao=e=>so.encodingLength(e),co=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),ho=e=>{const t=co(e),[r,n]=io(t),[s,i]=io(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new lo(r,s,o,t)};class lo{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}var uo=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const fo=uo;class po{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class yo{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return bo(this,e)}}class go{constructor(e){this.decoders=e}or(e){return bo(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bo=(e,t)=>new go({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class mo{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new po(e,t,r),this.decoder=new yo(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wo=({name:e,prefix:t,encode:r,decode:n})=>new mo(e,t,r,n),vo=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=fo(r,t);return wo({prefix:e,name:t,encode:n,decode:e=>co(s(e))})},Eo=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>wo({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),Ao=vo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),So=(vo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Eo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),_o=(Eo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Eo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5})),Co=(Eo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Eo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Eo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Eo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Eo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Eo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),ko=e=>{const t=Co.get(e);if(null==t){const t=new Map;return Co.set(e,t),t}return t};class Io{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Po)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Do)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Io.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=((e,t)=>{const r=t.byteLength,n=ao(e),s=n+ao(r),i=new Uint8Array(s+r);return oo(e,i,0),oo(r,i,n),i.set(t,s),new lo(e,r,t,i)})(e,t);return Io.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Io.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?xo(r,ko(e),t||Ao.encoder):Ro(r,ko(e),t||So.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Io)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Io(e,r,n,s||Oo(e,r,n.bytes))}if(!0===t[No]){const{version:e,multihash:r,code:n}=t,s=ho(r);return Io.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Po)throw new Error(`Version 0 CID must use dag-pb (code: ${Po}) block encoding`);return new Io(e,t,r,r.bytes);case 1:{const n=Oo(e,t,r.bytes);return new Io(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Io.create(0,Po,e)}static createV1(e,t){return Io.create(1,e,t)}static decode(e){const[t,r]=Io.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Io.inspectBytes(e),r=t.size-t.multihashSize,n=co(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new lo(t.multihashCode,t.digestSize,s,n);return[0===t.version?Io.createV0(i):Io.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=io(e.subarray(t));return t+=n,r};let n=r(),s=Po;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=To(e,t),s=Io.decode(n);return ko(s).set(r,e),s}}const To=(e,t)=>{switch(e[0]){case"Q":{const r=t||Ao;return[Ao.prefix,r.decode(`${Ao.prefix}${e}`)]}case Ao.prefix:{const r=t||Ao;return[Ao.prefix,r.decode(e)]}case So.prefix:{const r=t||So;return[So.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},xo=(e,t,r)=>{const{prefix:n}=r;if(n!==Ao.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},Ro=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},Po=112,Do=18,Oo=(e,t,r)=>{const n=ao(e),s=n+ao(t),i=new Uint8Array(s+r.byteLength);return oo(e,i,0),oo(t,i,n),i.set(r,s),i},No=Symbol.for("@ipld/js-cid/CID");var Lo=r(64591);function Uo(e){const t=Io.asCID(e);if(!t)throw N(new Error("Not a valid cid"),"ERR_INVALID_CID");return new De.s("/"+So.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function Bo(e){return Io.createV1(85,ho(So.decode("b"+e.toString().slice(1).toLowerCase())))}function Mo(e){const t=e.substring(0,1);if("/"===t)return Mo(e.substring(1));let r,n;r="b"===t.toLowerCase()?e=>So.decode(e.toLowerCase()).subarray(2):"c"===t.toLowerCase()?e=>_o.decode(e.toLowerCase()).subarray(2):"z"===t?e=>Ao.decode(e).subarray(2):"Q"===t?e=>Ao.decode("z"+e):e=>So.decode("b"+e.toLowerCase()).subarray(2);for(let t=1;t<e.length;t++)try{n=r(e.substring(0,t))}catch(e){if("Unexpected end of data"!==e.message)throw e}let s="/C";return n&&(s=`/${So.encode(n).slice(1,-1).toUpperCase()||"C"}`),s}class Vo extends Lo.E{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(const{key:r,value:n}of this.child.query(function(e){return{...e,prefix:e.prefix?Mo(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e({key:Bo(t.key),value:t.value}))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e({key:Bo(t.key),value:t.value},{key:Bo(r.key),value:r.value}))):void 0}}(e),t))yield{key:Bo(r),value:n}}async*queryKeys(e,t){for await(const r of this.child.queryKeys(function(e){return{...e,prefix:e.prefix?Mo(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e(Bo(t)))):void 0,orders:e.orders?e.orders.map((e=>(t,r)=>e(Bo(t),Bo(r)))):void 0}}(e),t))yield Bo(r)}async get(e,t){return this.child.get(Uo(e),t)}async*getMany(e,t){for await(const r of e)yield this.get(r,t)}async put(e,t,r){await this.child.put(Uo(e),t,r)}async*putMany(e,t){const r=(0,ni.d)({objectMode:!0});(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)((async()=>{try{const n=this.child;await(0,si.Z)(this.child.putMany(async function*(){for await(const s of e){const e=Uo(s.key);await n.has(e,t)||(yield{key:e,value:s.value}),r.push(s)}}())),r.end()}catch(e){r.end(e)}})),yield*r}has(e,t){return this.child.has(Uo(e),t)}delete(e,t){return this.child.delete(Uo(e),t)}deleteMany(e,t){const r=(0,ni.d)({objectMode:!0});return(0,si.Z)(this.child.deleteMany(async function*(){for await(const t of e)yield Uo(t),r.push(t);r.end()}(),t)).catch((e=>{r.end(e)})),r}}function zo(e,t,r){const n=r.path||"ipfs";return function(e,t,r,n){return new Vi(e,t,r,n)}(n,(e=>t.getCodec(e)),{root:new Ki(n,{prefix:"",version:2}),blocks:new Vo(new Ki(`${n}/blocks`,{prefix:"",version:2})),datastore:new Ki(`${n}/datastore`,{prefix:"",version:2}),keys:new Ki(`${n}/keys`,{prefix:"",version:2}),pins:new Ki(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||e,repoLock:hi})}},25006:(e,t,r)=>{"use strict";r.d(t,{kU:()=>u,Dp:()=>l,ET:()=>d});const n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};var s=r(50847);class i{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class o{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i(e,t,r),this.decoder=new o(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),u=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:o}=n(r,t);return l({prefix:e,name:t,encode:i,decode:e=>(0,s.oQ)(o(e))})},d=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)})},29956:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base32:()=>s,base32hex:()=>c,base32hexpad:()=>l,base32hexpadupper:()=>u,base32hexupper:()=>h,base32pad:()=>o,base32padupper:()=>a,base32upper:()=>i,base32z:()=>d});var n=r(25006);const s=(0,n.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i=(0,n.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,n.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,n.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,n.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),h=(0,n.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,n.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u=(0,n.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,n.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},40145:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base58btc:()=>s,base58flickr:()=>i});var n=r(25006);const s=(0,n.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),i=(0,n.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},50847:(e,t,r)=>{"use strict";r.d(t,{BB:()=>o,fS:()=>n,mL:()=>i,oQ:()=>s});new Uint8Array(0);const n=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},s=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},i=e=>(new TextEncoder).encode(e),o=e=>(new TextDecoder).decode(e)},55390:(e,t,r)=>{"use strict";r.d(t,{k:()=>l});var n=r(80134),s=r(10538),i=r(40145),o=r(29956),a=r(50847);const c=new WeakMap,h=e=>{const t=c.get(e);if(null==t){const t=new Map;return c.set(e,t),t}return t};class l{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==p)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==y)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return l.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=s.Ue(e,t);return l.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return l.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&s.fS(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?d(r,h(e),t||i.base58btc.encoder):f(r,h(e),t||o.base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof l)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new l(e,r,n,s||g(e,r,n.bytes))}if(!0===t[b]){const{version:e,multihash:r,code:n}=t,i=s.Jx(r);return l.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==p)throw new Error(`Version 0 CID must use dag-pb (code: ${p}) block encoding`);return new l(e,t,r,r.bytes);case 1:{const n=g(e,t,r.bytes);return new l(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return l.create(0,p,e)}static createV1(e,t){return l.create(1,e,t)}static decode(e){const[t,r]=l.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=l.inspectBytes(e),r=t.size-t.multihashSize,n=(0,a.oQ)(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new s.zZ(t.multihashCode,t.digestSize,i,n);return[0===t.version?l.createV0(o):l.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,s]=n.Jx(e.subarray(t));return t+=s,r};let s=r(),i=p;if(18===s?(s=0,t=0):i=r(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=r(),c=r(),h=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:h-o,size:h}}static parse(e,t){const[r,n]=u(e,t),s=l.decode(n);return h(s).set(r,e),s}}const u=(e,t)=>{switch(e[0]){case"Q":{const r=t||i.base58btc;return[i.base58btc.prefix,r.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const r=t||i.base58btc;return[i.base58btc.prefix,r.decode(e)]}case o.base32.prefix:{const r=t||o.base32;return[o.base32.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},d=(e,t,r)=>{const{prefix:n}=r;if(n!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},f=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},p=112,y=18,g=(e,t,r)=>{const s=n.P$(e),i=s+n.P$(t),o=new Uint8Array(i+r.byteLength);return n.mL(e,o,0),n.mL(t,o,s),o.set(r,i),o},b=Symbol.for("@ipld/js-cid/CID")},10538:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>o,Ue:()=>i,fS:()=>a,zZ:()=>c});var n=r(50847),s=r(80134);const i=(e,t)=>{const r=t.byteLength,n=s.P$(e),i=n+s.P$(r),o=new Uint8Array(i+r);return s.mL(e,o,0),s.mL(r,o,n),o.set(t,i),new c(e,r,t,o)},o=e=>{const t=(0,n.oQ)(e),[r,i]=s.Jx(t),[o,a]=s.Jx(t.subarray(i)),h=t.subarray(i+a);if(h.byteLength!==o)throw new Error("Incorrect length");return new c(r,o,h,t)},a=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&(0,n.fS)(e.bytes,r.bytes)}};class c{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}},80134:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>g,mL:()=>b,P$:()=>m});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t=0)=>[y.decode(e,t),y.decode.bytes],b=(e,t,r=0)=>(y.encode(e,t,r),t),m=e=>y.encodingLength(e)},97295:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=()=>{}},98509:(e,t,r)=>{"use strict";r.d(t,{n:()=>h});var n=r(32114),s=r(53597),i=r(75671),o=r(21007),a=r(20530),c=r(92754);async function*h(e,t){if("string"==typeof e||e instanceof String||(0,a._t)(e)||(0,a.Lj)(e)||e._readableState)throw n(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if((0,a.Os)(e)&&(e=(0,s.Z)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=(0,i.Z)(e),{value:s,done:c}=await r.peek();if(c)return void(yield*[]);if(r.push(s),Number.isInteger(s))throw n(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(s._readableState)return void(yield*(0,o.Z)(r,(e=>l({content:e},t))));if((0,a._t)(s))return void(yield l({content:r},t));if((0,a.Mk)(s)||s[Symbol.iterator]||s[Symbol.asyncIterator]||(0,a.Os)(s)||(0,a.Lj)(s))return void(yield*(0,o.Z)(r,(e=>l(e,t))))}if((0,a.Mk)(e))throw n(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw n(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function l(e,t){const{path:r,mode:n,mtime:s,content:i}=e,o={path:r||"",mode:(0,c.tK)(n),mtime:(0,c.Xu)(s)};return i?o.content=await t(i):r||(o.content=await t(e)),o}},44740:(e,t,r)=>{"use strict";r.d(t,{u:()=>de});var n={};r.r(n),r.d(n,{identity:()=>m});var s={};r.r(s),r.d(s,{base2:()=>w});var i={};r.r(i),r.d(i,{base8:()=>v});var o={};r.r(o),r.d(o,{base10:()=>E});var a={};r.r(a),r.d(a,{base16:()=>A,base16upper:()=>S});var c={};r.r(c),r.d(c,{base36:()=>C,base36upper:()=>k});var h={};r.r(h),r.d(h,{base64:()=>T,base64pad:()=>x,base64url:()=>R,base64urlpad:()=>P});var l={};r.r(l),r.d(l,{base256emoji:()=>L});var u={};r.r(u),r.d(u,{sha256:()=>z,sha512:()=>j});var d={};r.r(d),r.d(d,{identity:()=>$});var f={};r.r(f),r.d(f,{code:()=>K,decode:()=>G,encode:()=>H,name:()=>q});var p={};r.r(p),r.d(p,{code:()=>Q,decode:()=>X,encode:()=>Z,name:()=>Y});var y=r(32114),g=r(25006),b=r(50847);const m=(0,g.Dp)({prefix:"\0",name:"identity",encode:e=>(0,b.BB)(e),decode:e=>(0,b.mL)(e)}),w=(0,g.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),v=(0,g.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),E=(0,g.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),A=(0,g.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),S=(0,g.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _=r(29956);const C=(0,g.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),k=(0,g.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var I=r(40145);const T=(0,g.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),x=(0,g.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),R=(0,g.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),P=(0,g.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),D=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),O=D.reduce(((e,t,r)=>(e[r]=t,e)),[]),N=D.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const L=(0,g.Dp)({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=O[t]),"")},decode:function(e){const t=[];for(const r of e){const e=N[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var U=r(10538);const B=({name:e,code:t,encode:r})=>new M(e,t,r);class M{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?U.Ue(this.code,t):t.then((e=>U.Ue(this.code,e)))}throw Error("Unknown type, must be binary type")}}const V=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),z=B({name:"sha2-256",code:18,encode:V("SHA-256")}),j=B({name:"sha2-512",code:19,encode:V("SHA-512")}),F=b.oQ,$={code:0,name:"identity",encode:F,digest:e=>U.Ue(0,F(e))},q="raw",K=85,H=e=>(0,b.oQ)(e),G=e=>(0,b.oQ)(e),W=new TextEncoder,J=new TextDecoder,Y="json",Q=512,Z=e=>W.encode(JSON.stringify(e)),X=e=>JSON.parse(J.decode(e));r(55390),r(80134);const ee={...n,...s,...i,...o,...a,..._,...c,...I,...h,...l};function te(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function re(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ne=re("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),se=re("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?te(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),ie={utf8:ne,"utf-8":ne,hex:ee.base16,latin1:se,ascii:se,binary:se,...ee};var oe=r(53597);var ae=r(75671),ce=r(33686),he=r(21007),le=r(20530);async function*ue(e){yield e}async function de(e){if((0,le._t)(e))return ue(fe(e));if("string"==typeof e||e instanceof String)return ue(fe(e.toString()));if((0,le.Lj)(e))return"function"==typeof(t=e).stream?(0,oe.Z)(t.stream()):(0,oe.Z)(new Response(t).body);var t;if((0,le.Os)(e)&&(e=(0,oe.Z)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=(0,ae.Z)(e),{value:r,done:n}=await t.peek();if(n)return ue(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return ue(Uint8Array.from(await(0,ce.Z)(t)));if((0,le._t)(r)||"string"==typeof r||r instanceof String)return(0,he.Z)(t,fe)}throw y(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function fe(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):function(e,t="utf8"){const r=ie[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):te(globalThis.Buffer.from(e,"utf-8"))}(e.toString())}},3064:(e,t,r)=>{"use strict";r.d(t,{f:()=>i});var n=r(44740),s=r(98509);function i(e){return(0,s.n)(e,n.u)}},56740:(e,t,r)=>{"use strict";r.d(t,{f:()=>l});var n=r(44740),s=r(32114),i=r(53597),o=r(75671),a=r(20530),c=r(92754);async function h(e,t){const{path:r,mode:n,mtime:s,content:i}=e,o={path:r||"",mode:(0,c.tK)(n),mtime:(0,c.Xu)(s)};return i?o.content=await t(i):r||(o.content=await t(e)),o}function l(e){return async function*(e,t){if(null==e)throw s(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if("string"==typeof e||e instanceof String)yield h(e.toString(),t);else if((0,a._t)(e)||(0,a.Lj)(e))yield h(e,t);else{if((0,a.Os)(e)&&(e=(0,i.Z)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=(0,o.Z)(e),{value:n,done:i}=await r.peek();if(i)return void(yield{content:[]});if(r.push(n),Number.isInteger(n)||(0,a._t)(n)||"string"==typeof n||n instanceof String)return void(yield h(r,t));throw s(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!(0,a.Mk)(e))throw s(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield h(e,t)}}(e,n.u)}},20530:(e,t,r)=>{"use strict";function n(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function s(e){return e.constructor&&("Blob"===e.constructor.name||"File"===e.constructor.name)&&"function"==typeof e.stream}function i(e){return"object"==typeof e&&(e.path||e.content)}r.d(t,{Lj:()=>s,Mk:()=>i,Os:()=>o,_t:()=>n});const o=e=>e&&"function"==typeof e.getReader},51392:(e,t,r)=>{"use strict";r.d(t,{x:()=>s});const n=e=>Promise.reject(new Error(`No base found for "${e}"`));class s{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||n;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const t=await this._loadBase(e);return null==this._basesByName[t.name]&&null==this._basesByPrefix[t.prefix]&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}}},52890:(e,t,r)=>{"use strict";r.d(t,{w:()=>s});const n=e=>Promise.reject(new Error(`No codec found for "${e}"`));class s{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||n;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const t="string"==typeof e?this._codecsByName:this._codecsByCode;if(t[e])return t[e];const r=await this._loadCodec(e);return null==t[e]&&this.addCodec(r),r}listCodecs(){return Object.values(this._codecsByName)}}},55101:(e,t,r)=>{"use strict";r.d(t,{d:()=>s});const n=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class s{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||n;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const t="string"==typeof e?this._hashersByName:this._hashersByCode;if(t[e])return t[e];const r=await this._loadHasher(e);return null==t[e]&&this.addHasher(r),r}listHashers(){return Object.values(this._hashersByName)}}},47498:(e,t,r)=>{"use strict";r.d(t,{x:()=>d});var n=r(32114),s=r(75671),i=r(53597),o=r(33686),a=r(20530);async function c(e){if((0,a._t)(e))return new Blob([e]);if("string"==typeof e||e instanceof String)return new Blob([e.toString()]);if((0,a.Lj)(e))return e;if((0,a.Os)(e)&&(e=(0,i.Z)(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=(0,s.Z)(e),{value:r,done:n}=await t.peek();if(n)return h(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await(0,o.Z)(t))]);if((0,a._t)(r)||"string"==typeof r||r instanceof String)return h(t)}throw n(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function h(e){const t=[];for await(const r of e)t.push(r);return new Blob(t)}var l=r(98509);function u(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}async function d(e,t,r={}){const n=[],s=new FormData;let i=0,o=0;for await(const{content:t,path:r,mode:h,mtime:d}of(a=e,(0,l.n)(a,c,!0))){let e="";i>0&&(e=`-${i}`);let a=(t?"file":"dir")+e;const c=[];if(null!=h&&c.push(`mode=${u(h)}`),null!=d){const{secs:e,nsecs:t}=d;c.push(`mtime=${e}`),null!=t&&c.push(`mtime-nsecs=${t}`)}if(c.length&&(a=`${a}?${c.join("&")}`),t){s.set(a,t,null!=r?encodeURIComponent(r):void 0);const e=o+t.size;n.push({name:r,start:o,end:e}),o=e}else{if(null==r)throw new Error("path or content or both must be set");s.set(a,new File([""],encodeURIComponent(r),{type:"application/x-directory"}))}i++}var a;return{total:o,parts:n,headers:r,body:s}}},73297:(e,t,r)=>{"use strict";r.d(t,{f:()=>i});var n=r(32114),s=r(55390);async function*i(e){if(null==e)throw n(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=s.k.asCID(e);if(t)yield o({cid:t});else{if(!(e instanceof String||"string"==typeof e)){if(null!=e.cid||null!=e.path)return yield o(e);if(Symbol.iterator in e){const t=e[Symbol.iterator](),r=t.next();if(r.done)return t;if(s.k.asCID(r.value)||r.value instanceof String||"string"==typeof r.value){yield o({cid:r.value});for(const e of t)yield o({cid:e});return}if(null!=r.value.cid||null!=r.value.path){yield o(r.value);for(const e of t)yield o(e);return}throw n(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){const t=e[Symbol.asyncIterator](),r=await t.next();if(r.done)return t;if(s.k.asCID(r.value)||r.value instanceof String||"string"==typeof r.value){yield o({cid:r.value});for await(const e of t)yield o({cid:e});return}if(null!=r.value.cid||null!=r.value.path){yield o(r.value);for await(const e of t)yield o(e);return}throw n(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw n(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}yield o({path:e})}}function o(e){const t=e.cid||`${e.path}`;if(!t)throw n(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:!1!==e.recursive};return null!=e.metadata&&(r.metadata=e.metadata),r}},41966:(e,t,r)=>{"use strict";r.d(t,{B:()=>o});var n=r(55390),s=r(32114);const i="/ipfs/";function o(e){if(e instanceof Uint8Array)try{e=n.k.decode(e)}catch(e){throw s(e,"ERR_INVALID_CID")}let t=n.k.asCID(e);if(t)return{cid:t,path:void 0};(e=e.toString()).startsWith(i)&&(e=e.substring(i.length));const r=e.split("/");let o;try{t=n.k.parse(r.shift()||"")}catch(e){throw s(e,"ERR_INVALID_CID")}return r.length&&(o=`/${r.join("/")}`),{cid:t,path:o}}},63181:(e,t,r)=>{"use strict";r.d(t,{d:()=>i});var n=r(94306),s=r(45182);function i(e){try{e=(0,s.k)((0,n.HM)(e))}catch(e){}return e=e.toString()}},45847:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var n=r(10715),s=r(32044),i=r(92816);class o extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=o.code}}function a(e,t){return(...r)=>{const a=r[null==t?r.length-1:t];if(!a||!a.timeout)return e(...r);const c="string"==typeof a.timeout?(0,i.Z)(a.timeout):a.timeout,h=new n.TimeoutController(c);a.signal=(0,s.anySignal)([a.signal,h.signal]);const l=e(...r),u=new Promise(((e,t)=>{h.signal.addEventListener("abort",(()=>{t(new o)}))})),d=Date.now(),f=()=>{if(h.signal.aborted)throw new o;if(Date.now()-d>c)throw h.abort(),new o};return l[Symbol.asyncIterator]?async function*(){const e=l[Symbol.asyncIterator]();try{for(;;){const{value:t,done:r}=await Promise.race([e.next(),u]);if(r)break;f(),yield t}}catch(e){throw f(),e}finally{h.clear(),e.return&&e.return()}}():(async()=>{try{const e=await Promise.race([l,u]);return f(),e}catch(e){throw f(),e}finally{h.clear()}})()}}o.code="ERR_TIMEOUT"},77474:(e,t,r)=>{"use strict";r.d(t,{Ue:()=>Vs});var n={};r.r(n),r.d(n,{identity:()=>q});var s={};r.r(s),r.d(s,{identity:()=>te});var i={};r.r(i),r.d(i,{base2:()=>re});var o={};r.r(o),r.d(o,{base8:()=>ne});var a={};r.r(a),r.d(a,{base10:()=>se});var c={};r.r(c),r.d(c,{base16:()=>ie,base16upper:()=>oe});var h={};r.r(h),r.d(h,{base32:()=>ae,base32hex:()=>ue,base32hexpad:()=>fe,base32hexpadupper:()=>pe,base32hexupper:()=>de,base32pad:()=>he,base32padupper:()=>le,base32upper:()=>ce,base32z:()=>ye});var l={};r.r(l),r.d(l,{base36:()=>ge,base36upper:()=>be});var u={};r.r(u),r.d(u,{base58btc:()=>me,base58flickr:()=>we});var d={};r.r(d),r.d(d,{base64:()=>ve,base64pad:()=>Ee,base64url:()=>Ae,base64urlpad:()=>Se});var f={};r.r(f),r.d(f,{base256emoji:()=>Ie});var p={};r.r(p),r.d(p,{sha256:()=>Pe,sha512:()=>De});var y={};r.r(y),r.d(y,{code:()=>Ne,decode:()=>Ue,encode:()=>Le,name:()=>Oe});var g={};r.r(g),r.d(g,{code:()=>ze,decode:()=>Fe,encode:()=>je,name:()=>Ve});var b=r(51392),m=r(52890),w=r(55101),v=r(10539),E=r(34219),A=r(66258),S=r(46392);new Uint8Array(0);const _=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var C=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=k;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},k=Math.pow(2,31);var I=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var T=Math.pow(2,7),x=Math.pow(2,14),R=Math.pow(2,21),P=Math.pow(2,28),D=Math.pow(2,35),O=Math.pow(2,42),N=Math.pow(2,49),L=Math.pow(2,56),U=Math.pow(2,63);const B={encode:C,decode:I,encodingLength:function(e){return e<T?1:e<x?2:e<R?3:e<P?4:e<D?5:e<O?6:e<N?7:e<L?8:e<U?9:10}},M=(e,t=0)=>[B.decode(e,t),B.decode.bytes],V=(e,t,r=0)=>(B.encode(e,t,r),t),z=e=>B.encodingLength(e),j=(e,t)=>{const r=t.byteLength,n=z(e),s=n+z(r),i=new Uint8Array(s+r);return V(e,i,0),V(r,i,n),i.set(t,s),new F(e,r,t,i)};class F{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const $=_,q={code:0,name:"identity",encode:$,digest:e=>j(0,$(e))};var K=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const H=K;class G{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class W{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Y(this,e)}}class J{constructor(e){this.decoders=e}or(e){return Y(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Y=(e,t)=>new J({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Q{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new G(e,t,r),this.decoder=new W(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Z=({name:e,prefix:t,encode:r,decode:n})=>new Q(e,t,r,n),X=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=H(r,t);return Z({prefix:e,name:t,encode:n,decode:e=>_(s(e))})},ee=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Z({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),te=Z({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),re=ee({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ne=ee({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),se=X({prefix:"9",name:"base10",alphabet:"0123456789"}),ie=ee({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),oe=ee({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ae=ee({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ce=ee({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),he=ee({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),le=ee({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ue=ee({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),de=ee({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),fe=ee({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pe=ee({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ye=ee({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ge=X({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),be=X({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),me=X({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),we=X({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ve=ee({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ee=ee({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ae=ee({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Se=ee({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_e=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Ce=_e.reduce(((e,t,r)=>(e[r]=t,e)),[]),ke=_e.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Ie=Z({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Ce[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ke[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),Te=({name:e,code:t,encode:r})=>new xe(e,t,r);class xe{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?j(this.code,t):t.then((e=>j(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Re=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Pe=Te({name:"sha2-256",code:18,encode:Re("SHA-256")}),De=Te({name:"sha2-512",code:19,encode:Re("SHA-512")}),Oe="raw",Ne=85,Le=e=>_(e),Ue=e=>_(e),Be=new TextEncoder,Me=new TextDecoder,Ve="json",ze=512,je=e=>Be.encode(JSON.stringify(e)),Fe=e=>JSON.parse(Me.decode(e)),$e=new WeakMap,qe=e=>{const t=$e.get(e);if(null==t){const t=new Map;return $e.set(e,t),t}return t};class Ke{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Je)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ye)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ke.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=j(e,t);return Ke.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ke.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?Ge(r,qe(e),t||me.encoder):We(r,qe(e),t||ae.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ke)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Ke(e,r,n,s||Qe(e,r,n.bytes))}if(!0===t[Ze]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=_(e),[r,n]=M(t),[s,i]=M(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new F(r,s,o,t)})(r);return Ke.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Je)throw new Error(`Version 0 CID must use dag-pb (code: ${Je}) block encoding`);return new Ke(e,t,r,r.bytes);case 1:{const n=Qe(e,t,r.bytes);return new Ke(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ke.create(0,Je,e)}static createV1(e,t){return Ke.create(1,e,t)}static decode(e){const[t,r]=Ke.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ke.inspectBytes(e),r=t.size-t.multihashSize,n=_(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new F(t.multihashCode,t.digestSize,s,n);return[0===t.version?Ke.createV0(i):Ke.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=M(e.subarray(t));return t+=n,r};let n=r(),s=Je;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=He(e,t),s=Ke.decode(n);return qe(s).set(r,e),s}}const He=(e,t)=>{switch(e[0]){case"Q":{const r=t||me;return[me.prefix,r.decode(`${me.prefix}${e}`)]}case me.prefix:{const r=t||me;return[me.prefix,r.decode(e)]}case ae.prefix:{const r=t||ae;return[ae.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Ge=(e,t,r)=>{const{prefix:n}=r;if(n!==me.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},We=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},Je=112,Ye=18,Qe=(e,t,r)=>{const n=z(e),s=n+z(t),i=new Uint8Array(s+r.byteLength);return V(e,i,0),V(t,i,n),i.set(r,s),i},Ze=Symbol.for("@ipld/js-cid/CID"),Xe={...s,...i,...o,...a,...c,...h,...l,...u,...d,...f},et={...p,...n},tt={raw:y,json:g};var rt=r(94306),nt=r(106),st=r(92816),it=r(38461),ot=r(67137),at=r(40726),ct=r(63181),ht=r(97295);const lt=(0,it.kg)("ipfs-http-client:lib:error-handler"),ut=at.Z.bind({ignoreUndefined:!0}),dt=nt.isBrowser||nt.isWebWorker?location.protocol:"http",ft=nt.isBrowser||nt.isWebWorker?location.hostname:"localhost",pt=nt.isBrowser||nt.isWebWorker?location.port:"5001",yt=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const r=await e.json();lt(r),t=r.Message||r.message}else t=await e.text()}catch(e){lt("Failed to parse error response",e),t=e.message}let r=new ot.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(r=new ot.TimeoutError),t&&t.includes("context deadline exceeded")&&(r=new ot.TimeoutError)),t&&t.includes("request timed out")&&(r=new ot.TimeoutError),t&&(r.message=t),r},gt=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,bt=e=>e.replace(gt,(function(e){return"-"+e.toLowerCase()}));class mt extends ot{constructor(e={}){const t=((e={})=>{let t,r,n={};if("string"==typeof e||(0,rt.h2)(e))t=new URL((0,ct.d)(e));else if(e instanceof URL)t=e;else if("string"==typeof e.url||(0,rt.h2)(e.url))t=new URL((0,ct.d)(e.url)),n=e;else if(e.url instanceof URL)t=e.url,n=e;else{n=e||{};const r=(n.protocol||dt).replace(":",""),s=(n.host||ft).split(":")[0],i=n.port||pt;t=new URL(`${r}://${s}:${i}`)}if(n.apiPath?t.pathname=n.apiPath:"/"!==t.pathname&&void 0!==t.pathname||(t.pathname="api/v0"),nt.isNode){const e=(0,ht.Z)(t);r=n.agent||new e({keepAlive:!0,maxSockets:6})}return{...n,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:r}})(e);var r;super({timeout:(r=t.timeout||0,("string"==typeof r?(0,st.Z)(r):r)||void 0),headers:t.headers,base:`${t.url}`,handleError:yt,transformSearchParams:e=>{const t=new URLSearchParams;for(const[r,n]of e)"undefined"!==n&&"null"!==n&&"signal"!==r&&t.append(bt(r),n),"timeout"!==r||isNaN(n)||t.append(bt(r),n);return t},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const n=this.fetch;this.fetch=(e,r={})=>("string"!=typeof e||e.startsWith("/")||(e=`${t.url}/${e}`),n.call(this,e,ut(r,{method:"POST"})))}}ot.HTTPError;const wt=e=>t=>e(new mt(t),t);function vt(e){if(null!=e)return"string"==typeof e?e:e.toString(8).padStart(4,"0")}var Et=r(32114);function At(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw Et(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function St({arg:e,searchParams:t,hashAlg:r,mtime:n,mode:s,...i}={}){t&&(i={...i,...t}),r&&(i.hash=r),null!=n&&(n=At(n),i.mtime=n.secs,i.mtimeNsecs=n.nsecs),null!=s&&(i.mode=vt(s)),i.timeout&&!isNaN(i.timeout)&&(i.timeout=`${i.timeout}ms`),null==e?e=[]:Array.isArray(e)||(e=[e]);const o=new URLSearchParams(i);return e.forEach((e=>o.append("arg",e))),o}const _t=wt((e=>async function(t={}){return((await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:St(t),headers:t.headers})).json()).Keys||[]).map((e=>Ke.parse(e["/"])))})),Ct=wt((e=>async function(t,r={}){return((await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:St({...r,peer:t.toString()}),headers:r.headers})).json()).Keys||[]).map((e=>Ke.parse(e["/"])))}));var kt=r(93203);const It=wt((e=>async function(t={}){const r=await e.post("bitswap/stat",{searchParams:St(t),signal:t.signal,headers:t.headers});return function(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map((e=>Ke.parse(e["/"]))),peers:(e.Peers||[]).map((e=>(0,kt.jE)(e))),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}(await r.json())}));const Tt=wt((e=>async function(t,r={}){return(await e.post("bitswap/unwant",{signal:r.signal,searchParams:St({arg:t.toString(),...r}),headers:r.headers})).json()}));const xt=wt((e=>async function(t,r={}){const n=await e.post("block/get",{signal:r.signal,searchParams:St({arg:t.toString(),...r}),headers:r.headers});return new Uint8Array(await n.arrayBuffer())}));var Rt=r(47498),Pt=r(32044);function Dt(...e){return(0,Pt.anySignal)(function(e){return e.filter(Boolean)}(e))}const Ot=wt((e=>async function t(r,n={}){const s=new AbortController,i=Dt(s.signal,n.signal);let o;try{const t=await e.post("block/put",{signal:i,searchParams:St(n),...await(0,Rt.x)([r],s,n.headers)});o=await t.json()}catch(e){if("dag-pb"===n.format)return t(r,{...n,format:"protobuf"});if("dag-cbor"===n.format)return t(r,{...n,format:"cbor"});throw e}return Ke.parse(o.Key)})),Nt=wt((e=>async function*(t,r={}){Array.isArray(t)||(t=[t]);const n=await e.post("block/rm",{signal:r.signal,searchParams:St({arg:t.map((e=>e.toString())),"stream-channels":!0,...r}),headers:r.headers});for await(const e of n.ndjson())yield Lt(e)}));function Lt(e){const t={cid:Ke.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const Ut=wt((e=>async function(t,r={}){const n=await e.post("block/stat",{signal:r.signal,searchParams:St({arg:t.toString(),...r}),headers:r.headers}),s=await n.json();return{cid:Ke.parse(s.Key),size:s.Size}}));function Bt(e){return{get:xt(e),put:Ot(e),rm:Nt(e),stat:Ut(e)}}const Mt=wt((e=>async function(t,r={}){const n=await e.post("bootstrap/add",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map((e=>(0,rt.HM)(e)))}})),Vt=wt((e=>async function(t={}){const r=await e.post("bootstrap/rm",{signal:t.signal,searchParams:St({...t,all:!0}),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>(0,rt.HM)(e)))}})),zt=wt((e=>async function(t={}){const r=await e.post("bootstrap/list",{signal:t.signal,searchParams:St(t),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>(0,rt.HM)(e)))}})),jt=wt((e=>async function(t={}){const r=await e.post("bootstrap/add",{signal:t.signal,searchParams:St({...t,default:!0}),headers:t.headers}),{Peers:n}=await r.json();return{Peers:n.map((e=>(0,rt.HM)(e)))}})),Ft=wt((e=>async function(t,r={}){const n=await e.post("bootstrap/rm",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map((e=>(0,rt.HM)(e)))}}));function $t(e){return{add:Mt(e),clear:Vt(e),list:zt(e),reset:jt(e),rm:Ft(e)}}const qt=wt((e=>async function(t,r={}){const n=await e.post("config/profile/apply",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),s=await n.json();return{original:s.OldCfg,updated:s.NewCfg}}));function Kt(e){if(null==e)return e;const t=/^[A-Z]+$/;return Object.keys(e).reduce(((r,n)=>(t.test(n)?r[n.toLowerCase()]=e[n]:t.test(n[0])?r[n[0].toLowerCase()+n.slice(1)]=e[n]:r[n]=e[n],r)),{})}const Ht=wt((e=>async function(t={}){const r=await e.post("config/profile/list",{signal:t.signal,searchParams:St(t),headers:t.headers});return(await r.json()).map((e=>Kt(e)))}));function Gt(e){return{apply:qt(e),list:Ht(e)}}const Wt=wt((e=>async(t,r={})=>{if(!t)throw new Error("key argument is required");const n=await e.post("config",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});return(await n.json()).Value})),Jt=wt((e=>async(t={})=>{const r=await e.post("config/show",{signal:t.signal,searchParams:St({...t}),headers:t.headers});return await r.json()}));function Yt(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Qt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Zt=Qt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Xt=Qt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Yt(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),er={utf8:Zt,"utf-8":Zt,hex:Xe.base16,latin1:Xt,ascii:Xt,binary:Xt,...Xe};function tr(e,t="utf8"){const r=er[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Yt(globalThis.Buffer.from(e,"utf-8"))}const rr=wt((e=>async(t,r={})=>{const n=new AbortController,s=Dt(n.signal,r.signal),i=await e.post("config/replace",{signal:s,searchParams:St(r),...await(0,Rt.x)([tr(JSON.stringify(t))],n,r.headers)});await i.text()})),nr=wt((e=>async(t,r,n={})=>{if("string"!=typeof t)throw new Error("Invalid key type");const s={...n,...sr(t,r)},i=await e.post("config",{signal:n.signal,searchParams:St(s),headers:n.headers});await i.text()})),sr=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function ir(e){return{getAll:Jt(e),get:Wt(e),set:nr(e),replace:rr(e),profiles:Gt(e)}}const or=wt((e=>async function*(t,r={}){const n=await e.post("dag/export",{signal:r.signal,searchParams:St({arg:t.toString()}),headers:r.headers});yield*n.iterator()}));async function*ar(e,t,r,n,s){const i=async e=>{const t=await r.getCodec(e.code),i=await n(e,s);return t.decode(i)},o=t.split("/").filter(Boolean);let a=await i(e),c=e;for(;o.length;){const e=o.shift();if(!e)throw Et(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,e))throw Et(new Error(`no link named "${e}" under ${c}`),"ERR_NO_LINK");a=a[e],yield{value:a,remainderPath:o.join("/")};const r=Ke.asCID(a);r&&(c=r,a=await i(a))}yield{value:a,remainderPath:""}}var cr=r(91486),hr=r(68883);const lr=(e,t)=>{const r=wt(((t,r)=>{const n=xt(r);return async(t,r={})=>{if(r.path){const s=r.localResolve?await(0,cr.Z)(ar(t,r.path,e,n,r)):await(0,hr.Z)(ar(t,r.path,e,n,r));if(!s)throw Et(new Error("Not found"),"ERR_NOT_FOUND");return s}const s=await e.getCodec(t.code),i=await n(t,r);return{value:s.decode(i),remainderPath:""}}}));return r(t)},ur=wt((e=>async function*(t,r={}){const n=new AbortController,s=Dt(n.signal,r.signal),{headers:i,body:o}=await(0,Rt.x)(t,n,r.headers),a=await e.post("dag/import",{signal:s,headers:i,body:o,searchParams:St({"pin-roots":r.pinRoots})});for await(const{Root:e}of a.ndjson())if(void 0!==e){const{Cid:{"/":t},PinErrorMsg:r}=e;yield{root:{cid:Ke.parse(t),pinErrorMsg:r}}}})),dr=(e,t)=>{const r=wt((t=>async(r,n={})=>{const s={storeCodec:"dag-cbor",hashAlg:"sha2-256",...n};let i;if(s.inputCodec){if(!(r instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=r}else{i=(await e.getCodec(s.storeCodec)).encode(r),s.inputCodec=s.storeCodec}const o=new AbortController,a=Dt(o.signal,s.signal),c=await t.post("dag/put",{timeout:s.timeout,signal:a,searchParams:St(s),...await(0,Rt.x)([i],o,s.headers)}),h=await c.json();return Ke.parse(h.Cid["/"])}));return r(t)},fr=wt((e=>async(t,r={})=>{const n=await e.post("dag/resolve",{signal:r.signal,searchParams:St({arg:`${t}${r.path?`/${r.path}`.replace(/\/[/]+/g,"/"):""}`,...r}),headers:r.headers}),s=await n.json();return{cid:Ke.parse(s.Cid["/"]),remainderPath:s.RemPath}}));function pr(e,t){return{export:or(t),get:lr(e,t),import:ur(t),put:dr(e,t),resolve:fr(t)}}const yr=e=>{if(0===e.Type)return{name:"SENDING_QUERY",type:e.Type};if(1===e.Type)return{from:(0,kt.jE)(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:(0,kt.jE)(e),multiaddrs:t.map((e=>(0,rt.HM)(e))),protocols:[]}))),providers:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:(0,kt.jE)(e),multiaddrs:t.map((e=>(0,rt.HM)(e))),protocols:[]})))};if(2===e.Type){let t={id:e.ID??(0,kt.jE)(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:(0,kt.jE)(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map((e=>(0,rt.HM)(e))),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(3===e.Type)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(4===e.Type)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map((({ID:e,Addrs:t})=>({id:(0,kt.jE)(e),multiaddrs:t.map((e=>(0,rt.HM)(e))),protocols:[]})))};if(5===e.Type)return{name:"VALUE",type:e.Type,value:tr(e.Extra,"base64pad")};if(6===e.Type){const t=e.Responses.map((({ID:e})=>(0,kt.jE)(e)));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(7===e.Type)return{name:"DIALING_PEER",type:e.Type,peer:(0,kt.jE)(e.ID)};throw new Error("Unknown DHT event type")},gr=wt((e=>async function*(t,r={}){const n=await e.post("dht/findpeer",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});for await(const e of n.ndjson())yield yr(e)})),br=wt((e=>async function*(t,r={}){const n=await e.post("dht/findprovs",{signal:r.signal,searchParams:St({arg:t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield yr(e)}));function mr(e,t="utf8"){const r=er[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const wr=wt((e=>async function*(t,r={}){const n=await e.post("dht/get",{signal:r.signal,searchParams:St({arg:t instanceof Uint8Array?mr(t):t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield yr(e)})),vr=wt((e=>async function*(t,r={recursive:!1}){const n=Array.isArray(t)?t:[t],s=await e.post("dht/provide",{signal:r.signal,searchParams:St({arg:n.map((e=>e.toString())),...r}),headers:r.headers});for await(const e of s.ndjson())yield yr(e)})),Er=wt((e=>async function*(t,r,n={}){const s=new AbortController,i=Dt(s.signal,n.signal),o=await e.post("dht/put",{signal:i,searchParams:St({arg:t instanceof Uint8Array?mr(t):t.toString(),...n}),...await(0,Rt.x)([r],s,n.headers)});for await(const e of o.ndjson())yield yr(e)})),Ar=wt((e=>async function*(t,r={}){const n=await e.post("dht/query",{signal:r.signal,searchParams:St({arg:t.toString(),...r}),headers:r.headers});for await(const e of n.ndjson())yield yr(e)}));function Sr(e){return{findPeer:gr(e),findProvs:br(e),get:wr(e),provide:vr(e),put:Er(e),query:Ar(e)}}const _r=wt((e=>async function(t={}){return(await e.post("diag/cmds",{signal:t.signal,searchParams:St(t),headers:t.headers})).json()})),Cr=wt((e=>async function(t={}){return(await e.post("diag/net",{signal:t.signal,searchParams:St(t),headers:t.headers})).json()})),kr=wt((e=>async function(t={}){return(await e.post("diag/sys",{signal:t.signal,searchParams:St(t),headers:t.headers})).json()}));function Ir(e){return{cmds:_r(e),net:Cr(e),sys:kr(e)}}const Tr=wt((e=>async function(t,r,n={}){const s=await e.post("files/chmod",{signal:n.signal,searchParams:St({arg:t,mode:r,...n}),headers:n.headers});await s.text()})),xr=wt((e=>async function(t,r,n={}){const s=Array.isArray(t)?t:[t],i=await e.post("files/cp",{signal:n.signal,searchParams:St({arg:s.concat(r).map((e=>Ke.asCID(e)?`/ipfs/${e}`:e)),...n}),headers:n.headers});await i.text()})),Rr=wt((e=>async function(t,r={}){if(!t||"string"!=typeof t)throw new Error("ipfs.files.flush requires a path");const n=await e.post("files/flush",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),s=await n.json();return Ke.parse(s.Cid)}));function Pr(e){const t=Kt(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const Dr=wt((e=>async function*(t,r={}){if(!t)throw new Error("ipfs.files.ls requires a path");const n=await e.post("files/ls",{signal:r.signal,searchParams:St({arg:Ke.asCID(t)?`/ipfs/${t}`:t,long:!0,...r,stream:!0}),headers:r.headers});for await(const e of n.ndjson())if("Entries"in e)for(const t of e.Entries||[])yield Or(Pr(t));else yield Or(Pr(e))}));function Or(e){return e.hash&&(e.cid=Ke.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}const Nr=wt((e=>async function(t,r={}){const n=await e.post("files/mkdir",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});await n.text()})),Lr=wt((e=>async function(t,r,n={}){Array.isArray(t)||(t=[t]);const s=await e.post("files/mv",{signal:n.signal,searchParams:St({arg:t.concat(r),...n}),headers:n.headers});await s.text()}));var Ur=r(50590);const Br=wt((e=>async function*(t,r={}){const n=await e.post("files/read",{signal:r.signal,searchParams:St({arg:t,count:r.length,...r}),headers:r.headers});yield*Ur(n.body)})),Mr=wt((e=>async function(t,r={}){const n=await e.post("files/rm",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),s=await n.text();if(""!==s){const e=new ot.HTTPError(n);throw e.message=s,e}})),Vr=wt((e=>async function(t,r={}){const n=await e.post("files/stat",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),s=await n.json();return s.WithLocality=s.WithLocality||!1,(i=Pr(s)).cid=Ke.parse(i.hash),delete i.hash,i;var i}));const zr=wt((e=>async function(t,r={}){const n=await e.post("files/touch",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});await n.text()})),jr=wt((e=>async function(t,r,n={}){const s=new AbortController,i=Dt(s.signal,n.signal),o=await e.post("files/write",{signal:i,searchParams:St({arg:t,streamChannels:!0,count:n.length,...n}),...await(0,Rt.x)([{content:r,path:"arg",mode:vt(n.mode),mtime:At(n.mtime)}],s,n.headers)});await o.text()}));function Fr(e){return{chmod:Tr(e),cp:xr(e),flush:Rr(e),ls:Dr(e),mkdir:Nr(e),mv:Lr(e),read:Br(e),rm:Mr(e),stat:Vr(e),touch:zr(e),write:jr(e)}}const $r=wt((e=>async(e,t,r={})=>{throw Et(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),qr=wt((e=>async function(t,r={type:"Ed25519"}){const n=await e.post("key/gen",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});return Kt(await n.json())})),Kr=wt((e=>async function(t,r,n,s={}){const i=await e.post("key/import",{signal:s.signal,searchParams:St({arg:t,pem:r,password:n,...s}),headers:s.headers});return Kt(await i.json())})),Hr=wt((e=>async(e,t={})=>{throw Et(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),Gr=wt((e=>async function(t={}){const r=await e.post("key/list",{signal:t.signal,searchParams:St(t),headers:t.headers});return((await r.json()).Keys||[]).map((e=>Kt(e)))})),Wr=wt((e=>async function(t,r,n={}){const s=await e.post("key/rename",{signal:n.signal,searchParams:St({arg:[t,r],...n}),headers:n.headers});return Kt(await s.json())})),Jr=wt((e=>async function(t,r={}){const n=await e.post("key/rm",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});return Kt((await n.json()).Keys[0])}));function Yr(e){return{export:$r(e),gen:qr(e),import:Kr(e),info:Hr(e),list:Gr(e),rename:Wr(e),rm:Jr(e)}}const Qr=wt((e=>async function(t,r,n={}){const s=await e.post("log/level",{signal:n.signal,searchParams:St({arg:[t,r],...n}),headers:n.headers});return Kt(await s.json())})),Zr=wt((e=>async function(t={}){const r=await e.post("log/ls",{signal:t.signal,searchParams:St(t),headers:t.headers});return(await r.json()).Strings})),Xr=wt((e=>async function*(t={}){const r=await e.post("log/tail",{signal:t.signal,searchParams:St(t),headers:t.headers});yield*r.ndjson()}));function en(e){return{level:Qr(e),ls:Zr(e),tail:Xr(e)}}const tn=wt((e=>async function(t,r={}){const n=await e.post("name/publish",{signal:r.signal,searchParams:St({arg:`${t}`,...r}),headers:r.headers});return Kt(await n.json())})),rn=wt((e=>async function*(t,r={}){const n=await e.post("name/resolve",{signal:r.signal,searchParams:St({arg:t,stream:!0,...r}),headers:r.headers});for await(const e of n.ndjson())yield e.Path})),nn=wt((e=>async function(t,r={}){const n=await e.post("name/pubsub/cancel",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});return Kt(await n.json())})),sn=wt((e=>async function(t={}){const r=await e.post("name/pubsub/state",{signal:t.signal,searchParams:St(t),headers:t.headers});return Kt(await r.json())})),on=wt((e=>async function(t={}){const r=await e.post("name/pubsub/subs",{signal:t.signal,searchParams:St(t),headers:t.headers});return(await r.json()).Strings||[]}));function an(e){return{cancel:nn(e),state:sn(e),subs:on(e)}}function cn(e){return{publish:tn(e),resolve:rn(e),pubsub:an(e)}}const hn=wt((e=>async function(t,r={}){const n=await e.post("object/data",{signal:r.signal,searchParams:St({arg:`${t instanceof Uint8Array?Ke.decode(t):t}`,...r}),headers:r.headers}),s=await n.arrayBuffer();return new Uint8Array(s,0,s.byteLength)})),ln=wt((e=>async function(t,r={}){const n=await e.post("object/get",{signal:r.signal,searchParams:St({arg:`${t instanceof Uint8Array?Ke.decode(t):t}`,dataEncoding:"base64",...r}),headers:r.headers}),s=await n.json();return{Data:tr(s.Data,"base64pad"),Links:(s.Links||[]).map((e=>({Name:e.Name,Hash:Ke.parse(e.Hash),Tsize:e.Size})))}})),un=wt((e=>async function(t,r={}){const n=await e.post("object/links",{signal:r.signal,searchParams:St({arg:`${t instanceof Uint8Array?Ke.decode(t):t}`,...r}),headers:r.headers});return((await n.json()).Links||[]).map((e=>({Name:e.Name,Tsize:e.Size,Hash:Ke.parse(e.Hash)})))})),dn=wt((e=>async function(t={}){const r=await e.post("object/new",{signal:t.signal,searchParams:St({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await r.json();return Ke.parse(n)})),fn=(e,t)=>{const r=wt((r=>{const n=dr(e,t);return async function(e,t={}){return n(e,{...t,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}}));return r(t)},pn=wt((e=>async function(t,r={}){const n=await e.post("object/stat",{signal:r.signal,searchParams:St({arg:`${t}`,...r}),headers:r.headers}),s=await n.json();return{...s,Hash:Ke.parse(s.Hash)}})),yn=wt((e=>async function(t,r,n={}){const s=await e.post("object/patch/add-link",{signal:n.signal,searchParams:St({arg:[`${t}`,r.Name||r.name||"",(r.Hash||r.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:i}=await s.json();return Ke.parse(i)})),gn=wt((e=>async function(t,r,n={}){const s=new AbortController,i=Dt(s.signal,n.signal),o=await e.post("object/patch/append-data",{signal:i,searchParams:St({arg:`${t}`,...n}),...await(0,Rt.x)([r],s,n.headers)}),{Hash:a}=await o.json();return Ke.parse(a)})),bn=wt((e=>async function(t,r,n={}){const s=await e.post("object/patch/rm-link",{signal:n.signal,searchParams:St({arg:[`${t}`,r.Name||r.name||null],...n}),headers:n.headers}),{Hash:i}=await s.json();return Ke.parse(i)})),mn=wt((e=>async function(t,r,n={}){const s=new AbortController,i=Dt(s.signal,n.signal),o=await e.post("object/patch/set-data",{signal:i,searchParams:St({arg:[`${t}`],...n}),...await(0,Rt.x)([r],s,n.headers)}),{Hash:a}=await o.json();return Ke.parse(a)}));function wn(e){return{addLink:yn(e),appendData:gn(e),rmLink:bn(e),setData:mn(e)}}function vn(e,t){return{data:hn(t),get:ln(t),links:un(t),new:dn(t),put:fn(e,t),stat:pn(t),patch:wn(t)}}var En=r(73297);const An=wt((e=>async function*(t,r={}){for await(const{path:n,recursive:s,metadata:i}of(0,En.f)(t)){const t=await e.post("pin/add",{signal:r.signal,searchParams:St({...r,arg:n,recursive:s,metadata:i?JSON.stringify(i):void 0,stream:!0}),headers:r.headers});for await(const e of t.ndjson())if(e.Pins)for(const t of e.Pins)yield Ke.parse(t);else yield Ke.parse(e)}}));function Sn(e){const t=An(e);return wt((()=>async function(e,r={}){return(0,hr.Z)(t([{path:e,...r}],r))}))(e)}function _n(e,t,r){const n={type:e,cid:Ke.parse(t)};return r&&(n.metadata=r),n}const Cn=wt((e=>async function*(t={}){let r=[];t.paths&&(r=Array.isArray(t.paths)?t.paths:[t.paths]);const n=await e.post("pin/ls",{signal:t.signal,searchParams:St({...t,arg:r.map((e=>`${e}`)),stream:!0}),headers:t.headers});for await(const e of n.ndjson()){if(e.Keys){for(const t of Object.keys(e.Keys))yield _n(e.Keys[t].Type,t,e.Keys[t].Metadata);return}yield _n(e.Type,e.Cid,e.Metadata)}})),kn=wt((e=>async function*(t,r={}){for await(const{path:n,recursive:s}of(0,En.f)(t)){const t=new URLSearchParams(r.searchParams);t.append("arg",`${n}`),null!=s&&t.set("recursive",String(s));const i=await e.post("pin/rm",{signal:r.signal,headers:r.headers,searchParams:St({...r,arg:`${n}`,recursive:s})});for await(const e of i.ndjson())e.Pins?yield*e.Pins.map((e=>Ke.parse(e))):yield Ke.parse(e)}})),In=e=>{const t=kn(e);return wt((()=>async function(e,r={}){return(0,hr.Z)(t([{path:e,...r}],r))}))(e)},Tn=({Name:e,Status:t,Cid:r})=>({cid:Ke.parse(r),name:e,status:t}),xn=e=>{if("string"==typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},Rn=e=>{if(Ke.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of "+typeof e)},Pn=({service:e,cid:t,name:r,status:n,all:s})=>{const i=St({service:xn(e),name:r,force:!!s||void 0});if(t)for(const e of t)i.append("cid",Rn(e));if(n)for(const e of n)i.append("status",e);return i},Dn=({cid:e,service:t,background:r,name:n,origins:s})=>{const i=St({arg:Rn(e),service:xn(t),name:n,background:!!r||void 0});if(s)for(const e of s)i.append("origin",e.toString());return i};function On(e){return async function(t,{timeout:r,signal:n,headers:s,...i}){const o=await e.post("pin/remote/add",{timeout:r,signal:n,headers:s,searchParams:Dn({cid:t,...i})});return Tn(await o.json())}}function Nn(e){return async function*({timeout:t,signal:r,headers:n,...s}){const i=await e.post("pin/remote/ls",{timeout:t,signal:r,headers:n,searchParams:Pn(s)});for await(const e of i.ndjson())yield Tn(e)}}function Ln(e){return async function({timeout:t,signal:r,headers:n,...s}){await e.post("pin/remote/rm",{timeout:t,signal:r,headers:n,searchParams:Pn({...s,all:!1})})}}function Un(e){return async function({timeout:t,signal:r,headers:n,...s}){await e.post("pin/remote/rm",{timeout:t,signal:r,headers:n,searchParams:Pn({...s,all:!0})})}}function Bn(e){const t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function Mn(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:Vn(e.Stat)}}}function Vn(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:r,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:r,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function zn(e){return async function(t,r){const{endpoint:n,key:s,headers:i,timeout:o,signal:a}=r;await e.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:St({arg:[t,Bn(n),s]}),headers:i})}}function jn(e){return async function(t={}){const{stat:r,headers:n,timeout:s,signal:i}=t,o=await e.post("pin/remote/service/ls",{timeout:s,signal:i,headers:n,searchParams:!0===r?St({stat:r}):void 0}),{RemoteServices:a}=await o.json();return a.map(Mn)}}function Fn(e){return async function(t,r={}){await e.post("pin/remote/service/rm",{signal:r.signal,headers:r.headers,searchParams:St({arg:t})})}}function $n(e){const t=new mt(e);return{add:zn(t),ls:jn(t),rm:Fn(t)}}function qn(e){const t=new mt(e);return{add:On(t),ls:Nn(t),rm:Ln(t),rmAll:Un(t),service:$n(e)}}function Kn(e){return{addAll:An(e),add:Sn(e),ls:Cn(e),rmAll:kn(e),rm:In(e),remote:qn(e)}}const Hn=e=>mr(Gn(e)),Gn=e=>Ae.decode(e),Wn=e=>BigInt(`0x${mr(Ae.decode(e),"base16")}`),Jn=e=>Ae.encode(tr(e)),Yn=wt((e=>async function(t={}){const{Strings:r}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:St(t),headers:t.headers})).json();return n=r,(Array.isArray(n)?n.map(Hn):n)||[];var n})),Qn=wt((e=>async function(t,r={}){const n=await e.post("pubsub/peers",{signal:r.signal,searchParams:St({arg:Jn(t),...r}),headers:r.headers}),{Strings:s}=await n.json();return s||[]})),Zn=wt((e=>async function(t,r,n={}){const s=St({arg:Jn(t),...n}),i=new AbortController,o=Dt(i.signal,n.signal),a=await e.post("pubsub/pub",{signal:o,searchParams:s,...await(0,Rt.x)([r],i,n.headers)});await a.text()})),Xn=(0,it.kg)("ipfs-http-client:pubsub:subscribe"),es=(e,t)=>wt((e=>async function(r,n,s={}){let i,o;s.signal=t.subscribe(r,n,s.signal);const a=new Promise(((e,t)=>{i=e,o=t})),c=setTimeout((()=>i()),1e3);return e.post("pubsub/sub",{signal:s.signal,searchParams:St({arg:Jn(r),...s}),headers:s.headers}).catch((e=>{t.unsubscribe(r,n),o(e)})).then((e=>{clearTimeout(c),e&&(!async function(e,{onMessage:t,onEnd:r,onError:n}){n=n||Xn;try{for await(const r of e.ndjson())try{if(!r.from)continue;null!=r.from&&null!=r.seqno?t({type:"signed",from:(0,kt.jE)(r.from),data:Gn(r.data),sequenceNumber:Wn(r.seqno),topic:Hn(r.topicIDs[0]),key:Gn(r.key??"u"),signature:Gn(r.signature??"u")}):t({type:"unsigned",data:Gn(r.data),topic:Hn(r.topicIDs[0])})}catch(e){e.message=`Failed to parse pubsub message: ${e.message}`,n(e,!1,r)}}catch(e){ts(e)||n(e,!0)}finally{r()}}(e,{onMessage:e=>{n&&("function"!=typeof n?"function"==typeof n.handleEvent&&n.handleEvent(e):n(e))},onEnd:()=>t.unsubscribe(r,n),onError:s.onError}),i())})),a}))(e);const ts=e=>{switch(e.type){case"aborted":case"abort":return!0;default:return"AbortError"===e.name}};class rs{constructor(){this._subs=new Map}subscribe(e,t,r){const n=this._subs.get(e)||[];if(n.find((e=>e.handler===t)))throw new Error(`Already subscribed to ${e} with this handler`);const s=new AbortController;return this._subs.set(e,[{handler:t,controller:s}].concat(n)),r&&r.addEventListener("abort",(()=>this.unsubscribe(e,t))),s.signal}unsubscribe(e,t){const r=this._subs.get(e)||[];let n;t?(this._subs.set(e,r.filter((e=>e.handler!==t))),n=r.filter((e=>e.handler===t))):(this._subs.set(e,[]),n=r),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach((e=>e.controller.abort()))}}function ns(e){const t=new rs;return{ls:Yn(e),peers:Qn(e),publish:Zn(e),subscribe:es(e,t),unsubscribe:(r=t,async function(e,t){r.unsubscribe(e,t)})};var r}const ss=wt((e=>async function*(t={}){const r=await e.post("refs/local",{signal:t.signal,transform:Kt,searchParams:St(t),headers:t.headers});yield*r.ndjson()})),is=wt(((e,t)=>Object.assign((async function*(t,r={}){const n=Array.isArray(t)?t:[t],s=await e.post("refs",{signal:r.signal,searchParams:St({arg:n.map((e=>`${e instanceof Uint8Array?Ke.decode(e):e}`)),...r}),headers:r.headers,transform:Kt});yield*s.ndjson()}),{local:ss(t)}))),os=wt((e=>async function*(t={}){const r=await e.post("repo/gc",{signal:t.signal,searchParams:St(t),headers:t.headers,transform:e=>({err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?Ke.parse(e.Key["/"]):null})});yield*r.ndjson()})),as=wt((e=>async function(t={}){const r=await e.post("repo/stat",{signal:t.signal,searchParams:St(t),headers:t.headers}),n=await r.json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}})),cs=wt((e=>async function(t={}){return(await(await e.post("repo/version",{signal:t.signal,searchParams:St(t),headers:t.headers})).json()).Version}));function hs(e){return{gc:os(e),stat:as(e),version:cs(e)}}const ls=wt((e=>async function*(t={}){const r=await e.post("stats/bw",{signal:t.signal,searchParams:St(t),headers:t.headers,transform:e=>({totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)})});yield*r.ndjson()}));function us(e){return{bitswap:It(e),repo:as(e),bw:ls(e)}}const ds=wt((e=>async function(t={}){const r=await e.post("swarm/addrs",{signal:t.signal,searchParams:St(t),headers:t.headers}),{Addrs:n}=await r.json();return Object.keys(n).map((e=>({id:(0,kt.jE)(e),addrs:(n[e]||[]).map((e=>(0,rt.HM)(e)))})))})),fs=wt((e=>async function(t,r={}){const n=await e.post("swarm/connect",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),{Strings:s}=await n.json();return s||[]})),ps=wt((e=>async function(t,r={}){const n=await e.post("swarm/disconnect",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),{Strings:s}=await n.json();return s||[]})),ys=wt((e=>async function(t={}){const r=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:St(t),headers:t.headers}),{Strings:n}=await r.json();return(n||[]).map((e=>(0,rt.HM)(e)))})),gs=wt((e=>async function(t={}){const r=await e.post("swarm/peers",{signal:t.signal,searchParams:St(t),headers:t.headers}),{Peers:n}=await r.json();return(n||[]).map((e=>({addr:(0,rt.HM)(e.Addr),peer:(0,kt.jE)(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"})))}));function bs(e){return{addrs:ds(e),connect:fs(e),disconnect:ps(e),localAddrs:ys(e),peers:gs(e)}}const ms=wt((e=>async function*(t,r={}){const n=new AbortController,s=Dt(n.signal,r.signal),{headers:i,body:o,total:a,parts:c}=await(0,Rt.x)(t,n,r.headers),[h,l]="function"==typeof r.progress?ws(a,c,r.progress):[void 0,void 0],u=await e.post("add",{searchParams:St({"stream-channels":!0,...r,progress:Boolean(h)}),onUploadProgress:l,signal:s,headers:i,body:o});for await(let e of u.ndjson())e=Kt(e),void 0!==e.hash?yield Es(e):h&&h(e.bytes||0,e.name)})),ws=(e,t,r)=>t?[void 0,vs(e,t,r)]:[r,void 0],vs=(e,t,r)=>{let n=0;const s=t.length;return({loaded:i,total:o})=>{const a=Math.floor(i/o*e);for(;n<s;){const{start:e,end:s,name:i}=t[n];if(a<s){r(a-e,i);break}r(s-e,i),n+=1}}};function Es({name:e,hash:t,size:r,mode:n,mtime:s,mtimeNsecs:i}){const o={path:e,cid:Ke.parse(t),size:parseInt(r)};return null!=n&&(o.mode=parseInt(n,8)),null!=s&&(o.mtime={secs:s,nsecs:i||0}),o}var As=r(56740);function Ss(e){const t=ms(e);return wt((()=>async function(e,r={}){return await(0,hr.Z)(t((0,As.f)(e),r))}))(e)}const _s=wt((e=>async function*(t,r={}){const n=await e.post("cat",{signal:r.signal,searchParams:St({arg:t.toString(),...r}),headers:r.headers});yield*n.iterator()})),Cs=wt((e=>async(t={})=>(await e.post("commands",{signal:t.signal,searchParams:St(t),headers:t.headers})).json())),ks=wt((e=>async(t,r={})=>{const n=await e.post("dns",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers});return(await n.json()).Path})),Is=wt((e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}})),Ts=wt((e=>async function*(t,r={}){const n={arg:`${t instanceof Uint8Array?Ke.decode(t):t}`,...r};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel);const s=await e.post("get",{signal:r.signal,searchParams:St(n),headers:r.headers});yield*s.iterator()})),xs=wt((e=>async function(t={}){const r=await e.post("id",{signal:t.signal,searchParams:St({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers}),n={...Kt(await r.json())};return n.id=(0,kt.jE)(n.id),n.addresses&&(n.addresses=n.addresses.map((e=>(0,rt.HM)(e)))),n})),Rs=e=>{const t=xs(e);return async function(e={}){const r=await t(e);return Boolean(r&&r.addresses&&r.addresses.length)}},Ps=wt(((e,t)=>async function*(r,n={}){const s=`${r instanceof Uint8Array?Ke.decode(r):r}`;async function i(e){let r=e.Hash;if(r.includes("/")){const e=r.startsWith("/ipfs/")?r:`/ipfs/${r}`;r=(await Vr(t)(e)).cid}else r=Ke.parse(r);const n={name:e.Name,path:s+(e.Name?`/${e.Name}`:""),size:e.Size,cid:r,type:Ds(e)};return e.Mode&&(n.mode=parseInt(e.Mode,8)),void 0!==e.Mtime&&null!==e.Mtime&&(n.mtime={secs:e.Mtime},void 0!==e.MtimeNsecs&&null!==e.MtimeNsecs&&(n.mtime.nsecs=e.MtimeNsecs)),n}const o=await e.post("ls",{signal:n.signal,searchParams:St({arg:s,...n}),headers:n.headers});for await(let e of o.ndjson()){if(e=e.Objects,!e)throw new Error("expected .Objects in results");if(e=e[0],!e)throw new Error("expected one array in results.Objects");const t=e.Links;if(!Array.isArray(t))throw new Error("expected one array in results.Objects[0].Links");if(!t.length)return void(yield i(e));yield*t.map(i)}}));function Ds(e){switch(e.Type){case 1:case 5:return"dir";default:return"file"}}const Os=wt((e=>async function(t={}){const r=await e.post("dns",{signal:t.signal,searchParams:St(t),headers:t.headers});return Kt(await r.json())})),Ns=wt((e=>async function*(t,r={}){const n=await e.post("ping",{signal:r.signal,searchParams:St({arg:`${t}`,...r}),headers:r.headers,transform:Kt});yield*n.ndjson()})),Ls=wt((e=>async function(t,r={}){const n=await e.post("resolve",{signal:r.signal,searchParams:St({arg:t,...r}),headers:r.headers}),{Path:s}=await n.json();return s})),Us=wt((e=>async(e={})=>{throw Et(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})),Bs=wt((e=>async function(t={}){const r=await e.post("shutdown",{signal:t.signal,searchParams:St(t),headers:t.headers});await r.text()})),Ms=wt((e=>async function(t={}){const r=await e.post("version",{signal:t.signal,searchParams:St(t),headers:t.headers});return{...Kt(await r.json()),"ipfs-http-client":"1.0.0"}}));r(63897),r(46953);function Vs(e={}){const t={name:q.name,code:q.code,encode:e=>e,decode:e=>e},r=Object.values(Xe);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach((e=>r.push(e)));const n=new b.x({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),s=Object.values(tt);[v,E,A,S,t].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>s.push(e)));const i=new m.w({codecs:s,loadCodec:e.ipld&&e.ipld.loadCodec}),o=Object.values(et);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach((e=>o.push(e)));const a=new w.d({hashers:o,loadHasher:e.ipld&&e.ipld.loadHasher});var c;return{add:Ss(e),addAll:ms(e),bitswap:(c=e,{wantlist:_t(c),wantlistForPeer:Ct(c),unwant:Tt(c),stat:It(c)}),block:Bt(e),bootstrap:$t(e),cat:_s(e),commands:Cs(e),config:ir(e),dag:pr(i,e),dht:Sr(e),diag:Ir(e),dns:ks(e),files:Fr(e),get:Ts(e),getEndpointConfig:Is(e),id:xs(e),isOnline:Rs(e),key:Yr(e),log:en(e),ls:Ps(e),mount:Os(e),name:cn(e),object:vn(i,e),pin:Kn(e),ping:Ns(e),pubsub:ns(e),refs:is(e),repo:hs(e),resolve:Ls(e),start:Us(e),stats:us(e),stop:Bs(e),swarm:bs(e),version:Ms(e),bases:n,codecs:i,hashers:a}}},45895:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});const n=12},68919:(e,t,r)=>{"use strict";r.d(t,{AJ:()=>a,CK:()=>i,_I:()=>c,dR:()=>s,gg:()=>n,uF:()=>o});class n extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=n.code}}n.code="ERR_LOCK_EXISTS";class s extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=s.code}}s.code="ERR_NOT_FOUND";class i extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=i.code}}i.code="ERR_INVALID_REPO_VERSION";const o="ERR_REPO_NOT_INITIALIZED",a="ERR_REPO_ALREADY_OPEN",c="ERR_REPO_ALREADY_CLOSED"},69044:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});const n={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"}},69491:(e,t,r)=>{"use strict";r.d(t,{OY:()=>Se,BE:()=>_e,HN:()=>Ae});var n=r(32114),s=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=i;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},i=Math.pow(2,31);var o=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var a=Math.pow(2,7),c=Math.pow(2,14),h=Math.pow(2,21),l=Math.pow(2,28),u=Math.pow(2,35),d=Math.pow(2,42),f=Math.pow(2,49),p=Math.pow(2,56),y=Math.pow(2,63);const g={encode:s,decode:o,encodingLength:function(e){return e<a?1:e<c?2:e<h?3:e<l?4:e<u?5:e<d?6:e<f?7:e<p?8:e<y?9:10}},b=(e,t=0)=>[g.decode(e,t),g.decode.bytes],m=(e,t,r=0)=>(g.encode(e,t,r),t),w=e=>g.encodingLength(e),v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),E=(e,t)=>{const r=t.byteLength,n=w(e),s=n+w(r),i=new Uint8Array(s+r);return m(e,i,0),m(r,i,n),i.set(t,s),new S(e,r,t,i)},A=e=>{const t=v(e),[r,n]=b(t),[s,i]=b(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new S(r,s,o,t)};class S{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const _=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class C{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class k{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return T(this,e)}}class I{constructor(e){this.decoders=e}or(e){return T(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const T=(e,t)=>new I({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class x{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new C(e,t,r),this.decoder=new k(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const R=({name:e,prefix:t,encode:r,decode:n})=>new x(e,t,r,n),P=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=_(r,t);return R({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},D=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>R({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),O=P({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),N=(P({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),D({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),L=(D({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),D({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),D({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),D({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),D({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),D({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),D({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),new WeakMap),U=e=>{const t=L.get(e);if(null==t){const t=new Map;return L.set(e,t),t}return t};class B{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==j)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==F)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return B.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=E(e,t);return B.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return B.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?V(r,U(e),t||O.encoder):z(r,U(e),t||N.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof B)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new B(e,r,n,s||$(e,r,n.bytes))}if(!0===t[q]){const{version:e,multihash:r,code:n}=t,s=A(r);return B.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==j)throw new Error(`Version 0 CID must use dag-pb (code: ${j}) block encoding`);return new B(e,t,r,r.bytes);case 1:{const n=$(e,t,r.bytes);return new B(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return B.create(0,j,e)}static createV1(e,t){return B.create(1,e,t)}static decode(e){const[t,r]=B.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=B.inspectBytes(e),r=t.size-t.multihashSize,n=v(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new S(t.multihashCode,t.digestSize,s,n);return[0===t.version?B.createV0(i):B.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=b(e.subarray(t));return t+=n,r};let n=r(),s=j;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=M(e,t),s=B.decode(n);return U(s).set(r,e),s}}const M=(e,t)=>{switch(e[0]){case"Q":{const r=t||O;return[O.prefix,r.decode(`${O.prefix}${e}`)]}case O.prefix:{const r=t||O;return[O.prefix,r.decode(e)]}case N.prefix:{const r=t||N;return[N.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},V=(e,t,r)=>{const{prefix:n}=r;if(n!==O.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},z=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},j=112,F=18,$=(e,t,r)=>{const n=w(e),s=n+w(t),i=new Uint8Array(s+r.byteLength);return m(e,i,0),m(t,i,n),i.set(r,s),i},q=Symbol.for("@ipld/js-cid/CID");var K=r(10539),H=r(34219);const G=0;var W=r(92754),J=r(52090),Y=r(34097);const Q=async function(e){return(await Y.Pv.encode(e)).slice(0,8).reverse()},Z=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),X=async(e,t,r,n,s)=>{if(!n){const e=(0,J.$)({hashFn:Q});n={rootBucket:e,hamtDepth:1,lastBucket:e}}var i,o,a;await(i=e.Links,o=n.lastBucket,a=n.rootBucket,Promise.all(i.map((e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(2===e.Name.length){const t=parseInt(e.Name,16);return o._putObjectAt(t,new J.r({hash:a._options.hash,bits:a._options.bits},o,t))}return a.put(e.Name.substring(2),!0)}))));const c=await n.rootBucket._findNewBucketAndPos(t);let h=Z(c.pos);const l=(e=>{let t=e.bucket;const r=[];for(;t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()})(c);l.length>n.hamtDepth&&(n.lastBucket=l[n.hamtDepth],h=Z(n.lastBucket._posAtParent));const u=e.Links.find((e=>{if(null==e.Name)return!1;const r=e.Name.substring(0,2),n=e.Name.substring(2);return r===h&&(!n||n===t)}));if(!u)return null;if(null!=u.Name&&u.Name.substring(2)===t)return u.Hash;n.hamtDepth++;const d=await r.get(u.Hash,s);return e=(0,K.decode)(d),X(e,t,r,n,s)},ee=X;const te=function(e,t,r,n){const s=t+e.length;return r>=s||n<t?new Uint8Array(0):(n>=t&&n<s&&(e=e.subarray(0,n-t)),r>=t&&r<s&&(e=e.subarray(r-t)),e)},re=(e,t,r)=>{if(t||(t=0),t<0)throw n(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw n(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(r||0===r||(r=e-t),r<0)throw n(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+r>e&&(r=e-t),{offset:t,length:r}};var ne=r(37430),se=r(69849),ie=r(88211),oe=r(21007),ae=r(57665);async function ce(e,t,r,s,i,o,a,c){if(t instanceof Uint8Array)return void r.push(te(t,s,i,o));if(null==t.Data)throw n(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let h;try{h=W.fL.unmarshal(t.Data)}catch(e){throw n(e,"ERR_NOT_UNIXFS")}if(null!=h.data){const e=h.data,t=te(e,s,i,o);r.push(t),s+=t.byteLength}const l=[];for(let e=0;e<t.Links.length;e++){const r=t.Links[e],n=s,a=n+h.blockSizes[e];if((i>=n&&i<a||o>=n&&o<=a||i<n&&o>a)&&l.push({link:r,blockStart:s}),(s=a)>o)break}await(0,ie.zG)(l,(t=>(0,oe.Z)(t,(t=>async()=>{const r=await e.get(t.link.Hash,{signal:c.signal});return{...t,block:r}}))),(e=>(0,se.Z)(e,{ordered:!0})),(async t=>{for await(const{link:s,block:h,blockStart:l}of t){let t;switch(s.Hash.code){case K.code:t=K.decode(h);break;case 85:t=h;break;default:return void r.end(n(new Error(`Unsupported codec: ${s.Hash.code}`),"ERR_NOT_UNIXFS"))}a.add((async()=>{await ce(e,t,r,l,i,o,a,c)}))}}))}const he=(e,t,r,n,s,i,o)=>async function*(e={}){const n=r.fileSize();if(void 0===n)throw new Error("File was a directory");const{offset:s,length:i}=re(n,e.offset,e.length);if(0===i)return;const a=new ae.Z({concurrency:1}),c=(0,ne.d)();a.add((async()=>{await ce(o,t,c,0,s,s+i,a,e)})),a.on("error",(e=>{c.end(e)}));let h=0;for await(const e of c)null!=e&&(h+=e.byteLength,h===i&&c.end(),yield e)},le=(e,t,r,n,s,i,o)=>async function*(e={}){const r=e.offset||0,a=e.length||t.Links.length,c=t.Links.slice(r,a);for(const t of c){const r=await s(t.Hash,t.Name||"",`${n}/${t.Name||""}`,[],i+1,o,e);r.entry&&(yield r.entry)}};async function*ue(e,t,r,n,s,i){const o=e.Links;for(const a of o){const o=null!=a.Name?a.Name.substring(2):null;if(o){const e=await r(a.Hash,o,`${t}/${o}`,[],n+1,s,i);yield e.entry}else{const o=await s.get(a.Hash);e=(0,K.decode)(o);for await(const o of ue(e,t,r,n,s,i))yield o}}}const de=(e,t,r,n,s,i,o)=>function(e={}){return ue(t,n,s,i,o,e)},fe={raw:he,file:he,directory:le,"hamt-sharded-directory":de,metadata:(e,t,r,n,s,i,o)=>()=>[],symlink:(e,t,r,n,s,i,o)=>()=>[]},pe=async(e,t,r,s,i,o,a,c)=>{const h=await a.get(e,c),l=(0,K.decode)(h);let u,d;if(t||(t=e.toString()),null==l.Data)throw n(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{u=W.fL.unmarshal(l.Data)}catch(e){throw n(e,"ERR_NOT_UNIXFS")}if(r||(r=t),s.length){let e;if(e=u&&"hamt-sharded-directory"===u.type?await ee(l,s[0],a):((e,t)=>{const r=e.Links.find((e=>e.Name===t));return r&&r.Hash})(l,s[0]),!e)throw n(new Error("file does not exist"),"ERR_NOT_FOUND");const t=s.shift();d={cid:e,toResolve:s,name:t||"",path:`${r}/${t}`}}return{entry:{type:u.isDirectory()?"directory":"file",name:t,path:r,cid:e,content:fe[u.type](e,l,u,r,i,o,a),unixfs:u,depth:o,node:l,size:u.fileSize()},next:d}},ye=async(e,t,r,s,i,o,a,c)=>{if(s.length)throw n(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const h=await a.get(e,c);return{entry:{type:"raw",name:t,path:r,cid:e,content:(l=h,async function*(e={}){const{offset:t,length:r}=re(l.length,e.offset,e.length);yield te(l,0,t,t+r)}),depth:o,size:h.length,node:h}};var l},ge=async(e,t,r,s,i,o,a,c)=>{const h=await a.get(e),l=H.decode(h);let u=l,d=r;for(;s.length;){const i=s[0];if(!(i in u))throw n(new Error(`No property named ${i} found in cbor node ${e}`),"ERR_NO_PROP");{s.shift(),d=`${d}/${i}`;const n=B.asCID(u[i]);if(n)return{entry:{type:"object",name:t,path:r,cid:e,node:h,depth:o,size:h.length,content:async function*(){yield l}},next:{cid:n,name:i,path:d,toResolve:s}};u=u[i]}}return{entry:{type:"object",name:t,path:r,cid:e,node:h,depth:o,size:h.length,content:async function*(){yield l}}}},be=async(e,t,r,s,i,o,a,c)=>{if(s.length)throw n(new Error(`No link named ${r} found in raw node ${e}`),"ERR_NOT_FOUND");const h=await A(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:(l=h.digest,async function*(e={}){const{offset:t,length:r}=re(l.length,e.offset,e.length);yield te(l,0,t,t+r)}),depth:o,size:h.digest.length,node:h.digest}};var l},me={[K.code]:pe,85:ye,[H.code]:ge,[G]:be};const we=function e(t,r,s,i,o,a,c){const h=me[t.code];if(!h)throw n(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return h(t,r,s,i,e,o,a,c)};var ve=r(68883);const Ee=e=>{if(e instanceof Uint8Array)return{cid:B.decode(e),toResolve:[]};const t=B.asCID(e);if(t)return{cid:t,toResolve:[]};if("string"==typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=((e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean))(e);return{cid:B.parse(t[0]),toResolve:t.slice(1)}}throw n(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function*Ae(e,t,r={}){let{cid:s,toResolve:i}=Ee(e),o=s.toString(),a=o;const c=i.length;for(;;){const h=await we(s,o,a,i,c,t,r);if(!h.entry&&!h.next)throw n(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(h.entry&&(yield h.entry),!h.next)return;i=h.next.toResolve,s=h.next.cid,o=h.next.name,a=h.next.path}}async function Se(e,t,r={}){const s=await(0,ve.Z)(Ae(e,t,r));if(!s)throw n(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return s}async function*_e(e,t,r={}){const n=await Se(e,t,r);if(n&&(yield n,"directory"===n.type))for await(const e of async function*e(t,r){for await(const n of t.content(r))yield n,n instanceof Uint8Array||"directory"===n.type&&(yield*e(n,r))}(n,r))yield e}},53902:(e,t,r)=>{"use strict";r.d(t,{Z:()=>Ut});var n={};r.r(n),r.d(n,{sha256:()=>F,sha512:()=>$});var s={};r.r(s),r.d(s,{base58btc:()=>ne,base58flickr:()=>se});var i={};r.r(i),r.d(i,{base32:()=>ie,base32hex:()=>he,base32hexpad:()=>ue,base32hexpadupper:()=>de,base32hexupper:()=>le,base32pad:()=>ae,base32padupper:()=>ce,base32upper:()=>oe,base32z:()=>fe});var o={};r.r(o),r.d(o,{code:()=>xe,decode:()=>Pe,encode:()=>Re,name:()=>Te});var a={};r.r(a),r.d(a,{identity:()=>He});var c={};r.r(c),r.d(c,{base2:()=>Ge});var h={};r.r(h),r.d(h,{base8:()=>We});var l={};r.r(l),r.d(l,{base10:()=>Je});var u={};r.r(u),r.d(u,{base16:()=>Ye,base16upper:()=>Qe});var d={};r.r(d),r.d(d,{base36:()=>Ze,base36upper:()=>Xe});var f={};r.r(f),r.d(f,{base64:()=>et,base64pad:()=>tt,base64url:()=>rt,base64urlpad:()=>nt});var p={};r.r(p),r.d(p,{base256emoji:()=>at});var y={};r.r(y),r.d(y,{identity:()=>ht});var g={};r.r(g),r.d(g,{code:()=>ft,decode:()=>yt,encode:()=>pt,name:()=>dt});var b=r(14205);async function*m(e,t=1){for await(const r of(0,b.Z)(e,t)){const e=r.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const r=await e[t];if(!r.ok)throw r.err;yield r.value}}}var w=r(40726);new Uint8Array(0);const v=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var E=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=A;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},A=Math.pow(2,31);var S=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var _=Math.pow(2,7),C=Math.pow(2,14),k=Math.pow(2,21),I=Math.pow(2,28),T=Math.pow(2,35),x=Math.pow(2,42),R=Math.pow(2,49),P=Math.pow(2,56),D=Math.pow(2,63);const O={encode:E,decode:S,encodingLength:function(e){return e<_?1:e<C?2:e<k?3:e<I?4:e<T?5:e<x?6:e<R?7:e<P?8:e<D?9:10}},N=(e,t=0)=>[O.decode(e,t),O.decode.bytes],L=(e,t,r=0)=>(O.encode(e,t,r),t),U=e=>O.encodingLength(e),B=(e,t)=>{const r=t.byteLength,n=U(e),s=n+U(r),i=new Uint8Array(s+r);return L(e,i,0),L(r,i,n),i.set(t,s),new M(e,r,t,i)};class M{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const V=({name:e,code:t,encode:r})=>new z(e,t,r);class z{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?B(this.code,t):t.then((e=>B(this.code,e)))}throw Error("Unknown type, must be binary type")}}const j=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),F=V({name:"sha2-256",code:18,encode:j("SHA-256")}),$=V({name:"sha2-512",code:19,encode:j("SHA-512")});var q=r(34097);const K={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:F,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:async function(e){return(await q.Pv.encode(e)).slice(0,8).reverse()},hamtHashCode:34,hamtBucketBits:8};var H=r(92754);var G=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const W=G;class J{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Y{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Z(this,e)}}class Q{constructor(e){this.decoders=e}or(e){return Z(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Z=(e,t)=>new Q({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class X{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new J(e,t,r),this.decoder=new Y(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ee=({name:e,prefix:t,encode:r,decode:n})=>new X(e,t,r,n),te=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=W(r,t);return ee({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},re=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>ee({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),ne=te({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),se=te({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ie=re({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),oe=re({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ae=re({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ce=re({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),he=re({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),le=re({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ue=re({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),de=re({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),fe=re({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),pe=new WeakMap,ye=e=>{const t=pe.get(e);if(null==t){const t=new Map;return pe.set(e,t),t}return t};class ge{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==ve)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ee)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ge.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=B(e,t);return ge.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ge.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?me(r,ye(e),t||ne.encoder):we(r,ye(e),t||ie.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof ge)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new ge(e,r,n,s||Ae(e,r,n.bytes))}if(!0===t[Se]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=v(e),[r,n]=N(t),[s,i]=N(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new M(r,s,o,t)})(r);return ge.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==ve)throw new Error(`Version 0 CID must use dag-pb (code: ${ve}) block encoding`);return new ge(e,t,r,r.bytes);case 1:{const n=Ae(e,t,r.bytes);return new ge(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return ge.create(0,ve,e)}static createV1(e,t){return ge.create(1,e,t)}static decode(e){const[t,r]=ge.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=ge.inspectBytes(e),r=t.size-t.multihashSize,n=v(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new M(t.multihashCode,t.digestSize,s,n);return[0===t.version?ge.createV0(i):ge.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=N(e.subarray(t));return t+=n,r};let n=r(),s=ve;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=be(e,t),s=ge.decode(n);return ye(s).set(r,e),s}}const be=(e,t)=>{switch(e[0]){case"Q":{const r=t||ne;return[ne.prefix,r.decode(`${ne.prefix}${e}`)]}case ne.prefix:{const r=t||ne;return[ne.prefix,r.decode(e)]}case ie.prefix:{const r=t||ie;return[ie.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},me=(e,t,r)=>{const{prefix:n}=r;if(n!==ne.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},we=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},ve=112,Ee=18,Ae=(e,t,r)=>{const n=U(e),s=n+U(t),i=new Uint8Array(s+r.byteLength);return L(e,i,0),L(t,i,n),i.set(r,s),i},Se=Symbol.for("@ipld/js-cid/CID");var _e=r(10539);const Ce=async(e,t,r)=>{r.codec||(r.codec=_e),r.hasher||(r.hasher=F),void 0===r.cidVersion&&(r.cidVersion=1),r.codec===_e&&r.hasher!==F&&(r.cidVersion=1);const n=await r.hasher.digest(e),s=ge.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await t.put(s,e,{signal:r.signal}),s},ke=async(e,t,r)=>{const n=new H.fL({type:"directory",mtime:e.mtime,mode:e.mode}),s=(0,_e.encode)((0,_e.prepare)({Data:n.marshal()}));return{cid:await Ce(s,t,r),path:e.path,unixfs:n,size:s.length}};var Ie=r(32114);const Te="raw",xe=85,Re=e=>v(e),Pe=e=>v(e);var De=r(33686);const Oe=async function(e,t){return t(await(0,De.Z)(e))};async function Ne(e,t,r){const n=[];for await(const s of(0,b.Z)(e,r.maxChildrenPerNode))n.push(await t(s));return n.length>1?Ne(n,t,r):n[0]}const Le=function(e,t,r){return Ne(e,t,r)};const Ue=async function(e,t,r){const n=new Me(r.layerRepeat);let s=0,i=1,o=n;for await(const a of(0,b.Z)(e,r.maxChildrenPerNode))o.isFull()&&(o!==n&&n.addChild(await o.reduce(t)),s&&s%r.layerRepeat==0&&i++,o=new Be(i,r.layerRepeat,s),s++),o.append(a);return o&&o!==n&&n.addChild(await o.reduce(t)),n.reduce(t)};class Be{constructor(e,t,r=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=r,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let r=[];return e.children.length&&(r=await Promise.all(e.children.filter((e=>e.data)).map((e=>this._reduce(e,t))))),t((e.data||[]).concat(r))}_findParent(e,t){const r=e.parent;if(r&&0!==r.depth)return r.children.length!==r.maxChildren&&r.maxChildren?r:this._findParent(r,t)}}class Me extends Be{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}const Ve=async function*(e,t,r){for await(let n of e.content)yield async()=>{let s;r.progress(n.length,e.path);const i={codec:_e,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(i.codec=o,i.cidVersion=1):(s=new H.fL({type:r.leafType,data:n}),n=_e.encode({Data:s.marshal(),Links:[]})),{cid:await Ce(n,t,i),unixfs:s,size:n.length}}},ze={flat:Oe,balanced:Le,trickle:Ue};const je=function(e,t,r){const n=ze[r.strategy];if(!n)throw Ie(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return n(async function*(e,t,r){let n,s,i=-1;s="function"==typeof r.bufferImporter?r.bufferImporter:Ve;for await(const o of m(s(e,t,r),r.blockWriteConcurrency))i++,0!==i?(1===i&&n&&(yield n,n=null),yield o):n=o;n&&(n.single=!0,yield n)}(e,t,r),((e,t,r)=>async function(n){if(1===n.length&&n[0].single&&r.reduceSingleLeafToSelf){const s=n[0];if(void 0!==e.mtime||void 0!==e.mode){let n=await t.get(s.cid);s.unixfs=new H.fL({type:"file",mtime:e.mtime,mode:e.mode,data:n}),n=(0,_e.encode)((0,_e.prepare)({Data:s.unixfs.marshal()})),s.cid=await Ce(n,t,{...r,codec:_e,hasher:r.hasher,cidVersion:r.cidVersion}),s.size=n.length}return{cid:s.cid,path:e.path,unixfs:s.unixfs,size:s.size}}const s=new H.fL({type:"file",mtime:e.mtime,mode:e.mode}),i=n.filter((e=>!(e.cid.code!==xe||!e.size)||!(!e.unixfs||e.unixfs.data||!e.unixfs.fileSize())||Boolean(e.unixfs&&e.unixfs.data&&e.unixfs.data.length))).map((e=>e.cid.code===xe?(s.addBlockSize(e.size),{Name:"",Tsize:e.size,Hash:e.cid}):(e.unixfs&&e.unixfs.data?s.addBlockSize(e.unixfs.data.length):s.addBlockSize(e.unixfs&&e.unixfs.fileSize()||0),{Name:"",Tsize:e.size,Hash:e.cid}))),o={Data:s.marshal(),Links:i},a=(0,_e.encode)((0,_e.prepare)(o));return{cid:await Ce(a,t,r),path:e.path,unixfs:s,size:a.length+o.Links.reduce(((e,t)=>e+t.Tsize),0)}})(e,t,r),r)};var Fe=r(90581),$e=r(63060);const qe=async function*(e,t){let r,n,s;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)s=t.avgChunkSize,r=t.minChunkSize,n=t.maxChunkSize;else{if(!t.avgChunkSize)throw Ie(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");s=t.avgChunkSize,r=s/3,n=s+s/2}if(r<16)throw Ie(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<r&&(n=r),s<r&&(s=r);const i=Math.floor(Math.log2(s));for await(const s of async function*(e,t){const r=await(0,$e.create)(t.bits,t.min,t.max,t.window),n=new Fe.H;for await(const t of e){n.append(t);const e=r.fingerprint(t);for(let t=0;t<e.length;t++){const r=e[t],s=n.slice(0,r);n.consume(r),yield s}}n.length&&(yield n.subarray(0))}(e,{min:r,max:n,bits:i,window:t.window,polynomial:t.polynomial}))yield s};const Ke=async function*(e,t){let r=new Fe.H,n=0,s=!1;const i=t.maxChunkSize;for await(const t of e)for(r.append(t),n+=t.length;n>=i;)if(yield r.slice(0,i),s=!0,i===r.length)r=new Fe.H,n=0;else{const e=new Fe.H;e.append(r.sublist(i)),r=e,n-=i}s&&!n||(yield r.subarray(0,n))},He=ee({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Ge=re({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),We=re({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Je=te({prefix:"9",name:"base10",alphabet:"0123456789"}),Ye=re({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Qe=re({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ze=te({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xe=te({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),et=re({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tt=re({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rt=re({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nt=re({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),st=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),it=st.reduce(((e,t,r)=>(e[r]=t,e)),[]),ot=st.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const at=ee({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=it[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ot[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}}),ct=v,ht={code:0,name:"identity",encode:ct,digest:e=>B(0,ct(e))},lt=new TextEncoder,ut=new TextDecoder,dt="json",ft=512,pt=e=>lt.encode(JSON.stringify(e)),yt=e=>JSON.parse(ut.decode(e)),gt={...a,...c,...h,...l,...u,...i,...d,...s,...f,...p};function bt(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function mt(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const wt=mt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),vt=mt("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?bt(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Et={utf8:wt,"utf-8":wt,hex:gt.base16,latin1:vt,ascii:vt,binary:vt,...gt};function At(e,t="utf8"){const r=Et[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):bt(globalThis.Buffer.from(e,"utf-8"))}const St=async function*(e){for await(const t of e){if(void 0===t.length)throw Ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"==typeof t||t instanceof String)yield At(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw Ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}};function _t(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(t=e,Symbol.iterator in t)return async function*(){yield*e}();if(function(e){return Symbol.asyncIterator in e}(e))return e}catch{throw Ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var t;throw Ie(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}const Ct=async function*(e,t,r){for await(const n of e)if(n.path&&("./"===n.path.substring(0,2)&&(r.wrapWithDirectory=!0),n.path=n.path.split("/").filter((e=>e&&"."!==e)).join("/")),n.content){let e,s;e="function"==typeof r.chunker?r.chunker:"rabin"===r.chunker?qe:Ke,s="function"==typeof r.chunkValidator?r.chunkValidator:St;const i={path:n.path,mtime:n.mtime,mode:n.mode,content:e(s(_t(n.content),r),r)};yield()=>je(i,t,r)}else{if(!n.path)throw new Error("Import candidate must have content or path or both");{const e={path:n.path,mtime:n.mtime,mode:n.mode};yield()=>ke(e,t,r)}}};const kt=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}};const It=class extends kt{constructor(e,t){super(e,t),this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const e=Object.keys(this._children);for(let t=0;t<e.length;t++){const r=e[t];yield{key:r,child:this._children[r]}}}async*flush(e){const t=Object.keys(this._children),r=[];for(let n=0;n<t.length;n++){let s=this._children[t[n]];if(s instanceof kt)for await(const t of s.flush(e))s=t,yield s;null!=s.size&&s.cid&&r.push({Name:t[n],Tsize:s.size,Hash:s.cid})}const n=new H.fL({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:r},i=(0,_e.encode)((0,_e.prepare)(s)),o=await Ce(i,e,this.options),a=i.length+s.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=o,this.size=a,yield{cid:o,unixfs:n,path:this.path,size:a}}};var Tt=r(52090);const xt=class extends kt{constructor(e,t){super(e,t),this._bucket=(0,Tt.$)({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(const t of Rt(this._bucket,e,this,this.options))yield{...t,path:this.path}}};async function*Rt(e,t,r,n){const s=e._children,i=[];let o=0;for(let e=0;e<s.length;e++){const r=s.get(e);if(!r)continue;const a=e.toString(16).toUpperCase().padStart(2,"0");if(r instanceof Tt.r){let e;for await(const s of await Rt(r,t,null,n))e=s;if(!e)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:a,Tsize:e.size,Hash:e.cid}),o+=e.size}else if("function"==typeof r.value.flush){const e=r.value;let n;for await(const r of e.flush(t))n=r,yield n;const s=a+r.key;i.push({Name:s,Tsize:n.size,Hash:n.cid}),o+=n.size}else{const e=r.value;if(!e.cid)continue;const t=a+r.key,n=e.size;i.push({Name:t,Tsize:n,Hash:e.cid}),o+=n}}const a=Uint8Array.from(s.bitField().reverse()),c=new H.fL({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:n.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),h={Data:c.marshal(),Links:i},l=(0,_e.encode)((0,_e.prepare)(h)),u=await Ce(l,t,n),d=l.length+o;yield{cid:u,unixfs:c,size:d}}const Pt=async function e(t,r,n,s){let i=r;r instanceof It&&r.directChildrenCount()>=n&&(i=await async function(e,t){const r=new xt({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:t,child:n}of e.eachChildSeries())await r.put(t,n);return r}(r,s));const o=i.parent;if(o){if(i!==r){if(t&&(t.parent=i),!i.parentKey)throw new Error("No parent key found");await o.put(i.parentKey,i)}return e(i,o,n,s)}return i},Dt=(e="")=>(e.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);async function Ot(e,t,r){const n=Dt(e.path||""),s=n.length-1;let i=t,o="";for(let a=0;a<n.length;a++){const c=n[a];o+=`${o?"/":""}${c}`;const h=a===s;if(i.dirty=!0,i.cid=void 0,i.size=void 0,h)await i.put(c,e),t=await Pt(null,i,r.shardSplitThreshold,r);else{let e=await i.get(c);e&&e instanceof kt||(e=new It({root:!1,dir:!0,parent:i,parentKey:c,path:o,dirty:!0,flat:!0,mtime:e&&e.unixfs&&e.unixfs.mtime,mode:e&&e.unixfs&&e.unixfs.mode},r)),await i.put(c,e),i=e}}return t}async function*Nt(e,t){e instanceof kt?yield*e.flush(t):e&&e.unixfs&&e.unixfs.isDirectory()&&(yield e)}const Lt=async function*(e,t,r){let n=new It({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(const t of e)t&&(n=await Ot(t,n,r),t.unixfs&&t.unixfs.isDirectory()||(yield t));if(r.wrapWithDirectory)yield*Nt(n,t);else for await(const e of n.eachChildSeries())e&&(yield*Nt(e.child,t))};async function*Ut(e,t,r={}){const n=((e={})=>w.Z.bind({ignoreUndefined:!0})(K,e))(r);let s,i,o;s="function"==typeof r.dagBuilder?r.dagBuilder:Ct,i="function"==typeof r.treeBuilder?r.treeBuilder:Lt,o=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];for await(const e of i(m(s(o,t,n),n.fileImportConcurrency),t,n))yield{cid:e.cid,path:e.path,unixfs:e.unixfs,size:e.size}}},92754:(e,t,r)=>{"use strict";r.d(t,{fL:()=>b,tK:()=>y,Xu:()=>g});var n=r(32114),s=r(62100);const i=s.Reader,o=s.Writer,a=s.util,c=s.roots["ipfs-unixfs"]||(s.roots["ipfs-unixfs"]={}),h=c.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=a.newBuffer([]),e.prototype.filesize=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=a.emptyArray,e.prototype.hashType=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.fanout=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=o.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&c.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.Data;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2==(7&s))for(var o=e.uint32()+e.pos;e.pos<o;)n.blocksizes.push(e.uint64());else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=c.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&s)}}if(!n.hasOwnProperty("Type"))throw a.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof c.Data)return e;var t=new c.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5}if(null!=e.Data&&("string"==typeof e.Data?a.base64.decode(e.Data,t.Data=a.newBuffer(a.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(a.Long?(t.filesize=a.Long.fromValue(e.filesize)).unsigned=!0:"string"==typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"==typeof e.filesize?t.filesize=e.filesize:"object"==typeof e.filesize&&(t.filesize=new a.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)a.Long?(t.blocksizes[r]=a.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"==typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"==typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"==typeof e.blocksizes[r]&&(t.blocksizes[r]=new a.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&(a.Long?(t.hashType=a.Long.fromValue(e.hashType)).unsigned=!0:"string"==typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"==typeof e.hashType?t.hashType=e.hashType:"object"==typeof e.hashType&&(t.hashType=new a.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(a.Long?(t.fanout=a.Long.fromValue(e.fanout)).unsigned=!0:"string"==typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"==typeof e.fanout?t.fanout=e.fanout:"object"==typeof e.fanout&&(t.fanout=new a.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!=typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=c.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=a.newBuffer(r.Data))),a.Long){var n=new a.Long(0,0,!0);r.filesize=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.filesize=t.longs===String?"0":0;if(a.Long){n=new a.Long(0,0,!0);r.hashType=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.hashType=t.longs===String?"0":0;if(a.Long){n=new a.Long(0,0,!0);r.fanout=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?c.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?a.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"==typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?a.Long.prototype.toString.call(e.filesize):t.longs===Number?new a.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var s=0;s<e.blocksizes.length;++s)"number"==typeof e.blocksizes[s]?r.blocksizes[s]=t.longs===String?String(e.blocksizes[s]):e.blocksizes[s]:r.blocksizes[s]=t.longs===String?a.Long.prototype.toString.call(e.blocksizes[s]):t.longs===Number?new a.LongBits(e.blocksizes[s].low>>>0,e.blocksizes[s].high>>>0).toNumber(!0):e.blocksizes[s]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"==typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?a.Long.prototype.toString.call(e.hashType):t.longs===Number?new a.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"==typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?a.Long.prototype.toString.call(e.fanout):t.longs===Number?new a.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=c.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e})(),l=(c.UnixTime=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=o.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.UnixTime;e.pos<r;){var s=e.uint32();switch(s>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&s)}}if(!n.hasOwnProperty("Seconds"))throw a.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof c.UnixTime)return e;var t=new c.UnixTime;return null!=e.Seconds&&(a.Long?(t.Seconds=a.Long.fromValue(e.Seconds)).unsigned=!1:"string"==typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"==typeof e.Seconds?t.Seconds=e.Seconds:"object"==typeof e.Seconds&&(t.Seconds=new a.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(a.Long){var n=new a.Long(0,0,!1);r.Seconds=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"==typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?a.Long.prototype.toString.call(e.Seconds):t.longs===Number?new a.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e})(),c.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=o.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new c.Metadata;e.pos<r;){var s=e.uint32();if(s>>>3==1)n.MimeType=e.string();else e.skipType(7&s)}return n},e.fromObject=function(e){if(e instanceof c.Metadata)return e;var t=new c.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e})(),h),u=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],d=["directory","hamt-sharded-directory"],f=parseInt("0644",8),p=parseInt("0755",8);function y(e){if(null!=e)return"number"==typeof e?4095&e:"0"===(e=e.toString()).substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10)}function g(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw n(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}class b{static unmarshal(e){const t=l.decode(e),r=l.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new b({type:u[r.Type],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:r.mtime?{secs:r.mtime.Seconds,nsecs:r.mtime.FractionalNanoseconds}:void 0});return n._originalMode=r.mode||0,n}constructor(e={type:"file"}){const{type:t,data:r,blockSizes:s,hashType:i,fanout:o,mtime:a,mode:c}=e;if(t&&!u.includes(t))throw n(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=r,this.hashType=i,this.fanout=o,this.blockSizes=s||[],this._originalMode=0,this.mode=y(c),a&&(this.mtime=g(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?p:f;const t=y(e);void 0!==t&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&d.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach((t=>{e+=t})),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=l.DataType.Raw;break;case"directory":e=l.DataType.Directory;break;case"file":e=l.DataType.File;break;case"metadata":e=l.DataType.Metadata;break;case"symlink":e=l.DataType.Symlink;break;case"hamt-sharded-directory":e=l.DataType.HAMTShard;break;default:throw n(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t,r,s=this.data;if(this.data&&this.data.length||(s=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(y(this.mode)||0),t!==f||this.isDirectory()||(t=void 0),t===p&&this.isDirectory()&&(t=void 0)),null!=this.mtime){const e=g(this.mtime);e&&(r={Seconds:e.secs,FractionalNanoseconds:e.nsecs},0===r.FractionalNanoseconds&&delete r.FractionalNanoseconds)}const i={Type:e,Data:s,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r};return l.encode(i).finish()}}},11365:(e,t,r)=>{"use strict";r.d(t,{BL:()=>h,FB:()=>i,Fl:()=>s,L0:()=>n,SY:()=>o,TO:()=>l,WS:()=>u,eb:()=>c,vH:()=>a});const n="ERR_IPNS_EXPIRED_RECORD",s="ERR_UNRECOGNIZED_VALIDITY",i="ERR_SIGNATURE_CREATION",o="ERR_SIGNATURE_VERIFICATION",a="ERR_UNRECOGNIZED_FORMAT",c="ERR_UNDEFINED_PARAMETER",h="ERR_INVALID_RECORD_DATA",l="ERR_INVALID_EMBEDDED_KEY",u="ERR_MISSING_PRIVATE_KEY"},39233:(e,t,r)=>{"use strict";r.d(t,{Ue:()=>v,_M:()=>A,ef:()=>l.ef,fy:()=>l.fy,iR:()=>w,md:()=>l.md,uD:()=>m});var n=r(84957),s=r(42837),i=r(51988),o=r(32114),a=r(63215),c=r(55471),h=r(38461),l=r(6672),u=r(11365),d=r(67374),f=r(39791),p=r(75968),y=r(2229);const g=(0,h.kg)("ipns"),b=p.identity.code,m="/ipns/",w=m.length,v=async(e,t,r,s)=>{const i=new n(Date.now()+Number(s)),o=y.X.ValidityType.EOL,[a,c]=s.toString().split("."),h=BigInt(a)*BigInt(1e5)+BigInt(c??"0");return await E(e,t,r,o,i,h)},E=async(e,t,r,n,s,a)=>{r=BigInt(r);const h=(0,c.m)(s.toString());if(null==e.privateKey)throw o(new Error("Missing private key"),u.WS);const p=await(0,i.unmarshalPrivateKey)(e.privateKey),y=await S(p,t,n,h),m=(0,l.yf)(t,h,n,r,a),w=(0,l.MP)(m),v={value:t,signature:y,validityType:n,validity:h,sequence:r,ttl:a,signatureV2:await p.sign(w),data:m};if(null!=e.publicKey){const t=f.Jx(e.toBytes());t.code===b&&(0,d.f)(e.publicKey,t.digest)||(v.pubKey=e.publicKey)}return g("ipns entry for %b created",t),v},A=e=>new s.s(`/ipns/${(e=>a.base32upper.encode(e).slice(1))(e)}`),S=async(e,t,r,n)=>{try{const s=(0,l.B4)(t,r,n);return await e.sign(s)}catch(e){throw g.error("record signature creation failed",e),o(new Error("record signature creation failed"),u.FB)}}},2229:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var n,s=r(46888);!function(e){let t,r,n;!function(e){e.EOL="EOL"}(t=e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(r||(r={})),function(e){e.codec=()=>(0,s.Ji)(r)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==n&&(n=(0,s.yw)(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.value&&(r.uint32(10),r.bytes(t.value)),null!=t.signature&&(r.uint32(18),r.bytes(t.signature)),null!=t.validityType&&(r.uint32(24),e.ValidityType.codec().encode(t.validityType,r)),null!=t.validity&&(r.uint32(34),r.bytes(t.validity)),null!=t.sequence&&(r.uint32(40),r.uint64(t.sequence)),null!=t.ttl&&(r.uint32(48),r.uint64(t.ttl)),null!=t.pubKey&&(r.uint32(58),r.bytes(t.pubKey)),null!=t.signatureV2&&(r.uint32(66),r.bytes(t.signatureV2)),null!=t.data&&(r.uint32(74),r.bytes(t.data)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.value=t.bytes();break;case 2:n.signature=t.bytes();break;case 3:n.validityType=e.ValidityType.codec().decode(t);break;case 4:n.validity=t.bytes();break;case 5:n.sequence=t.uint64();break;case 6:n.ttl=t.uint64();break;case 7:n.pubKey=t.bytes();break;case 8:n.signatureV2=t.bytes();break;case 9:n.data=t.bytes();break;default:t.skipType(7&r)}}return n}))),n),e.encode=t=>(0,s.LE)(t,e.codec()),e.decode=t=>(0,s.C6)(t,e.codec())}(n||(n={}))},95738:(e,t,r)=>{"use strict";r.d(t,{e:()=>o});var n=r(19962),s=r(2229),i=r(6672);const o=(e,t)=>{const r=t.map(((e,t)=>({entry:s.X.decode(e),index:t})));return r.sort(((e,t)=>{if(null!=e.entry.signatureV2&&null==t.entry.signatureV2)return-1;if(null==e.entry.signatureV2&&null!=t.entry.signatureV2)return 1;const r=e.entry.sequence??0n,s=t.entry.sequence??0n;if(r>s)return-1;if(r<s)return 1;const o=e.entry.validity??new Uint8Array(0),a=t.entry.validity??new Uint8Array(0),c=(0,i.r5)((0,n.B)(o)),h=(0,i.r5)((0,n.B)(a));return c.getTime()>h.getTime()?-1:c.getTime()<h.getTime()?1:0})),r[0].index}},6672:(e,t,r)=>{"use strict";r.d(t,{yf:()=>_,L8:()=>b,B4:()=>m,MP:()=>w,ef:()=>v,uZ:()=>C,r5:()=>g,dc:()=>S,fy:()=>A,md:()=>E});var n=r(32114),s=r(11365),i=r(51988),o=r(93203),a=r(38461),c=r(2229),h=r(55471),l=r(86805),u=r(55732);function d(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=(0,l.E)(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return(0,u.P)(r)}var f=r(64936);const p=(0,a.kg)("ipns:utils"),y=(0,h.m)("/ipns/");function g(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");const n=parseInt(r[1],10),s=parseInt(r[2],10)-1,i=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),h=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,s,i,o,a,c,h))}const b=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw p.error(e),n(e,s.eb)}let r;if(null!=t.pubKey){try{r=(0,i.unmarshalPublicKey)(t.pubKey)}catch(e){throw p.error(e),e}if(!(await(0,o.y5)(t.pubKey)).equals(e))throw n(new Error("Embedded public key did not match PeerID"),s.TO)}else null!=e.publicKey&&(r=(0,i.unmarshalPublicKey)(e.publicKey));if(null!=r)return r;throw n(new Error("no public key is available"),s.eb)},m=(e,t,r)=>d([e,r,(0,h.m)(t)]),w=e=>d([(0,h.m)("ipns-signature:"),e]),v=e=>c.X.encode(e),E=e=>{const t=c.X.decode(e);return null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),{value:t.value??new Uint8Array(0),signature:t.signature??new Uint8Array(0),validityType:t.validityType??c.X.ValidityType.EOL,validity:t.validity??new Uint8Array(0),sequence:t.sequence??0n,pubKey:t.pubKey,ttl:t.ttl??void 0,signatureV2:t.signatureV2,data:t.data}},A=e=>d([y,e.toBytes()]),S=e=>(0,o.cv)(e.slice(y.length)),_=(e,t,r,i,o)=>{let a;if(r!==c.X.ValidityType.EOL)throw n(new Error("Unknown validity type"),s.Fl);a=0;const h={Value:e,Validity:t,ValidityType:a,Sequence:i,TTL:o};return f.cv(h)},C=e=>{const t=f.Jx(e);if(0!==t.ValidityType)throw n(new Error("Unknown validity type"),s.Fl);return t.ValidityType=c.X.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t}},60:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(32114),s=r(19962),i=r(67374),o=r(2229),a=r(6672),c=r(11365);const h=(0,r(38461).kg)("ipns:validator"),l=e=>{if(null==e.data)throw n(new Error("Record data is missing"),c.BL);const t=(0,a.uZ)(e.data);if(!(0,i.f)(t.Value,e.value))throw n(new Error('Field "value" did not match between protobuf and CBOR'),c.SY);if(!(0,i.f)(t.Validity,e.validity))throw n(new Error('Field "validity" did not match between protobuf and CBOR'),c.SY);if(t.ValidityType!==e.validityType)throw n(new Error('Field "validityType" did not match between protobuf and CBOR'),c.SY);if(t.Sequence!==e.sequence)throw n(new Error('Field "sequence" did not match between protobuf and CBOR'),c.SY);if(t.TTL!==e.ttl)throw n(new Error('Field "ttl" did not match between protobuf and CBOR'),c.SY)},u=async(e,t)=>{const r=(0,a.dc)(e),i=(0,a.md)(t),u=await(0,a.L8)(r,i);await(async(e,t)=>{const{value:r,validityType:i,validity:u}=t;let d,f,p;if(null==t.signatureV2||null==t.data)throw n(new Error("missing data or signatureV2"),c.SY);f=t.signatureV2,d=(0,a.MP)(t.data),l(t);try{p=await e.verify(d,f)}catch(e){p=!1}if(!p)throw h.error("record signature verification failed"),n(new Error("record signature verification failed"),c.SY);if(null!=u&&i===o.X.ValidityType.EOL){let e;try{e=(0,a.r5)((0,s.B)(u))}catch(e){throw h.error("unrecognized validity format (not an rfc3339 format)"),n(new Error("unrecognized validity format (not an rfc3339 format)"),c.vH)}if(e.getTime()<Date.now())throw h.error("record has expired"),n(new Error("record has expired"),c.L0)}else if(null!=i)throw h.error("unrecognized validity type"),n(new Error("unrecognized validity type"),c.Fl);h("ipns entry for %b is valid",r)})(u,i)}},75102:(e,t,r)=>{"use strict";r.d(t,{kU:()=>u,Dp:()=>l,ET:()=>d});const n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};var s=r(23252);class i{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class o{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i(e,t,r),this.decoder=new o(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),u=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:o}=n(r,t);return l({prefix:e,name:t,encode:i,decode:e=>(0,s.oQ)(o(e))})},d=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)})},63215:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base32:()=>s,base32hex:()=>c,base32hexpad:()=>l,base32hexpadupper:()=>u,base32hexupper:()=>h,base32pad:()=>o,base32padupper:()=>a,base32upper:()=>i,base32z:()=>d});var n=r(75102);const s=(0,n.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i=(0,n.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,n.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,n.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,n.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),h=(0,n.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,n.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u=(0,n.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,n.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},23252:(e,t,r)=>{"use strict";r.d(t,{BB:()=>i,mL:()=>s,oQ:()=>n});new Uint8Array(0);const n=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},s=e=>(new TextEncoder).encode(e),i=e=>(new TextDecoder).decode(e)},39791:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>o,Ue:()=>i});var n=r(23252),s=r(90604);const i=(e,t)=>{const r=t.byteLength,n=s.P$(e),i=n+s.P$(r),o=new Uint8Array(i+r);return s.mL(e,o,0),s.mL(r,o,n),o.set(t,i),new a(e,r,t,o)},o=e=>{const t=(0,n.oQ)(e),[r,i]=s.Jx(t),[o,c]=s.Jx(t.subarray(i)),h=t.subarray(i+c);if(h.byteLength!==o)throw new Error("Incorrect length");return new a(r,o,h,t)};class a{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}},75968:(e,t,r)=>{"use strict";r.r(t),r.d(t,{identity:()=>o});var n=r(23252),s=r(39791);const i=n.oQ,o={code:0,name:"identity",encode:i,digest:e=>s.Ue(0,i(e))}},90604:(e,t,r)=>{"use strict";r.d(t,{Jx:()=>g,mL:()=>b,P$:()=>m});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t=0)=>[y.decode(e,t),y.decode.bytes],b=(e,t,r=0)=>(y.encode(e,t,r),t),m=e=>y.encodingLength(e)},86805:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var n=r(55732);function s(e=0){return null!=globalThis.Buffer?.allocUnsafe?(0,n.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},67374:(e,t,r)=>{"use strict";function n(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}r.d(t,{f:()=>n})},55471:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var n=r(38862),s=r(55732);function i(e,t="utf8"){const r=n.Z[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):(0,s.P)(globalThis.Buffer.from(e,"utf-8"))}},19962:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var n=r(38862);function s(e,t="utf8"){const r=n.Z[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},55732:(e,t,r)=>{"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}r.d(t,{P:()=>n})},38862:(e,t,r)=>{"use strict";r.d(t,{Z:()=>ie});var n={};r.r(n),r.d(n,{identity:()=>b});var s={};r.r(s),r.d(s,{base2:()=>m});var i={};r.r(i),r.d(i,{base8:()=>w});var o={};r.r(o),r.d(o,{base10:()=>v});var a={};r.r(a),r.d(a,{base16:()=>E,base16upper:()=>A});var c={};r.r(c),r.d(c,{base36:()=>_,base36upper:()=>C});var h={};r.r(h),r.d(h,{base58btc:()=>k,base58flickr:()=>I});var l={};r.r(l),r.d(l,{base64:()=>T,base64pad:()=>x,base64url:()=>R,base64urlpad:()=>P});var u={};r.r(u),r.d(u,{base256emoji:()=>L});var d={};r.r(d),r.d(d,{sha256:()=>z,sha512:()=>j});var f={};r.r(f),r.d(f,{code:()=>q,decode:()=>H,encode:()=>K,name:()=>$});var p={};r.r(p),r.d(p,{code:()=>Y,decode:()=>Z,encode:()=>Q,name:()=>J});var y=r(75102),g=r(23252);const b=(0,y.Dp)({prefix:"\0",name:"identity",encode:e=>(0,g.BB)(e),decode:e=>(0,g.mL)(e)}),m=(0,y.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),w=(0,y.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),v=(0,y.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),E=(0,y.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),A=(0,y.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var S=r(63215);const _=(0,y.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),C=(0,y.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),k=(0,y.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),I=(0,y.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),T=(0,y.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),x=(0,y.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),R=(0,y.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),P=(0,y.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),D=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),O=D.reduce(((e,t,r)=>(e[r]=t,e)),[]),N=D.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const L=(0,y.Dp)({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=O[t]),"")},decode:function(e){const t=[];for(const r of e){const e=N[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var U=r(39791);const B=({name:e,code:t,encode:r})=>new M(e,t,r);class M{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?U.Ue(this.code,t):t.then((e=>U.Ue(this.code,e)))}throw Error("Unknown type, must be binary type")}}const V=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),z=B({name:"sha2-256",code:18,encode:V("SHA-256")}),j=B({name:"sha2-512",code:19,encode:V("SHA-512")});var F=r(75968);const $="raw",q=85,K=e=>(0,g.oQ)(e),H=e=>(0,g.oQ)(e),G=new TextEncoder,W=new TextDecoder,J="json",Y=512,Q=e=>G.encode(JSON.stringify(e)),Z=e=>JSON.parse(W.decode(e));r(90604);new WeakMap;class X{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return X.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return X.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return X.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof X)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new X(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return X.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new X(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new X(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return X.create(0,DAG_PB_CODE,e)}static createV1(e,t){return X.create(1,e,t)}static decode(e){const[t,r]=X.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=X.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?X.createV0(i):X.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=X.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const ee={...n,...s,...i,...o,...a,...S,...c,...h,...l,...u};var te=r(86805);function re(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ne=re("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),se=re("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=(0,te.E)(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),ie={utf8:ne,"utf-8":ne,hex:ee.base16,latin1:se,ascii:se,binary:se,...ee}},33686:(e,t,r)=>{"use strict";async function n(e){const t=[];for await(const r of e)t.push(r);return t}r.d(t,{Z:()=>n})},14205:(e,t,r)=>{"use strict";async function*n(e,t=1){let r=[];t<1&&(t=1);for await(const n of e)for(r.push(n);r.length>=t;)yield r.slice(0,t),r=r.slice(t);for(;r.length>0;)yield r.slice(0,t),r=r.slice(t)}r.d(t,{Z:()=>n})},93361:(e,t,r)=>{"use strict";async function n(e){for await(const t of e);}r.d(t,{Z:()=>n})},44752:(e,t,r)=>{"use strict";async function*n(e,t){for await(const r of e)await t(r)&&(yield r)}r.d(t,{Z:()=>n})},91486:(e,t,r)=>{"use strict";async function n(e){for await(const t of e)return t}r.d(t,{Z:()=>n})},51816:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o});var n=r(93489),s=r(37430),i=r(85275);function o(e){const t=(0,s.d)(),r=(0,n.r)(e.source),o=(0,i.Z)();let a;const c=e.sink(async function*(){yield*t;const e=await o.promise;yield*e}());c.catch((e=>{a=e}));return{reader:r,writer:t,stream:{sink:async e=>null!=a?await Promise.reject(a):(o.resolve(e),await c),source:r},rest:()=>t.end(),write:t.push,read:async()=>{const e=await r.next();if(null!=e.value)return e.value}}}},68883:(e,t,r)=>{"use strict";async function n(e){let t;for await(const r of e)t=r;return t}r.d(t,{Z:()=>n})},55150:(e,t,r)=>{"use strict";r.d(t,{J:()=>l,c:()=>o});var n=r(90581),s=r(77443);const i=e=>{const t=s.hG.encodingLength(e),r=(n=t,null!=globalThis?.Buffer?.allocUnsafe?globalThis.Buffer.allocUnsafe(n):new Uint8Array(n));var n;return s.hG.encode(e,r),i.bytes=t,r};function o(e){const t=(e=e??{}).lengthEncoder??i;return async function*(e){for await(const r of e){const e=t(r.byteLength);e instanceof Uint8Array?yield e:yield*e,r instanceof Uint8Array?yield r:yield*r}}}i.bytes=0,o.single=(e,t)=>{const r=(t=t??{}).lengthEncoder??i;return new n.H(r(e.byteLength),e)};var a=r(32114);var c;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(c||(c={}));const h=e=>{const t=s.hG.decode(e);return h.bytes=s.hG.encodingLength(t),t};function l(e){return async function*(t){const r=new n.H;let s=c.LENGTH,i=-1;const o=e?.lengthDecoder??h,l=e?.maxLengthLength??8,u=e?.maxDataLength??4194304;for await(const n of t)for(r.append(n);r.byteLength>0;){if(s===c.LENGTH)try{if(i=o(r),i<0)throw a(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>u)throw a(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const t=o.bytes;r.consume(t),null!=e?.onLength&&e.onLength(i),s=c.DATA}catch(e){if(e instanceof RangeError){if(r.byteLength>l)throw a(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===c.DATA){if(r.byteLength<i)break;const t=r.sublist(0,i);r.consume(i),null!=e?.onData&&e.onData(t),yield t,s=c.LENGTH}}if(r.byteLength>0)throw a(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}h.bytes=0,l.fromReader=(e,t)=>{let r=1;const n=async function*(){for(;;)try{const{done:t,value:n}=await e.next(r);if(!0===t)return;null!=n&&(yield n)}catch(e){if("ERR_UNDER_READ"===e.code)return{done:!0,value:null};throw e}finally{r=1}}();return l({...t??{},onLength:e=>{r=e}})(n)}},95918:(e,t,r)=>{"use strict";async function n(e){let t=0;for await(const r of e)t++;return t}r.d(t,{Z:()=>n})},21007:(e,t,r)=>{"use strict";async function*n(e,t){for await(const r of e)yield t(r)}r.d(t,{Z:()=>n})},52019:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(37430);async function*s(...e){const t=(0,n.d)({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const r of e)t.push(r)}))),t.end()}catch(e){t.end(e)}})),yield*t}},69849:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(85275);const s=globalThis.CustomEvent??Event;async function*i(e,t={}){let r=t.concurrency??1/0;r<1&&(r=1/0);const i=null!=t.ordered&&t.ordered,o=new EventTarget,a=[];let c,h=(0,n.Z)(),l=(0,n.Z)(),u=!1,d=!1;function f(){return i?a[0]?.done:Boolean(a.find((e=>e.done)))}function*p(){for(;a.length>0&&a[0].done;){const e=a[0];if(a.shift(),!e.ok)throw d=!0,h.resolve(),e.err;yield e.value,h.resolve()}}function*y(){for(;f();)for(let e=0;e<a.length;e++)if(a[e].done){const t=a[e];if(a.splice(e,1),e--,!t.ok)throw d=!0,h.resolve(),t.err;yield t.value,h.resolve()}}for(o.addEventListener("task-complete",(()=>{l.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(a.length===r&&(h=(0,n.Z)(),await h.promise),d)break;const e={done:!1};a.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,o.dispatchEvent(new s("task-complete"))}),(t=>{e.done=!0,e.err=t,o.dispatchEvent(new s("task-complete"))}))}u=!0,o.dispatchEvent(new s("task-complete"))}catch(e){c=e,o.dispatchEvent(new s("task-complete"))}}));;){if(f()||(l=(0,n.Z)(),await l.promise),null!=c)throw c;if(i?yield*p():yield*y(),u&&0===a.length)break}}},75671:(e,t,r)=>{"use strict";function n(e){const[t,r]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:e=>{n.push(e)},next:()=>n.length>0?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}r.d(t,{Z:()=>n})},88211:(e,t,r)=>{"use strict";r.d(t,{zG:()=>c});var n=r(37430),s=r(46884);const i=e=>null!=e&&("function"==typeof e[Symbol.asyncIterator]||"function"==typeof e[Symbol.iterator]||"function"==typeof e.next),o=e=>null!=e&&"function"==typeof e.sink&&i(e.source),a=e=>t=>{const r=e.sink(t);if(null!=r.then){const t=(0,n.d)({objectMode:!0});r.then((()=>{t.end()}),(e=>{t.end(e)}));const i=async function*(){yield*e.source,t.end()};return s(t,i())}return e.source};function c(e,...t){if(o(e)){const t=e;e=()=>t.source}else if(i(e)){const t=e;e=()=>t}const r=[e,...t];if(r.length>1&&o(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)o(r[e])&&(r[e]=a(r[e]));return((...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t})(...r)}},37430:(e,t,r)=>{"use strict";r.d(t,{d:()=>i,e:()=>o});class n{constructor(e){if(!(e>0)||0!=(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class s{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new n(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new n(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function i(e={}){return a((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),e)}function o(e={}){return a((e=>{let t;const r=[];for(;!e.isEmpty()&&(t=e.shift(),null!=t);){if(null!=t.error)throw t.error;!1===t.done&&r.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:r}}),e)}function a(e,t){let r,n,i,o=(t=t??{}).onEnd,a=new s;const c=e=>null!=n?n(e):(a.push(e),r),h=e=>{if(i)return r;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},l=e=>i?r:(i=!0,null!=e?(e=>(a=new s,null!=n?n({error:e}):(a.push({error:e}),r)))(e):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>a.isEmpty()?i?{done:!0}:await new Promise(((t,s)=>{n=i=>{n=null,a.push(i);try{t(e(a))}catch(e){s(e)}return r}})):e(a),return:()=>(a=new s,l(),{done:!0}),throw:e=>(l(e),{done:!0}),push:h,end:l,get readableLength(){return a.size}},null==o)return r;const u=r;return r={[Symbol.asyncIterator](){return this},next:()=>u.next(),throw:e=>(u.throw(e),null!=o&&(o(e),o=void 0),{done:!0}),return:()=>(u.return(),null!=o&&(o(),o=void 0),{done:!0}),push:h,end:e=>(u.end(e),null!=o&&(o(e),o=void 0),r),get readableLength(){return u.readableLength}},r}},93489:(e,t,r)=>{"use strict";r.d(t,{r:()=>s});var n=r(90581);function s(e){const t=async function*(){let t=yield,r=new n.H;for await(const s of e)if(null!=t)for(r.append(s);r.length>=t;){const e=r.sublist(0,t);if(r.consume(t),t=yield e,null==t){r.length>0&&(t=yield r,r=new n.H);break}}else r.append(s),t=yield r,r=new n.H;if(null!=t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:r})}();return t.next(),t}},46380:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(33686);async function*s(e,t){const r=await(0,n.Z)(e);yield*r.sort(t)}},44363:(e,t,r)=>{"use strict";async function*n(e,t){let r=0;if(!(t<1))for await(const n of e)if(yield n,r++,r===t)return}r.d(t,{Z:()=>n})},36672:(e,t,r)=>{"use strict";r.d(t,{P:()=>dt});var n={};r.r(n),r.d(n,{identity:()=>x});var s={};r.r(s),r.d(s,{base2:()=>R});var i={};r.r(i),r.d(i,{base8:()=>P});var o={};r.r(o),r.d(o,{base10:()=>D});var a={};r.r(a),r.d(a,{base16:()=>O,base16upper:()=>N});var c={};r.r(c),r.d(c,{base32:()=>L,base32hex:()=>V,base32hexpad:()=>j,base32hexpadupper:()=>F,base32hexupper:()=>z,base32pad:()=>B,base32padupper:()=>M,base32upper:()=>U,base32z:()=>$});var h={};r.r(h),r.d(h,{base36:()=>q,base36upper:()=>K});var l={};r.r(l),r.d(l,{base58btc:()=>H,base58flickr:()=>G});var u={};r.r(u),r.d(u,{base64:()=>W,base64pad:()=>J,base64url:()=>Y,base64urlpad:()=>Q});var d={};r.r(d),r.d(d,{base256emoji:()=>te});var f={};r.r(f),r.d(f,{sha256:()=>Ae,sha512:()=>Se});var p={};r.r(p),r.d(p,{identity:()=>Ce});var y={};r.r(y),r.d(y,{code:()=>Ie,decode:()=>xe,encode:()=>Te,name:()=>ke});var g={};r.r(g),r.d(g,{code:()=>Oe,decode:()=>Le,encode:()=>Ne,name:()=>De});var b=r(90581);var m=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const w=m,v=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class E{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return _(this,e)}}class S{constructor(e){this.decoders=e}or(e){return _(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _=(e,t)=>new S({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class C{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new E(e,t,r),this.decoder=new A(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const k=({name:e,prefix:t,encode:r,decode:n})=>new C(e,t,r,n),I=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=w(r,t);return k({prefix:e,name:t,encode:n,decode:e=>v(s(e))})},T=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>k({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),x=k({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),R=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),P=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),D=I({prefix:"9",name:"base10",alphabet:"0123456789"}),O=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),N=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),L=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),U=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),z=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),q=I({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),K=I({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),H=I({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),G=I({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Q=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Z=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),X=Z.reduce(((e,t,r)=>(e[r]=t,e)),[]),ee=Z.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const te=k({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=X[t]),"")},decode:function(e){const t=[];for(const r of e){const e=ee[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var re=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ne;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ne=Math.pow(2,31);var se=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var ie=Math.pow(2,7),oe=Math.pow(2,14),ae=Math.pow(2,21),ce=Math.pow(2,28),he=Math.pow(2,35),le=Math.pow(2,42),ue=Math.pow(2,49),de=Math.pow(2,56),fe=Math.pow(2,63);const pe={encode:re,decode:se,encodingLength:function(e){return e<ie?1:e<oe?2:e<ae?3:e<ce?4:e<he?5:e<le?6:e<ue?7:e<de?8:e<fe?9:10}},ye=(e,t,r=0)=>(pe.encode(e,t,r),t),ge=e=>pe.encodingLength(e),be=(e,t)=>{const r=t.byteLength,n=ge(e),s=n+ge(r),i=new Uint8Array(s+r);return ye(e,i,0),ye(r,i,n),i.set(t,s),new me(e,r,t,i)};class me{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const we=({name:e,code:t,encode:r})=>new ve(e,t,r);class ve{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?be(this.code,t):t.then((e=>be(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ee=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Ae=we({name:"sha2-256",code:18,encode:Ee("SHA-256")}),Se=we({name:"sha2-512",code:19,encode:Ee("SHA-512")}),_e=v,Ce={code:0,name:"identity",encode:_e,digest:e=>be(0,_e(e))},ke="raw",Ie=85,Te=e=>v(e),xe=e=>v(e),Re=new TextEncoder,Pe=new TextDecoder,De="json",Oe=512,Ne=e=>Re.encode(JSON.stringify(e)),Le=e=>JSON.parse(Pe.decode(e));new WeakMap;class Ue{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ue.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Ue.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ue.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t||base58btc.encoder):toStringV1(r,baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Ue)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Ue(e,r,n,s||encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Ue.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Ue(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new Ue(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Ue.create(0,DAG_PB_CODE,e)}static createV1(e,t){return Ue.create(1,e,t)}static decode(e){const[t,r]=Ue.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Ue.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Ue.createV0(i):Ue.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),s=Ue.decode(n);return baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Be={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Me(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ve(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ze=Ve("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),je=Ve("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Me(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Fe={utf8:ze,"utf-8":ze,hex:Be.base16,latin1:je,ascii:je,binary:je,...Be};function $e(e,t="utf8"){const r=Fe[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function qe(e,t="utf8"){const r=Fe[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Me(globalThis.Buffer.from(e,"utf-8"))}"0".charCodeAt(0),qe("ustar\0","binary"),qe("ustar ","binary"),qe(" \0","binary");r(93489);var Ke=r(71993),He=r(48438);const Ge="0".charCodeAt(0),We=qe("ustar\0","binary"),Je=qe("00","binary"),Ye=parseInt("7777",8),Qe=function(e,t){const r=e.toString(8);return r.length>t?qe("7777777777777777777".slice(0,t)+" "):qe("0000000000000000000".slice(0,t-r.length)+r+" ")},Ze=function(e){const t=qe(e).byteLength;let r=Math.floor(Math.log(t)/Math.log(10))+1;return t+r>=Math.pow(10,r)&&r++,`${t+r}${e}`};function Xe(e){const t=new Uint8Array(512);let r=e.name,n="";if(5===e.typeflag&&"/"!==r[r.length-1]&&(r+="/"),qe(r).byteLength!==r.length)return null;for(;qe(r).byteLength>100;){const e=r.indexOf("/");if(-1===e)return null;n+=""!==n?"/"+r.slice(0,e):r.slice(0,e),r=r.slice(e+1)}return qe(r).byteLength>100||qe(n).byteLength>155||null!=e.linkname&&qe(e.linkname).byteLength>100?null:(t.set(qe(r),0),t.set(Qe(e.mode&Ye,6),100),t.set(Qe(e.uid,6),108),t.set(Qe(e.gid,6),116),t.set(Qe(e.size,11),124),t.set(Qe(e.mtime.getTime()/1e3|0,11),136),t[156]=Ge+function(e){switch(e){case"file":default:return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}}(e.type),null!=e.linkname&&t.set(qe(e.linkname),157),t.set(We,257),t.set(Je,263),null!=e.uname&&t.set(qe(e.uname),265),null!=e.gname&&t.set(qe(e.gname),297),t.set(Qe(e.devmajor??0,6),329),t.set(Qe(e.devminor??0,6),337),null!=n&&t.set(qe(n),345),t.set(Qe(function(e){let t=256;for(let r=0;r<148;r++)t+=e[r];for(let r=156;r<512;r++)t+=e[r];return t}(t),6),148),t)}const{S_IFMT:et,S_IFBLK:tt,S_IFCHR:rt,S_IFDIR:nt,S_IFIFO:st,S_IFLNK:it}=Ke,ot=parseInt("755",8),at=parseInt("644",8),ct=new Uint8Array(1024);function ht(e=0){switch(e&et){case tt:return"block-device";case rt:return"character-device";case nt:return"directory";case st:return"fifo";case it:return"symlink";default:return"file"}}function lt(e){return 0!==(e&=511)?ct.subarray(0,512-e):new Uint8Array(0)}function ut(e){if(null==e.pax){const t=Xe(e);if(null!=t)return t}return function(e){const t=function(e){let t="";null!=e.name&&(t+=Ze(" path="+e.name+"\n")),null!=e.linkname&&(t+=Ze(" linkpath="+e.linkname+"\n"));const r=e.pax;if(null!=r)for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t+=Ze(" "+e+"="+r[e]+"\n"));return qe(t)}(e),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname,uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};return new b.H(Xe(r)??new Uint8Array(0),t,lt(t.length),Xe({...r,size:e.size,type:e.type})??new Uint8Array(0)).subarray()}(e)}function dt(){return async function*(e){for await(let{header:t,body:r}of e){const e={...t,size:"symlink"===t.type?0:t.size??0,type:t.type??ht(t.mode),mode:t.mode??("directory"===t.type?ot:at),uid:t.uid??0,gid:t.gid??0,mtime:t.mtime??new Date};if("string"==typeof r&&(r=qe(r)),r instanceof Uint8Array||(0,b.Z)(r)){e.size=r.length,yield ut(e),yield(0,b.Z)(r)?r.subarray():r,yield lt(e.size);continue}if("symlink"===e.type&&null==e.linkname){if(null==r)throw new Error("type was symlink but no linkname or body specified");e.linkname=$e(await(0,He.Z)(r)),yield ut(e);continue}if(yield ut(e),"file"!==e.type&&"contiguous-file"!==e.type)continue;let n=0;for await(const e of r??[])n+=e.length,yield(0,b.Z)(e)?e.subarray():e;if(n!==e.size)throw new Error(`size mismatch, wrote ${n} of ${e.size} bytes`);yield lt(e.size)}yield ct}}},48438:(e,t,r)=>{"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function s(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?n(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}(t);let s=0;for(const t of e)r.set(t,s),s+=t.length;return n(r)}async function i(e){let t=new Uint8Array(0);for await(const r of e)t=s([t,r],t.length+r.length);return t}r.d(t,{Z:()=>i})},26679:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var n=function(e,t,r){var n,i,o;Array.isArray(t)&&(n=t.slice(0));"string"==typeof t&&(n=t.split("."));"symbol"==typeof t&&(n=[t]);if(!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(!(i=n.pop()))return!1;s(i);for(;o=n.shift();)if(s(o),void 0===e[o]&&(e[o]={}),!(e=e[o])||"object"!=typeof e)return!1;return e[i]=r,!0};function s(e){if("__proto__"==e||"constructor"==e||"prototype"==e)throw new Error("setting of prototype values not supported")}},15029:(e,t,r)=>{"use strict";r.d(t,{N:()=>ra});var n={};r.r(n),r.d(n,{identity:()=>rt});var s={};r.r(s),r.d(s,{base2:()=>nt});var i={};r.r(i),r.d(i,{base8:()=>st});var o={};r.r(o),r.d(o,{base10:()=>it});var a={};r.r(a),r.d(a,{base16:()=>ot,base16upper:()=>at});var c={};r.r(c),r.d(c,{base32:()=>ct,base32hex:()=>dt,base32hexpad:()=>pt,base32hexpadupper:()=>yt,base32hexupper:()=>ft,base32pad:()=>lt,base32padupper:()=>ut,base32upper:()=>ht,base32z:()=>gt});var h={};r.r(h),r.d(h,{base36:()=>bt,base36upper:()=>mt});var l={};r.r(l),r.d(l,{base58btc:()=>wt,base58flickr:()=>vt});var u={};r.r(u),r.d(u,{base64:()=>Et,base64pad:()=>At,base64url:()=>St,base64urlpad:()=>_t});var d={};r.r(d),r.d(d,{base256emoji:()=>Tt});var f={};r.r(f),r.d(f,{sha256:()=>Yt,sha512:()=>Qt});var p={};r.r(p),r.d(p,{identity:()=>Xt});var y={};r.r(y),r.d(y,{code:()=>tr,decode:()=>nr,encode:()=>rr,name:()=>er});var g={};r.r(g),r.d(g,{code:()=>ar,decode:()=>hr,encode:()=>cr,name:()=>or});var b={};r.r(b),r.d(b,{identity:()=>zn});var m={};r.r(m),r.d(m,{base2:()=>jn});var w={};r.r(w),r.d(w,{base8:()=>Fn});var v={};r.r(v),r.d(v,{base10:()=>$n});var E={};r.r(E),r.d(E,{base16:()=>qn,base16upper:()=>Kn});var A={};r.r(A),r.d(A,{base32:()=>Hn,base32hex:()=>Yn,base32hexpad:()=>Zn,base32hexpadupper:()=>Xn,base32hexupper:()=>Qn,base32pad:()=>Wn,base32padupper:()=>Jn,base32upper:()=>Gn,base32z:()=>es});var S={};r.r(S),r.d(S,{base36:()=>ts,base36upper:()=>rs});var _={};r.r(_),r.d(_,{base58btc:()=>ns,base58flickr:()=>ss});var C={};r.r(C),r.d(C,{base64:()=>is,base64pad:()=>os,base64url:()=>as,base64urlpad:()=>cs});var k={};r.r(k),r.d(k,{base256emoji:()=>ds});var I={};r.r(I),r.d(I,{sha256:()=>Os,sha512:()=>Ns});var T={};r.r(T),r.d(T,{identity:()=>Us});var x={};r.r(x),r.d(x,{code:()=>Ms,decode:()=>zs,encode:()=>Vs,name:()=>Bs});var R={};r.r(R),r.d(R,{code:()=>qs,decode:()=>Hs,encode:()=>Ks,name:()=>$s});var P,D,O=r(38461),N=r(46857),L=r(57447),U=r(85404),B=r(32114);!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(P||(P={})),function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TIMEOUT="ERR_TIMEOUT",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED"}(D||(D={}));var M=r(44752),V=r(21007);async function*z(e,t){yield*(0,V.Z)(e,(async e=>(await t.addressBook.add(e.id,e.multiaddrs),e)))}function j(e){const t=new Set;return(0,M.Z)(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}async function*F(e,t=1){let r=0;for await(const t of e)r++,yield t;if(r<t)throw B(new Error("not found"),"NOT_FOUND")}var $=r(10715),q=r(52019),K=r(88211),H=r(91486),G=r(93361),W=r(27695),J=r(17187);const Y=(0,O.kg)("libp2p:peer-routing");class Q{constructor(e,t){this.components=e,this.routers=t.routers,this.refreshManagerInit=t.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||0===this.routers.length||null!=this.timeoutId||!1===this.refreshManagerInit.enabled||(this.timeoutId=(0,W.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(null==this.abortController)try{this.abortController=new $.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(0,J.setMaxListeners)?.(1/0,this.abortController.signal)}catch{}await(0,G.Z)(this.getClosestPeers(this.components.peerId.toBytes(),{signal:this.abortController.signal}))}catch(e){Y.error(e)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,W.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(e,t){if(0===this.routers.length)throw B(new Error("No peer routers available"),D.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.peerId.toString())throw B(new Error("Should not try to find self"),D.ERR_FIND_SELF);const r=await(0,K.zG)((0,q.Z)(...this.routers.map((r=>async function*(){try{yield await r.findPeer(e,t)}catch(e){Y.error(e)}}()))),(e=>(0,M.Z)(e,Boolean)),(e=>z(e,this.components.peerStore)),(async e=>await(0,H.Z)(e)));if(null!=r)return r;throw B(new Error(P.NOT_FOUND),D.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw B(new Error("No peer routers available"),D.ERR_NO_ROUTERS_AVAILABLE);yield*(0,K.zG)((0,q.Z)(...this.routers.map((r=>r.getClosestPeers(e,t)))),(e=>z(e,this.components.peerStore)),(e=>j(e)),(e=>F(e)))}}class Z{constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(0===this.routers.length)throw B(new Error("No content this.routers available"),D.ERR_NO_ROUTERS_AVAILABLE);yield*(0,K.zG)((0,q.Z)(...this.routers.map((r=>r.findProviders(e,t)))),(e=>z(e,this.components.peerStore)),(e=>j(e)),(e=>F(e)))}async provide(e,t={}){if(0===this.routers.length)throw B(new Error("No content routers available"),D.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async r=>await r.provide(e,t))))}async put(e,t,r){if(!this.isStarted())throw B(new Error(P.NOT_STARTED_YET),D.DHT_NOT_STARTED);const n=this.components.dht;null!=n&&await(0,G.Z)(n.put(e,t,r))}async get(e,t){if(!this.isStarted())throw B(new Error(P.NOT_STARTED_YET),D.DHT_NOT_STARTED);const r=this.components.dht;if(null!=r)for await(const n of r.get(e,t))if("VALUE"===n.name)return n.value;throw B(new Error(P.NOT_FOUND),D.ERR_NOT_FOUND)}async*getMany(e,t,r){if(!this.isStarted())throw B(new Error(P.NOT_STARTED_YET),D.DHT_NOT_STARTED);if(null==t||0===t)return;let n=0;const s=this.components.dht;if(null!=s)for await(const i of s.get(e,r))if("VALUE"===i.name&&(yield{from:i.from,val:i.value},n++,n===t))break;if(0===n)throw B(new Error(P.NOT_FOUND),D.ERR_NOT_FOUND)}}var X=r(93203),ee=r(94306),te=r(682);function re(e){if((0,te.I)(e))return{id:e,multiaddrs:[],protocols:[]};let t;return"string"==typeof e&&(e=(0,ee.HM)(e)),(0,ee.h2)(e)&&(t=e,e=function(e){const t=e.getPeerId();if(null==t)throw B(new Error(`${e.toString()} does not have a valid peer type`),D.ERR_INVALID_MULTIADDR);try{return(0,X.jE)(t)}catch(t){throw B(new Error(`${e.toString()} is not a valid peer type`),D.ERR_INVALID_MULTIADDR)}}(e)),{id:e,multiaddrs:null!=t?[t]:[],protocols:[]}}const ne=e=>e;class se extends N.v{constructor(e,t){super();const{listen:r=[],announce:n=[]}=t;this.components=e,this.listen=new Set(r.map((e=>e.toString()))),this.announce=new Set(n.map((e=>e.toString()))),this.observed=new Set,this.announceFilter=t.announceFilter??ne}getListenAddrs(){return Array.from(this.listen).map((e=>(0,ee.HM)(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>(0,ee.HM)(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>(0,ee.HM)(e)))}confirmObservedAddr(e){}removeObservedAddr(e){}addObservedAddr(e){let t=(0,ee.HM)(e);const r=t.getPeerId();if(null!=r){(0,X.jE)(r).equals(this.components.peerId)&&(t=t.decapsulate((0,ee.HM)(`/p2p/${this.components.peerId.toString()}`)))}const n=t.toString();this.observed.has(n)||(this.observed.add(n),this.dispatchEvent(new N.A("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(this.getObservedAddrs().map((e=>e.toString())));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>(0,ee.HM)(e)))).map((e=>e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate(`/p2p/${this.components.peerId.toString()}`)))}}var ie=r(40726);const oe=(0,O.kg)("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class ae extends N.v{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",null!=globalThis.document&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",t="visibilitychange";void 0!==globalThis.document.hidden?(e="hidden",t="visibilitychange"):void 0!==globalThis.document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):void 0!==globalThis.document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==globalThis.document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=t}_addVisibilityChangeListener(){void 0===globalThis.document.addEventListener||void 0===document[this.hidden]?oe("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this.hidden&&void 0!==document[this.hidden])return null==document[this.hidden]}_handleVisibilityChange(){const e=!1===globalThis.document[this.hidden];oe(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new N.A("visibilityChange",{detail:e}))}}const ce=(0,O.kg)("libp2p:connection-manager:latency-monitor");class he extends N.v{constructor(e={}){super();const{latencyCheckIntervalMs:t,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:s}=e;this.latencyCheckIntervalMs=t??500,this.latencyRandomPercentage=s??10,this.latencyCheckMultiply=this.latencyRandomPercentage/100*2*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=null===r||0===r?void 0:r??5e3,ce("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),null!=this.dataEmitIntervalMs?ce("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):ce("Not emitting summaries"),this.asyncTestFn=n,null!=globalThis.process?.hrtime?(ce("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{const t=this.now(e);return 1e3*t[0]+t[1]/1e6}):"undefined"!=typeof window&&null!=window.performance?.now?(ce("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(ce("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this.latencyData=this.initLatencyData()}start(){void 0!==globalThis.window&&(this.visibilityChangeEmitter=new ae,this.visibilityChangeEmitter.addEventListener("visibilityChange",(e=>{const{detail:t}=e;t?this._startTimers():(this._emitSummary(),this._stopTimers())}))),!0===this.visibilityChangeEmitter?.isVisible()&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){null==this.checkLatencyID&&(this.checkLatency(),null!=this.dataEmitIntervalMs&&(this.emitIntervalID=setInterval((()=>this._emitSummary()),this.dataEmitIntervalMs),"function"==typeof this.emitIntervalID.unref&&this.emitIntervalID.unref()))}_stopTimers(){null!=this.checkLatencyID&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),null!=this.emitIntervalID&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const e=this.getSummary();e.events>0&&this.dispatchEvent(new N.A("data",{detail:e}))}getSummary(){const e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),ce.trace("Summary: %O",e),e}checkLatency(){const e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,t={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},r=()=>{if(null==this.checkLatencyID)return;const e=this.getDeltaMS(t.startTime)-t.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,e),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,e),this.latencyData.totalMs+=e,ce.trace("MS: %s Data: %O",e,this.latencyData)};ce.trace("localData: %O",t),this.checkLatencyID=setTimeout((()=>{null!=this.asyncTestFn?(t.deltaOffset=0,t.startTime=this.now(),this.asyncTestFn(r)):(t.deltaOffset-=1,r())}),t.deltaOffset),"function"==typeof this.checkLatencyID.unref&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}var le=r(82916);const ue="OPEN",de="CLOSING",fe="CLOSED";var pe=r(4542);var ye=r(8558);const ge=(0,O.kg)("libp2p:connection-manager"),be={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,inboundConnectionThreshold:5,maxIncomingPendingConnections:10},me="libp2p",we="connection-manager";class ve extends N.v{constructor(e,t){if(super(),this.opts=ie.Z.call({ignoreUndefined:!0},be,t),this.opts.maxConnections<this.opts.minConnections)throw B(new Error("Connection Manager maxConnections must be greater than minConnections"),D.ERR_INVALID_PARAMETERS);ge("options: %o",this.opts),this.components=e,this.connections=new Map,this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new he({latencyCheckIntervalMs:t.pollInterval,dataEmitIntervalMs:t.pollInterval});try{(0,J.setMaxListeners)?.(1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=t.startupReconnectTimeout??6e4,this.dialTimeout=t.dialTimeout??3e4,this.allow=(t.allow??[]).map((e=>(0,ee.HM)(e))),this.deny=(t.deny??[]).map((e=>(0,ee.HM)(e))),this.inboundConnectionRateLimiter=new ye.RateLimiterMemory({points:this.opts.inboundConnectionThreshold,duration:1}),this.incomingPendingConnections=0}isStarted(){return this.started}async start(){null!=this.components.metrics&&(this.timer=this.timer??le(this._checkMetrics,this.opts.pollInterval)),this.components.metrics?.updateComponentMetric({system:me,component:we,metric:"connections",label:"direction",value:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const r of t)"inbound"===r.stat.direction?e.inbound++:e.outbound++;return e}}),this.components.metrics?.updateComponentMetric({system:me,component:we,metric:"protocol-streams-total",label:"protocol",value:()=>{const e={};for(const t of this.connections.values())for(const r of t)for(const t of r.streams){const r=`${t.stat.direction} ${t.stat.protocol??"unnegotiated"}`;e[r]=(e[r]??0)+1}return e}}),this.components.metrics?.updateComponentMetric({system:me,component:we,metric:"protocol-streams-per-connection-90th-percentile",label:"protocol",value:()=>{const e={};for(const t of this.connections.values())for(const r of t){const t={};for(const e of r.streams){const r=`${e.stat.direction} ${e.stat.protocol??"unnegotiated"}`;t[r]=(t[r]??0)+1}for(const[r,n]of Object.entries(t))e[r]=e[r]??[],e[r].push(n)}const t={};for(let[r,n]of Object.entries(e)){n=n.sort(((e,t)=>e-t));const e=Math.floor(.9*n.length);t[r]=n[e]}return t}}),this.latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor.addEventListener("data",this._onLatencyMeasure),this.started=!0,ge("started")}async afterStart(){this.components.upgrader.addEventListener("connection",this.onConnect),this.components.upgrader.addEventListener("connectionEnd",this.onDisconnect),Promise.resolve().then((async()=>{const e=[];for(const t of await this.components.peerStore.all()){(await this.components.peerStore.getTags(t.id)).filter((e=>"keep-alive"===e.name)).length>0&&e.push(t.id)}this.connectOnStartupController?.clear(),this.connectOnStartupController=new $.TimeoutController(this.startupReconnectTimeout);try{(0,J.setMaxListeners)?.(1/0,this.connectOnStartupController.signal)}catch{}await Promise.all(e.map((async e=>{await this.openConnection(e,{signal:this.connectOnStartupController?.signal}).catch((e=>{ge.error(e)}))})))})).catch((e=>{ge.error(e)})).finally((()=>{this.connectOnStartupController?.clear()}))}async beforeStop(){this.connectOnStartupController?.abort(),this.components.upgrader.removeEventListener("connection",this.onConnect),this.components.upgrader.removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.timer?.clear(),this.latencyMonitor.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor.stop(),this.started=!1,await this._close(),ge("stopped")}async _close(){const e=[];for(const t of this.connections.values())for(const r of t)e.push((async()=>{try{await r.close()}catch(e){ge.error(e)}})());ge("closing %d connections",e.length),await Promise.all(e),this.connections.clear()}async _checkMetrics(){const e=this.components.metrics;if(null!=e)try{const t=e.getGlobal().getMovingAverages(),r=t.dataReceived[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxReceivedData",r);const n=t.dataSent[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxSentData",n);const s=r+n;await this._checkMaxLimit("maxData",s),ge.trace("metrics update",s)}finally{this.timer=le(this._checkMetrics,this.opts.pollInterval)}}onConnect(e){this._onConnect(e).catch((e=>{ge.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const r=t.remotePeer,n=r.toString(),s=this.connections.get(n);null!=s?s.push(t):this.connections.set(n,[t]),null!=r.publicKey&&await this.components.peerStore.keyBook.set(r,r.publicKey);const i=this.getConnections().length,o=i-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",i,o),this.dispatchEvent(new N.A("peer:connect",{detail:t}))}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const r=t.remotePeer.toString();let n=this.connections.get(r);null!=n&&n.length>1?(n=n.filter((e=>e.id!==t.id)),this.connections.set(r,n)):null!=n&&(this.connections.delete(r),this.dispatchEvent(new N.A("peer:disconnect",{detail:t})),this.components.metrics?.onPeerDisconnected(t.remotePeer))}getConnections(e){if(null!=e)return this.connections.get(e.toString())??[];let t=[];for(const e of this.connections.values())t=t.concat(e);return t}async openConnection(e,t={}){ge("dial to %p",e);const r=this.getConnections(e);if(r.length>0)return ge("had an existing connection to %p",e),r[0];let n;if(null==t?.signal){n=new $.TimeoutController(this.dialTimeout),t.signal=n.signal;try{(0,J.setMaxListeners)?.(1/0,n.signal)}catch{}}try{const r=await this.components.dialer.dial(e,t);let s=this.connections.get(e.toString());null==s&&(s=[],this.connections.set(e.toString(),s));let i=!1;for(const e of s)e.id===r.id&&(i=!0);return i||s.push(r),r}finally{null!=n&&n.clear()}}async closeConnections(e){const t=this.connections.get(e.toString())??[];await Promise.all(t.map((async e=>await e.close())))}getAll(e){if(!(0,te.I)(e))throw B(new Error("peerId must be an instance of peer-id"),D.ERR_INVALID_PARAMETERS);const t=e.toString(),r=this.connections.get(t);return null!=r?r.filter((e=>e.stat.status===ue)):[]}_onLatencyMeasure(e){const{detail:t}=e;this._checkMaxLimit("maxEventLoopDelay",t.avgMs,1).catch((e=>{ge.error(e)}))}async _checkMaxLimit(e,t,r=1){const n=this.opts[e];ge.trace("checking limit of %s. current value: %d of %d",e,t,n),t>n&&(ge("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",this.components.peerId,e,t,n,r),await this._pruneConnections(r))}async _pruneConnections(e){const t=this.getConnections(),r=new pe.ji;for(const e of t){const t=e.remotePeer;if(r.has(t))continue;const n=await this.components.peerStore.getTags(t);r.set(t,n.reduce(((e,t)=>e+t.value),0))}const n=t.sort(((e,t)=>{const n=r.get(e.remotePeer)??0,s=r.get(t.remotePeer)??0;return n>s?1:n<s?-1:0})),s=[];for(const t of n)if(ge("too many connections open - closing a connection to %p",t.remotePeer),s.push(t),s.length===e)break;await Promise.all(s.map((async e=>{try{await e.close()}catch(e){ge.error(e)}this.onDisconnect(new N.A("connectionEnd",{detail:e}))})))}async acceptIncomingConnection(e){if(this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return ge("connection from %s refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.opts.maxIncomingPendingConnections)return ge("connection from %s refused - incomingPendingConnections exceeded by peer %s",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return ge("connection from %s refused - inboundConnectionThreshold exceeded by host %s",t,e.remoteAddr),!1}}return this.getConnections().length<this.opts.maxConnections?(this.incomingPendingConnections++,!0):(ge("connection from %s refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}}var Ee=r(33686),Ae=r(46380);const Se=(0,O.kg)("libp2p:connection-manager:auto-dialler"),_e={enabled:!0,minConnections:0,autoDialInterval:1e4};class Ce{constructor(e,t){this.components=e,this.options=ie.Z.call({ignoreUndefined:!0},_e,t),this.running=!1,this._autoDial=this._autoDial.bind(this),Se("options: %j",this.options)}isStarted(){return this.running}async start(){this.options.enabled?(this.running=!0,this._autoDial().catch((e=>{Se.error("could start autodial",e)})),Se("started")):Se("not enabled")}async stop(){this.options.enabled?(this.running=!1,null!=this.autoDialTimeout&&this.autoDialTimeout.clear(),Se("stopped")):Se("not enabled")}async _autoDial(){null!=this.autoDialTimeout&&this.autoDialTimeout.clear();const e=this.options.minConnections;if(this.components.connectionManager.getConnections().length>=e)return void(this.autoDialTimeout=le(this._autoDial,this.options.autoDialInterval));const t=await this.components.peerStore.all(),r=await(0,K.zG)(t.sort((()=>Math.random()>.5?1:-1)),(e=>(0,M.Z)(e,(e=>!e.id.equals(this.components.peerId)))),(e=>(0,Ae.Z)(e,((e,t)=>t.protocols.length>e.protocols.length||null!=t.id.publicKey&&null==e.id.publicKey?1:-1))),(async e=>await(0,Ee.Z)(e)));for(let t=0;this.running&&t<r.length&&this.components.connectionManager.getConnections().length<e;t++){if(!this.running)return;const e=r[t];if(0===this.components.connectionManager.getConnections(e.id).length){Se("connecting to a peerStore stored peer %p",e.id);try{await this.components.connectionManager.openConnection(e.id)}catch(e){Se.error("could not connect to peerStore stored peer",e)}}}this.running&&(this.autoDialTimeout=le(this._autoDial,this.options.autoDialInterval))}}var ke,Ie=r(76237),Te=r(46888);!function(e){let t,r,n,s,i,o;!function(e){e.SUCCESS="SUCCESS",e.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",e.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",e.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",e.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",e.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",e.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",e.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",e.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",e.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",e.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",e.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",e.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",e.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",e.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE"}(t=e.Status||(e.Status={})),function(e){e[e.SUCCESS=100]="SUCCESS",e[e.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",e[e.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",e[e.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",e[e.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",e[e.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",e[e.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",e[e.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",e[e.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",e[e.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",e[e.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",e[e.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",e[e.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",e[e.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",e[e.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"}(r||(r={})),function(e){e.codec=()=>(0,Te.Ji)(r)}(t=e.Status||(e.Status={})),function(e){e.HOP="HOP",e.STOP="STOP",e.STATUS="STATUS",e.CAN_HOP="CAN_HOP"}(n=e.Type||(e.Type={})),function(e){e[e.HOP=1]="HOP",e[e.STOP=2]="STOP",e[e.STATUS=3]="STATUS",e[e.CAN_HOP=4]="CAN_HOP"}(s||(s={})),function(e){e.codec=()=>(0,Te.Ji)(s)}(n=e.Type||(e.Type={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={id:new Uint8Array(0),addrs:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:r.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(i=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=(0,Te.yw)(((t,r,n={})=>{!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.srcPeer&&(r.uint32(18),e.Peer.codec().encode(t.srcPeer,r,{writeDefaults:!1})),null!=t.dstPeer&&(r.uint32(26),e.Peer.codec().encode(t.dstPeer,r,{writeDefaults:!1})),null!=t.code&&(r.uint32(32),e.Status.codec().encode(t.code,r)),!1!==n.lengthDelimited&&r.ldelim()}),((t,r)=>{const n={},s=null==r?t.len:t.pos+r;for(;t.pos<s;){const r=t.uint32();switch(r>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.srcPeer=e.Peer.codec().decode(t,t.uint32());break;case 3:n.dstPeer=e.Peer.codec().decode(t,t.uint32());break;case 4:n.code=e.Status.codec().decode(t);break;default:t.skipType(7&r)}}return n}))),o),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(ke||(ke={}));var xe=r(73861);const Re=(0,O.kg)("libp2p:stream:converter");function Pe(e,t={}){const{stream:r,remoteAddr:n}=e,{sink:s,source:i}=r,o=async function*(){for await(const e of i)yield*e}(),a={async sink(e){null!=t.signal&&(e=(0,xe.wJ)(e,t.signal));try{await s(e),await c()}catch(e){"aborted"!==e.type&&Re(e)}},source:null!=t.signal?(0,xe.wJ)(o,t.signal):o,remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(){await s(async function*(){yield new Uint8Array(0)}()),await c()}};async function c(){return null==a.timeline.close&&(a.timeline.close=Date.now()),await Promise.resolve()}return a}const De="/libp2p/circuit/relay/0.1.0";function Oe(e,t){e.write({type:ke.Type.STATUS,code:t})}function Ne(e,t){try{null!=e.dstPeer?.addrs&&e.dstPeer.addrs.forEach((e=>(0,ee.HM)(e)))}catch(r){throw Oe(t,e.type===ke.Type.HOP?ke.Status.HOP_DST_MULTIADDR_INVALID:ke.Status.STOP_DST_MULTIADDR_INVALID),r}try{null!=e.srcPeer?.addrs&&e.srcPeer.addrs.forEach((e=>(0,ee.HM)(e)))}catch(r){throw Oe(t,e.type===ke.Type.HOP?ke.Status.HOP_SRC_MULTIADDR_INVALID:ke.Status.STOP_SRC_MULTIADDR_INVALID),r}}var Le=r(55150),Ue=r(51816);const Be=(0,O.kg)("libp2p:circuit:stream-handler");class Me{constructor(e){const{stream:t,maxLength:r=4096}=e;this.stream=t,this.shake=(0,Ue.Y)(this.stream),this.decoder=Le.J.fromReader(this.shake.reader,{maxDataLength:r})}async read(){const e=await this.decoder.next();if(null!=e.value){const t=ke.decode(e.value);return Be("read message type",t.type),t}Be("read received no value, closing stream"),this.close()}write(e){Be("write message type %s",e.type),this.shake.write(Le.c.single(ke.encode(e)))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){Be("closing the stream"),this.rest().sink([]).catch((e=>{Be.error(e)}))}}const Ve=(0,O.kg)("libp2p:circuit:stop");const ze=(0,O.kg)("libp2p:circuit:hop");async function je(e){const{connection:t,request:r,streamHandler:n,circuit:s,connectionManager:i}=e;if(!s.hopEnabled())return ze("HOP request received but we are not acting as a relay"),n.end({type:ke.Type.STATUS,code:ke.Status.HOP_CANT_SPEAK_RELAY});try{Ne(r,n)}catch(e){return void ze.error("invalid hop request via peer %p %o",t.remotePeer,e)}if(null==r.dstPeer)return void ze("HOP request received but we do not receive a dstPeer");const o=(0,X.cv)(r.dstPeer.id),a=i.getConnections(o);if(0===a.length&&!s.hopActive())return ze("HOP request received but we are not connected to the destination peer"),n.end({type:ke.Type.STATUS,code:ke.Status.HOP_NO_CONN_TO_DST});if(0===a.length)return ze("did not have connection to remote peer"),n.end({type:ke.Type.STATUS,code:ke.Status.HOP_NO_CONN_TO_DST});const c={type:ke.Type.STOP,dstPeer:r.dstPeer,srcPeer:r.srcPeer};let h;try{ze("performing STOP request");const e=await async function(e){const{connection:t,request:r,signal:n}=e,s=await t.newStream(De,{signal:n});Ve("starting stop request to %p",t.remotePeer);const i=new Me({stream:s});i.write(r);const o=await i.read();if(null!=o){if(o.code===ke.Status.SUCCESS)return Ve("stop request to %p was successful",t.remotePeer),i.rest();Ve("stop request failed with code %d",o.code),i.close()}else i.close()}({connection:a[0],request:c});if(null==e)throw new Error("Could not stop");h=e}catch(e){return void ze.error(e)}ze("hop request from %p is valid",t.remotePeer),n.write({type:ke.Type.STATUS,code:ke.Status.SUCCESS});const l=n.rest();return ze("creating related connections"),await(0,K.zG)(l,h,l)}var Fe=r(12348);const $e=(0,O.kg)("libp2p:circuit");class qe{constructor(e,t){this._init=t,this.components=e,this._started=!1}isStarted(){return this._started}async start(){this._started||(this._started=!0,await this.components.registrar.handle(De,(e=>{this._onProtocol(e).catch((e=>{$e.error(e)}))})).catch((e=>{$e.error(e)})))}async stop(){await this.components.registrar.unhandle(De)}hopEnabled(){return!0}hopActive(){return!0}get[Fe.N](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(e){const{connection:t,stream:r}=e,n=new $.TimeoutController(this._init.hop.timeout);try{(0,J.setMaxListeners)?.(1/0,n.signal)}catch{}try{const e=(0,xe.D7)(r,n.signal),s=new Me({stream:{...r,...e}}),i=await s.read();if(null==i)return $e("request was invalid, could not read from stream"),s.write({type:ke.Type.STATUS,code:ke.Status.MALFORMED_MESSAGE}),void s.close();let o;switch(i.type){case ke.Type.CAN_HOP:$e("received CAN_HOP request from %p",t.remotePeer),await function(e){const{connection:t,streamHandler:r,circuit:n}=e,s=n.hopEnabled();ze("can hop (%s) request from %p",s,t.remotePeer),r.end({type:ke.Type.STATUS,code:s?ke.Status.SUCCESS:ke.Status.HOP_CANT_SPEAK_RELAY})}({circuit:this,connection:t,streamHandler:s});break;case ke.Type.HOP:$e("received HOP request from %p",t.remotePeer),await je({connection:t,request:i,streamHandler:s,circuit:this,connectionManager:this.components.connectionManager});break;case ke.Type.STOP:$e("received STOP request from %p",t.remotePeer),o=await function(e){const{connection:t,request:r,streamHandler:n}=e;try{Ne(r,n)}catch(e){return void Ve.error("invalid stop request via peer %p %o",t.remotePeer,e)}return Ve("stop request is valid"),n.write({type:ke.Type.STATUS,code:ke.Status.SUCCESS}),n.rest()}({connection:t,request:i,streamHandler:s});break;default:return $e("Request of type %s not supported",i.type),s.write({type:ke.Type.STATUS,code:ke.Status.MALFORMED_MESSAGE}),void s.close()}if(null!=o){const e=t.remoteAddr.encapsulate("/p2p-circuit").encapsulate((0,ee.HM)(i.dstPeer?.addrs[0])),r=Pe({stream:o,remoteAddr:e,localAddr:(0,ee.HM)(i.srcPeer?.addrs[0])}),n=i.type===ke.Type.HOP?"relay":"inbound";$e("new %s connection %s",n,r.remoteAddr);const s=await this.components.upgrader.upgradeInbound(r);$e("%s connection %s upgraded",n,r.remoteAddr),null!=this.handler&&this.handler(s)}}finally{n.clear()}}async dial(e,t={}){const r=e.toString().split("/p2p-circuit"),n=(0,ee.HM)(r[0]),s=(0,ee.HM)(r[r.length-1]),i=n.getPeerId(),o=s.getPeerId();if(null==i||null==o){const e="Circuit relay dial failed as addresses did not have peer id";throw $e.error(e),B(new Error(e),D.ERR_RELAYED_DIAL)}const a=(0,X.jE)(i),c=(0,X.jE)(o);let h=!1;let l=this.components.connectionManager.getConnections(a)[0];null==l&&(await this.components.peerStore.addressBook.add(a,[n]),l=await this.components.connectionManager.openConnection(a,t),h=!0);try{const r=await async function(e){const{connection:t,request:r,signal:n}=e,s=await t.newStream(De,{signal:n}),i=new Me({stream:s});i.write(r);const o=await i.read();if(null==o)throw B(new Error("HOP request had no response"),D.ERR_HOP_REQUEST_FAILED);if(o.code===ke.Status.SUCCESS)return ze("hop request was successful"),i.rest();throw ze("hop request failed with code %d, closing stream",o.code),i.close(),B(new Error(`HOP request failed with code "${o.code??"unknown"}"`),D.ERR_HOP_REQUEST_FAILED)}({...t,connection:l,request:{type:ke.Type.HOP,srcPeer:{id:this.components.peerId.toBytes(),addrs:this.components.addressManager.getAddresses().map((e=>e.bytes))},dstPeer:{id:c.toBytes(),addrs:[(0,ee.HM)(s).bytes]}}}),i=Pe({stream:r,remoteAddr:e,localAddr:n.encapsulate(`/p2p-circuit/p2p/${this.components.peerId.toString()}`)});return $e("new outbound connection %s",i.remoteAddr),await this.components.upgrader.upgradeOutbound(i)}catch(e){throw $e.error("Circuit relay dial failed",e),h&&await l.close(),e}}createListener(e){return this.handler=e.handler,function(e){const t=new Map,r=Object.assign(new N.v,{close:async()=>await Promise.resolve(),listen:async function(n){const s=n.toString().split("/p2p-circuit").find((e=>""!==e)),i=(0,ee.HM)(s),o=i.getPeerId();if(null==o)throw new Error("Could not determine relay peer from multiaddr");const a=(0,X.jE)(o);await e.peerStore.addressBook.add(a,[i]);const c=await e.connectionManager.openConnection(a),h=c.remoteAddr.encapsulate("/p2p-circuit");t.set(c.remotePeer.toString(),h),r.dispatchEvent(new N.A("listening"))},getAddrs:function(){const e=[];for(const r of t.values())e.push(r);return e}});return e.connectionManager.addEventListener("peer:disconnect",(e=>{const{detail:n}=e;t.delete(n.remotePeer.toString())&&r.dispatchEvent(new N.A("close"))})),r}({connectionManager:this.components.connectionManager,peerStore:this.components.peerStore})}filter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>Ie.dx.matches(e)))}}var Ke=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const He=Ke,Ge=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class We{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Je{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Qe(this,e)}}class Ye{constructor(e){this.decoders=e}or(e){return Qe(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Qe=(e,t)=>new Ye({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ze{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new We(e,t,r),this.decoder=new Je(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Xe=({name:e,prefix:t,encode:r,decode:n})=>new Ze(e,t,r,n),et=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=He(r,t);return Xe({prefix:e,name:t,encode:n,decode:e=>Ge(s(e))})},tt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Xe({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),rt=Xe({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),nt=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),st=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),it=et({prefix:"9",name:"base10",alphabet:"0123456789"}),ot=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),at=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ct=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ht=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lt=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ut=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dt=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ft=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pt=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yt=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gt=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),bt=et({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mt=et({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),wt=et({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vt=et({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Et=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),At=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),St=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_t=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ct=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),kt=Ct.reduce(((e,t,r)=>(e[r]=t,e)),[]),It=Ct.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const Tt=Xe({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=kt[t]),"")},decode:function(e){const t=[];for(const r of e){const e=It[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var xt=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=Rt;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},Rt=Math.pow(2,31);var Pt=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var Dt=Math.pow(2,7),Ot=Math.pow(2,14),Nt=Math.pow(2,21),Lt=Math.pow(2,28),Ut=Math.pow(2,35),Bt=Math.pow(2,42),Mt=Math.pow(2,49),Vt=Math.pow(2,56),zt=Math.pow(2,63);const jt={encode:xt,decode:Pt,encodingLength:function(e){return e<Dt?1:e<Ot?2:e<Nt?3:e<Lt?4:e<Ut?5:e<Bt?6:e<Mt?7:e<Vt?8:e<zt?9:10}},Ft=(e,t=0)=>[jt.decode(e,t),jt.decode.bytes],$t=(e,t,r=0)=>(jt.encode(e,t,r),t),qt=e=>jt.encodingLength(e),Kt=(e,t)=>{const r=t.byteLength,n=qt(e),s=n+qt(r),i=new Uint8Array(s+r);return $t(e,i,0),$t(r,i,n),i.set(t,s),new Ht(e,r,t,i)};class Ht{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Gt=({name:e,code:t,encode:r})=>new Wt(e,t,r);class Wt{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Kt(this.code,t):t.then((e=>Kt(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Jt=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Yt=Gt({name:"sha2-256",code:18,encode:Jt("SHA-256")}),Qt=Gt({name:"sha2-512",code:19,encode:Jt("SHA-512")}),Zt=Ge,Xt={code:0,name:"identity",encode:Zt,digest:e=>Kt(0,Zt(e))},er="raw",tr=85,rr=e=>Ge(e),nr=e=>Ge(e),sr=new TextEncoder,ir=new TextDecoder,or="json",ar=512,cr=e=>sr.encode(JSON.stringify(e)),hr=e=>JSON.parse(ir.decode(e)),lr=new WeakMap,ur=e=>{const t=lr.get(e);if(null==t){const t=new Map;return lr.set(e,t),t}return t};class dr{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==gr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==br)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return dr.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Kt(e,t);return dr.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return dr.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&((e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(e.bytes,r.bytes)}})(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?pr(r,ur(e),t||wt.encoder):yr(r,ur(e),t||ct.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof dr)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new dr(e,r,n,s||mr(e,r,n.bytes))}if(!0===t[wr]){const{version:e,multihash:r,code:n}=t,s=(e=>{const t=Ge(e),[r,n]=Ft(t),[s,i]=Ft(t.subarray(n)),o=t.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Ht(r,s,o,t)})(r);return dr.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==gr)throw new Error(`Version 0 CID must use dag-pb (code: ${gr}) block encoding`);return new dr(e,t,r,r.bytes);case 1:{const n=mr(e,t,r.bytes);return new dr(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return dr.create(0,gr,e)}static createV1(e,t){return dr.create(1,e,t)}static decode(e){const[t,r]=dr.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=dr.inspectBytes(e),r=t.size-t.multihashSize,n=Ge(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Ht(t.multihashCode,t.digestSize,s,n);return[0===t.version?dr.createV0(i):dr.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Ft(e.subarray(t));return t+=n,r};let n=r(),s=gr;if(18===n?(n=0,t=0):s=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=fr(e,t),s=dr.decode(n);return ur(s).set(r,e),s}}const fr=(e,t)=>{switch(e[0]){case"Q":{const r=t||wt;return[wt.prefix,r.decode(`${wt.prefix}${e}`)]}case wt.prefix:{const r=t||wt;return[wt.prefix,r.decode(e)]}case ct.prefix:{const r=t||ct;return[ct.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},pr=(e,t,r)=>{const{prefix:n}=r;if(n!==wt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},yr=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},gr=112,br=18,mr=(e,t,r)=>{const n=qt(e),s=n+qt(t),i=new Uint8Array(s+r.byteLength);return $t(e,i,0),$t(t,i,n),i.set(r,s),i},wr=Symbol.for("@ipld/js-cid/CID"),vr={...n,...s,...i,...o,...a,...c,...h,...l,...u,...d};function Er(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ar(e=0){return null!=globalThis.Buffer?.allocUnsafe?Er(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Sr(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const _r=Sr("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Cr=Sr("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=Ar((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),kr={utf8:_r,"utf-8":_r,hex:vr.base16,latin1:Cr,ascii:Cr,binary:Cr,...vr};function Ir(e,t="utf8"){const r=kr[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Er(globalThis.Buffer.from(e,"utf-8"))}function Tr(e,t="utf8"){const r=kr[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}async function xr(e){const t=(new TextEncoder).encode(e),r=await Yt.digest(t);return dr.createV0(r)}const Rr="hop_relay",Pr="true",Dr="/libp2p/relay";var Or=r(290);function Nr(e){const{address:t}=e.nodeAddress();return Boolean(Or(t))}function Lr(e,t){const r=Nr(e.multiaddr),n=Nr(t.multiaddr);return r&&!n?1:!r&&n||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}const Ur=(0,O.kg)("libp2p:auto-relay"),Br=()=>{};class Mr{constructor(e,t){this.components=e,this.addressSorter=t.addressSorter??Lr,this.maxListeners=t.maxListeners??1,this.listenRelays=new Set,this.onError=t.onError??Br,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.peerStore.addEventListener("change:protocols",(e=>{this._onProtocolChange(e).catch((e=>{Ur.error(e)}))})),this.components.connectionManager.addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(e){const{peerId:t,protocols:r}=e.detail,n=t.toString();if(null!=r.find((e=>e===De))){if(!this.listenRelays.has(n))try{const e=this.components.connectionManager.getConnections(t);if(0===e.length)return;const r=e[0];if(r.remoteAddr.protoCodes().includes(290))return void Ur(`relayed connection to ${n} will not be used to hop on`);const s=await async function(e){const{connection:t,signal:r}=e,n=await t.newStream(De,{signal:r}),s=new Me({stream:n});s.write({type:ke.Type.CAN_HOP});const i=await s.read();return await s.close(),null!=i&&i.code===ke.Status.SUCCESS}({connection:r});s&&(await this.components.peerStore.metadataBook.setValue(t,Rr,Ir(Pr)),await this._addListenRelay(r,n))}catch(e){this.onError(e)}}else this.listenRelays.has(n)&&await this._removeListenRelay(n)}_onPeerDisconnected(e){const t=e.detail.remotePeer.toString();this.listenRelays.has(t)&&this._removeListenRelay(t).catch((e=>{Ur.error(e)}))}async _addListenRelay(e,t){try{if(this.listenRelays.size>=this.maxListeners)return;const r=await(0,K.zG)(await this.components.peerStore.addressBook.get(e.remotePeer),(e=>(0,Ae.Z)(e,this.addressSorter)),(async e=>await(0,Ee.Z)(e)));(await Promise.all(r.map((async t=>{try{let r=t.multiaddr;return null==r.getPeerId()&&(r=r.encapsulate(`/p2p/${e.remotePeer.toString()}`)),r=r.encapsulate("/p2p-circuit"),await this.components.transportManager.listen([r]),!0}catch(e){Ur.error("error listening on circuit address",e),this.onError(e)}return!1})))).includes(!0)&&this.listenRelays.add(t)}catch(e){this.onError(e),this.listenRelays.delete(t)}}async _removeListenRelay(e){this.listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this.listenRelays.size>=this.maxListeners)return;const t=[],r=await this.components.peerStore.all();for(const{id:n,metadata:s}of r){const r=n.toString();if(this.listenRelays.has(r))continue;if(e.includes(r))continue;const i=s.get(Rr);if(null==i||Tr(i)!==Pr)continue;const o=this.components.connectionManager.getConnections(n);if(0!==o.length){if(await this._addListenRelay(o[0],r),this.listenRelays.size>=this.maxListeners)return}else t.push(n)}for(const e of t)if(await this._tryToListenOnRelay(e),this.listenRelays.size>=this.maxListeners)return;try{const e=await xr(Dr);for await(const t of this.components.contentRouting.findProviders(e)){if(0===t.multiaddrs.length)continue;const e=t.id;if(!e.equals(this.components.peerId)&&(await this.components.peerStore.addressBook.add(e,t.multiaddrs),await this._tryToListenOnRelay(e),this.listenRelays.size>=this.maxListeners))return}}catch(e){this.onError(e)}}async _tryToListenOnRelay(e){try{const t=await this.components.connectionManager.openConnection(e);await this._addListenRelay(t,e.toString())}catch(t){Ur.error("Could not use %p as relay",e,t),this.onError(t,`could not connect and listen on known hop relay ${e.toString()}`)}}}const Vr=(0,O.kg)("libp2p:relay");class zr{constructor(e,t){this.components=e,this.autoRelay=!1!==t.autoRelay?.enabled?new Mr(e,{addressSorter:t.addressSorter,...t.autoRelay}):void 0,this.started=!1,this.init=t,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){!1!==this.init.hop.enabled&&!1!==this.init.advertise.enabled&&(this.timeout=(0,W.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){null!=this.timeout&&(0,W.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{const e=await xr(Dr);await this.components.contentRouting.provide(e)}catch(e){e.code===D.ERR_NO_ROUTERS_AVAILABLE?(Vr.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),await this.stop()):Vr.error(e)}}}var jr=r(50202),Fr=r(42837),$r=(r(79437),r(97450),r(3832));r(25414);const qr=$r.pki;const Kr=(0,O.kg)("libp2p:keychain:cms"),Hr=new WeakMap;class Gr{constructor(e,t){if(null==e)throw B(new Error("keychain is required"),D.ERR_KEYCHAIN_REQUIRED);this.keychain=e,Hr.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw B(new Error("Plain data must be a Uint8Array"),D.ERR_INVALID_PARAMETERS);const r=await this.keychain.findKeyByName(e),n=await this.keychain.getPrivateKey(e),s=Hr.get(this);if(null==s)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const i=s.dek,o=$r.pki.decryptRsaPrivateKey(n,i),a=await((e,t)=>{const r=qr.rsa.setPublicKey(t.n,t.e),n=qr.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);const s=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return n.setSubject(s),n.setIssuer(s),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(t),n})(r,o),c=$r.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=$r.util.createBuffer(t),c.encrypt();return Ir($r.asn1.toDer(c.toAsn1()).getBytes(),"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw B(new Error("CMS data is required"),D.ERR_INVALID_PARAMETERS);let t;try{const r=$r.util.createBuffer(Tr(e,"ascii")),n=$r.asn1.fromDer(r);t=$r.pkcs7.messageFromAsn1(n)}catch(e){throw Kr.error(e),B(new Error("Invalid CMS"),D.ERR_INVALID_CMS)}const r=t.recipients.filter((e=>e.issuer.find((e=>"O"===e.shortName&&"ipfs"===e.value)))).filter((e=>e.issuer.find((e=>"CN"===e.shortName)))).map((e=>({recipient:e,keyId:e.issuer.find((e=>"CN"===e.shortName)).value}))),n=await async function(e,t){const r=e.map(t);return e[(await Promise.all(r)).findIndex((e=>e))]}(r,(async e=>{try{if(null!=await this.keychain.findKeyById(e.keyId))return!0}catch(e){return!1}return!1}));if(null==n){const e=r.map((e=>e.keyId));throw B(new Error(`Decryption needs one of the key(s): ${e.join(", ")}`),D.ERR_MISSING_KEYS,{missingKeys:e})}const s=await this.keychain.findKeyById(n.keyId);if(null==s)throw B(new Error("No key available to decrypto"),D.ERR_NO_KEY);const i=await this.keychain.getPrivateKey(s.name),o=Hr.get(this);if(null==o)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const a=o.dek,c=$r.pki.decryptRsaPrivateKey(i,a);return t.decrypt(n.recipient,c),Ir(t.content.getBytes(),"ascii")}}var Wr=r(51988),Jr=r(79944);const Yr=(0,O.kg)("libp2p:keychain"),Qr="/info/",Zr=new WeakMap,Xr=14,en=16,tn=1e3,rn={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function nn(e){return null!=e&&("string"==typeof e&&(e===jr(e.trim())&&e.length>0))}async function sn(){const e=800*Math.random()+200;await new Promise((t=>setTimeout(t,e)))}function on(e){return new Fr.s("/pkcs8/"+e)}function an(e){return new Fr.s(Qr+e)}class cn{constructor(e,t){if(this.components=e,this.init=(0,ie.Z)(rn,t),null!=this.init.pass&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(null!=this.init.dek?.keyLength&&this.init.dek.keyLength<Xr)throw new Error(`dek.keyLength must be least ${Xr} bytes`);if(null!=this.init.dek?.salt?.length&&this.init.dek.salt.length<en)throw new Error(`dek.saltLength must be least ${en} bytes`);if(null!=this.init.dek?.iterationCount&&this.init.dek.iterationCount<tn)throw new Error(`dek.iterationCount must be least ${tn}`);const r=null!=this.init.pass&&null!=this.init.dek?.salt?(0,Jr.nk)(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";Zr.set(this,{dek:r}),this.started=!1}isStarted(){return this.started}async start(){const e=an("self");await this.components.datastore.has(e)||await this.importPeer("self",this.components.peerId),this.started=!0}stop(){this.started=!1}get cms(){const e=Zr.get(this);if(null==e)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const t=e.dek;return new Gr(this,t)}static generateOptions(){const e=Object.assign({},rn),t=3*Math.ceil(en/3);return e.dek.salt=Tr((0,Jr.O6)(t),"base64"),e}static get options(){return rn}async createKey(e,t,r=2048){if(!nn(e)||"self"===e)throw await sn(),B(new Error("Invalid key name"),D.ERR_INVALID_KEY_NAME);if("string"!=typeof t)throw await sn(),B(new Error("Invalid key type"),D.ERR_INVALID_KEY_TYPE);const n=on(e);if(await this.components.datastore.has(n))throw await sn(),B(new Error("Key name already exists"),D.ERR_KEY_ALREADY_EXISTS);if("rsa"===t.toLowerCase())if(!Number.isSafeInteger(r)||r<2048)throw await sn(),B(new Error("Invalid RSA key size"),D.ERR_INVALID_KEY_SIZE);let s;try{const i=await(0,Wr.generateKeyPair)(t,r),o=await i.id(),a=Zr.get(this);if(null==a)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const c=a.dek,h=await i.export(c);s={name:e,id:o};const l=this.components.datastore.batch();l.put(n,Ir(h)),l.put(an(e),Ir(JSON.stringify(s))),await l.commit()}catch(e){throw await sn(),e}return s}async listKeys(){const e={prefix:Qr},t=[];for await(const r of this.components.datastore.query(e))t.push(JSON.parse(Tr(r.value)));return t}async findKeyById(e){try{return(await this.listKeys()).find((t=>t.id===e))}catch(e){throw await sn(),e}}async findKeyByName(e){if(!nn(e))throw await sn(),B(new Error(`Invalid key name '${e}'`),D.ERR_INVALID_KEY_NAME);const t=an(e);try{const e=await this.components.datastore.get(t);return JSON.parse(Tr(e))}catch(t){throw await sn(),Yr.error(t),B(new Error(`Key '${e}' does not exist.`),D.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!nn(e)||"self"===e)throw await sn(),B(new Error(`Invalid key name '${e}'`),D.ERR_INVALID_KEY_NAME);const t=on(e),r=await this.findKeyByName(e),n=this.components.datastore.batch();return n.delete(t),n.delete(an(e)),await n.commit(),r}async renameKey(e,t){if(!nn(e)||"self"===e)throw await sn(),B(new Error(`Invalid old key name '${e}'`),D.ERR_OLD_KEY_NAME_INVALID);if(!nn(t)||"self"===t)throw await sn(),B(new Error(`Invalid new key name '${t}'`),D.ERR_NEW_KEY_NAME_INVALID);const r=on(e),n=on(t),s=an(e),i=an(t);if(await this.components.datastore.has(n))throw await sn(),B(new Error(`Key '${t}' already exists`),D.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.datastore.get(r),o=await this.components.datastore.get(s),a=JSON.parse(Tr(o));a.name=t;const c=this.components.datastore.batch();return c.put(n,e),c.put(i,Ir(JSON.stringify(a))),c.delete(r),c.delete(s),await c.commit(),a}catch(e){throw await sn(),e}}async exportKey(e,t){if(!nn(e))throw await sn(),B(new Error(`Invalid key name '${e}'`),D.ERR_INVALID_KEY_NAME);if(null==t)throw await sn(),B(new Error("Password is required"),D.ERR_PASSWORD_REQUIRED);const r=on(e);try{const e=Tr(await this.components.datastore.get(r)),n=Zr.get(this);if(null==n)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const s=n.dek,i=await(0,Wr.importKey)(e,s);return await i.export(t)}catch(e){throw await sn(),e}}async importKey(e,t,r){if(!nn(e)||"self"===e)throw await sn(),B(new Error(`Invalid key name '${e}'`),D.ERR_INVALID_KEY_NAME);if(null==t)throw await sn(),B(new Error("PEM encoded key is required"),D.ERR_PEM_REQUIRED);const n=on(e);if(await this.components.datastore.has(n))throw await sn(),B(new Error(`Key '${e}' already exists`),D.ERR_KEY_ALREADY_EXISTS);let s,i;try{s=await(0,Wr.importKey)(t,r)}catch(e){throw await sn(),B(new Error("Cannot read the key, most likely the password is wrong"),D.ERR_CANNOT_READ_KEY)}try{i=await s.id();const e=Zr.get(this);if(null==e)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const r=e.dek;t=await s.export(r)}catch(e){throw await sn(),e}const o={name:e,id:i},a=this.components.datastore.batch();return a.put(n,Ir(t)),a.put(an(e),Ir(JSON.stringify(o))),await a.commit(),o}async importPeer(e,t){try{if(!nn(e))throw B(new Error(`Invalid key name '${e}'`),D.ERR_INVALID_KEY_NAME);if(null==t)throw B(new Error("PeerId is required"),D.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw B(new Error("PeerId.privKey is required"),D.ERR_MISSING_PRIVATE_KEY);const r=await(0,Wr.unmarshalPrivateKey)(t.privateKey),n=on(e);if(await this.components.datastore.has(n))throw await sn(),B(new Error(`Key '${e}' already exists`),D.ERR_KEY_ALREADY_EXISTS);const s=Zr.get(this);if(null==s)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const i=s.dek,o=await r.export(i),a={name:e,id:t.toString()},c=this.components.datastore.batch();return c.put(n,Ir(o)),c.put(an(e),Ir(JSON.stringify(a))),await c.commit(),a}catch(e){throw await sn(),e}}async getPrivateKey(e){if(!nn(e))throw await sn(),B(new Error(`Invalid key name '${e}'`),D.ERR_INVALID_KEY_NAME);try{const t=on(e);return Tr(await this.components.datastore.get(t))}catch(t){throw await sn(),Yr.error(t),B(new Error(`Key '${e}' does not exist.`),D.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){if("string"!=typeof e)throw await sn(),B(new Error(`Invalid old pass type '${typeof e}'`),D.ERR_INVALID_OLD_PASS_TYPE);if("string"!=typeof t)throw await sn(),B(new Error(`Invalid new pass type '${typeof t}'`),D.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await sn(),B(new Error(`Invalid pass length ${t.length}`),D.ERR_INVALID_PASS_LENGTH);Yr("recreating keychain");const r=Zr.get(this);if(null==r)throw B(new Error("dek missing"),D.ERR_INVALID_PARAMETERS);const n=r.dek;this.init.pass=t;const s=null!=t&&null!=this.init.dek?.salt?(0,Jr.nk)(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";Zr.set(this,{dek:s});const i=await this.listKeys();for(const e of i){const t=Tr(await this.components.datastore.get(on(e.name))),r=await(0,Wr.importKey)(t,n),i=s.toString(),o=await r.export(i),a=this.components.datastore.batch(),c={name:e.name,id:e.id};a.put(on(e.name),Ir(o)),a.put(an(e.name),Ir(JSON.stringify(c))),await a.commit()}Yr("keychain reconstructed")}}async function*hn(e,t){for await(const r of e)await t(r),yield r}var ln=r(70248);const un=50;class dn{constructor(e){if("number"!=typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");this.timespan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,t){return 1-Math.exp(-(e-t)/this.timespan)}push(e,t){if(null!=this.previousTime){const r=this.alpha(e,this.previousTime),n=t-this.movingAverage,s=r*n;this.movingAverage=r*t+(1-r)*this.movingAverage,this.variance=(1-r)*(this.variance+n*s),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+r*n}else this.movingAverage=t;this.previousTime=e}}function fn(e){return new dn(e)}class pn extends N.v{constructor(e){super(),this.enabled=e.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=e.computeThrottleMaxQueueSize,this.computeThrottleTimeout=e.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=e.movingAverageIntervals;for(let t=0;t<e.initialCounters.length;t++){const r=e.initialCounters[t];this.stats[r]=0n,this.movingAverages[r]=[];for(let e=0;e<this.movingAverageIntervals.length;e++){const t=this.movingAverageIntervals[e];(this.movingAverages[r][t]=fn(t)).push(this.frequencyLastTime,0)}}}start(){this.enabled&&this.queue.length>0&&this._resetComputeTimeout()}stop(){null!=this.timeout&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(e,t){this.queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=le(this._update,this._nextTimeout())}_nextTimeout(){const e=this.queue.length/this.computeThrottleMaxQueueSize;return Math.max(this.computeThrottleTimeout*(1-e),0)}_update(){if(this.timeout=null,this.queue.length>0){let e=["",0,0];for(e of this.queue)this._applyOp(e);this.queue=[],e.length>2&&""!==e[0]&&this._updateFrequency(e[2]),this.dispatchEvent(new N.A("update",{detail:this.stats}))}}_updateFrequency(e){const t=e-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",t,e),this._updateFrequencyFor("dataSent",t,e),this.frequencyLastTime=e}_updateFrequencyFor(e,t,r){const n=this.frequencyAccumulators[e]??0;this.frequencyAccumulators[e]=0;const s=n/(t??1)*1e3;let i=this.movingAverages[e];null==i&&(i=this.movingAverages[e]=[]);const o=this.movingAverageIntervals;for(let e=0;e<o.length;e++){const t=o[e];let n=i[t];null==n&&(n=i[t]=fn(t)),n.push(r,s)}}_applyOp(e){const t=e[0],r=e[1];if("number"!=typeof r)throw new Error("invalid increment number");let n;n=Object.prototype.hasOwnProperty.call(this.stats,t)?this.stats[t]:this.stats[t]=0n,this.stats[t]=n+BigInt(r),null==this.frequencyAccumulators[t]&&(this.frequencyAccumulators[t]=0),this.frequencyAccumulators[t]+=r}}const yn=["dataReceived","dataSent"],gn={in:"dataReceived",out:"dataSent"};class bn{constructor(e){this.enabled=e.enabled,this.statsInit={...e,initialCounters:yn},this.globalStats=new pn(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=ln(e.maxOldPeersRetention??un),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}async start(){this.enabled&&(this.running=!0)}async stop(){if(this.running){this.running=!1,this.globalStats.stop();for(const e of this.peerStats.values())e.stop();for(const e of this.protocolStats.values())e.stop()}}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(e){const{system:t="libp2p",component:r,metric:n,value:s,label:i,help:o}=e;this.systems.has(t)||this.systems.set(t,new Map);const a=this.systems.get(t);if(null==a)throw new Error("Unknown metric system");a.has(r)||a.set(r,new Map);const c=a.get(r);if(null==c)throw new Error("Unknown metric component");c.set(n,{label:i,help:o,calculate:"function"!=typeof s?()=>s:s})}forPeer(e){const t=e.toString();return this.peerStats.get(t)??this.oldPeers.get(t)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(e){return this.protocolStats.get(e)}onPeerDisconnected(e){const t=e.toString(),r=this.peerStats.get(t);null!=r&&(r.stop(),this.peerStats.delete(t),this.oldPeers.set(t,r))}_onMessage(e){if(!this.running)return;const{remotePeer:t,protocol:r,direction:n,dataLength:s}=e,i=gn[n];let o=this.forPeer(t);if(null==o){const e=new pn(this.statsInit);this.peerStats.set(t.toString(),e),o=e}if(o.push(i,s),this.globalStats.push(i,s),null!=r){let e=this.forProtocol(r);if(null==e){const t=new pn(this.statsInit);this.protocolStats.set(r,t),e=t}e.push(i,s)}}updatePlaceholder(e,t){if(!this.running)return;const r=e.toString(),n=this.peerStats.get(r)??this.oldPeers.get(r),s=t.toString(),i=this.peerStats.get(s)??this.oldPeers.get(s);let o=n;var a,c;null!=i&&(c=o,(a=i).stop(),c.stop(),a.queue=[...a.queue,...c.queue],o=a,this.oldPeers.remove(s)),this.peerStats.delete(e.toString()),this.peerStats.set(s,o),o.start()}trackStream(e){const{stream:t,remotePeer:r,protocol:n}=e;if(!this.running)return;const s=t.source;t.source=hn(s,(e=>this._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:e.byteLength})));const i=t.sink;t.sink=async e=>await(0,K.zG)(e,(e=>hn(e,(e=>{this._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:e.byteLength})}))),i)}}async function mn(e){try{return{status:"fulfilled",value:await e,isFulfilled:!0,isRejected:!1}}catch(e){return{status:"rejected",reason:e,isFulfilled:!1,isRejected:!0}}}class wn{value;next;constructor(e){this.value=e}}class vn{#e;#t;#r;constructor(){this.clear()}enqueue(e){const t=new wn(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#r++}dequeue(){const e=this.#e;if(e)return this.#e=this.#e.next,this.#r--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}}function En(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new vn;let r=0;const n=async(e,n,s)=>{r++;const i=(async()=>e(...s))();n(i);try{await i}catch{}r--,t.size>0&&t.dequeue()()},s=(s,...i)=>new Promise((o=>{((s,i,o)=>{t.enqueue(n.bind(void 0,s,i,o)),(async()=>{await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()})()})(s,o,i)}));return Object.defineProperties(s,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),s}async function An(e,t={}){const{concurrency:r=Number.POSITIVE_INFINITY}=t,n=En(r);return Promise.all(e.map((e=>e&&"function"==typeof e.then?mn(e):mn("function"==typeof e?n((()=>e())):Promise.resolve(e)))))}var Sn=r(20199);const _n=(0,O.kg)("libp2p:transports");class Cn extends N.v{constructor(e,t={}){super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=(0,Sn.s)({component:"transport-manager",metric:"listeners",metrics:this.components.metrics}),this.faultTolerance=t.faultTolerance??kn.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw B(new Error("Transport must have a valid tag"),D.ERR_INVALID_KEY);if(this.transports.has(t))throw B(new Error("There is already a transport with this tag"),D.ERR_DUPLICATE_TRANSPORT);_n("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}async start(){const e=this.components.addressManager.getListenAddrs();await this.listen(e),this.started=!0}async stop(){const e=[];for(const[t,r]of this.listeners)for(_n("closing listeners for %s",t);r.length>0;){const t=r.pop();null!=t&&e.push(t.close())}await Promise.all(e),_n("all listeners closed");for(const e of this.listeners.keys())this.listeners.set(e,[]);this.started=!1}async dial(e,t){const r=this.transportForMultiaddr(e);if(null==r)throw B(new Error(`No transport available for address ${String(e)}`),D.ERR_TRANSPORT_UNAVAILABLE);try{return await r.dial(e,{...t,upgrader:this.components.upgrader})}catch(e){throw null==e.code&&(e.code=D.ERR_TRANSPORT_DIAL_FAILED),e}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const r of t)e=[...e,...r.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(const t of this.transports.values()){if(t.filter([e]).length>0)return t}}async listen(e){if(null==e||0===e.length)return void _n("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,n]of this.transports.entries()){const s=n.filter(e),i=[];for(const e of s){_n("creating listener for %s on %s",r,e);const t=n.createListener({upgrader:this.components.upgrader});let s=this.listeners.get(r);null==s&&(s=[],this.listeners.set(r,s)),s.push(t),t.addEventListener("listening",(()=>{this.dispatchEvent(new N.A("listener:listening",{detail:t}))})),t.addEventListener("close",(()=>{this.dispatchEvent(new N.A("listener:close",{detail:t}))})),i.push(t.listen(e))}if(0===i.length){t.push(r);continue}if(null==(await An(i)).find((e=>e.isFulfilled))&&this.faultTolerance!==kn.NO_FATAL)throw B(new Error(`Transport (${r}) could not listen on any available address`),D.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e=`no valid addresses were provided for transports [${t.join(", ")}]`;if(this.faultTolerance===kn.FATAL_ALL)throw B(new Error(e),D.ERR_NO_VALID_ADDRESSES);_n(`libp2p in dial mode only: ${e}`)}}async remove(e){_n("removing %s",e);for(const t of this.listeners.get(e)??[])await t.close();this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}var kn;!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(kn||(kn={}));const In="/multistream/1.0.0";var Tn=r(90581);var xn=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const Rn=xn,Pn=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Dn{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class On{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ln(this,e)}}class Nn{constructor(e){this.decoders=e}or(e){return Ln(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ln=(e,t)=>new Nn({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Un{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Dn(e,t,r),this.decoder=new On(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Bn=({name:e,prefix:t,encode:r,decode:n})=>new Un(e,t,r,n),Mn=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:s}=Rn(r,t);return Bn({prefix:e,name:t,encode:n,decode:e=>Pn(s(e))})},Vn=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Bn({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),zn=Bn({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),jn=Vn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Fn=Vn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$n=Mn({prefix:"9",name:"base10",alphabet:"0123456789"}),qn=Vn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kn=Vn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Hn=Vn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gn=Vn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Wn=Vn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Jn=Vn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yn=Vn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Qn=Vn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Zn=Vn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xn=Vn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),es=Vn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ts=Mn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rs=Mn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ns=Mn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ss=Mn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),is=Vn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),os=Vn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),as=Vn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),cs=Vn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),hs=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ls=hs.reduce(((e,t,r)=>(e[r]=t,e)),[]),us=hs.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const ds=Bn({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=ls[t]),"")},decode:function(e){const t=[];for(const r of e){const e=us[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var fs=function e(t,r,n){r=r||[];var s=n=n||0;for(;t>=ps;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-s+1,r},ps=Math.pow(2,31);var ys=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var gs=Math.pow(2,7),bs=Math.pow(2,14),ms=Math.pow(2,21),ws=Math.pow(2,28),vs=Math.pow(2,35),Es=Math.pow(2,42),As=Math.pow(2,49),Ss=Math.pow(2,56),_s=Math.pow(2,63);const Cs={encode:fs,decode:ys,encodingLength:function(e){return e<gs?1:e<bs?2:e<ms?3:e<ws?4:e<vs?5:e<Es?6:e<As?7:e<Ss?8:e<_s?9:10}},ks=(e,t,r=0)=>(Cs.encode(e,t,r),t),Is=e=>Cs.encodingLength(e),Ts=(e,t)=>{const r=t.byteLength,n=Is(e),s=n+Is(r),i=new Uint8Array(s+r);return ks(e,i,0),ks(r,i,n),i.set(t,s),new xs(e,r,t,i)};class xs{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Rs=({name:e,code:t,encode:r})=>new Ps(e,t,r);class Ps{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ts(this.code,t):t.then((e=>Ts(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ds=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Os=Rs({name:"sha2-256",code:18,encode:Ds("SHA-256")}),Ns=Rs({name:"sha2-512",code:19,encode:Ds("SHA-512")}),Ls=Pn,Us={code:0,name:"identity",encode:Ls,digest:e=>Ts(0,Ls(e))},Bs="raw",Ms=85,Vs=e=>Pn(e),zs=e=>Pn(e),js=new TextEncoder,Fs=new TextDecoder,$s="json",qs=512,Ks=e=>js.encode(JSON.stringify(e)),Hs=e=>JSON.parse(Fs.decode(e));new WeakMap;class Gs{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Gs.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Digest.create(e,t);return Gs.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Gs.equals(this,e)}static equals(e,t){const r=t;return r&&e.code===r.code&&e.version===r.version&&Digest.equals(e.multihash,r.multihash)}toString(e){return((e,t)=>{const{bytes:r,version:n}=e;return 0===n?cid_toStringV0(r,cid_baseCache(e),t||base58btc.encoder):cid_toStringV1(r,cid_baseCache(e),t||base32.encoder)})(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Gs)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:s}=t;return new Gs(e,r,n,s||cid_encodeCID(e,r,n.bytes))}if(!0===t[cid_cidSymbol]){const{version:e,multihash:r,code:n}=t,s=Digest.decode(r);return Gs.create(e,n,s)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${cid_DAG_PB_CODE}) block encoding`);return new Gs(e,t,r,r.bytes);case 1:{const n=cid_encodeCID(e,t,r.bytes);return new Gs(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return Gs.create(0,cid_DAG_PB_CODE,e)}static createV1(e,t){return Gs.create(1,e,t)}static decode(e){const[t,r]=Gs.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Gs.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const s=n.subarray(t.multihashSize-t.digestSize),i=new Digest.Digest(t.multihashCode,t.digestSize,s,n);return[0===t.version?Gs.createV0(i):Gs.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=varint.decode(e.subarray(t));return n,r};let n=r(),s=cid_DAG_PB_CODE;if(18===n?(0,0):r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,o=r(),a=r(),c=t+a;return{version:n,codec:s,multihashCode:o,digestSize:a,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=cid_parseCIDtoBytes(e,t),s=Gs.decode(n);return cid_baseCache(s).set(r,e),s}}Symbol.for("@ipld/js-cid/CID");const Ws={...b,...m,...w,...v,...E,...A,...S,..._,...C,...k};function Js(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ys(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Qs=Ys("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Zs=Ys("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{const t=function(e=0){return null!=globalThis.Buffer?.allocUnsafe?Js(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),Xs={utf8:Qs,"utf-8":Qs,hex:Ws.base16,latin1:Zs,ascii:Zs,binary:Zs,...Ws};function ei(e,t="utf8"){const r=Xs[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Js(globalThis.Buffer.from(e,"utf-8"))}var ti=r(72533);const ri=ei("\n");function ni(e){const t=new Tn.H(e,ri);return Le.c.single(t)}function si(e,t,r={}){const n=ni(t);!0===r.writeBytes?e.push(n.subarray()):e.push(n)}async function ii(e,t){const r=await async function(e,t){let r=1;const n={[Symbol.asyncIterator]:()=>n,next:async()=>await e.next(r)};let s=n;null!=t?.signal&&(s=(0,xe.wJ)(n,t.signal));const i=await(0,K.zG)(s,Le.J({onLength:e=>{r=e},maxDataLength:1024}),(async e=>await ti(e)));if(null==i||0===i.length)throw B(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(i.get(i.byteLength-1)!==ri[0])throw B(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return i.sublist(0,-1)}(e,t);return function(e,t="utf8"){const r=Xs[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}(r.subarray())}r(28580),r(93489);const oi=(0,O.kg)("libp2p:mss:select");async function ai(e,t,r={}){t=Array.isArray(t)?[...t]:[t];const{reader:n,writer:s,rest:i,stream:o}=(0,Ue.Y)(e),a=t.shift();if(null==a)throw new Error("At least one protocol must be specified");oi('select: write ["%s", "%s"]',In,a);!function(e,t,r={}){const n=new Tn.H;for(const e of t)n.append(ni(e));!0===r.writeBytes?e.push(n.subarray()):e.push(n)}(s,[ei(In),ei(a)],r);let c=await ii(n,r);if(oi('select: read "%s"',c),c===In&&(c=await ii(n,r),oi('select: read "%s"',c)),c===a)return i(),{stream:o,protocol:a};for(const e of t){oi('select: write "%s"',e),si(s,ei(e),r);const t=await ii(n,r);if(oi('select: read "%s" for "%s"',t,e),t===e)return i(),{stream:o,protocol:e}}throw i(),B(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}const ci=(0,O.kg)("libp2p:mss:handle");async function hi(e,t,r){t=Array.isArray(t)?t:[t];const{writer:n,reader:s,rest:i,stream:o}=(0,Ue.Y)(e);for(;;){const e=await ii(s,r);if(ci('read "%s"',e),e!==In){if(t.includes(e))return si(n,ei(e),r),ci('respond with "%s" for "%s"',e,e),i(),{stream:o,protocol:e};"ls"!==e?(si(n,ei("na"),r),ci('respond with "na" for "%s"',e)):(si(n,new Tn.H(...t.map((e=>ni(ei(e))))),r),ci('respond with "%s" for %s',t,e))}else ci('respond with "%s" for "%s"',In,e),si(n,ei(In),r)}}var li=r(99633);const ui=Symbol.for("@libp2p/connection");const di=(0,O.kg)("libp2p:connection");class fi{constructor(e){const{remoteAddr:t,remotePeer:r,newStream:n,close:s,getStreams:i,stat:o}=e;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=r,this.stat={...o,status:ue},this._newStream=n,this._close=s,this._getStreams=i,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[ui](){return!0}get streams(){return this._getStreams()}async newStream(e,t){if(this.stat.status===de)throw B(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===fe)throw B(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);const r=await this._newStream(e,t);return r.stat.direction="outbound",r}addStream(e){e.stat.direction="inbound"}removeStream(e){}async close(){if(this.stat.status!==fe&&!this._closing){this.stat.status=de;try{this.streams.forEach((e=>e.close()))}catch(e){di.error(e)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=fe}}}var pi=r(1388);const yi=(0,O.kg)("libp2p:registrar");class gi{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.connectionManager.addEventListener("peer:disconnect",this._onDisconnect),this.components.peerStore.addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw B(new Error(`No handler registered for protocol ${e}`),D.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,r){if(this.handlers.has(e))throw B(new Error(`Handler already registered for protocol ${e}`),D.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const n=ie.Z.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},r);this.handlers.set(e,{handler:t,options:n}),await this.components.peerStore.protoBook.add(this.components.peerId,[e])}async unhandle(e){const t=Array.isArray(e)?e:[e];t.forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.protoBook.remove(this.components.peerId,t)}async register(e,t){if(!(0,pi.w)(t))throw yi.error("topology must be an instance of interfaces/topology"),B(new Error("topology must be an instance of interfaces/topology"),D.ERR_INVALID_PARAMETERS);const r=`${(1e9*Math.random()).toString(36)}${Date.now()}`;let n=this.topologies.get(e);return null==n&&(n=new Map,this.topologies.set(e,n)),n.set(r,t),await t.setRegistrar(this),r}unregister(e){for(const[t,r]of this.topologies.entries())r.has(e)&&(r.delete(e),0===r.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.protoBook.get(t.remotePeer).then((e=>{for(const r of e){const e=this.topologies.get(r);if(null!=e)for(const r of e.values())r.onDisconnect(t.remotePeer)}})).catch((e=>{yi.error(e)}))}_onProtocolChange(e){const{peerId:t,protocols:r,oldProtocols:n}=e.detail,s=n.filter((e=>!r.includes(e))),i=r.filter((e=>!n.includes(e)));for(const e of s){const r=this.topologies.get(e);if(null!=r)for(const e of r.values())e.onDisconnect(t)}for(const e of i){const r=this.topologies.get(e);if(null!=r)for(const e of r.values()){const r=this.components.connectionManager.getConnections(t)[0];null!=r&&e.onConnect(t,r)}}}}const bi=(0,O.kg)("libp2p:upgrader");function mi(e,t,r){let n=0;return r.streams.forEach((r=>{r.stat.direction===t&&r.stat.protocol===e&&n++})),n}class wi extends N.v{constructor(e,t){super(),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout}async upgradeInbound(e){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw B(new Error("connection denied"),D.ERR_CONNECTION_DENIED);let t,r,n,s,i,o,a;const c=this.components.metrics,h=new $.TimeoutController(this.inboundUpgradeTimeout);try{(0,J.setMaxListeners)?.(1/0,h.signal)}catch{}try{const l=(0,xe.D7)(e,h.signal);if(e.source=l.source,e.sink=l.sink,await this.components.connectionGater.denyInboundConnection(e))throw B(new Error("The multiaddr connection is blocked by gater.acceptConnection"),D.ERR_CONNECTION_INTERCEPTED);if(null!=c){({setTarget:o,proxy:a}=li());const t=`${(1e9*Math.random()).toString(36)}${Date.now()}`;o({toString:()=>t}),c.trackStream({stream:e,remotePeer:a})}bi("starting the inbound connection upgrade");let u=e;const d=this.components.connectionProtector;null!=d&&(bi("protecting the inbound connection"),u=await d.protect(e));try{if(({conn:t,remotePeer:r,protocol:i}=await this._encryptInbound(u)),await this.components.connectionGater.denyInboundEncryptedConnection(r,{...u,...t}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),D.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){const e=await this._multiplexInbound({...u,...t},this.muxers);s=e.muxerFactory,n=e.stream}else n=t}catch(e){throw bi.error("Failed to upgrade inbound connection",e),e}if(await this.components.connectionGater.denyInboundUpgradedConnection(r,{...u,...t}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),D.ERR_CONNECTION_INTERCEPTED);return null!=c&&(c.updatePlaceholder(a,r),o(r)),bi("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:i,direction:"inbound",maConn:e,upgradedConn:n,muxerFactory:s,remotePeer:r})}finally{this.components.connectionManager.afterUpgradeInbound(),h.clear()}}async upgradeOutbound(e,t){const r=e.remoteAddr.getPeerId();if(null==r)throw B(new Error("outbound connection must have a peer id"),D.ERR_INVALID_MULTIADDR);const n=(0,X.jE)(r);if(await this.components.connectionGater.denyOutboundConnection(n,e))throw B(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),D.ERR_CONNECTION_INTERCEPTED);let s,i,o,a,c,h,l;const u=this.components.metrics;if(null!=u){({setTarget:h,proxy:l}=li());const t=`${(1e9*Math.random()).toString(36)}${Date.now()}`;h({toB58String:()=>t}),u.trackStream({stream:e,remotePeer:l})}bi("Starting the outbound connection upgrade");let d=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(d=await t.protect(e))}try{if(s=d,!0!==t?.skipEncryption){if(({conn:s,remotePeer:i,protocol:a}=await this._encryptOutbound(d,n)),await this.components.connectionGater.denyOutboundEncryptedConnection(i,{...d,...s}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),D.ERR_CONNECTION_INTERCEPTED)}else a="native",i=n;if(o=s,null!=t?.muxerFactory)c=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...d,...s},this.muxers);c=e.muxerFactory,o=e.stream}}catch(t){throw bi.error("Failed to upgrade outbound connection",t),await e.close(t),t}if(await this.components.connectionGater.denyOutboundUpgradedConnection(i,{...d,...s}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),D.ERR_CONNECTION_INTERCEPTED);return null!=u&&(u.updatePlaceholder(l,i),h(i)),bi("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,muxerFactory:c,remotePeer:i})}_createConnection(e){const{cryptoProtocol:t,direction:r,maConn:n,upgradedConn:s,remotePeer:i,muxerFactory:o}=e;let a,c,h;null!=o&&(a=o.createStreamMuxer({direction:r,onIncomingStream:e=>{null!=h&&Promise.resolve().then((async()=>{const t=this.components.registrar.getProtocols(),{stream:n,protocol:s}=await hi(e,t);bi("%s: incoming stream opened on %s",r,s);const o=this.components.metrics;if(null!=o&&o.trackStream({stream:n,remotePeer:i,protocol:s}),null==h)return;const a=function(e,t){try{const{options:r}=t.getHandler(e);return r.maxInboundStreams}catch(e){if(e.code!==D.ERR_NO_HANDLER_FOR_PROTOCOL)throw e}return 32}(s,this.components.registrar);mi(s,"inbound",h)!==a?(e.source=n.source,e.sink=n.sink,e.stat.protocol=s,this.components.peerStore.protoBook.add(i,[s]).catch((e=>bi.error(e))),h.addStream(e),this._onStream({connection:h,stream:e,protocol:s})):e.abort(B(new Error(`Too many inbound protocol streams for protocol "${s}" - limit ${a}`),D.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS))})).catch((t=>{bi.error(t),null==e.stat.timeline.close&&e.close()}))},onStreamEnd:e=>{h?.removeStream(e.id)}}),c=async(e,t={})=>{if(null==a)throw B(new Error("Stream is not multiplexed"),D.ERR_MUXER_UNAVAILABLE);bi("%s: starting new stream on %s",r,e);const n=await a.newStream(),s=this.components.metrics;let o;try{if(null==t.signal){bi("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e),o=new $.TimeoutController(3e4),t.signal=o.signal;try{(0,J.setMaxListeners)?.(1/0,o.signal)}catch{}}const{stream:r,protocol:a}=await ai(n,e,t);null!=s&&s.trackStream({stream:r,remotePeer:i,protocol:a});const c=function(e,t){try{const{options:r}=t.getHandler(e);return r.maxOutboundStreams}catch(e){if(e.code!==D.ERR_NO_HANDLER_FOR_PROTOCOL)throw e}return 64}(a,this.components.registrar);if(mi(a,"outbound",h)===c){const e=B(new Error(`Too many outbound protocol streams for protocol "${a}" - limit ${c}`),D.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw n.abort(e),e}return this.components.peerStore.protoBook.add(i,[a]).catch((e=>bi.error(e))),n.source=r.source,n.sink=r.sink,n.stat.protocol=a,n}catch(e){if(bi.error("could not create new stream",e),null==n.stat.timeline.close&&n.close(),null!=e.code)throw e;throw B(e,D.ERR_UNSUPPORTED_PROTOCOL)}finally{null!=o&&o.clear()}},(0,K.zG)(s,a,s).catch(bi.error));const l=n.timeline;n.timeline=new Proxy(l,{set:(...e)=>(null!=h&&"close"===e[1]&&null!=e[2]&&null==l.close&&(async()=>{try{"OPEN"===h.stat.status&&await h.close()}catch(e){bi.error(e)}finally{this.dispatchEvent(new N.A("connectionEnd",{detail:h}))}})().catch((e=>{bi.error(e)})),Reflect.set(...e))}),n.timeline.upgraded=Date.now();const u=()=>{throw B(new Error("connection is not multiplexed"),D.ERR_CONNECTION_NOT_MULTIPLEXED)};var d;return d={remoteAddr:n.remoteAddr,remotePeer:i,stat:{status:"OPEN",direction:r,timeline:n.timeline,multiplexer:a?.protocol,encryption:t},newStream:c??u,getStreams:()=>null!=a?a.streams:u(),close:async()=>{await n.close(),null!=a&&a.close()}},h=new fi(d),this.dispatchEvent(new N.A("connection",{detail:h})),h}_onStream(e){const{connection:t,stream:r,protocol:n}=e,{handler:s}=this.components.registrar.getHandler(n);s({connection:t,stream:r})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());bi("handling inbound crypto protocol selection",t);try{const{stream:r,protocol:n}=await hi(e,t,{writeBytes:!0}),s=this.connectionEncryption.get(n);if(null==s)throw new Error(`no crypto module found for ${n}`);return bi("encrypting inbound connection..."),{...await s.secureInbound(this.components.peerId,r),protocol:n}}catch(e){throw B(e,D.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const r=Array.from(this.connectionEncryption.keys());bi("selecting outbound crypto protocol",r);try{const{stream:n,protocol:s}=await ai(e,r,{writeBytes:!0}),i=this.connectionEncryption.get(s);if(null==i)throw new Error(`no crypto module found for ${s}`);return bi("encrypting outbound connection to %p",t),{...await i.secureOutbound(this.components.peerId,n,t),protocol:s}}catch(e){throw B(e,D.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const r=Array.from(t.keys());bi("outbound selecting muxer %s",r);try{const{stream:n,protocol:s}=await ai(e,r,{writeBytes:!0});bi("%s selected as muxer protocol",s);return{stream:n,muxerFactory:t.get(s)}}catch(e){throw bi.error("error multiplexing outbound stream",e),B(e,D.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const r=Array.from(t.keys());bi("inbound handling muxers %s",r);try{const{stream:n,protocol:s}=await hi(e,r,{writeBytes:!0});return{stream:n,muxerFactory:t.get(s)}}catch(e){throw bi.error("error multiplexing inbound stream",e),B(e,D.ERR_MUXER_UNAVAILABLE)}}}var vi;!function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={listenAddrs:[],protocols:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 5:r.protocolVersion=e.string();break;case 6:r.agentVersion=e.string();break;case 1:r.publicKey=e.bytes();break;case 2:r.listenAddrs.push(e.bytes());break;case 4:r.observedAddr=e.bytes();break;case 3:r.protocols.push(e.string());break;case 8:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(vi||(vi={}));var Ei=r(92713);const Ai="js-libp2p/0.0.0",Si=(0,O.kg)("libp2p:identify");class _i{constructor(e,t){this.components=e,this.started=!1,this.init=t,this.identifyProtocolStr=`/${t.protocolPrefix}/id/1.0.0`,this.identifyPushProtocolStr=`/${t.protocolPrefix}/id/push/1.0.0`,this.host={protocolVersion:`${t.protocolPrefix}/0.1.0`,...t.host},this.components.connectionManager.addEventListener("peer:connect",(e=>{const t=e.detail;this.identify(t).catch(Si.error)})),this.components.peerStore.addEventListener("change:multiaddrs",(e=>{const{peerId:t}=e.detail;this.components.peerId.equals(t)&&this.pushToPeerStore().catch((e=>Si.error(e)))})),this.components.peerStore.addEventListener("change:protocols",(e=>{const{peerId:t}=e.detail;this.components.peerId.equals(t)&&this.pushToPeerStore().catch((e=>Si.error(e)))}))}isStarted(){return this.started}async start(){this.started||(await this.components.peerStore.metadataBook.setValue(this.components.peerId,"AgentVersion",Ir(this.host.agentVersion)),await this.components.peerStore.metadataBook.setValue(this.components.peerId,"ProtocolVersion",Ir(this.host.protocolVersion)),await this.components.registrar.handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{Si.error(e)}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),await this.components.registrar.handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{Si.error(e)}))}),{maxInboundStreams:this.init.maxPushIncomingStreams,maxOutboundStreams:this.init.maxPushOutgoingStreams}),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.identifyProtocolStr),await this.components.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async push(e){const t=await this.components.peerStore.addressBook.getRawEnvelope(this.components.peerId),r=this.components.addressManager.getAddresses().map((e=>e.bytes)),n=await this.components.peerStore.protoBook.get(this.components.peerId),s=e.map((async e=>{let s;const i=new $.TimeoutController(this.init.timeout);try{(0,J.setMaxListeners)?.(1/0,i.signal)}catch{}try{s=await e.newStream([this.identifyPushProtocolStr],{signal:i.signal});const o=(0,xe.D7)(s,i.signal);await o.sink((0,K.zG)([vi.encode({listenAddrs:r,signedPeerRecord:t,protocols:n})],Le.c()))}catch(e){Si.error("could not push identify update to peer",e)}finally{null!=s&&s.close(),i.clear()}}));await Promise.all(s)}async pushToPeerStore(){if(!this.isStarted())return;const e=[];for(const t of this.components.connectionManager.getConnections()){const r=t.remotePeer;(await this.components.peerStore.get(r)).protocols.includes(this.identifyPushProtocolStr)&&e.push(t)}await this.push(e)}async _identify(e,t={}){let r,n,s=t.signal;if(null==s){r=new $.TimeoutController(this.init.timeout),s=r.signal;try{(0,J.setMaxListeners)?.(1/0,r.signal)}catch{}}try{n=await e.newStream([this.identifyProtocolStr],{signal:s});const t=(0,xe.D7)(n,s),i=await(0,K.zG)([],t,Le.J({maxDataLength:this.init.maxIdentifyMessageSize??8192}),(async e=>await(0,H.Z)(e)));if(null==i)throw B(new Error("No data could be retrieved"),D.ERR_CONNECTION_ENDED);try{return vi.decode(i)}catch(e){throw B(e,D.ERR_INVALID_MESSAGE)}}finally{null!=r&&r.clear(),null!=n&&n.close()}}async identify(e,t={}){const r=await this._identify(e,t),{publicKey:n,listenAddrs:s,protocols:i,observedAddr:o,signedPeerRecord:a,agentVersion:c,protocolVersion:h}=r;if(null==n)throw B(new Error("public key was missing from identify message"),D.ERR_MISSING_PUBLIC_KEY);const l=await(0,X.y5)(n);if(!e.remotePeer.equals(l))throw B(new Error("identified peer does not match the expected peer"),D.ERR_INVALID_PEER);if(this.components.peerId.equals(l))throw B(new Error("identified peer is our own peer id?"),D.ERR_INVALID_PEER);const u=_i.getCleanMultiaddr(o);if(null!=a){Si("received signed peer record from %p",l);try{const e=await Ei.X.openAndCertify(a,Ei.K.DOMAIN);if(!e.peerId.equals(l))throw B(new Error("identified peer does not match the expected peer"),D.ERR_INVALID_PEER);if(await this.components.peerStore.addressBook.consumePeerRecord(e))return await this.components.peerStore.protoBook.set(l,i),null!=c&&await this.components.peerStore.metadataBook.setValue(l,"AgentVersion",Ir(c)),null!=h&&await this.components.peerStore.metadataBook.setValue(l,"ProtocolVersion",Ir(h)),void Si("identify completed for peer %p and protocols %o",l,i)}catch(e){Si("received invalid envelope, discard it and fallback to listenAddrs is available",e)}}else Si("no signed peer record received from %p",l);Si("falling back to legacy addresses from %p",l);try{await this.components.peerStore.addressBook.set(l,s.map((e=>(0,ee.HM)(e))))}catch(e){Si.error("received invalid addrs",e)}await this.components.peerStore.protoBook.set(l,i),null!=c&&await this.components.peerStore.metadataBook.setValue(l,"AgentVersion",Ir(c)),null!=h&&await this.components.peerStore.metadataBook.setValue(l,"ProtocolVersion",Ir(h)),Si("identify completed for peer %p and protocols %o",l,i),Si("received observed address of %s",u?.toString())}async _handleIdentify(e){const{connection:t,stream:r}=e,n=new $.TimeoutController(this.init.timeout);try{(0,J.setMaxListeners)?.(1/0,n.signal)}catch{}try{const e=this.components.peerId.publicKey??new Uint8Array(0),s=await this.components.peerStore.get(this.components.peerId),i=this.components.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ee.a_)("p2p").code)));let o=s.peerRecordEnvelope;if(i.length>0&&null==o){const e=new Ei.K({peerId:this.components.peerId,multiaddrs:i}),t=await Ei.X.seal(e,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(t),o=t.marshal().subarray()}const a=vi.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:i.map((e=>e.bytes)),signedPeerRecord:o,observedAddr:t.remoteAddr.bytes,protocols:s.protocols}),c=(0,xe.D7)(r,n.signal),h=(0,K.zG)([a],Le.c());await c.sink(h)}catch(e){Si.error("could not respond to identify request",e)}finally{r.close(),n.clear()}}async _handlePush(e){const{connection:t,stream:r}=e,n=new $.TimeoutController(this.init.timeout);try{(0,J.setMaxListeners)?.(1/0,n.signal)}catch{}let s;try{const e=(0,xe.D7)(r,n.signal),t=await(0,K.zG)([],e,Le.J({maxDataLength:this.init.maxIdentifyMessageSize??8192}),(async e=>await(0,H.Z)(e)));null!=t&&(s=vi.decode(t))}catch(e){return Si.error("received invalid message",e)}finally{r.close(),n.clear()}if(null==s)return Si.error("received invalid message");const i=t.remotePeer;if(this.components.peerId.equals(i))Si("received push from ourselves?");else{if(Si("received push from %p",i),null!=s.signedPeerRecord){Si("received signedPeerRecord in push");try{const e=await Ei.X.openAndCertify(s.signedPeerRecord,Ei.K.DOMAIN);if(await this.components.peerStore.addressBook.consumePeerRecord(e))return Si("consumed signedPeerRecord sent in push"),void await this.components.peerStore.protoBook.set(i,s.protocols);Si("failed to consume signedPeerRecord sent in push")}catch(e){Si("received invalid envelope, discard it and fallback to listenAddrs is available",e)}}else Si("did not receive signedPeerRecord in push");try{await this.components.peerStore.addressBook.set(i,s.listenAddrs.map((e=>(0,ee.HM)(e))))}catch(e){Si.error("received invalid addrs",e)}try{await this.components.peerStore.protoBook.set(i,s.protocols)}catch(e){Si.error("received invalid protocols",e)}Si("handled push from %p",i)}}static getCleanMultiaddr(e){if(null!=e&&e.length>0)try{return(0,ee.HM)(e)}catch{}}}var Ci,ki;!function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),!0!==r.writeDefaults&&""===e.identifier||(t.uint32(10),t.string(e.identifier)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={identifier:""},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.identifier=e.string();else e.skipType(7&t)}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(Ci||(Ci={})),function(e){let t,r,n;!function(e){e.OK="OK",e.NOT_FOUND="NOT_FOUND",e.ERROR="ERROR"}(t=e.StatusCode||(e.StatusCode={})),function(e){e[e.OK=0]="OK",e[e.NOT_FOUND=1]="NOT_FOUND",e[e.ERROR=2]="ERROR"}(r||(r={})),function(e){e.codec=()=>(0,Te.Ji)(r)}(t=e.StatusCode||(e.StatusCode={})),e.codec=()=>(null==n&&(n=(0,Te.yw)(((t,n,s={})=>{!1!==s.lengthDelimited&&n.fork(),(!0===s.writeDefaults||null!=t.status&&0!==r[t.status])&&(n.uint32(8),e.StatusCode.codec().encode(t.status,n)),(!0===s.writeDefaults||null!=t.data&&t.data.byteLength>0)&&(n.uint32(18),n.bytes(t.data)),!1!==s.lengthDelimited&&n.ldelim()}),((r,n)=>{const s={status:t.OK,data:new Uint8Array(0)},i=null==n?r.len:r.pos+n;for(;r.pos<i;){const t=r.uint32();switch(t>>>3){case 1:s.status=e.StatusCode.codec().decode(r);break;case 2:s.data=r.bytes();break;default:r.skipType(7&t)}}return s}))),n),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(ki||(ki={}));const Ii=(0,O.kg)("libp2p:fetch");class Ti{constructor(e,t){this.started=!1,this.components=e,this.protocol=`/${t.protocolPrefix??"libp2p"}/fetch/0.0.1`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=t}async start(){await this.components.registrar.handle(this.protocol,(e=>{this.handleMessage(e).catch((e=>{Ii.error(e)})).finally((()=>{e.stream.close()}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(e,t,r={}){Ii("dialing %s to %p",this.protocol,e);const n=await this.components.connectionManager.openConnection(e,r);let s,i,o=r.signal;if(null==o){s=new $.TimeoutController(this.init.timeout),o=s.signal;try{(0,J.setMaxListeners)?.(1/0,s.signal)}catch{}}try{i=await n.newStream([this.protocol],{signal:o});const e=(0,xe.D7)(i,o),r=await(0,K.zG)([Ci.encode({identifier:t})],Le.c(),e,Le.J(),(async function(e){const t=await(0,H.Z)(e);if(null==t)throw B(new Error("No data received"),D.ERR_INVALID_MESSAGE);const r=ki.decode(t);switch(r.status){case ki.StatusCode.OK:return r.data;case ki.StatusCode.NOT_FOUND:return null;case ki.StatusCode.ERROR:{const e=(new TextDecoder).decode(r.data);throw B(new Error("Error in fetch protocol response: "+e),D.ERR_INVALID_PARAMETERS)}default:throw B(new Error("Unknown response status"),D.ERR_INVALID_MESSAGE)}}));return r??null}finally{null!=s&&s.clear(),null!=i&&i.close()}}async handleMessage(e){const{stream:t}=e,r=this;await(0,K.zG)(t,Le.J(),(async function*(e){const t=await(0,H.Z)(e);if(null==t)throw B(new Error("No data received"),D.ERR_INVALID_MESSAGE);const n=Ci.decode(t);let s;const i=r._getLookupFunction(n.identifier);if(null!=i){const e=await i(n.identifier);s=null!=e?{status:ki.StatusCode.OK,data:e}:{status:ki.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{const e=(new TextEncoder).encode("No lookup function registered for key: "+n.identifier);s={status:ki.StatusCode.ERROR,data:e}}yield ki.encode(s)}),Le.c(),t)}_getLookupFunction(e){for(const t of this.lookupFunctions.keys())if(e.startsWith(t))return this.lookupFunctions.get(t)}registerLookupFunction(e,t){if(this.lookupFunctions.has(e))throw B(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),D.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){if(null!=t){if(this.lookupFunctions.get(e)!==t)return}this.lookupFunctions.delete(e)}}const xi=(0,O.kg)("libp2p:ping");class Ri{constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix}/ping/1.0.0`,this.init=t}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){const{stream:t}=e;(0,K.zG)(t,t).catch((e=>{xi.error(e)}))}async ping(e,t={}){xi("dialing %s to %p",this.protocol,e);const r=Date.now(),n=(0,Jr.O6)(32),s=await this.components.connectionManager.openConnection(e,t);let i,o,a=t.signal;if(null==a){i=new $.TimeoutController(this.init.timeout),a=i.signal;try{(0,J.setMaxListeners)?.(1/0,i.signal)}catch{}}try{o=await s.newStream([this.protocol],{signal:a});const e=(0,xe.D7)(o,a),t=await(0,K.zG)([n],e,(async e=>await(0,H.Z)(e))),c=Date.now();if(null==t||!function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(n,t.subarray()))throw B(new Error("Received wrong ping ack"),D.ERR_WRONG_PING_ACK);return c-r}finally{null!=i&&i.clear(),null!=o&&o.close()}}}var Pi=r(14560);function Di(e){const{address:t}=e.nodeAddress();return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r=t)||/^::1$/.test(r);var r}const Oi=(0,O.kg)("libp2p:nat"),Ni=7200;function Li(e=1024,t=65535){return Math.floor(Math.random()*(t-e+1)+e)}class Ui{constructor(e,t){if(this.components=e,this.started=!1,this.enabled=t.enabled,this.externalAddress=t.externalAddress,this.localAddress=t.localAddress,this.description=t.description??`libp2p@0.0.0 ${this.components.peerId.toString()}`,this.ttl=t.ttl??Ni,this.keepAlive=t.keepAlive??!0,this.gateway=t.gateway,this.ttl<Ni)throw B(new Error("NatManager ttl should be at least 7200 seconds"),D.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){Pi.jU||!this.enabled||this.started||(this.started=!0,this._start().catch((e=>{Oi.error(e)})))}async _start(){const e=this.components.transportManager.getAddrs();for(const t of e){const{family:e,host:r,port:n,transport:s}=t.toOptions();if(!t.isThinWaistAddress()||"tcp"!==s)continue;if(Di(t))continue;if(4!==e)continue;const i=await this._getClient(),o=this.externalAddress??await i.externalIp();if(Or(o))throw new Error(`${o} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);const a=Li();Oi(`opening uPnP connection from ${o}:${a} to ${r}:${n}`),await i.map({publicPort:a,localPort:n,localAddress:this.localAddress,protocol:"TCP"===s.toUpperCase()?"TCP":"UDP"}),this.components.addressManager.addObservedAddr((0,ee.uv)({family:4,address:o,port:a},s))}}async _getClient(){return null!=this.client||(this.client=await async function(){throw new Error("Not supported in browsers")}((this.description,this.ttl,this.keepAlive,this.gateway))),this.client}async stop(){if(!Pi.jU&&null!=this.client)try{await this.client.close(),this.client=void 0}catch(e){Oi.error(e)}}}const Bi=(0,O.kg)("libp2p:peer-record-updater");class Mi{constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.transportManager.addEventListener("listener:listening",this.update),this.components.transportManager.addEventListener("listener:close",this.update),this.components.addressManager.addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.transportManager.removeEventListener("listener:listening",this.update),this.components.transportManager.removeEventListener("listener:close",this.update),this.components.addressManager.removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then((async()=>{const e=new Ei.K({peerId:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode((0,ee.a_)("p2p").code)))}),t=await Ei.X.seal(e,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(t)})).catch((e=>{Bi.error("Could not update self peer record: %o",e)}))}}class Vi{constructor(e){this.dht=e}async findPeer(e,t={}){for await(const r of this.dht.findPeer(e,t))if("FINAL_PEER"===r.name)return r.peer;throw B(new Error(P.NOT_FOUND),D.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(const r of this.dht.getClosestPeers(e,t))"FINAL_PEER"===r.name&&(yield r.peer)}}const zi="ERR_INVALID_PARAMETERS",ji="ERR_NOT_FOUND";var Fi=r(71783),$i=r(2606),qi=r(48128),Ki=r(63192);const Hi=(0,O.kg)("libp2p:peer-store:address-book"),Gi="change:multiaddrs";async function Wi(){return!0}class Ji{constructor(e,t,r){this.dispatchEvent=e,this.store=t,this.addressFilter=r??Wi}async consumePeerRecord(e){Hi.trace("consumePeerRecord await write lock");const t=await this.store.lock.writeLock();let r,n,s;Hi.trace("consumePeerRecord got write lock");try{let i;try{i=Ei.K.createFromProtobuf(e.payload)}catch(e){return Hi.error("invalid peer record received"),!1}r=i.peerId;const o=i.multiaddrs;if(!r.equals(e.peerId))return Hi("signing key does not match PeerId in the PeerRecord"),!1;if(null==o||0===o.length)return!1;if(await this.store.has(r)&&(n=await this.store.load(r),null!=n.peerRecordEnvelope)){const e=await Ei.X.createFromProtobuf(n.peerRecordEnvelope),t=Ei.K.createFromProtobuf(e.payload);if(t.seqNumber>=i.seqNumber)return Hi("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,i.seqNumber),!1}const a=await Yi(r,o,this.addressFilter,!0);s=await this.store.patchOrCreate(r,{addresses:a,peerRecordEnvelope:e.marshal().subarray()}),Hi("stored provided peer record for %p",i.peerId)}finally{Hi.trace("consumePeerRecord release write lock"),t()}return this.dispatchEvent(new N.A(Gi,{detail:{peerId:r,multiaddrs:s.addresses.map((({multiaddr:e})=>e)),oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}})),!0}async getRawEnvelope(e){Hi.trace("getRawEnvelope await read lock");const t=await this.store.lock.readLock();Hi.trace("getRawEnvelope got read lock");try{return(await this.store.load(e)).peerRecordEnvelope}catch(e){if(e.code!==ji)throw e}finally{Hi.trace("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){const t=await this.getRawEnvelope(e);if(null!=t)return await Ei.X.createFromProtobuf(t)}async get(e){e=(0,X.vL)(e),Hi.trace("get wait for read lock");const t=await this.store.lock.readLock();Hi.trace("get got read lock");try{return(await this.store.load(e)).addresses}catch(e){if(e.code!==ji)throw e}finally{Hi.trace("get release read lock"),t()}return[]}async set(e,t){if(e=(0,X.vL)(e),!Array.isArray(t))throw Hi.error("multiaddrs must be an array of Multiaddrs"),B(new Error("multiaddrs must be an array of Multiaddrs"),zi);Hi.trace("set await write lock");const r=await this.store.lock.writeLock();Hi.trace("set got write lock");let n,s,i=!1;try{const o=await Yi(e,t,this.addressFilter);if(0===o.length)return;try{if(n=await this.store.load(e),i=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...n.addresses.map((({multiaddr:e})=>e.toString()))]).size===n.addresses.length&&o.length===n.addresses.length)return}catch(e){if(e.code!==ji)throw e}s=await this.store.patchOrCreate(e,{addresses:o}),Hi("set multiaddrs for %p",e)}finally{Hi.trace("set multiaddrs for %p",e),Hi("set release write lock"),r()}this.dispatchEvent(new N.A(Gi,{detail:{peerId:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}})),i||this.dispatchEvent(new N.A("peer",{detail:{id:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),protocols:s.protocols}}))}async add(e,t){if(e=(0,X.vL)(e),!Array.isArray(t))throw Hi.error("multiaddrs must be an array of Multiaddrs"),B(new Error("multiaddrs must be an array of Multiaddrs"),zi);Hi.trace("add await write lock");const r=await this.store.lock.writeLock();let n,s,i;Hi.trace("add got write lock");try{const o=await Yi(e,t,this.addressFilter);if(0===o.length)return;try{if(s=await this.store.load(e),n=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...s.addresses.map((({multiaddr:e})=>e.toString()))]).size===s.addresses.length)return}catch(e){if(e.code!==ji)throw e}i=await this.store.mergeOrCreate(e,{addresses:o}),Hi("added multiaddrs for %p",e)}finally{Hi.trace("set release write lock"),r()}this.dispatchEvent(new N.A(Gi,{detail:{peerId:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==s?[]:s.addresses.map((({multiaddr:e})=>e))}})),!0===n&&this.dispatchEvent(new N.A("peer",{detail:{id:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),protocols:i.protocols}}))}async delete(e){e=(0,X.vL)(e),Hi.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;Hi.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==ji)throw e}await this.store.patchOrCreate(e,{addresses:[]})}finally{Hi.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new N.A(Gi,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:null==r?[]:r.addresses.map((({multiaddr:e})=>e))}}))}}async function Yi(e,t,r,n=!1){return await(0,K.zG)(t,(e=>Ki(e,(e=>{if(!(0,ee.h2)(e))throw Hi.error("multiaddr must be an instance of Multiaddr"),B(new Error("multiaddr must be an instance of Multiaddr"),zi)}))),(t=>$i(t,(async t=>await r(e,t)))),(e=>qi(e,(e=>({multiaddr:e,isCertified:n})))),(async e=>await Fi(e)))}function Qi(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}const Zi=(0,O.kg)("libp2p:peer-store:key-book"),Xi="change:pubkey";class eo{constructor(e,t){this.dispatchEvent=e,this.store=t}async set(e,t){if(e=(0,X.vL)(e),!(t instanceof Uint8Array))throw Zi.error("publicKey must be an instance of Uint8Array to store data"),B(new Error("publicKey must be an instance of PublicKey"),zi);Zi.trace("set await write lock");const r=await this.store.lock.writeLock();Zi.trace("set got write lock");let n,s=!1;try{try{if(n=await this.store.load(e),null!=n.pubKey&&Qi(n.pubKey,t))return}catch(e){if(e.code!==ji)throw e}await this.store.patchOrCreate(e,{pubKey:t}),s=!0}finally{Zi.trace("set release write lock"),r()}s&&this.dispatchEvent(new N.A(Xi,{detail:{peerId:e,publicKey:t,oldPublicKey:null==n?void 0:n.pubKey}}))}async get(e){e=(0,X.vL)(e),Zi.trace("get await write lock");const t=await this.store.lock.readLock();Zi.trace("get got write lock");try{return(await this.store.load(e)).pubKey}catch(e){if(e.code!==ji)throw e}finally{Zi("get release write lock"),t()}}async delete(e){e=(0,X.vL)(e),Zi.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;Zi.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==ji)throw e}await this.store.patchOrCreate(e,{pubKey:void 0})}catch(e){if(e.code!==ji)throw e}finally{Zi.trace("delete release write lock"),t()}this.dispatchEvent(new N.A(Xi,{detail:{peerId:e,publicKey:void 0,oldPublicKey:null==r?void 0:r.pubKey}}))}}const to=(0,O.kg)("libp2p:peer-store:metadata-book"),ro="change:metadata";class no{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){e=(0,X.vL)(e),to.trace("get await read lock");const t=await this.store.lock.readLock();to.trace("get got read lock");try{return(await this.store.load(e)).metadata}catch(e){if(e.code!==ji)throw e}finally{to.trace("get release read lock"),t()}return new Map}async getValue(e,t){e=(0,X.vL)(e),to.trace("getValue await read lock");const r=await this.store.lock.readLock();to.trace("getValue got read lock");try{return(await this.store.load(e)).metadata.get(t)}catch(e){if(e.code!==ji)throw e}finally{to.trace("getValue release write lock"),r()}}async set(e,t){if(e=(0,X.vL)(e),!(t instanceof Map))throw to.error("valid metadata must be provided to store data"),B(new Error("valid metadata must be provided"),zi);to.trace("set await write lock");const r=await this.store.lock.writeLock();let n;to.trace("set got write lock");try{try{n=await this.store.load(e)}catch(e){if(e.code!==ji)throw e}await this.store.mergeOrCreate(e,{metadata:t})}finally{to.trace("set release write lock"),r()}this.dispatchEvent(new N.A(ro,{detail:{peerId:e,metadata:t,oldMetadata:null==n?new Map:n.metadata}}))}async setValue(e,t,r){if(e=(0,X.vL)(e),"string"!=typeof t||!(r instanceof Uint8Array))throw to.error("valid key and value must be provided to store data"),B(new Error("valid key and value must be provided"),zi);to.trace("setValue await write lock");const n=await this.store.lock.writeLock();let s,i;to.trace("setValue got write lock");try{try{s=await this.store.load(e);const n=s.metadata.get(t);if(null!=n&&Qi(r,n))return}catch(e){if(e.code!==ji)throw e}i=await this.store.mergeOrCreate(e,{metadata:new Map([[t,r]])})}finally{to.trace("setValue release write lock"),n()}this.dispatchEvent(new N.A(ro,{detail:{peerId:e,metadata:i.metadata,oldMetadata:null==s?new Map:s.metadata}}))}async delete(e){e=(0,X.vL)(e),to.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;to.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==ji)throw e}null!=r&&await this.store.patch(e,{metadata:new Map})}finally{to.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new N.A(ro,{detail:{peerId:e,metadata:new Map,oldMetadata:r.metadata}}))}async deleteValue(e,t){e=(0,X.vL)(e),to.trace("deleteValue await write lock");const r=await this.store.lock.writeLock();let n,s;to.trace("deleteValue got write lock");try{s=await this.store.load(e),n=s.metadata,n.delete(t),await this.store.patch(e,{metadata:n})}catch(e){if(e.code!==ji)throw e}finally{to.trace("deleteValue release write lock"),r()}null!=n&&this.dispatchEvent(new N.A(ro,{detail:{peerId:e,metadata:n,oldMetadata:null==s?new Map:s.metadata}}))}}const so=(0,O.kg)("libp2p:peer-store:proto-book"),io="change:protocols";class oo{constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){so.trace("get wait for read lock");const t=await this.store.lock.readLock();so.trace("get got read lock");try{return(await this.store.load(e)).protocols}catch(e){if(e.code!==ji)throw e}finally{so.trace("get release read lock"),t()}return[]}async set(e,t){if(e=(0,X.vL)(e),!Array.isArray(t))throw so.error("protocols must be provided to store data"),B(new Error("protocols must be provided"),zi);so.trace("set await write lock");const r=await this.store.lock.writeLock();let n,s;so.trace("set got write lock");try{try{if(n=await this.store.load(e),new Set([...t]).size===n.protocols.length)return}catch(e){if(e.code!==ji)throw e}s=await this.store.patchOrCreate(e,{protocols:t}),so("stored provided protocols for %p",e)}finally{so.trace("set release write lock"),r()}this.dispatchEvent(new N.A(io,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==n?[]:n.protocols}}))}async add(e,t){if(e=(0,X.vL)(e),!Array.isArray(t))throw so.error("protocols must be provided to store data"),B(new Error("protocols must be provided"),zi);so.trace("add await write lock");const r=await this.store.lock.writeLock();let n,s;so.trace("add got write lock");try{try{if(n=await this.store.load(e),new Set([...n.protocols,...t]).size===n.protocols.length)return}catch(e){if(e.code!==ji)throw e}s=await this.store.mergeOrCreate(e,{protocols:t}),so("added provided protocols for %p",e)}finally{so.trace("add release write lock"),r()}this.dispatchEvent(new N.A(io,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==n?[]:n.protocols}}))}async remove(e,t){if(e=(0,X.vL)(e),!Array.isArray(t))throw so.error("protocols must be provided to store data"),B(new Error("protocols must be provided"),zi);so.trace("remove await write lock");const r=await this.store.lock.writeLock();let n,s;so.trace("remove got write lock");try{try{n=await this.store.load(e);const r=new Set(n.protocols);for(const e of t)r.delete(e);if(n.protocols.length===r.size)return;t=Array.from(r)}catch(e){if(e.code!==ji)throw e}s=await this.store.patchOrCreate(e,{protocols:t})}finally{so.trace("remove release write lock"),r()}this.dispatchEvent(new N.A(io,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==n?[]:n.protocols}}))}async delete(e){e=(0,X.vL)(e),so.trace("delete await write lock");const t=await this.store.lock.writeLock();let r;so.trace("delete got write lock");try{try{r=await this.store.load(e)}catch(e){if(e.code!==ji)throw e}await this.store.patchOrCreate(e,{protocols:[]})}finally{so.trace("delete release write lock"),t()}null!=r&&this.dispatchEvent(new N.A(io,{detail:{peerId:e,protocols:[],oldProtocols:r.protocols}}))}}new Uint8Array(0);class ao{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class co{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return lo(this,e)}}class ho{constructor(e){this.decoders=e}or(e){return lo(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const lo=(e,t)=>new ho({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class uo{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new ao(e,t,r),this.decoder=new co(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const fo=({name:e,prefix:t,encode:r,decode:n})=>new uo(e,t,r,n),po=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>fo({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),yo=po({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});po({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),po({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),po({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),po({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),po({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),po({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),po({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),po({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var go,bo,mo;!function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.addresses)for(const r of e.addresses)t.uint32(10),bo.codec().encode(r,t,{writeDefaults:!0});if(null!=e.protocols)for(const r of e.protocols)t.uint32(18),t.string(r);if(null!=e.metadata)for(const r of e.metadata)t.uint32(26),mo.codec().encode(r,t,{writeDefaults:!0});null!=e.pubKey&&(t.uint32(34),t.bytes(e.pubKey)),null!=e.peerRecordEnvelope&&(t.uint32(42),t.bytes(e.peerRecordEnvelope)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={addresses:[],protocols:[],metadata:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.addresses.push(bo.codec().decode(e,e.uint32()));break;case 2:r.protocols.push(e.string());break;case 3:r.metadata.push(mo.codec().decode(e,e.uint32()));break;case 4:r.pubKey=e.bytes();break;case 5:r.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(go||(go={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),(!0===r.writeDefaults||null!=e.multiaddr&&e.multiaddr.byteLength>0)&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.multiaddr=e.bytes();break;case 2:r.isCertified=e.bool();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(bo||(bo={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),!0!==r.writeDefaults&&""===e.key||(t.uint32(10),t.string(e.key)),(!0===r.writeDefaults||null!=e.value&&e.value.byteLength>0)&&(t.uint32(18),t.bytes(e.value)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={key:"",value:new Uint8Array(0)},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(mo||(mo={}));var wo=r(33412);const vo=(0,O.kg)("libp2p:peer-store:store"),Eo="/peers/";class Ao{constructor(e){this.components=e,this.lock=(0,wo.Z)({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(e){if(null==e.type)throw vo.error("peerId must be an instance of peer-id to store data"),B(new Error("peerId must be an instance of peer-id"),zi);const t=e.toCID().toString();return new Fr.s(`/peers/${t}`)}async has(e){return await this.components.datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this.components.datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){const t=await this.components.datastore.get(this._peerIdToDatastoreKey(e)),r=go.decode(t),n=new Map;for(const e of r.metadata)n.set(e.key,e.value);return{...r,id:e,addresses:r.addresses.map((({multiaddr:e,isCertified:t})=>({multiaddr:(0,ee.HM)(e),isCertified:t??!1}))),metadata:n,pubKey:r.pubKey??void 0,peerRecordEnvelope:r.peerRecordEnvelope??void 0}}async save(e){if(null!=e.pubKey&&null!=e.id.publicKey&&!Qi(e.pubKey,e.id.publicKey))throw vo.error("peer publicKey bytes do not match peer id publicKey bytes"),B(new Error("publicKey bytes do not match peer id publicKey bytes"),zi);const t=new Set,r=e.addresses.filter((e=>!t.has(e.multiaddr.toString())&&(t.add(e.multiaddr.toString()),!0))).sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((({multiaddr:e,isCertified:t})=>({multiaddr:e.bytes,isCertified:t}))),n=[];[...e.metadata.keys()].sort().forEach((t=>{const r=e.metadata.get(t);null!=r&&n.push({key:t,value:r})}));const s=go.encode({addresses:r,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:n,peerRecordEnvelope:e.peerRecordEnvelope});return await this.components.datastore.put(this._peerIdToDatastoreKey(e.id),s.subarray()),await this.load(e.id)}async patch(e,t){const r=await this.load(e);return await this._patch(e,t,r)}async patchOrCreate(e,t){let r;try{r=await this.load(e)}catch(t){if(t.code!==ji)throw t;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,r)}async _patch(e,t,r){return await this.save({...r,...t,id:e})}async merge(e,t){const r=await this.load(e);return await this._merge(e,t,r)}async mergeOrCreate(e,t){let r;try{r=await this.load(e)}catch(t){if(t.code!==ji)throw t;r={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,r)}async _merge(e,t,r){const n=new Map;return r.addresses.forEach((e=>{n.set(e.multiaddr.toString(),e.isCertified)})),(t.addresses??[]).forEach((e=>{const t=e.multiaddr.toString(),r=Boolean(n.get(t))||e.isCertified;n.set(t,r)})),await this.save({id:e,addresses:Array.from(n.entries()).map((([e,t])=>({multiaddr:(0,ee.HM)(e),isCertified:t}))),protocols:Array.from(new Set([...r.protocols??[],...t.protocols??[]])),metadata:new Map([...r.metadata?.entries()??[],...t.metadata?.entries()??[]]),pubKey:t.pubKey??(null!=r?r.pubKey:void 0),peerRecordEnvelope:t.peerRecordEnvelope??(null!=r?r.peerRecordEnvelope:void 0)})}async*all(){for await(const e of this.components.datastore.queryKeys({prefix:Eo})){const t=e.toString().split("/")[2],r=yo.decode(t);yield this.load((0,X.cv)(r))}}}var So,_o;!function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{if(!1!==r.lengthDelimited&&t.fork(),null!=e.tags)for(const r of e.tags)t.uint32(10),_o.codec().encode(r,t,{writeDefaults:!0});!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={tags:[]},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.tags.push(_o.codec().decode(e,e.uint32()));else e.skipType(7&t)}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(So||(So={})),function(e){let t;e.codec=()=>(null==t&&(t=(0,Te.yw)(((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),!0!==r.writeDefaults&&""===e.name||(t.uint32(10),t.string(e.name)),null!=e.value&&(t.uint32(16),t.uint32(e.value)),null!=e.expiry&&(t.uint32(24),t.uint64(e.expiry)),!1!==r.lengthDelimited&&t.ldelim()}),((e,t)=>{const r={name:""},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.name=e.string();break;case 2:r.value=e.uint32();break;case 3:r.expiry=e.uint64();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>(0,Te.LE)(t,e.codec()),e.decode=t=>(0,Te.C6)(t,e.codec())}(_o||(_o={}));const Co=(0,O.kg)("libp2p:peer-store");class ko extends N.v{constructor(e,t={}){super(),this.components=e,this.store=new Ao(e),this.addressBook=new Ji(this.dispatchEvent.bind(this),this.store,t.addressFilter),this.keyBook=new eo(this.dispatchEvent.bind(this),this.store),this.metadataBook=new no(this.dispatchEvent.bind(this),this.store),this.protoBook=new oo(this.dispatchEvent.bind(this),this.store)}async forEach(e){Co.trace("getPeers await read lock");const t=await this.store.lock.readLock();Co.trace("getPeers got read lock");try{for await(const t of this.store.all())t.id.equals(this.components.peerId)||e(t)}finally{Co.trace("getPeers release read lock"),t()}}async all(){const e=[];return await this.forEach((t=>{e.push(t)})),e}async delete(e){Co.trace("delete await write lock");const t=await this.store.lock.writeLock();Co.trace("delete got write lock");try{await this.store.delete(e)}finally{Co.trace("delete release write lock"),t()}}async get(e){Co.trace("get await read lock");const t=await this.store.lock.readLock();Co.trace("get got read lock");try{return await this.store.load(e)}finally{Co.trace("get release read lock"),t()}}async has(e){Co.trace("has await read lock");const t=await this.store.lock.readLock();Co.trace("has got read lock");try{return await this.store.has(e)}finally{Co.trace("has release read lock"),t()}}async tagPeer(e,t,r={}){const n=r.value??0,s=Math.round(n),i=r.ttl??void 0;if(s!==n||s<0||s>100)throw B(new Error("Tag value must be between 0-100"),"ERR_TAG_VALUE_OUT_OF_BOUNDS");const o=await this.metadataBook.getValue(e,"tags");let a=[];null!=o&&(a=So.decode(o).tags);for(const e of a)if(e.name===t)throw B(new Error("Peer already tagged"),"ERR_DUPLICATE_TAG");a.push({name:t,value:s,expiry:null==i?void 0:BigInt(Date.now()+i)}),await this.metadataBook.setValue(e,"tags",So.encode({tags:a}).subarray())}async unTagPeer(e,t){const r=await this.metadataBook.getValue(e,"tags");let n=[];null!=r&&(n=So.decode(r).tags),n=n.filter((e=>e.name!==t)),await this.metadataBook.setValue(e,"tags",So.encode({tags:n}).subarray())}async getTags(e){const t=await this.metadataBook.getValue(e,"tags");let r=[];null!=t&&(r=So.decode(t).tags);const n=BigInt(Date.now()),s=r.filter((e=>null==e.expiry||e.expiry>n));return s.length!==r.length&&await this.metadataBook.setValue(e,"tags",So.encode({tags:s}).subarray()),s.map((e=>({name:e.name,value:e.value??0})))}}class Io{constructor(e){this.dht=e}async provide(e){await(0,G.Z)(this.dht.provide(e))}async*findProviders(e,t={}){for await(const r of this.dht.findProviders(e,t))"PROVIDER"===r.name&&(yield*r.providers)}async put(e,t,r){await(0,G.Z)(this.dht.put(e,t,r))}async get(e,t){for await(const r of this.dht.get(e,t))if("VALUE"===r.name)return r.value;throw B(new Error("Not found"),"ERR_NOT_FOUND")}}class To{constructor(e={}){this._started=!1,this._peerId=e.peerId,this._addressManager=e.addressManager,this._peerStore=e.peerStore,this._upgrader=e.upgrader,this._metrics=e.metrics,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._connectionGater=e.connectionGater,this._contentRouting=e.contentRouting,this._peerRouting=e.peerRouting,this._datastore=e.datastore,this._connectionProtector=e.connectionProtector,this._dht=e.dht,this._pubsub=e.pubsub,this._dialer=e.dialer}isStarted(){return this._started}async beforeStart(){await Promise.all(Object.values(this).filter((e=>(0,L.qK)(e))).map((async e=>{null!=e.beforeStart&&await e.beforeStart()})))}async start(){await Promise.all(Object.values(this).filter((e=>(0,L.qK)(e))).map((async e=>{await e.start()}))),this._started=!0}async afterStart(){await Promise.all(Object.values(this).filter((e=>(0,L.qK)(e))).map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async beforeStop(){await Promise.all(Object.values(this).filter((e=>(0,L.qK)(e))).map((async e=>{null!=e.beforeStop&&await e.beforeStop()})))}async stop(){await Promise.all(Object.values(this).filter((e=>(0,L.qK)(e))).map((async e=>{await e.stop()}))),this._started=!1}async afterStop(){await Promise.all(Object.values(this).filter((e=>(0,L.qK)(e))).map((async e=>{null!=e.afterStop&&await e.afterStop()})))}get peerId(){if(null==this._peerId)throw B(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this._peerId}set peerId(e){this._peerId=e}get addressManager(){if(null==this._addressManager)throw B(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this._addressManager}set addressManager(e){this._addressManager=e}get peerStore(){if(null==this._peerStore)throw B(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this._peerStore}set peerStore(e){this._peerStore=e}get upgrader(){if(null==this._upgrader)throw B(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this._upgrader}set upgrader(e){this._upgrader=e}get registrar(){if(null==this._registrar)throw B(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this._registrar}set registrar(e){this._registrar=e}get connectionManager(){if(null==this._connectionManager)throw B(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this._connectionManager}set connectionManager(e){this._connectionManager=e}get transportManager(){if(null==this._transportManager)throw B(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this._transportManager}set transportManager(e){this._transportManager=e}get connectionGater(){if(null==this._connectionGater)throw B(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this._connectionGater}set connectionGater(e){this._connectionGater=e}get contentRouting(){if(null==this._contentRouting)throw B(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this._contentRouting}set contentRouting(e){this._contentRouting=e}get peerRouting(){if(null==this._peerRouting)throw B(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this._peerRouting}set peerRouting(e){this._peerRouting=e}get datastore(){if(null==this._datastore)throw B(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this._datastore}set datastore(e){this._datastore=e}get connectionProtector(){return this._connectionProtector}set connectionProtector(e){this._connectionProtector=e}get dialer(){if(null==this._dialer)throw B(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this._dialer}set dialer(e){this._dialer=e}get metrics(){return this._metrics}set metrics(e){this._metrics=e}get dht(){return this._dht}set dht(e){this._dht=e}get pubsub(){return this._pubsub}set pubsub(e){this._pubsub=e}}var xo=r(20030),Ro=r(11227),Po=r(73692);const Do=globalThis.fetch,Oo=globalThis.Headers;globalThis.Request,globalThis.Response;function No(e,t,r){return`${e}?name=${t}&type=${r}`}async function Lo(e,t){const r=await Do(e,{headers:new Oo({accept:"application/dns-json"}),signal:t});return await r.json()}function Uo(e,t){return`${t}_${e}`}const Bo=Object.assign(Ro("dns-over-http-resolver"),{error:Ro("dns-over-http-resolver:error")});const Mo=class{constructor(e={}){this._cache=new Po({max:e?.maxCache??100}),this._TXTcache=new Po({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??Lo,this._abortControllers=[]}cancel(){this._abortControllers.forEach((e=>e.abort()))}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e}setServers(e){this._servers=e}async resolve(e,t="A"){switch(t){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){const t="A",r=this._cache.get(Uo(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const s=new AbortController;this._abortControllers.push(s);try{const n=await this._request(No(r,e,t),s.signal),i=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(Uo(e,t),i,{ttl:o}),i}catch(t){s.signal.aborted&&(n=!0),Bo.error(`${r} could not resolve ${e} record A`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==s))}}if(n)throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record A`)}async resolve6(e){const t="AAAA",r=this._cache.get(Uo(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const s=new AbortController;this._abortControllers.push(s);try{const n=await this._request(No(r,e,t),s.signal),i=n.Answer.map((e=>e.data)),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._cache.set(Uo(e,t),i,{ttl:o}),i}catch(t){s.signal.aborted&&(n=!0),Bo.error(`${r} could not resolve ${e} record AAAA`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==s))}}if(n)throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record AAAA`)}async resolveTxt(e){const t="TXT",r=this._TXTcache.get(Uo(e,t));if(null!=r)return r;let n=!1;for(const r of this._getShuffledServers()){const s=new AbortController;this._abortControllers.push(s);try{const n=await this._request(No(r,e,t),s.signal),i=n.Answer.map((e=>[e.data.replace(/['"]+/g,"")])),o=Math.min(...n.Answer.map((e=>e.TTL)));return this._TXTcache.set(Uo(e,t),i,{ttl:o}),i}catch(t){s.signal.aborted&&(n=!0),Bo.error(`${r} could not resolve ${e} record TXT`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==s))}}if(n)throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record TXT`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}},{code:Vo}=(0,xo.Ev)("dnsaddr");const zo={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:100,maxDialsPerPeer:4,dialTimeout:3e4,inboundUpgradeTimeout:3e4,resolvers:{dnsaddr:async function(e,t={}){const r=new Mo;null!=t.signal&&t.signal.addEventListener("abort",(()=>{r.cancel()}));const n=e.getPeerId(),[,s]=e.stringTuples().find((([e])=>e===Vo))??[];if(null==s)throw new Error("No hostname found in multiaddr");let i=(await r.resolveTxt(`_dnsaddr.${s}`)).flat().map((e=>e.split("=")[1]));return null!=n&&(i=i.filter((e=>e.includes(n)))),i}},addressSorter:Lr},connectionGater:{},transportManager:{faultTolerance:kn.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:9e5,enabled:!1,ttl:18e5},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:Ai},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};var jo=r(34361);var Fo=r(59769);class $o extends N.v{get[Fo.N](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}get lan(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}get(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}findProviders(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}findPeer(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}getClosestPeers(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}provide(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}put(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}async getMode(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}async setMode(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}async refreshRoutingTable(){throw B(new Error(P.DHT_DISABLED),D.DHT_DISABLED)}}class qo extends N.v{constructor(){super(...arguments),this.topicValidators=new Map}isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}get multicodecs(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}getPeers(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}getTopics(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}subscribe(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}unsubscribe(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}getSubscribers(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}async publish(){throw B(new Error(P.PUBSUB_DISABLED),D.ERR_PUBSUB_DISABLED)}}var Ko=r(52770),Ho=r(32044),Go=r(35103);const Wo=(0,O.kg)("libp2p:dialer:dial-request");class Jo{constructor(e){const{addrs:t,dialAction:r,dialer:n}=e;this.addrs=t,this.dialer=n,this.dialAction=r}async run(e={}){const t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw B(new Error("No dial tokens available"),D.ERR_NO_DIAL_TOKENS);const r=new Go;for(const e of t)r.push(e).catch((e=>{Wo.error(e)}));const n=this.addrs.map((()=>{const e=new AbortController;try{(0,J.setMaxListeners)?.(1/0,e.signal)}catch{}return e}));if(null!=e.signal)try{(0,J.setMaxListeners)?.(1/0,e.signal)}catch{}let s=0,i=!1;try{return await Promise.any(this.addrs.map((async(o,a)=>{const c=await r.shift();if(i)throw this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0]),B(new Error("dialAction already succeeded"),D.ERR_ALREADY_SUCCEEDED);const h=n[a];if(null==h)throw B(new Error("dialAction did not come with an AbortController"),D.ERR_INVALID_PARAMETERS);let l;try{const i=h.signal;l=await this.dialAction(o,{...e,signal:null!=e.signal?(0,Ho.anySignal)([i,e.signal]):i}),n[a]=void 0}finally{s++,this.addrs.length-s>=t.length?r.push(c).catch((e=>{Wo.error(e)})):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}if(null==l)throw B(new Error("dialAction led to empty object"),D.ERR_TRANSPORT_DIAL_FAILED);return i=!0,l})))}finally{n.forEach((e=>{void 0!==e&&e.abort()})),t.forEach((e=>this.dialer.releaseToken(e)))}}}const Yo=(0,O.kg)("libp2p:dialer"),Qo="dialler";class Zo{constructor(e,t={}){this.started=!1,this.addressSorter=t.addressSorter??Lr,this.maxAddrsToDial=t.maxAddrsToDial??25,this.timeout=t.dialTimeout??3e4,this.maxDialsPerPeer=t.maxDialsPerPeer??4,this.tokens=[...new Array(t.maxParallelDials??100)].map(((e,t)=>t)),this.components=e,this.pendingDials=(0,Sn.s)({component:Qo,metric:"pending-dials",metrics:t.metrics}),this.pendingDialTargets=(0,Sn.s)({component:Qo,metric:"pending-dial-targets",metrics:e.metrics});for(const[e,r]of Object.entries(t.resolvers??{}))ee.s_.set(e,r)}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(const e of this.pendingDials.values())try{e.controller.abort()}catch(e){Yo.error(e)}this.pendingDials.clear();for(const e of this.pendingDialTargets.values())e.reject(new Ko._("Dialer was destroyed"));this.pendingDialTargets.clear()}async dial(e,t={}){const{id:r,multiaddrs:n}=re(e);if(this.components.peerId.equals(r))throw B(new Error("Tried to dial self"),D.ERR_DIALED_SELF);if(Yo("check multiaddrs %p",r),null!=n&&n.length>0&&(Yo("storing multiaddrs %p",r,n),await this.components.peerStore.addressBook.add(r,n)),await this.components.connectionGater.denyDialPeer(r))throw B(new Error("The dial request is blocked by gater.allowDialPeer"),D.ERR_PEER_DIAL_INTERCEPTED);Yo("creating dial target for %p",r);const s=await this._createCancellableDialTarget(r,t);if(0===s.addrs.length)throw B(new Error("The dial request has no valid addresses"),D.ERR_NO_VALID_ADDRESSES);const i=this.pendingDials.get(s.id)??this._createPendingDial(s,t);try{const e=await i.promise;return Yo("dial succeeded to %s",s.id),e}catch(e){throw Yo("dial failed to %s",s.id,e),i.controller.signal.aborted&&(e.code=D.ERR_TIMEOUT),Yo.error(e),e}finally{i.destroy()}}async _createCancellableDialTarget(e,t){const r=`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`,n=new Promise(((e,t)=>{this.pendingDialTargets.set(r,{resolve:e,reject:t})}));try{return await Promise.race([this._createDialTarget(e,t),n])}finally{this.pendingDialTargets.delete(r)}}async _createDialTarget(e,t){const r=this._resolve.bind(this),n=await(0,K.zG)(await this.components.peerStore.addressBook.get(e),(t=>(0,M.Z)(t,(async t=>!await this.components.connectionGater.denyDialMultiaddr(e,t.multiaddr)))),(e=>(0,Ae.Z)(e,this.addressSorter)),(async function*(e){for await(const n of e)yield*await r(n.multiaddr,t)}),(e=>(0,M.Z)(e,(e=>Boolean(this.components.transportManager.transportForMultiaddr(e))))),(t=>(0,V.Z)(t,(t=>e.toString()===t.getPeerId()?t:t.encapsulate(`/p2p/${e.toString()}`)))),(async e=>await(0,Ee.Z)(e)));if(n.length>this.maxAddrsToDial)throw await this.components.peerStore.delete(e),B(new Error("dial with more addresses than allowed"),D.ERR_TOO_MANY_ADDRESSES);return{id:e.toString(),addrs:n}}_createPendingDial(e,t={}){const r=new Jo({addrs:e.addrs,dialAction:async(e,t={})=>{if(!0===t.signal?.aborted)throw B(new Error("already aborted"),D.ERR_ALREADY_ABORTED);return await this.components.transportManager.dial(e,t).catch((t=>{throw Yo.error("dial to %s failed",e,t),t}))},dialer:this}),n=new $.TimeoutController(this.timeout),s=[n.signal];null!=t.signal&&s.push(t.signal);const i=(0,Ho.anySignal)(s);try{(0,J.setMaxListeners)?.(1/0,i)}catch{}const o={dialRequest:r,controller:n,promise:r.run({...t,signal:i}),destroy:()=>{n.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,o),o}getTokens(e){const t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),r=this.tokens.splice(0,t);return Yo("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),r}releaseToken(e){this.tokens.includes(e)||(Yo("token %d released",e),this.tokens.push(e))}async _resolve(e,t){if(!e.protoNames().includes("dnsaddr"))return[e];const r=await this._resolveRecord(e,t);return(await Promise.all(r.map((async e=>await this._resolve(e,t))))).flat().reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[])}async _resolveRecord(e,t){try{e=(0,ee.HM)(e.toString());return await e.resolve(t)}catch(t){return Yo.error(`multiaddr ${e.toString()} could not be resolved`,t),[]}}}const Xo=(0,O.kg)("libp2p");class ea extends N.v{constructor(e){super(),this.started=!1,this.peerId=e.peerId;const t=this.components=new To({peerId:e.peerId,datastore:e.datastore??new U.a,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...e.connectionGater}});t.peerStore=new ko(t,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore}),this.services=[t],e.metrics.enabled&&(this.metrics=this.components.metrics=new bn(e.metrics)),this.peerStore=this.components.peerStore,this.peerStore.addEventListener("peer",(e=>{const{detail:t}=e;this.dispatchEvent(new N.A("peer:discovery",{detail:t}))})),null!=e.connectionProtector&&(this.components.connectionProtector=e.connectionProtector(t)),this.components.upgrader=new wi(this.components,{connectionEncryption:(e.connectionEncryption??[]).map((e=>this.configureComponent(e(this.components)))),muxers:(e.streamMuxers??[]).map((e=>this.configureComponent(e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.components.dialer=new Zo(this.components,e.connectionManager),this.connectionManager=this.components.connectionManager=new ve(this.components,e.connectionManager),this.registrar=this.components.registrar=new gi(this.components),this.components.transportManager=new Cn(this.components,e.transportManager),this.components.addressManager=new se(this.components,e.addresses),this.configureComponent(new Mi(this.components)),this.configureComponent(new Ce(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));const r=cn.generateOptions();this.keychain=this.configureComponent(new cn(this.components,{...r,...e.keychain})),this.services.push(new Ui(this.components,e.nat)),e.transports.forEach((e=>{this.components.transportManager.add(this.configureComponent(e(this.components)))})),this.identifyService=new _i(this.components,{...e.identify}),this.configureComponent(this.identifyService),null!=e.dht?this.dht=this.components.dht=e.dht(this.components):this.dht=new $o,null!=e.pubsub?this.pubsub=this.components.pubsub=e.pubsub(this.components):this.pubsub=new qo;const n=(e.peerRouters??[]).map((e=>this.configureComponent(e(this.components))));null!=e.dht&&(n.push(this.configureComponent(new Vi(this.dht))),this.dht.addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))),this.peerRouting=this.components.peerRouting=this.configureComponent(new Q(this.components,{...e.peerRouting,routers:n}));const s=(e.contentRouters??[]).map((e=>this.configureComponent(e(this.components))));null!=e.dht&&s.push(this.configureComponent(new Io(this.dht))),this.contentRouting=this.components.contentRouting=this.configureComponent(new Z(this.components,{routers:s})),e.relay.enabled&&(this.components.transportManager.add(this.configureComponent(new qe(this.components,e.relay))),this.configureComponent(new zr(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new Ti(this.components,{...e.fetch})),this.pingService=this.configureComponent(new Ri(this.components,{...e.ping}));for(const t of e.peerDiscovery??[]){this.configureComponent(t(this.components)).addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))}}configureComponent(e){return(0,L.qK)(e)&&this.services.push(e),e}async start(){if(!this.started){this.started=!0,Xo("libp2p is starting");try{await Promise.all(this.services.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(this.services.map((e=>e.start()))),await Promise.all(this.services.map((async e=>{null!=e.afterStart&&await e.afterStart()}))),Xo("libp2p has started")}catch(e){throw Xo.error("An error occurred starting libp2p",e),await this.stop(),e}}}async stop(){this.started&&(Xo("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(this.services.map((e=>e.stop()))),await Promise.all(this.services.map((async e=>{null!=e.afterStop&&await e.afterStop()}))),Xo("libp2p has stopped"))}isStarted(){return this.started}getConnections(e){return this.components.connectionManager.getConnections(e)}getPeers(){const e=new pe.fd;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){const{id:r,multiaddrs:n}=re(e);return await this.components.peerStore.addressBook.add(r,n),await this.components.connectionManager.openConnection(r,t)}async dialProtocol(e,t,r={}){if(null==t)throw B(new Error("no protocols were provided to open a stream"),D.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw B(new Error("no protocols were provided to open a stream"),D.ERR_INVALID_PROTOCOLS_FOR_STREAM);const n=await this.dial(e,r);return await n.newStream(t,r)}getMultiaddrs(){return this.components.addressManager.getAddresses()}async hangUp(e){const{id:t}=re(e);await this.components.connectionManager.closeConnections(t)}async getPublicKey(e,t={}){if(Xo("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const r=await this.peerStore.get(e);if(null!=r.pubKey)return r.pubKey;if(null==this.dht)throw B(new Error("Public key was not in the peer store and the DHT is not enabled"),D.ERR_NO_ROUTERS_AVAILABLE);const n=function(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=Ar(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Er(r)}([Ir("/pk/"),e.multihash.digest]);for await(const r of this.dht.get(n,t))if("VALUE"===r.name){const t=(0,Wr.unmarshalPublicKey)(r.value);return await this.peerStore.keyBook.set(e,r.value),t.bytes}throw B(new Error(`Node not responding with its public key: ${e.toString()}`),D.ERR_INVALID_RECORD)}async fetch(e,t,r={}){const{id:n,multiaddrs:s}=re(e);return null!=s&&await this.components.peerStore.addressBook.add(n,s),await this.fetchService.fetch(n,t,r)}async ping(e,t={}){const{id:r,multiaddrs:n}=re(e);return n.length>0&&await this.components.peerStore.addressBook.add(r,n),await this.pingService.ping(r,t)}async handle(e,t,r){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,r)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}onDiscoveryPeer(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?(t.multiaddrs.length>0&&this.components.peerStore.addressBook.add(t.id,t.multiaddrs).catch((e=>Xo.error(e))),t.protocols.length>0&&this.components.peerStore.protoBook.set(t.id,t.protocols).catch((e=>Xo.error(e))),this.dispatchEvent(new N.A("peer:discovery",{detail:t}))):Xo.error(new Error(D.ERR_DISCOVERED_SELF))}}async function ta(e){return null==e.peerId&&(e.peerId=await(0,jo.n9)()),new ea(function(e){const t=(0,ie.Z)(zo,e);if(null==t.transports||t.transports.length<1)throw B(new Error(P.ERR_TRANSPORTS_REQUIRED),D.ERR_TRANSPORTS_REQUIRED);if(null==t.connectionEncryption||0===t.connectionEncryption.length)throw B(new Error(P.CONN_ENCRYPTION_REQUIRED),D.CONN_ENCRYPTION_REQUIRED);if(null===t.connectionProtector&&null!=globalThis.process?.env?.LIBP2P_FORCE_PNET)throw B(new Error(P.ERR_PROTECTOR_REQUIRED),D.ERR_PROTECTOR_REQUIRED);return t.identify.host.agentVersion===Ai&&(Pi.UG||Pi.$l?t.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(Pi.jU||Pi.n2||Pi.iP||Pi.b$)&&(t.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),t}(e))}async function ra(e){return await ta(e)}},40726:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=r(70942)},33412:(e,t,r)=>{"use strict";r.d(t,{Z:()=>_});var n=r(57665);class s extends Error{constructor(e){super(e),this.name="TimeoutError"}}class i extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const o=e=>void 0===globalThis.DOMException?new i(e):new DOMException(e),a=e=>{const t=void 0===e.reason?o("This operation was aborted."):e.reason;return t instanceof Error?t:o(t)};const c="lock:worker:request-read",h="lock:worker:release-read",l="lock:master:grant-read",u="lock:worker:request-write",d="lock:worker:release-write",f="lock:master:grant-write",p={},y=e=>{e.addEventListener("message",(t=>{y.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{y.dispatchEvent("message",e,t)}))};y.addEventListener=(e,t)=>{null==p[e]&&(p[e]=[]),p[e].push(t)},y.removeEventListener=(e,t)=>{null!=p[e]&&(p[e]=p[e].filter((e=>e===t)))},y.dispatchEvent=function(e,t,r){null!=p[e]&&p[e].forEach((e=>e(t,r)))};const g=y,b=(e,t,r,n,s)=>(i,o)=>{if(o.data.type!==r)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(i.postMessage({type:s,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=r=>{if(null==r||null==r.data)return;const s=r.data.type,o=(r.data.name,r.data.identifier);s===n&&o===a.identifier&&(i.removeEventListener("message",t),e())};i.addEventListener("message",t)})))}}))},m=(e,t,r,n)=>async()=>{const s=((e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),""))();return globalThis.postMessage({type:t,identifier:s,name:e}),await new Promise((t=>{const i=o=>{if(null==o||null==o.data)return;const a=o.data.type,c=o.data.identifier;a===r&&c===s&&(globalThis.removeEventListener("message",i),t((()=>{globalThis.postMessage({type:n,identifier:s,name:e})})))};globalThis.addEventListener("message",i)}))},w={singleProcess:!1},v={};let E;async function A(e,t){let r;const n=new Promise((e=>{r=e}));return e.add((async()=>await function(e,t){const{milliseconds:r,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=t;let c;const h=new Promise(((h,l)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r!==Number.POSITIVE_INFINITY){if(t.signal){const{signal:e}=t;e.aborted&&l(a(e)),e.addEventListener("abort",(()=>{l(a(e))}))}c=o.setTimeout.call(void 0,(()=>{if(n){try{h(n())}catch(e){l(e)}return}const t=i instanceof Error?i:new s("string"==typeof i?i:`Promise timed out after ${r} milliseconds`);"function"==typeof e.cancel&&e.cancel(),l(t)}),r),(async()=>{try{h(await e)}catch(e){l(e)}finally{o.clearTimeout.call(void 0,c)}})()}else h(e)}));return h.clear=()=>{o.clearTimeout.call(void 0,c),c=void 0},h}((async()=>await new Promise((e=>{r((()=>{e()}))})))(),{milliseconds:t.timeout}))),await n}const S={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function _(e){const t=Object.assign({},S,e);return null==E&&(E=(e=>{if(e=Object.assign({},w,e),Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return g.addEventListener("message",b(e,"requestReadLock",c,h,l)),g.addEventListener("message",b(e,"requestWriteLock",u,d,f)),e}return{isWorker:!0,readLock:e=>m(e,c,l,h),writeLock:e=>m(e,u,f,d)}})(t),!0!==E.isWorker&&(E.addEventListener("requestReadLock",(e=>{null!=v[e.data.name]&&v[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),E.addEventListener("requestWriteLock",(async e=>{null!=v[e.data.name]&&v[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==v[t.name]&&(v[t.name]=((e,t)=>{if(!0===E.isWorker)return{readLock:E.readLock(e,t),writeLock:E.writeLock(e,t)};const r=new n.Z({concurrency:1});let s;return{async readLock(){if(null!=s)return await A(s,t);s=new n.Z({concurrency:t.concurrency,autoStart:!1});const e=s,i=A(s,t);return r.add((async()=>(e.start(),await e.onIdle().then((()=>{s===e&&(s=null)}))))),await i},writeLock:async()=>(s=null,await A(r,t))}})(t.name,t)),v[t.name]}},89880:(e,t,r)=>{"use strict";r.d(t,{kU:()=>u,Dp:()=>l,ET:()=>d});const n=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==r[o])throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,s=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*h+1>>>0,o=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var u=0,d=i-1;(0!==l||u<s)&&-1!==d;d--,u++)l+=a*o[d]>>>0,o[d]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var f=i-s;f!==i&&0===o[f];)f++;for(var p=new Uint8Array(n+(i-f)),y=n;f!==i;)p[y++]=o[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,s=0,i=t.length;s!==i&&0===t[s];)s++,r++;for(var o=(i-s)*l+1>>>0,h=new Uint8Array(o);s!==i;){for(var u=t[s],d=0,f=o-1;(0!==u||d<n)&&-1!==f;f--,d++)u+=256*h[f]>>>0,h[f]=u%a>>>0,u=u/a>>>0;if(0!==u)throw new Error("Non-zero carry");n=d,s++}for(var p=o-n;p!==o&&0===h[p];)p++;for(var y=c.repeat(r);p<o;++p)y+=e.charAt(h[p]);return y},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw new Error(`Non-${t} character`)}}};var s=r(95934);class i{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class o{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return c(this,e)}}class a{constructor(e){this.decoders=e}or(e){return c(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const c=(e,t)=>new a({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class h{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new i(e,t,r),this.decoder=new o(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const l=({name:e,prefix:t,encode:r,decode:n})=>new h(e,t,r,n),u=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:o}=n(r,t);return l({prefix:e,name:t,encode:i,decode:e=>(0,s.coerce)(o(e))})},d=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>l({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],s=(1<<r)-1;let i="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,i+=t[s&a>>o];if(o&&(i+=t[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,h=0;for(let t=0;t<i;++t){const i=s[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)})},22817:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base32:()=>s,base32hex:()=>c,base32hexpad:()=>l,base32hexpadupper:()=>u,base32hexupper:()=>h,base32pad:()=>o,base32padupper:()=>a,base32upper:()=>i,base32z:()=>d});var n=r(89880);const s=(0,n.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i=(0,n.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,n.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,n.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,n.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),h=(0,n.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),l=(0,n.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),u=(0,n.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,n.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},99086:(e,t,r)=>{"use strict";r.r(t),r.d(t,{base58btc:()=>s,base58flickr:()=>i});var n=r(89880);const s=(0,n.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),i=(0,n.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},23256:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CID:()=>W.CID,bases:()=>Q,bytes:()=>y,codecs:()=>X,digest:()=>L,hasher:()=>Y,hashes:()=>Z,varint:()=>J});var n={};r.r(n),r.d(n,{identity:()=>g});var s={};r.r(s),r.d(s,{base2:()=>b});var i={};r.r(i),r.d(i,{base8:()=>m});var o={};r.r(o),r.d(o,{base10:()=>w});var a={};r.r(a),r.d(a,{base16:()=>v,base16upper:()=>E});var c={};r.r(c),r.d(c,{base36:()=>S,base36upper:()=>_});var h={};r.r(h),r.d(h,{base64:()=>k,base64pad:()=>I,base64url:()=>T,base64urlpad:()=>x});var l={};r.r(l),r.d(l,{base256emoji:()=>O});var u={};r.r(u),r.d(u,{identity:()=>B});var d={};r.r(d),r.d(d,{code:()=>V,decode:()=>j,encode:()=>z,name:()=>M});var f={};r.r(f),r.d(f,{code:()=>K,decode:()=>G,encode:()=>H,name:()=>q});var p=r(89880),y=r(95934);const g=(0,p.Dp)({prefix:"\0",name:"identity",encode:e=>(0,y.toString)(e),decode:e=>(0,y.fromString)(e)}),b=(0,p.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),m=(0,p.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),w=(0,p.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),v=(0,p.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),E=(0,p.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var A=r(22817);const S=(0,p.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),_=(0,p.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var C=r(99086);const k=(0,p.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),I=(0,p.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),T=(0,p.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),x=(0,p.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),R=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),P=R.reduce(((e,t,r)=>(e[r]=t,e)),[]),D=R.reduce(((e,t,r)=>(e[t.codePointAt(0)]=r,e)),[]);const O=(0,p.Dp)({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=P[t]),"")},decode:function(e){const t=[];for(const r of e){const e=D[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var N=r(56155),L=r(28924);const U=y.coerce,B={code:0,name:"identity",encode:U,digest:e=>L.create(0,U(e))},M="raw",V=85,z=e=>(0,y.coerce)(e),j=e=>(0,y.coerce)(e),F=new TextEncoder,$=new TextDecoder,q="json",K=512,H=e=>F.encode(JSON.stringify(e)),G=e=>JSON.parse($.decode(e));var W=r(81362),J=r(4714),Y=r(7225);const Q={...n,...s,...i,...o,...a,...A,...c,...C,...h,...l},Z={...N,...u},X={raw:d,json:f}},95934:(e,t,r)=>{"use strict";r.r(t),r.d(t,{coerce:()=>a,empty:()=>n,equals:()=>o,fromHex:()=>i,fromString:()=>h,isBinary:()=>c,toHex:()=>s,toString:()=>l});const n=new Uint8Array(0),s=e=>e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),i=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):n},o=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},a=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},c=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),h=e=>(new TextEncoder).encode(e),l=e=>(new TextDecoder).decode(e)},81362:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CID:()=>c});var n=r(4714),s=r(28924),i=r(99086),o=r(22817),a=r(95934);class c{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:b,byteLength:b,code:g,version:g,multihash:g,bytes:g,_baseCache:b,asCID:b})}toV0(){if(0===this.version)return this;{const{code:e,multihash:t}=this;if(e!==d)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==f)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return c.createV0(t)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=s.create(e,t);return c.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&s.equals(this.multihash,e.multihash)}toString(e){const{bytes:t,version:r,_baseCache:n}=this;return 0===r?l(t,n,e||i.base58btc.encoder):u(t,n,e||o.base32.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return m(/^0\.0/,w),!(!e||!e[y]&&e.asCID!==e)}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof c)return e;if(null!=e&&e.asCID===e){const{version:t,code:r,multihash:n,bytes:s}=e;return new c(t,r,n,s||p(t,r,n.bytes))}if(null!=e&&!0===e[y]){const{version:t,multihash:r,code:n}=e,i=s.decode(r);return c.create(t,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");switch(e){case 0:if(t!==d)throw new Error(`Version 0 CID must use dag-pb (code: ${d}) block encoding`);return new c(e,t,r,r.bytes);case 1:{const n=p(e,t,r.bytes);return new c(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return c.create(0,d,e)}static createV1(e,t){return c.create(1,e,t)}static decode(e){const[t,r]=c.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=c.inspectBytes(e),r=t.size-t.multihashSize,n=(0,a.coerce)(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new s.Digest(t.multihashCode,t.digestSize,i,n);return[0===t.version?c.createV0(o):c.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,s]=n.decode(e.subarray(t));return t+=s,r};let s=r(),i=d;if(18===s?(s=0,t=0):1===s&&(i=r()),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=r(),c=r(),h=t+c;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:h-o,size:h}}static parse(e,t){const[r,n]=h(e,t),s=c.decode(n);return s._baseCache.set(r,e),s}}const h=(e,t)=>{switch(e[0]){case"Q":{const r=t||i.base58btc;return[i.base58btc.prefix,r.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const r=t||i.base58btc;return[i.base58btc.prefix,r.decode(e)]}case o.base32.prefix:{const r=t||o.base32;return[o.base32.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},l=(e,t,r)=>{const{prefix:n}=r;if(n!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=t.get(n);if(null==s){const s=r.encode(e).slice(1);return t.set(n,s),s}return s},u=(e,t,r)=>{const{prefix:n}=r,s=t.get(n);if(null==s){const s=r.encode(e);return t.set(n,s),s}return s},d=112,f=18,p=(e,t,r)=>{const s=n.encodingLength(e),i=s+n.encodingLength(t),o=new Uint8Array(i+r.byteLength);return n.encodeTo(e,o,0),n.encodeTo(t,o,s),o.set(r,i),o},y=Symbol.for("@ipld/js-cid/CID"),g={writable:!1,configurable:!1,enumerable:!0},b={writable:!1,enumerable:!1,configurable:!1},m=(e,t)=>{if(!e.test("0.0.0-dev"))throw new Error(t);console.warn(t)},w="CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n"},28924:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Digest:()=>c,create:()=>i,decode:()=>o,equals:()=>a});var n=r(95934),s=r(4714);const i=(e,t)=>{const r=t.byteLength,n=s.encodingLength(e),i=n+s.encodingLength(r),o=new Uint8Array(i+r);return s.encodeTo(e,o,0),s.encodeTo(r,o,n),o.set(t,i),new c(e,r,t,o)},o=e=>{const t=(0,n.coerce)(e),[r,i]=s.decode(t),[o,a]=s.decode(t.subarray(i)),h=t.subarray(i+a);if(h.byteLength!==o)throw new Error("Incorrect length");return new c(r,o,h,t)},a=(e,t)=>e===t||e.code===t.code&&e.size===t.size&&(0,n.equals)(e.bytes,t.bytes);class c{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}},7225:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Hasher:()=>i,from:()=>s});var n=r(28924);const s=({name:e,code:t,encode:r})=>new i(e,t,r);class i{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?n.create(this.code,t):t.then((e=>n.create(this.code,e)))}throw Error("Unknown type, must be binary type")}}},56155:(e,t,r)=>{"use strict";r.r(t),r.d(t,{sha256:()=>i,sha512:()=>o});var n=r(7225);const s=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),i=(0,n.from)({name:"sha2-256",code:18,encode:s("SHA-256")}),o=(0,n.from)({name:"sha2-512",code:19,encode:s("SHA-512")})},4714:(e,t,r)=>{"use strict";r.r(t),r.d(t,{decode:()=>g,encodeTo:()=>b,encodingLength:()=>m});var n=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=s;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},s=Math.pow(2,31);var i=function e(t,r){var n,s=0,i=0,o=r=r||0,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],s+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=o-r,s};var o=Math.pow(2,7),a=Math.pow(2,14),c=Math.pow(2,21),h=Math.pow(2,28),l=Math.pow(2,35),u=Math.pow(2,42),d=Math.pow(2,49),f=Math.pow(2,56),p=Math.pow(2,63);const y={encode:n,decode:i,encodingLength:function(e){return e<o?1:e<a?2:e<c?3:e<h?4:e<l?5:e<u?6:e<d?7:e<f?8:e<p?9:10}},g=(e,t=0)=>[y.decode(e,t),y.decode.bytes],b=(e,t,r=0)=>(y.encode(e,t,r),t),m=e=>y.encodingLength(e)},85275:(e,t,r)=>{"use strict";function n(){const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}r.d(t,{Z:()=>n})},57665:(e,t,r)=>{"use strict";r.d(t,{Z:()=>j});var n=r(26729);class s extends Error{constructor(e){super(e),this.name="TimeoutError"}}class i extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const o=e=>void 0===globalThis.DOMException?new i(e):new DOMException(e),a=e=>{const t=void 0===e.reason?o("This operation was aborted."):e.reason;return t instanceof Error?t:o(t)};var c,h=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class l{constructor(){c.set(this,[])}enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&h(this,c,"f")[this.size-1].priority>=t.priority)return void h(this,c,"f").push(r);const n=function(e,t,r){let n=0,s=e.length;for(;s>0;){const i=Math.trunc(s/2);let o=n+i;r(e[o],t)<=0?(n=++o,s-=i+1):s=i}return n}(h(this,c,"f"),r,((e,t)=>t.priority-e.priority));h(this,c,"f").splice(n,0,r)}dequeue(){const e=h(this,c,"f").shift();return null==e?void 0:e.run}filter(e){return h(this,c,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return h(this,c,"f").length}}c=new WeakMap;var u,d,f,p,y,g,b,m,w,v,E,A,S,_,C,k,I,T,x,R,P,D,O,N,L,U,B=function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},M=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};const V=new s;class z extends Error{}class j extends n{constructor(e){var t,r,n,s;if(super(),u.add(this),d.set(this,void 0),f.set(this,void 0),p.set(this,0),y.set(this,void 0),g.set(this,void 0),b.set(this,0),m.set(this,void 0),w.set(this,void 0),v.set(this,void 0),E.set(this,void 0),A.set(this,0),S.set(this,void 0),_.set(this,void 0),C.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:l,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(s=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==s?s:""}\` (${typeof e.interval})`);B(this,d,e.carryoverConcurrencyCount,"f"),B(this,f,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),B(this,y,e.intervalCap,"f"),B(this,g,e.interval,"f"),B(this,v,new e.queueClass,"f"),B(this,E,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,B(this,C,!0===e.throwOnTimeout,"f"),B(this,_,!1===e.autoStart,"f")}get concurrency(){return M(this,S,"f")}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);B(this,S,e,"f"),M(this,u,"m",L).call(this)}async add(e,t={}){return new Promise(((r,n)=>{M(this,v,"f").enqueue((async()=>{var i,o,c;B(this,A,(o=M(this,A,"f"),++o),"f"),B(this,p,(c=M(this,p,"f"),++c),"f");try{if(null===(i=t.signal)||void 0===i?void 0:i.aborted)return void n(new z("The task was aborted."));const o=void 0===this.timeout&&void 0===t.timeout?e({signal:t.signal}):function(e,t,r,n){let i;const o=new Promise(((o,c)=>{if("number"!=typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if((n={customTimers:{setTimeout,clearTimeout},...n}).signal){const{signal:e}=n;e.aborted&&c(a(e)),e.addEventListener("abort",(()=>{c(a(e))}))}i=n.customTimers.setTimeout.call(void 0,(()=>{if("function"==typeof r){try{o(r())}catch(e){c(e)}return}const n=r instanceof Error?r:new s("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),c(n)}),t),(async()=>{try{o(await e)}catch(e){c(e)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()}else o(e)}));return o.clear=()=>{clearTimeout(i),i=void 0},o}(Promise.resolve(e({signal:t.signal})),void 0===t.timeout?this.timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?M(this,C,"f"):t.throwOnTimeout)&&n(V)})),c=await o;r(c),this.emit("completed",c)}catch(e){n(e),this.emit("error",e)}M(this,u,"m",T).call(this)}),t),M(this,u,"m",D).call(this),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return M(this,_,"f")?(B(this,_,!1,"f"),M(this,u,"m",L).call(this),this):this}pause(){B(this,_,!0,"f")}clear(){B(this,v,new(M(this,E,"f")),"f")}async onEmpty(){0!==M(this,v,"f").size&&await M(this,u,"m",U).call(this,"empty")}async onSizeLessThan(e){M(this,v,"f").size<e||await M(this,u,"m",U).call(this,"next",(()=>M(this,v,"f").size<e))}async onIdle(){0===M(this,A,"f")&&0===M(this,v,"f").size||await M(this,u,"m",U).call(this,"idle")}get size(){return M(this,v,"f").size}sizeBy(e){return M(this,v,"f").filter(e).length}get pending(){return M(this,A,"f")}get isPaused(){return M(this,_,"f")}}d=new WeakMap,f=new WeakMap,p=new WeakMap,y=new WeakMap,g=new WeakMap,b=new WeakMap,m=new WeakMap,w=new WeakMap,v=new WeakMap,E=new WeakMap,A=new WeakMap,S=new WeakMap,_=new WeakMap,C=new WeakMap,u=new WeakSet,k=function(){return M(this,f,"f")||M(this,p,"f")<M(this,y,"f")},I=function(){return M(this,A,"f")<M(this,S,"f")},T=function(){var e;B(this,A,(e=M(this,A,"f"),--e),"f"),M(this,u,"m",D).call(this),this.emit("next")},x=function(){this.emit("empty"),0===M(this,A,"f")&&this.emit("idle")},R=function(){M(this,u,"m",N).call(this),M(this,u,"m",O).call(this),B(this,w,void 0,"f")},P=function(){const e=Date.now();if(void 0===M(this,m,"f")){const t=M(this,b,"f")-e;if(!(t<0))return void 0===M(this,w,"f")&&B(this,w,setTimeout((()=>{M(this,u,"m",R).call(this)}),t),"f"),!0;B(this,p,M(this,d,"f")?M(this,A,"f"):0,"f")}return!1},D=function(){if(0===M(this,v,"f").size)return M(this,m,"f")&&clearInterval(M(this,m,"f")),B(this,m,void 0,"f"),M(this,u,"m",x).call(this),!1;if(!M(this,_,"f")){const e=!M(this,u,"a",P);if(M(this,u,"a",k)&&M(this,u,"a",I)){const t=M(this,v,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&M(this,u,"m",O).call(this),!0)}}return!1},O=function(){M(this,f,"f")||void 0!==M(this,m,"f")||(B(this,m,setInterval((()=>{M(this,u,"m",N).call(this)}),M(this,g,"f")),"f"),B(this,b,Date.now()+M(this,g,"f"),"f"))},N=function(){0===M(this,p,"f")&&0===M(this,A,"f")&&M(this,m,"f")&&(clearInterval(M(this,m,"f")),B(this,m,void 0,"f")),B(this,p,M(this,d,"f")?M(this,A,"f"):0,"f"),M(this,u,"m",L).call(this)},L=function(){for(;M(this,u,"m",D).call(this););},U=async function(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))}},92816:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});let n=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function s(e="",t="ms"){var r=null;return(e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2")).replace(n,(function(e,t,n){(n=i(n))&&(r=(r||0)+parseFloat(t,10)*n)})),r&&r/(i(t)||1)}function i(e){return s[e]||s[e.toLowerCase().replace(/s$/,"")]}s.nanosecond=s.ns=1e-6,s["µs"]=s["μs"]=s.us=s.microsecond=.001,s.millisecond=s.ms=s[""]=1,s.second=s.sec=s.s=1e3*s.ms,s.minute=s.min=s.m=60*s.s,s.hour=s.hr=s.h=60*s.m,s.day=s.d=24*s.h,s.week=s.wk=s.w=7*s.d,s.month=s.b=30.4375*s.d,s.year=s.yr=s.y=365.25*s.d;const o=s},46888:(e,t,r)=>{"use strict";r.d(t,{C6:()=>l,LE:()=>u,Ji:()=>p,yw:()=>y});var n=r(51408),s=r(50593),i=r(41173),o=r(43155);r(99693)._configure(),n._configure(s),i._configure(o);const a=["uint64","int64","sint64","fixed64","sfixed64"];function c(e){return function(e){for(const t of a){if(null==e[t])continue;const r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}(new n(e))}function h(){return function(e){for(const t of a){if(null==e[t])continue;const r=e[t];e[t]=function(e){return r.call(this,e.toString())}}return e}(i.create())}function l(e,t){const r=c(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function u(e,t){const r=h();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var d;function f(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function p(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return f("enum",d.VARINT,(function(e,r){const n=t(e);r.int32(n)}),(function(e){return t(e.int32())}))}function y(e,t){return f("message",d.LENGTH_DELIMITED,e,t)}!function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(d||(d={}))},77443:(e,t,r)=>{"use strict";function n(e){return e instanceof Uint8Array?{get:t=>e[t],set(t,r){e[t]=r}}:{get:t=>e.get(t),set(t,r){e.set(t,r)}}}r.d(t,{hG:()=>g});const s=4294967296;class i{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(!0===e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){const e=-(1&this.lo),t=((this.lo>>>1|this.hi<<31)^e)>>>0,r=(this.hi>>>1^e)>>>0;return new i(r,t)}zzEncode(){const e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,r=(this.lo<<1^e)>>>0;return new i(t,r)}toBytes(e,t=0){const r=n(e);for(;this.hi>0;)r.set(t++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)r.set(t++,127&this.lo|128),this.lo=this.lo>>>7;r.set(t++,this.lo)}static fromBigInt(e){if(0n===e)return new i;const t=e<0;t&&(e=-e);let r=0|Number(e>>32n),n=0|Number(e-(BigInt(r)<<32n));return t&&(r=~r>>>0,n=~n>>>0,++n>s&&(n=0,++r>s&&(r=0))),new i(r,n)}static fromNumber(e){if(0===e)return new i;const t=e<0;t&&(e=-e);let r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(n,r)}static fromBytes(e,t=0){const r=n(e),s=new i;let o=0;if(e.length-t>4){for(;o<4;++o)if(s.lo=(s.lo|(127&r.get(t))<<7*o)>>>0,r.get(t++)<128)return s;if(s.lo=(s.lo|(127&r.get(t))<<28)>>>0,s.hi=(s.hi|(127&r.get(t))>>4)>>>0,r.get(t++)<128)return s;o=0}else for(;o<4;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(s.lo=(s.lo|(127&r.get(t))<<7*o)>>>0,r.get(t++)<128)return s}if(e.length-t>4){for(;o<5;++o)if(s.hi=(s.hi|(127&r.get(t))<<7*o+3)>>>0,r.get(t++)<128)return s}else if(t<e.byteLength)for(;o<5;++o){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(s.hi=(s.hi|(127&r.get(t))<<7*o+3)>>>0,r.get(t++)<128)return s}throw RangeError("invalid varint encoding")}}function o(e=0){return null!=globalThis.Buffer?.allocUnsafe?(t=globalThis.Buffer.allocUnsafe(e),null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t):new Uint8Array(e);var t}const a=Math.pow(2,7),c=Math.pow(2,14),h=Math.pow(2,21),l=Math.pow(2,28),u=Math.pow(2,35),d=Math.pow(2,42),f=Math.pow(2,49),p=Math.pow(2,56),y=Math.pow(2,63),g={encodingLength:e=>e<a?1:e<c?2:e<h?3:e<l?4:e<u?5:e<d?6:e<f?7:e<p?8:e<y?9:10,encode(e,t,r=0){if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==t&&(t=o(g.encodingLength(e))),i.fromNumber(e).toBytes(t,r),t},decode:(e,t=0)=>i.fromBytes(e,t).toNumber(!0)}},90581:(e,t,r)=>{"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function s(e=0){return null!=globalThis.Buffer?.alloc?n(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function i(e=0){return null!=globalThis.Buffer?.allocUnsafe?n(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function o(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const r=i(t);let s=0;for(const t of e)r.set(t,s),s+=t.length;return n(r)}function a(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}r.d(t,{H:()=>u,Z:()=>l});const c=Symbol.for("@achingbrain/uint8arraylist");function h(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let r=0;for(const n of e){const e=r+n.byteLength;if(t<e)return{buf:n,index:t-r};r=e}throw new RangeError("index is out of bounds")}function l(e){return Boolean(e?.[c])}class u{constructor(...e){Object.defineProperty(this,c,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const r of e)if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.push(r);else{if(!l(r))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.push(...r.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const r of e.reverse())if(r instanceof Uint8Array)t+=r.byteLength,this.bufs.unshift(r);else{if(!l(r))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=r.byteLength,this.bufs.unshift(...r.bufs)}this.length+=t}get(e){const t=h(this.bufs,e);return t.buf[t.index]}set(e,t){const r=h(this.bufs,e);r.buf[r.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let r=0;r<e.length;r++)this.set(t+r,e[r]);else{if(!l(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let r=0;r<e.length;r++)this.set(t+r,e.get(r))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:r,length:n}=this._subList(e,t);return o(r,n)}subarray(e,t){const{bufs:r,length:n}=this._subList(e,t);return 1===r.length?r[0]:o(r,n)}sublist(e,t){const{bufs:r,length:n}=this._subList(e,t),s=new u;return s.length=n,s.bufs=r,s}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const r=[];let n=0;for(let s=0;s<this.bufs.length;s++){const i=this.bufs[s],o=n,a=o+i.byteLength;if(n=a,e>=a)continue;const c=e>=o&&e<a,h=t>o&&t<=a;if(c&&h){if(e===o&&t===a){r.push(i);break}const n=e-o;r.push(i.subarray(n,n+(t-e)));break}if(c){if(0===e){r.push(i);continue}r.push(i.subarray(e-o))}else{if(h){if(t===a){r.push(i);break}r.push(i.subarray(0,t-o));break}r.push(i)}}return{bufs:r,length:t-e}}indexOf(e,t=0){if(!(l(e)||e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const n=r.byteLength;if(0===n)throw new TypeError("search must be at least 1 byte long");const s=new Int32Array(256);for(let e=0;e<256;e++)s[e]=-1;for(let e=0;e<n;e++)s[r[e]]=e;const i=s,o=this.byteLength-r.byteLength,a=r.byteLength-1;let c;for(let e=t;e<=o;e+=c){c=0;for(let t=a;t>=0;t--){const n=this.get(e+t);if(r[t]!==n){c=Math.max(1,t-i[n]);break}}if(0===c)return e}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const r=i(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,t),this.write(r,e)}getInt16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,t)}setInt16(e,t,r){const n=s(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt16(0,t,r),this.write(n,e)}getInt32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,t)}setInt32(e,t,r){const n=s(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt32(0,t,r),this.write(n,e)}getBigInt64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,t)}setBigInt64(e,t,r){const n=s(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigInt64(0,t,r),this.write(n,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const r=i(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,t),this.write(r,e)}getUint16(e,t){const r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,t)}setUint16(e,t,r){const n=s(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,t,r),this.write(n,e)}getUint32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,t)}setUint32(e,t,r){const n=s(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,t,r),this.write(n,e)}getBigUint64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,t)}setBigUint64(e,t,r){const n=s(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigUint64(0,t,r),this.write(n,e)}getFloat32(e,t){const r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,t)}setFloat32(e,t,r){const n=s(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat32(0,t,r),this.write(n,e)}getFloat64(e,t){const r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,t)}setFloat64(e,t,r){const n=s(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat64(0,t,r),this.write(n,e)}equals(e){if(null==e)return!1;if(!(e instanceof u))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!a(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const r=new u;return r.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),r.length=t,r}}},53160:(e,t,r)=>{"use strict";r.d(t,{E:()=>s});var n=r(16867);function s(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(0,n.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},20605:(e,t,r)=>{"use strict";r.r(t),r.d(t,{concat:()=>i});var n=r(53160),s=r(16867);function i(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=(0,n.E)(t);let i=0;for(const t of e)r.set(t,i),i+=t.length;return(0,s.P)(r)}},19588:(e,t,r)=>{"use strict";function n(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}r.r(t),r.d(t,{equals:()=>n})},52217:(e,t,r)=>{"use strict";r.r(t),r.d(t,{fromString:()=>i});var n=r(67645),s=r(16867);function i(e,t="utf8"){const r=n.Z[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):(0,s.P)(globalThis.Buffer.from(e,"utf-8"))}},92263:(e,t,r)=>{"use strict";r.r(t),r.d(t,{toString:()=>s});var n=r(67645);function s(e,t="utf8"){const r=n.Z[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},16867:(e,t,r)=>{"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}r.d(t,{P:()=>n})},67645:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(23256),s=r(53160);function i(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const o=i("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),a=i("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=(0,s.E)(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),c={utf8:o,"utf-8":o,hex:n.bases.base16,latin1:a,ascii:a,binary:a,...n.bases}},14560:(e,t,r)=>{"use strict";r.d(t,{$l:()=>a,UG:()=>h,b$:()=>u,iP:()=>c,jU:()=>o,n2:()=>l});var n=r(59134);const s="object"==typeof window&&"object"==typeof document&&9===document.nodeType,i=n(),o=s&&!i,a=i&&!s,c=i&&s,h=void 0!==globalThis.process&&void 0!==globalThis.process.release&&"node"===globalThis.process.release.name&&!i,l="function"==typeof importScripts&&"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,u=(void 0!==globalThis.process&&void 0!==globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!=typeof navigator&&"ReactNative"===navigator.product)}},__webpack_module_cache__={},deferred,leafPrototypes,getProto;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,r,n)=>{if(!t){var s=1/0;for(c=0;c<deferred.length;c++){for(var[t,r,n]=deferred[c],i=!0,o=0;o<t.length;o++)(!1&n||s>=n)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[o])))?t.splice(o--,1):(i=!1,n<s&&(s=n));if(i){deferred.splice(c--,1);var a=r();void 0!==a&&(e=a)}}return e}n=n||0;for(var c=deferred.length;c>0&&deferred[c-1][2]>n;c--)deferred[c]=deferred[c-1];deferred[c]=[t,r,n]},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var r=Object.create(null);__webpack_require__.r(r);var n={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var s=2&t&&e;"object"==typeof s&&!~leafPrototypes.indexOf(s);s=getProto(s))Object.getOwnPropertyNames(s).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,__webpack_require__.d(r,n),r},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={891:0};__webpack_require__.O.j=t=>0===e[t];var t=(t,r)=>{var n,s,[i,o,a]=r,c=0;if(i.some((t=>0!==e[t]))){for(n in o)__webpack_require__.o(o,n)&&(__webpack_require__.m[n]=o[n]);if(a)var h=a(__webpack_require__)}for(t&&t(r);c<i.length;c++)s=i[c],__webpack_require__.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return __webpack_require__.O(h)},r=self.webpackChunkipfs_companion=self.webpackChunkipfs_companion||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var __webpack_exports__=__webpack_require__.O(void 0,[384],(()=>__webpack_require__(70514)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();