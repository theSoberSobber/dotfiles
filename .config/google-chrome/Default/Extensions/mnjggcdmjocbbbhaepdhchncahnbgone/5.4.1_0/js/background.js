(()=>{"use strict";var e={2697:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendRequestToCustomServer=t.setupBackgroundRequestProxy=t.sendRealRequestToCustomServer=void 0;const i=o(8884);function r(e,t,o={}){return n(this,void 0,void 0,(function*(){return"get"===e.toLowerCase()&&(t=(0,i.objectToURI)(t,o,!0),o=null),yield fetch(t,{method:e,headers:{"Content-Type":"application/json"},redirect:"follow",body:o?JSON.stringify(o):null})}))}t.sendRealRequestToCustomServer=r,t.setupBackgroundRequestProxy=function(){chrome.runtime.onMessage.addListener(((e,t,o)=>"sendRequest"===e.message&&(r(e.type,e.url,e.data).then((e=>n(this,void 0,void 0,(function*(){o({responseText:yield e.text(),status:e.status,ok:e.ok})})))),!0)))},t.sendRequestToCustomServer=function(e,t,o={}){return new Promise((n=>{chrome.runtime.sendMessage({message:"sendRequest",type:e,url:t,data:o},(e=>{n(e)}))}))}},4219:function(e,t){var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoConfig=void 0,t.ProtoConfig=class{constructor(e,t,o){this.configLocalListeners=[],this.configSyncListeners=[],this.cachedSyncConfig=null,this.cachedLocalStorage=null,this.config=null,this.local=null,this.syncDefaults=e,this.localDefaults=t,this.setupConfig(o).then((e=>{this.config=null==e?void 0:e.sync,this.local=null==e?void 0:e.local}))}configProxy(){chrome.storage.onChanged.addListener(((e,t)=>{if("sync"===t){for(const t in e)this.cachedSyncConfig[t]=e[t].newValue;for(const t of this.configSyncListeners)t(e)}else if("local"===t){for(const t in e)this.cachedLocalStorage[t]=e[t].newValue;for(const t of this.configLocalListeners)t(e)}}));const e=this,t={set:(t,o,n)=>(e.cachedSyncConfig[o]=n,chrome.storage.sync.set({[o]:n}),!0),get(t,o){const n=e.cachedSyncConfig[o];return t[o]||n},deleteProperty:(e,t)=>(chrome.storage.sync.remove(t),!0)},o={set:(t,o,n)=>(e.cachedLocalStorage[o]=n,chrome.storage.local.set({[o]:n}),!0),get(t,o){const n=e.cachedLocalStorage[o];return t[o]||n},deleteProperty:(e,t)=>(chrome.storage.local.remove(t),!0)};return{sync:new Proxy({handler:t},t),local:new Proxy({handler:o},o)}}forceSyncUpdate(e){const t=this.cachedSyncConfig[e];if("unsubmittedSegments"===e&&JSON.stringify(t).length+e.length>8e3)for(const e in t)(!t[e]||t[e].length<=0)&&delete t[e];chrome.storage.sync.set({[e]:t})}forceLocalUpdate(e){chrome.storage.local.set({[e]:this.cachedLocalStorage[e]})}fetchConfig(){return o(this,void 0,void 0,(function*(){yield Promise.all([new Promise((e=>{chrome.storage.sync.get(null,(t=>{this.cachedSyncConfig=t,e()}))})),new Promise((e=>{chrome.storage.local.get(null,(t=>{this.cachedLocalStorage=t,e()}))}))])}))}setupConfig(e){return o(this,void 0,void 0,(function*(){if("undefined"==typeof chrome)return null;yield this.fetchConfig(),this.addDefaults();const t=this.configProxy();return e(t.sync),t}))}addDefaults(){for(const e in this.syncDefaults)if(Object.prototype.hasOwnProperty.call(this.cachedSyncConfig,e)){if("barTypes"===e)for(const t in this.syncDefaults[e])Object.prototype.hasOwnProperty.call(this.cachedSyncConfig[e],t)||(this.cachedSyncConfig[e][t]=this.syncDefaults[e][t])}else this.cachedSyncConfig[e]=this.syncDefaults[e];for(const e in this.localDefaults)Object.prototype.hasOwnProperty.call(this.cachedLocalStorage,e)||(this.cachedLocalStorage[e]=this.localDefaults[e])}isReady(){return null!==this.config}}},7984:function(e,t){var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};function n(e){return!!e&&e.offsetWidth>0&&e.offsetHeight>0}function i(e){return r(e)}function r(e,t){for(const o of e){const e=t?t(o):o;if(e&&n(e))return e}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.waitForElement=t.findValidElement=t.findValidElementFromSelector=t.isVisible=void 0,t.isVisible=n,t.findValidElementFromSelector=function(e){return r(e,(e=>document.querySelector(e)))},t.findValidElement=i;let s=!1,a=null,c=[];function l(){if(!a){const e=()=>{const e=[];for(const{selector:t,visibleCheck:o,callback:n}of c){const i=u(t,o);i&&(n(i),e.push(t))}c=c.filter((t=>!e.includes(t.selector))),0===c.length&&(null==a||a.disconnect(),a=null,s=!1)};e(),c.length>0&&(a=new MutationObserver(e),a.observe(document.body,{childList:!0,subtree:!0}))}}function u(e,t){return t?i(document.querySelectorAll(e)):document.querySelector(e)}t.waitForElement=function(e,t=!1){return o(this,void 0,void 0,(function*(){return yield new Promise((o=>{const n=u(e,t);n?o(n):(c.push({selector:e,visibleCheck:t,callback:o}),s||(s=!0,document.body?l():window.addEventListener("DOMContentLoaded",(()=>{l()}))))}))}))}},6031:function(e,t){var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=void 0,t.getHash=function(e,t=5e3){return o(this,void 0,void 0,(function*(){if(t<=0)return"";let o=e;for(let e=0;e<t;e++){const e=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(o).buffer);o=Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return o}))}},8884:function(e,t){var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.objectToURI=t.waitFor=void 0,t.waitFor=function(e,t=5e3,n=100,i){return o(this,void 0,void 0,(function*(){return yield new Promise(((o,r)=>{setTimeout((()=>{clearInterval(a),r("TIMEOUT")}),t);const s=()=>{const t=e();(i?i(t):t)&&(o(t),clearInterval(a))},a=setInterval(s,n);s()}))}))},t.objectToURI=function(e,t,o){let n=0;for(const i in t){const r=e.includes("?")||n>0?"&":o?"?":"",s="string"==typeof t[i]?t[i]:JSON.stringify(t[i]);e+=r+encodeURIComponent(i)+"="+encodeURIComponent(s),n++}return e}},7957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUserID=void 0,t.generateUserID=function(e=36){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let o="";if(window.crypto&&window.crypto.getRandomValues){const n=new Uint32Array(e);window.crypto.getRandomValues(n);for(let i=0;i<e;i++)o+=t[n[i]%t.length];return o}for(let n=0;n<e;n++)o+=t[Math.floor(Math.random()*t.length)];return o}},3098:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupTabUpdates=void 0;const n=o(8884);function i(e){chrome.tabs.sendMessage(e,{message:"update"},(()=>{chrome.runtime.lastError}))}function r(e){e.navigationApiAvailable&&(e.navigationApiAvailable.newValue?chrome.tabs.onUpdated.removeListener(i):chrome.tabs.onUpdated.addListener(i))}t.setupTabUpdates=function(e){chrome.tabs.onUpdated.addListener(i),(0,n.waitFor)((()=>null!==e.local)).then((()=>{e.local.navigationApiAvailable&&chrome.tabs.onUpdated.removeListener(i)})),e.configSyncListeners.includes(r)||e.configSyncListeners.push(r)}},1051:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(1181),r=o(7542);o(7592);const s=o(2697),a=o(3098),c=o(7957);window.SB=r.default;const l=new(o(3147).default)({registerFirefoxContentScript:p,unregisterFirefoxContentScript:f}),u={},d={};function p(e){const t=d[e.id];t&&t.unregister(),chrome.contentScripts.register({allFrames:e.allFrames,js:e.js,css:e.css,matches:e.matches}).then((t=>{d[e.id]=t}))}function f(e){d[e]&&(d[e].unregister(),delete d[e])}l.wait((()=>null!==r.default.config)).then((function(){r.default.config.supportInvidious&&l.setupExtraSiteContentScripts()})),(0,s.setupBackgroundRequestProxy)(),(0,a.setupTabUpdates)(r.default),chrome.runtime.onMessage.addListener((function(e,t,o){var a;switch(e.message){case"openConfig":return chrome.tabs.create({url:chrome.runtime.getURL("options/options.html"+(e.hash?"#"+e.hash:""))}),!1;case"openHelp":return chrome.tabs.create({url:chrome.runtime.getURL("help/index.html")}),!1;case"openPage":return chrome.tabs.create({url:chrome.runtime.getURL(e.url)}),!1;case"submitVote":return function(e,t,o){return n(this,void 0,void 0,(function*(){let a=r.default.config.userID;null!=a&&"undefined"!==a||(a=(0,c.generateUserID)(),r.default.config.userID=a);const l=void 0!==e?"&type="+e:"&category="+o,u=yield function(e,t,o={}){return n(this,void 0,void 0,(function*(){const n=r.default.config.testingServer?i.testingServerAddress:r.default.config.serverAddress;return yield(0,s.sendRealRequestToCustomServer)(e,n+t,o)}))}("POST","/api/voteOnSponsorTime?UUID="+t+"&userID="+a+l);return u.ok?{successType:1,responseText:yield u.text()}:405==u.status?{successType:0,statusCode:u.status,responseText:yield u.text()}:{successType:-1,statusCode:u.status,responseText:yield u.text()}}))}(e.type,e.UUID,e.category).then(o),!0;case"registerContentScript":return p(e),!1;case"unregisterContentScript":return f(e.id),!1;case"tabs":return chrome.tabs.query({active:!0,currentWindow:!0},(t=>{chrome.tabs.sendMessage(t[0].id,e.data,(e=>{o(e)}))})),!0;case"time":case"infoUpdated":case"videoChanged":return t.tab&&(null===(a=u[t.tab.id])||void 0===a||a.postMessage(e)),!1;default:return!1}})),chrome.runtime.onConnect.addListener((e=>{"popup"===e.name&&chrome.tabs.query({active:!0,currentWindow:!0},(t=>{u[t[0].id]=e}))})),chrome.runtime.onInstalled.addListener((function(){setTimeout((()=>n(this,void 0,void 0,(function*(){if(!r.default.config.userID){chrome.tabs.create({url:chrome.extension.getURL("/help/index.html")});const e=(0,c.generateUserID)();r.default.config.userID=e,r.default.config.categoryPillUpdate=!0}r.default.config.supportInvidious&&((yield l.containsInvidiousPermission())||chrome.tabs.create({url:chrome.extension.getURL("/permissions/index.html")}))}))),1500)}))},7542:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(1181),i=o(2938),r=o(7683),s=o(7657),a=o(4219);class c extends a.ProtoConfig{resetToDefault(){chrome.storage.sync.set(Object.assign(Object.assign({},this.syncDefaults),{userID:this.config.userID,minutesSaved:this.config.minutesSaved,skipCount:this.config.skipCount,sponsorTimesContributed:this.config.sponsorTimesContributed}))}}const l=new c({userID:null,isVip:!1,permissions:{},unsubmittedSegments:{},defaultCategory:"chooseACategory",renderSegmentsAsChapters:!1,whitelistedChannels:[],forceChannelCheck:!1,minutesSaved:0,skipCount:0,sponsorTimesContributed:0,submissionCountSinceCategories:0,showTimeWithSkips:!0,disableSkipping:!1,muteSegments:!0,fullVideoSegments:!0,fullVideoLabelsOnThumbnails:!0,manualSkipOnFullVideo:!1,trackViewCount:!0,trackViewCountInPrivate:!0,trackDownvotes:!0,dontShowNotice:!1,noticeVisibilityMode:r.NoticeVisbilityMode.FadedForAutoSkip,hideVideoPlayerControls:!1,hideInfoButtonPlayerControls:!1,hideDeleteButtonPlayerControls:!1,hideUploadButtonPlayerControls:!1,hideSkipButtonPlayerControls:!1,hideDiscordLaunches:0,hideDiscordLink:!1,invidiousInstances:["invidious.snopyta.org"],supportInvidious:!1,serverAddress:n.serverAddress,minDuration:0,skipNoticeDuration:4,audioNotificationOnSkip:!1,checkForUnlistedVideos:!1,testingServer:!1,refetchWhenNotFound:!0,ytInfoPermissionGranted:!1,allowExpirements:!0,showDonationLink:!0,showPopupDonationCount:0,showUpsells:!0,donateClicked:0,autoHideInfoButton:!0,autoSkipOnMusicVideos:!1,scrollToEditTimeUpdate:!1,categoryPillUpdate:!1,showChapterInfoMessage:!0,darkMode:!0,showCategoryGuidelines:!0,showCategoryWithoutPermission:!1,showSegmentNameInChapterBar:!0,useVirtualTime:!0,showSegmentFailedToFetchWarning:!0,allowScrollingToEdit:!0,categoryPillColors:{},skipKeybind:{key:"Enter"},startSponsorKeybind:{key:";"},submitKeybind:{key:"'"},nextChapterKeybind:{key:"ArrowRight",ctrl:!0},previousChapterKeybind:{key:"ArrowLeft",ctrl:!0},categorySelections:[{name:"sponsor",option:r.CategorySkipOption.AutoSkip},{name:"poi_highlight",option:r.CategorySkipOption.ManualSkip},{name:"exclusive_access",option:r.CategorySkipOption.ShowOverlay},{name:"chapter",option:r.CategorySkipOption.ShowOverlay}],payments:{licenseKey:null,lastCheck:0,lastFreeCheck:0,freeAccess:!1,chaptersAllowed:!1},colorPalette:{red:"#780303",white:"#ffffff",locked:"#ffc83d"},barTypes:{"preview-chooseACategory":{color:"#ffffff",opacity:"0.7"},sponsor:{color:"#00d400",opacity:"0.7"},"preview-sponsor":{color:"#007800",opacity:"0.7"},selfpromo:{color:"#ffff00",opacity:"0.7"},"preview-selfpromo":{color:"#bfbf35",opacity:"0.7"},exclusive_access:{color:"#008a5c",opacity:"0.7"},interaction:{color:"#cc00ff",opacity:"0.7"},"preview-interaction":{color:"#6c0087",opacity:"0.7"},intro:{color:"#00ffff",opacity:"0.7"},"preview-intro":{color:"#008080",opacity:"0.7"},outro:{color:"#0202ed",opacity:"0.7"},"preview-outro":{color:"#000070",opacity:"0.7"},preview:{color:"#008fd6",opacity:"0.7"},"preview-preview":{color:"#005799",opacity:"0.7"},music_offtopic:{color:"#ff9900",opacity:"0.7"},"preview-music_offtopic":{color:"#a6634a",opacity:"0.7"},poi_highlight:{color:"#ff1684",opacity:"0.7"},"preview-poi_highlight":{color:"#9b044c",opacity:"0.7"},filler:{color:"#7300FF",opacity:"0.9"},"preview-filler":{color:"#2E0066",opacity:"0.7"}}},{downvotedSegments:{},navigationApiAvailable:null},(function(e){if(e.chapterCategoryAdded||(e.chapterCategoryAdded=!0,e.categorySelections.some((e=>"chapter"===e.name))||(e.categorySelections.push({name:"chapter",option:r.CategorySkipOption.ShowOverlay}),e.categorySelections=e.categorySelections)),e.segmentTimes){const t={};for(const o of e.segmentTimes)t[o[0]]=o[1];chrome.storage.sync.remove("segmentTimes",(()=>e.unsubmittedSegments=t))}if(void 0!==e.exclusive_accessCategoryAdded&&chrome.storage.sync.remove("exclusive_accessCategoryAdded"),void 0!==e.fillerUpdate&&chrome.storage.sync.remove("fillerUpdate"),void 0!==e.highlightCategoryAdded&&chrome.storage.sync.remove("highlightCategoryAdded"),void 0!==e.highlightCategoryUpdate&&chrome.storage.sync.remove("highlightCategoryUpdate"),e.askAboutUnlistedVideos&&chrome.storage.sync.remove("askAboutUnlistedVideos"),!e.autoSkipOnMusicVideosUpdate){e.autoSkipOnMusicVideosUpdate=!0;for(const t of e.categorySelections)if("music_offtopic"===t.name&&t.option===r.CategorySkipOption.AutoSkip){e.autoSkipOnMusicVideos=!0;break}}if(e.disableAutoSkip)for(const t of e.categorySelections)"sponsor"===t.name&&(t.option=r.CategorySkipOption.ManualSkip,chrome.storage.sync.remove("disableAutoSkip"));"string"==typeof e.skipKeybind&&(e.skipKeybind={key:e.skipKeybind}),"string"==typeof e.startSponsorKeybind&&(e.startSponsorKeybind={key:e.startSponsorKeybind}),"string"==typeof e.submitKeybind&&(e.submitKeybind={key:e.submitKeybind});const t=["skipKeybind","startSponsorKeybind","submitKeybind"];for(let o=t.length-1;o>=0;o--)for(let n=0;n<t.length;n++)o!=n&&(0,s.keybindEquals)(e[t[o]],e[t[n]])&&(e[t[o]]=null);void 0!==e.sponsorVideoID&&chrome.storage.sync.remove("sponsorVideoID"),void 0!==e.previousVideoID&&chrome.storage.sync.remove("previousVideoID"),!e.supportInvidious&&e.invidiousInstances.length<i.length&&(e.invidiousInstances=[...new Set([...i,...e.invidiousInstances])]),e.lastIsVipUpdate&&chrome.storage.sync.remove("lastIsVipUpdate")}));t.default=l},7683:(e,t)=>{var o,n,i,r,s,a;Object.defineProperty(t,"__esModule",{value:!0}),t.NoticeVisbilityMode=t.ChannelIDStatus=t.SponsorSourceType=t.ActionTypes=t.ActionType=t.SponsorHideType=t.CategorySkipOption=void 0,(a=t.CategorySkipOption||(t.CategorySkipOption={}))[a.ShowOverlay=0]="ShowOverlay",a[a.ManualSkip=1]="ManualSkip",a[a.AutoSkip=2]="AutoSkip",(s=t.SponsorHideType||(t.SponsorHideType={}))[s.Visible=void 0]="Visible",s[s.Downvoted=1]="Downvoted",s[s.MinimumDuration=2]="MinimumDuration",s[s.Hidden=3]="Hidden",function(e){e.Skip="skip",e.Mute="mute",e.Chapter="chapter",e.Full="full",e.Poi="poi"}(o=t.ActionType||(t.ActionType={})),t.ActionTypes=[o.Skip,o.Mute],(r=t.SponsorSourceType||(t.SponsorSourceType={}))[r.Server=void 0]="Server",r[r.Local=1]="Local",r[r.YouTube=2]="YouTube",(i=t.ChannelIDStatus||(t.ChannelIDStatus={}))[i.Fetching=0]="Fetching",i[i.Found=1]="Found",i[i.Failed=2]="Failed",(n=t.NoticeVisbilityMode||(t.NoticeVisbilityMode={}))[n.FullSize=0]="FullSize",n[n.MiniForAutoSkip=1]="MiniForAutoSkip",n[n.MiniForAll=2]="MiniForAll",n[n.FadedForAutoSkip=3]="FadedForAutoSkip",n[n.FadedForAll=4]="FadedForAll"},3147:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(7542),r=o(7683),s=o(6031),a=o(1181),c=o(8884),l=o(7657),u=o(7984),d=o(2697);t.default=class{constructor(e=null){this.js=["./js/content.js"],this.css=["content.css","./libs/Source+Sans+Pro.css","popup.css","shared.css"],this.backgroundScriptContainer=e}wait(e,t=5e3,o=100){return n(this,void 0,void 0,(function*(){return(0,c.waitFor)(e,t,o)}))}containsPermission(e){return new Promise((t=>{chrome.permissions.contains(e,t)}))}setupExtraSitePermissions(e){let t=["webNavigation"];(0,l.isSafari)()||t.push("declarativeContent"),this.isFirefox()&&!(0,l.isSafari)()&&(t=[]),chrome.permissions.request({origins:this.getPermissionRegex(),permissions:t},(t=>n(this,void 0,void 0,(function*(){t?this.setupExtraSiteContentScripts():this.removeExtraSiteRegistration(),e(t)}))))}setupExtraSiteContentScripts(){const e=[];for(const t of this.js)e.push({file:t});const t=[];for(const e of this.css)t.push({file:e});const o={message:"registerContentScript",id:"invidious",allFrames:!0,js:e,css:t,matches:this.getPermissionRegex()};this.backgroundScriptContainer?this.backgroundScriptContainer.registerFirefoxContentScript(o):chrome.runtime.sendMessage(o)}removeExtraSiteRegistration(){const e="invidious";this.backgroundScriptContainer?this.backgroundScriptContainer.unregisterFirefoxContentScript(e):chrome.runtime.sendMessage({message:"unregisterContentScript",id:e}),!this.isFirefox()&&chrome.declarativeContent&&chrome.declarativeContent.onPageChanged.removeRules(["invidious"]),chrome.permissions.remove({origins:this.getPermissionRegex()})}applyInvidiousPermissions(e,t="supportInvidious"){return new Promise((o=>{e?this.setupExtraSitePermissions((e=>{e||(i.default.config[t]=!1),o(e)})):(this.removeExtraSiteRegistration(),o(!1))}))}containsInvidiousPermission(){return new Promise((e=>{let t=["declarativeContent"];this.isFirefox()&&(t=[]),chrome.permissions.contains({origins:this.getPermissionRegex(),permissions:t},(function(t){e(t)}))}))}getMergedTimestamps(e){let t=[];return e.forEach((e=>{const o=t.findIndex((t=>e[0]>=t[0]&&e[0]<=t[1])),n=t.findIndex((t=>e[1]>=t[0]&&e[1]<=t[1]));if(~o&&~n){if(o===n)return;const e=t.splice(Math.max(o,n),1)[0],i=t.splice(Math.min(o,n),1)[0];t.push([Math.min(e[0],i[0]),Math.max(e[1],i[1])])}else~o?t[o][1]=e[1]:~n?t[n][0]=e[0]:t.push(e.slice());t=t.filter((t=>!(t[0]>e[0]&&t[1]<e[1])))})),t}getTimestampsDuration(e){return this.getMergedTimestamps(e).reduce(((e,t)=>e+t[1]-t[0]),0)}getSponsorIndexFromUUID(e,t){for(let o=0;o<e.length;o++)if(e[o].UUID===t)return o;return-1}getSponsorTimeFromUUID(e,t){return e[this.getSponsorIndexFromUUID(e,t)]}getCategorySelection(e){for(const t of i.default.config.categorySelections)if(t.name===e)return t;return{name:"None",option:0}}getPermissionRegex(e=[]){const t=[];0===e.length&&(e=[...i.default.config.invidiousInstances]);for(const o of e)t.push("https://*."+o+"/*"),t.push("http://*."+o+"/*");return t}asyncRequestToCustomServer(e,t,o={}){return(0,d.sendRequestToCustomServer)(e,t,o)}asyncRequestToServer(e,t,o={}){return n(this,void 0,void 0,(function*(){const n=i.default.config.testingServer?a.testingServerAddress:i.default.config.serverAddress;return yield this.asyncRequestToCustomServer(e,n+t,o)}))}sendRequestToServer(e,t,o){const n=i.default.config.testingServer?a.testingServerAddress:i.default.config.serverAddress;chrome.runtime.sendMessage({message:"sendRequest",type:e,url:n+t},(e=>{o(e)}))}findReferenceNode(){var e,t;let o=(0,u.findValidElementFromSelector)(["#player-container-id","#movie_player","#c4-player","#player-container","#main-panel.ytmusic-player-page","#player-container .video-js",".main-video-section > .video-container",".shaka-video-container"]);if(null==o){const n=document.getElementById("player");if(o=null==n?void 0:n.firstChild,o){let i=1;for(;i<n.children.length&&(!(null===(e=o.classList)||void 0===e?void 0:e.contains("html5-video-player"))||!(null===(t=o.classList)||void 0===t?void 0:t.contains("ytp-embed")));)o=n.children[i],i++}}return o}isContentScript(){return"http:"===window.location.protocol||"https:"===window.location.protocol}isHex(e){return Boolean(e.match(/^[0-9a-f]+$/i))}isFirefox(){return"undefined"!=typeof browser}addHiddenSegment(e,t,o){return n(this,void 0,void 0,(function*(){if(chrome.extension.inIncognitoContext||!i.default.config.trackDownvotes)return;const n=(yield(0,s.getHash)(e,1)).slice(0,4),a=yield(0,s.getHash)(t,1),c=i.default.local.downvotedSegments,l=c[n]||{segments:[],lastAccess:0};l.lastAccess=Date.now();const u=l.segments.find((e=>e.uuid===a));o===r.SponsorHideType.Visible?(l.segments.splice(l.segments.indexOf(u),1),0===l.segments.length&&delete c[n]):(u?u.hidden=o:l.segments.push({uuid:a,hidden:o}),c[n]=l);const d=Object.entries(c);if(d.length>1e4){let e=null;for(let t=0;t<d[0].length;t++)(null===e||d[t][1].lastAccess<e[1].lastAccess)&&(e=d[t]);delete c[e[0]]}i.default.forceLocalUpdate("downvotedSegments")}))}}},7657:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keybindToString=t.formatKey=t.keybindEquals=t.isSafari=t.showDonationLink=void 0;const n=o(7542);function i(e){return null==e?"":" "==e?"Space":1==e.length?e.toUpperCase():e}t.showDonationLink=function(){return"Apple Computer, Inc."!==navigator.vendor&&n.default.config.showDonationLink},t.isSafari=function(){return"undefined"!=typeof navigator&&"Apple Computer, Inc."===navigator.vendor},t.keybindEquals=function(e,t){return!(null==e||null==t||Boolean(e.alt)!=Boolean(t.alt)||Boolean(e.ctrl)!=Boolean(t.ctrl)||Boolean(e.shift)!=Boolean(t.shift)||null==e.key&&null==e.code||null==t.key&&null==t.code)&&(null!=e.code&&null!=t.code?e.code===t.code:null!=e.key&&null!=t.key&&e.key.toUpperCase()===t.key.toUpperCase())},t.formatKey=i,t.keybindToString=function(e){if(null==e||null==e.key)return"";let t="";return e.ctrl&&(t+="Ctrl+"),e.alt&&(t+="Alt+"),e.shift&&(t+="Shift+"),t+i(e.key)}},7592:(e,t,o)=>{o.r(t);const n=globalThis.chrome&&new function e(t){return new Proxy(t,{get:(t,o)=>"function"!=typeof t[o]?new e(t[o]):(...e)=>new Promise(((n,i)=>{t[o](...e,(e=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):n(e)}))}))})}(globalThis.chrome),i=/^(https?|wss?|file|ftp|\*):\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^file:\/\/\/.*$|^resource:\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^about:/,r="object"==typeof navigator&&navigator.userAgent.includes("Firefox/"),s=r?/^(https?|wss?):[/][/][^/]+([/].*)?$/:/^https?:[/][/][^/]+([/].*)?$/,a=/^(https?|file|ftp):[/]+/;function c(...e){return 0===e.length?/$./:e.includes("<all_urls>")?a:e.includes("*://*/*")?s:new RegExp(e.map((e=>function(e){if(!i.test(e))throw new Error(e+" is an invalid pattern, it must match "+String(i));let[,t,o,n]=e.split(/(^[^:]+:[/][/])([^/]+)?/);return t=t.replace("*",r?"(https?|wss?)":"https?").replace(/[/]/g,"[/]"),o=(null!=o?o:"").replace(/^[*][.]/,"([^/]+.)*").replace(/^[*]$/,"[^/]+").replace(/[.]/g,"[.]").replace(/[*]$/g,"[^.]+"),n=n.replace(/[/]/g,"[/]").replace(/[.]/g,"[.]").replace(/[*]/g,".*"),"^"+t+o+"("+n+")?$"}(e))).join("|"))}const l=Boolean(globalThis.chrome?.scripting);function u(e){return Array.isArray(e)?e:[e]}function d(e){return void 0===e?void 0:[e]}async function p({tabId:e,frameId:t,files:o,allFrames:i,matchAboutBlank:r,runAt:s},{ignoreTargetErrors:a}={}){const c=Promise.all(o.map((async o=>("string"==typeof o&&(o={file:o}),l?chrome.scripting.insertCSS({target:{tabId:e,frameIds:d(t),allFrames:i},files:"file"in o?[o.file]:void 0,css:"code"in o?o.code:void 0}):n.tabs.insertCSS(e,{...o,matchAboutBlank:r,allFrames:i,frameId:t,runAt:s??"document_start"})))));a?await m(c):await c}async function f({tabId:e,frameId:t,files:o,allFrames:i,matchAboutBlank:r,runAt:s},{ignoreTargetErrors:a}={}){let c;const u=o.map((e=>"string"==typeof e?{file:e}:e));if(l){!function(e){if(e.some((e=>"code"in e)))throw new Error("chrome.scripting does not support injecting strings of `code`")}(u);const o=chrome.scripting.executeScript({target:{tabId:e,frameIds:d(t),allFrames:i},files:u.map((({file:e})=>e))});a&&m(o)}else for(const o of u)"code"in o&&await c,c=n.tabs.executeScript(e,{...o,matchAboutBlank:r,allFrames:i,frameId:t,runAt:s}),a&&m(c)}const h=/^No frame with id \d+ in tab \d+.$|^No tab with id: \d+.$|^The tab was closed.$|^The frame was removed.$/;async function m(e){try{await e}catch(e){if(!h.test(e?.message))throw e}}const g="object"==typeof chrome&&"webNavigation"in chrome;"object"!=typeof chrome||chrome.contentScripts||(chrome.contentScripts={register:async function(e,t){const{js:o=[],css:i=[],matchAboutBlank:r,matches:s=[],excludeMatches:a,runAt:l}=e;let{allFrames:d}=e;if(g?d=!1:d&&console.warn("`allFrames: true` requires the `webNavigation` permission to work correctly: https://github.com/fregante/content-scripts-register-polyfill#permissions"),0===s.length)throw new Error("Type error for parameter contentScriptOptions (Error processing matches: Array requires at least 1 items; you have 0) for contentScripts.register.");await Promise.all(s.map((async e=>{if(!await n.permissions.contains({origins:[e]}))throw new Error("Permission denied to register a content script for "+e)})));const h=c(...s),m=c(...null!=a?a:[]),y=async(e,t,s=0)=>{h.test(e)&&!m.test(e)&&await async function(e){return n.permissions.contains({origins:[new URL(e).origin+"/*"]})}(e)&&await async function(e,t,o={}){const n=u(e);await Promise.all(n.map((async e=>async function({frameId:e,tabId:t,allFrames:o},n,i={}){const r=u(n).flatMap((n=>[p({tabId:t,frameId:e,allFrames:o,files:n.css??[],matchAboutBlank:n.matchAboutBlank??n.match_about_blank,runAt:n.runAt??n.run_at},i),f({tabId:t,frameId:e,allFrames:o,files:n.js??[],matchAboutBlank:n.matchAboutBlank??n.match_about_blank,runAt:n.runAt??n.run_at},i)]));await Promise.all(r)}(function(e){return"object"==typeof e?{...e,allFrames:!1}:{tabId:e,frameId:void 0,allFrames:!0}}(e),t,o))))}({tabId:t,frameId:s},{css:i,js:o,matchAboutBlank:r,runAt:l},{ignoreTargetErrors:!0})},v=async(e,{status:t},{url:o})=>{"loading"===t&&o&&y(o,e)},S=async({tabId:e,frameId:t,url:o})=>{y(o,e,t)};g?chrome.webNavigation.onCommitted.addListener(S):chrome.tabs.onUpdated.addListener(v);const w={async unregister(){g?chrome.webNavigation.onCommitted.removeListener(S):chrome.tabs.onUpdated.removeListener(v)}};return"function"==typeof t&&t(w),w}})},2938:e=>{e.exports=JSON.parse('["inv.bp.projectsegfau.lt","inv.odyssey346.dev","inv.riverside.rocks","inv.vern.cc","invidious.baczek.me","invidious.epicsite.xyz","invidious.esmailelbob.xyz","invidious.flokinet.to","invidious.lidarshield.cloud","invidious.nerdvpn.de","invidious.privacydev.net","invidious.snopyta.org","invidious.tiekoetter.com","invidious.weblibre.org","iv.melmac.space","vid.puffyan.us","watch.thekitty.zone","y.com.sb","yewtu.be","yt.artemislena.eu","yt.funami.tech","yt.oelrichsgarcia.de"]')},1181:e=>{e.exports=JSON.parse('{"serverAddress":"https://sponsor.ajay.app","testingServerAddress":"https://sponsor.ajay.app/test","serverAddressComment":"This specifies the default SponsorBlock server to connect to","categoryList":["sponsor","selfpromo","exclusive_access","interaction","poi_highlight","intro","outro","preview","filler","chapter","music_offtopic"],"categorySupport":{"sponsor":["skip","mute","full"],"selfpromo":["skip","mute","full"],"exclusive_access":["full"],"interaction":["skip","mute"],"intro":["skip","mute"],"outro":["skip","mute"],"preview":["skip","mute"],"filler":["skip","mute"],"music_offtopic":["skip"],"poi_highlight":["poi"],"chapter":["chapter"]},"wikiLinks":{"sponsor":"https://wiki.sponsor.ajay.app/w/Sponsor","selfpromo":"https://wiki.sponsor.ajay.app/w/Unpaid/Self_Promotion","exclusive_access":"https://wiki.sponsor.ajay.app/w/Exclusive_Access","interaction":"https://wiki.sponsor.ajay.app/w/Interaction_Reminder_(Subscribe)","intro":"https://wiki.sponsor.ajay.app/w/Intermission/Intro_Animation","outro":"https://wiki.sponsor.ajay.app/w/Endcards/Credits","preview":"https://wiki.sponsor.ajay.app/w/Preview/Recap","filler":"https://wiki.sponsor.ajay.app/w/Filler_Tangent","music_offtopic":"https://wiki.sponsor.ajay.app/w/Music:_Non-Music_Section","poi_highlight":"https://wiki.sponsor.ajay.app/w/Highlight","guidelines":"https://wiki.sponsor.ajay.app/w/Guidelines","mute":"https://wiki.sponsor.ajay.app/w/Mute_Segment","chapter":"https://wiki.sponsor.ajay.app/w/Chapter"}}')}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o(1051)})();