(()=>{"use strict";var e,t={5921:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=i(7294),s=i(7542),r=i(6388),a=i(9566),l=i(5699),c=i(8887),u=i(6465),p=i(5712);class d extends o.Component{constructor(e){super(e),this.state={segment:null,show:!1,open:!1}}render(){var e;const t={backgroundColor:this.getColor(),display:this.state.show?"flex":"none",color:this.getTextColor()};return o.createElement("span",{style:t,className:"sponsorBlockCategoryPill","aria-label":this.getTitleText(),onClick:e=>this.toggleOpen(e),onMouseEnter:()=>this.openTooltip(),onMouseLeave:()=>this.closeTooltip()},o.createElement("span",{className:"sponsorBlockCategoryPillTitleSection"},o.createElement("img",{className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),o.createElement("span",{className:"sponsorBlockCategoryPillTitle"},chrome.i18n.getMessage("category_"+(null===(e=this.state.segment)||void 0===e?void 0:e.category)))),this.state.open&&o.createElement(o.Fragment,null,o.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerUpvoteCategoryPill",className:"voteButton",style:{marginLeft:"5px"},title:chrome.i18n.getMessage("upvoteButtonInfo"),onClick:e=>this.vote(e,1)},o.createElement(r.default,{fill:s.default.config.colorPalette.white})),o.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerDownvoteCategoryPill",className:"voteButton",title:chrome.i18n.getMessage("reportButtonInfo"),onClick:e=>this.vote(e,0)},o.createElement(a.default,{fill:(0,l.downvoteButtonColor)(null,null,l.SkipNoticeAction.Downvote)}))),o.createElement("img",{src:chrome.extension.getURL("icons/close.png"),className:"categoryPillClose",onClick:()=>this.setState({show:!1})}))}toggleOpen(e){e.stopPropagation(),this.state.show&&this.setState({open:!this.state.open})}vote(e,t){return n(this,void 0,void 0,(function*(){if(e.stopPropagation(),this.state.segment){const i=c.AnimationUtils.applyLoadingAnimation(e.currentTarget,.3),n=yield this.props.vote(t,this.state.segment.UUID);yield i(),1==n.successType||-1==n.successType&&429==n.statusCode?this.setState({open:!1,show:1===t}):403!==n.statusCode&&alert(u.GenericUtils.getErrorMessage(n.statusCode,n.responseText))}}))}getColor(){var e,t;const i=s.default.config.barTypes["preview-"+(null===(e=this.state.segment)||void 0===e?void 0:e.category)]||s.default.config.barTypes[null===(t=this.state.segment)||void 0===t?void 0:t.category];return null==i?void 0:i.color}getTextColor(){var e,t;const i=this.getColor();if(!i)return null;const n=s.default.config.categoryPillColors[null===(e=this.state.segment)||void 0===e?void 0:e.category];if(n&&n.lastColor===i)return n.textColor;{const e=u.GenericUtils.getLuminance(i)>128?"black":"white";return s.default.config.categoryPillColors[null===(t=this.state.segment)||void 0===t?void 0:t.category]={lastColor:i,textColor:e},e}}openTooltip(){const e=document.querySelector("#above-the-fold");e&&(this.tooltip=new p.Tooltip({text:this.getTitleText(),referenceNode:e,bottomOffset:"0px",opacity:.95,displayTriangle:!1,showLogo:!1,showGotIt:!1,prependElement:e.firstElementChild}))}closeTooltip(){var e;null===(e=this.tooltip)||void 0===e||e.close(),this.tooltip=null}getTitleText(){var e;const t=chrome.i18n.getMessage(`category_${null===(e=this.state.segment)||void 0===e?void 0:e.category}_pill`);return(t?t+". ":"")+chrome.i18n.getMessage("categoryPillTitleText")}}t.default=d},4954:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=i(7294),s=i(7542),r=i(6388),a=i(9566),l=i(5699),c=i(8887),u=i(6465),p=i(5712);class d extends o.Component{constructor(e){var t;super(e),this.state={segment:null,show:!1,size:null!==(t=e.size)&&void 0!==t?t:"22px"}}render(){return this.tooltip&&!this.state.show&&(this.tooltip.close(),this.tooltip=null),o.createElement(o.Fragment,null,o.createElement("button",{id:"sponsorTimesDownvoteButtonsContainerUpvoteChapter",className:"playerButton sbPlayerUpvote ytp-button "+(this.state.show?"":"hidden"),draggable:"false",title:chrome.i18n.getMessage("upvoteButtonInfo"),onClick:e=>this.vote(e,1)},o.createElement(r.default,{className:"playerButtonImage",fill:s.default.config.colorPalette.white,width:this.state.size,height:this.state.size})),o.createElement("button",{id:"sponsorTimesDownvoteButtonsContainerDownvoteChapter",className:"playerButton sbPlayerDownvote ytp-button "+(this.state.show?"":"hidden"),draggable:"false",title:chrome.i18n.getMessage("reportButtonInfo"),onClick:e=>{var t,i,n,o;const s=document.querySelector(".ytp-chapter-container");if(this.tooltip)this.tooltip.close(),this.tooltip=null;else{const r=null===(t=null==s?void 0:s.parentElement)||void 0===t?void 0:t.parentElement;if(r){const t=r.getBoundingClientRect(),a=null===(n=null===(i=e.target)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.getBoundingClientRect();this.tooltip=new p.Tooltip({referenceNode:null===(o=null==s?void 0:s.parentElement)||void 0===o?void 0:o.parentElement,prependElement:null==s?void 0:s.parentElement,showLogo:!1,showGotIt:!1,bottomOffset:`${t.height+25}px`,leftOffset:a.x-t.x+"px",extraClass:"centeredSBTriangle",buttons:[{name:chrome.i18n.getMessage("incorrectVote"),listener:t=>this.vote(t,0,e.target).then((()=>{var e;null===(e=this.tooltip)||void 0===e||e.close(),this.tooltip=null}))},{name:chrome.i18n.getMessage("harmfulVote"),listener:t=>this.vote(t,30,e.target).then((()=>{var e;null===(e=this.tooltip)||void 0===e||e.close(),this.tooltip=null}))}]})}}}},o.createElement(a.default,{className:"playerButtonImage",fill:(0,l.downvoteButtonColor)(this.state.segment?[this.state.segment]:null,l.SkipNoticeAction.Downvote,l.SkipNoticeAction.Downvote),width:this.state.size,height:this.state.size})))}vote(e,t,i){return n(this,void 0,void 0,(function*(){if(e.stopPropagation(),this.state.segment){const n=c.AnimationUtils.applyLoadingAnimation(null!=i?i:e.currentTarget,.3),o=yield this.props.vote(t,this.state.segment.UUID);yield n(),1==o.successType||-1==o.successType&&429==o.statusCode?this.setState({show:1===t}):403!==o.statusCode&&alert(u.GenericUtils.getErrorMessage(o.statusCode,o.responseText))}}))}}t.default=d},2899:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294);class o extends n.Component{constructor(e){super(e),this.state={}}render(){return n.createElement("div",{id:this.props.id,style:{display:this.props.options.length>0?"inherit":"none"},className:"sbSelector"},n.createElement("div",{onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,className:"sbSelectorBackground"},this.getOptions()))}getOptions(){const e=[];for(const t of this.props.options)e.push(n.createElement("div",{className:"sbSelectorOption",onClick:e=>{e.stopPropagation(),this.props.onChange(t.label)},key:t.label},t.label));return e}}t.default=o},9461:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294),o=i(1181),s=i(7542),r=i(7683),a=i(4934),l=i(1373),c=new(i(3147).default),u=i(4980),p=i(7657),d=i(6388),h=i(9566),g=i(3722),m=i(5699),f=i(6465);var y;!function(e){e[e.Undo=0]="Undo",e[e.Redo=1]="Redo",e[e.Start=2]="Start"}(y||(y={}));class v extends n.Component{constructor(e){var t,i;super(e),this.noticeRef=n.createRef(),this.categoryOptionRef=n.createRef(),this.segments=e.segments,this.autoSkip=e.autoSkip,this.contentContainer=e.contentContainer;const o=(0,u.getSkippingText)(this.segments,this.props.autoSkip),a=document.getElementsByClassName("sponsorSkipNoticeParent");this.amountOfPreviousNotices=a.length,this.showInSecondSlot=a.length>0&&[...a].some((e=>!e.classList.contains("secondSkipNotice"))),this.segments.length>1&&this.segments.sort(((e,t)=>e.segment[0]-t.segment[0]));for(const e of this.segments)this.idSuffix+=e.UUID;this.idSuffix+=this.amountOfPreviousNotices,this.selectedColor=s.default.config.colorPalette.red,this.unselectedColor=s.default.config.colorPalette.white,this.lockedColor=s.default.config.colorPalette.locked;const l=this.segments[0].actionType===r.ActionType.Mute,c=l?this.getFullDurationCountdown(0):()=>s.default.config.skipNoticeDuration,p=this.props.startReskip?y.Redo:y.Undo,d=[p,l?y.Start:p],h=this.props.startReskip?this.reskip.bind(this):this.unskip.bind(this),g=[h,l?this.reskip.bind(this):h];this.state={noticeTitle:o,messages:[],messageOnClick:null,maxCountdownTime:c,countdownTime:c(),countdownText:null,skipButtonStates:d,skipButtonCallbacks:g,showSkipButton:[!0,!0],editing:!1,choosingCategory:!1,thanksForVotingText:null,actionState:m.SkipNoticeAction.None,showKeybindHint:null===(t=this.props.showKeybindHint)||void 0===t||t,smaller:null!==(i=this.props.smaller)&&void 0!==i&&i,voted:new Array(this.props.segments.length).fill(m.SkipNoticeAction.None),copied:new Array(this.props.segments.length).fill(m.SkipNoticeAction.None)},this.autoSkip||Object.assign(this.state,this.getUnskippedModeInfo(null,0,y.Start))}render(){const e={};this.contentContainer().onMobileYouTube&&(e.bottom="4em",e.transform="scale(0.8) translate(10%, 10%)");const t=this.props.smaller||this.segments[0].actionType===r.ActionType.Mute?this.getSkipButton(0):null;return n.createElement(a.default,{noticeTitle:this.state.noticeTitle,amountOfPreviousNotices:this.amountOfPreviousNotices,showInSecondSlot:this.showInSecondSlot,idSuffix:this.idSuffix,fadeIn:!0,startFaded:s.default.config.noticeVisibilityMode>=r.NoticeVisbilityMode.FadedForAll||s.default.config.noticeVisibilityMode>=r.NoticeVisbilityMode.FadedForAutoSkip&&this.autoSkip,timed:!0,maxCountdownTime:this.state.maxCountdownTime,style:e,biggerCloseButton:this.contentContainer().onMobileYouTube,ref:this.noticeRef,closeListener:()=>this.closeListener(),smaller:this.state.smaller,limitWidth:!0,firstColumn:t,bottomRow:[...this.getMessageBoxes(),...this.getBottomRow()],onMouseEnter:()=>this.onMouseEnter()})}getBottomRow(){return[n.createElement("tr",{id:"sponsorSkipNoticeSecondRow"+this.idSuffix,key:0},this.state.thanksForVotingText?n.createElement("td",{id:"sponsorTimesVoteButtonInfoMessage"+this.idSuffix,className:"sponsorTimesInfoMessage sponsorTimesVoteButtonMessage",style:{marginRight:"10px"}},n.createElement("span",{style:{marginRight:"10px"}},this.state.thanksForVotingText),n.createElement("button",{id:"sponsorTimesContinueVotingContainer"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton",title:"Continue Voting",onClick:()=>this.setState({thanksForVotingText:null,messages:[]})},chrome.i18n.getMessage("ContinueVoting"))):n.createElement("td",{id:"sponsorTimesVoteButtonsContainer"+this.idSuffix,className:"sponsorTimesVoteButtonsContainer"},n.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerUpvote"+this.idSuffix,className:"voteButton",style:{marginRight:"5px"},title:chrome.i18n.getMessage("upvoteButtonInfo"),onClick:()=>this.prepAction(m.SkipNoticeAction.Upvote)},n.createElement(d.default,{fill:this.state.actionState===m.SkipNoticeAction.Upvote?this.selectedColor:this.unselectedColor})),n.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerDownvote"+this.idSuffix,className:"voteButton",style:{marginRight:"5px",marginLeft:"5px"},title:chrome.i18n.getMessage("reportButtonInfo"),onClick:()=>this.prepAction(m.SkipNoticeAction.Downvote)},n.createElement(h.default,{fill:(0,m.downvoteButtonColor)(this.segments,this.state.actionState,m.SkipNoticeAction.Downvote)})),n.createElement("div",{id:"sponsorTimesDownvoteButtonsContainerCopyDownvote"+this.idSuffix,className:"voteButton",style:{marginLeft:"5px"},onClick:()=>this.openEditingOptions()},n.createElement(g.default,{fill:!0===this.state.editing||this.state.actionState===m.SkipNoticeAction.CopyDownvote||!0===this.state.choosingCategory?this.selectedColor:this.unselectedColor}))),this.props.smaller&&this.segments[0].actionType!==r.ActionType.Mute?null:this.getSkipButton(1),!this.autoSkip||this.props.startReskip?"":n.createElement("td",{className:"sponsorSkipNoticeRightSection",key:1},n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:this.contentContainer().dontShowNoticeAgain},chrome.i18n.getMessage("Hide")))),this.state.editing&&!this.state.thanksForVotingText&&!(this.state.choosingCategory||this.state.actionState===m.SkipNoticeAction.CopyDownvote)&&n.createElement("tr",{id:"sponsorSkipNoticeEditSegmentsRow"+this.idSuffix,key:2},n.createElement("td",{id:"sponsorTimesEditSegmentsContainer"+this.idSuffix},n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",title:chrome.i18n.getMessage("CopyDownvoteButtonInfo"),style:{color:(0,m.downvoteButtonColor)(this.segments,this.state.actionState,m.SkipNoticeAction.Downvote)},onClick:()=>this.prepAction(m.SkipNoticeAction.CopyDownvote)},chrome.i18n.getMessage("CopyAndDownvote")),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",title:chrome.i18n.getMessage("ChangeCategoryTooltip"),style:{color:this.state.actionState===m.SkipNoticeAction.CategoryVote&&1==this.state.editing?this.selectedColor:this.unselectedColor},onClick:()=>this.resetStateToStart(m.SkipNoticeAction.CategoryVote,!0,!0)},chrome.i18n.getMessage("incorrectCategory")))),this.state.choosingCategory&&!this.state.thanksForVotingText&&n.createElement("tr",{id:"sponsorSkipNoticeCategoryChooserRow"+this.idSuffix,key:3},n.createElement("td",null,n.createElement("select",{id:"sponsorTimeCategories"+this.idSuffix,className:"sponsorTimeCategories sponsorTimeEditSelector",defaultValue:this.segments[0].category,ref:this.categoryOptionRef},this.getCategoryOptions()),1===this.segments.length&&n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",onClick:()=>this.prepAction(m.SkipNoticeAction.CategoryVote)},chrome.i18n.getMessage("submit")))),this.state.actionState!==m.SkipNoticeAction.None&&this.segments.length>1&&!this.state.thanksForVotingText&&n.createElement("tr",{id:"sponsorSkipNoticeSubmissionOptionsRow"+this.idSuffix,key:4},n.createElement("td",{id:"sponsorTimesSubmissionOptionsContainer"+this.idSuffix},this.getSubmissionChooser()))]}getSkipButton(e){if(this.state.showSkipButton[e]&&(this.segments.length>1||this.segments[0].actionType!==r.ActionType.Poi||this.props.unskipTime)){const t=1===e&&this.segments[0].actionType===r.ActionType.Mute,i={marginLeft:"4px",color:[m.SkipNoticeAction.Unskip0,m.SkipNoticeAction.Unskip1].includes(this.state.actionState)?this.selectedColor:this.unselectedColor};return this.contentContainer().onMobileYouTube&&(i.padding="20px",i.minWidth="100px"),n.createElement("span",{className:"sponsorSkipNoticeUnskipSection"},n.createElement("button",{id:"sponsorSkipUnskipButton"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton",style:i,onClick:()=>this.prepAction(1===e?m.SkipNoticeAction.Unskip1:m.SkipNoticeAction.Unskip0)},this.getSkipButtonText(e,t?r.ActionType.Skip:null)+(!t&&this.state.showKeybindHint?" ("+(0,p.keybindToString)(s.default.config.skipKeybind)+")":"")))}return null}getSubmissionChooser(){const e=[];for(let t=0;t<this.segments.length;t++)e.push(n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",style:{opacity:this.getSubmissionChooserOpacity(t),color:this.getSubmissionChooserColor(t)},onClick:()=>this.performAction(t),key:"submission"+t+this.segments[t].category+this.idSuffix},t+1+". "+chrome.i18n.getMessage("category_"+this.segments[t].category)));return e}getSubmissionChooserOpacity(e){const t=this.state.actionState===m.SkipNoticeAction.Upvote,i=this.state.actionState==m.SkipNoticeAction.Downvote,n=this.state.actionState==m.SkipNoticeAction.CopyDownvote;return t&&this.state.voted[e]==m.SkipNoticeAction.Upvote||i&&this.state.voted[e]==m.SkipNoticeAction.Downvote||n&&this.state.copied[e]==m.SkipNoticeAction.CopyDownvote?.35:1}getSubmissionChooserColor(e){const t=this.state.actionState==m.SkipNoticeAction.Downvote,i=this.state.actionState==m.SkipNoticeAction.CopyDownvote;return s.default.config.isVip&&(t||i)&&1===this.segments[e].locked?this.lockedColor:this.unselectedColor}onMouseEnter(){this.state.smaller&&this.setState({smaller:!1})}getMessageBoxes(){if(0===this.state.messages.length)return[n.createElement("tr",{id:"sponsorSkipNoticeSpacer"+this.idSuffix,className:"sponsorBlockSpacer",key:"messageBoxSpacer"})];const e=[];for(let t=0;t<this.state.messages.length;t++)e.push(n.createElement("tr",{key:t+"_messageBox"},n.createElement("td",{key:t+"_messageBox"},n.createElement(l.default,{idSuffix:this.idSuffix,text:this.state.messages[t],onClick:this.state.messageOnClick,key:t+"_messageBox"}))));return e}prepAction(e){if(1===this.segments.length)this.performAction(0,e);else switch(null!=e?e:this.state.actionState){case m.SkipNoticeAction.None:this.resetStateToStart();break;case m.SkipNoticeAction.Upvote:this.resetStateToStart(m.SkipNoticeAction.Upvote);break;case m.SkipNoticeAction.Downvote:this.resetStateToStart(m.SkipNoticeAction.Downvote);break;case m.SkipNoticeAction.CategoryVote:this.resetStateToStart(m.SkipNoticeAction.CategoryVote,!0,!0);break;case m.SkipNoticeAction.CopyDownvote:this.resetStateToStart(m.SkipNoticeAction.CopyDownvote,!0);break;case m.SkipNoticeAction.Unskip0:this.resetStateToStart(m.SkipNoticeAction.Unskip0);break;case m.SkipNoticeAction.Unskip1:this.resetStateToStart(m.SkipNoticeAction.Unskip1)}}performAction(e,t){switch(null!=t?t:this.state.actionState){case m.SkipNoticeAction.None:this.noAction(e);break;case m.SkipNoticeAction.Upvote:this.upvote(e);break;case m.SkipNoticeAction.Downvote:this.downvote(e);break;case m.SkipNoticeAction.CategoryVote:this.categoryVote(e);break;case m.SkipNoticeAction.CopyDownvote:this.copyDownvote(e);break;case m.SkipNoticeAction.Unskip0:this.unskipAction(0,e,!1);break;case m.SkipNoticeAction.Unskip1:this.unskipAction(1,e,!0);break;default:this.resetStateToStart()}}noAction(e){const t=this.state.voted;t[e]=m.SkipNoticeAction.None,this.setState({voted:t})}upvote(e){1===this.segments.length&&this.resetStateToStart(),this.contentContainer().vote(1,this.segments[e].UUID,void 0,this)}downvote(e){1===this.segments.length&&this.resetStateToStart(),this.contentContainer().vote(0,this.segments[e].UUID,void 0,this)}categoryVote(e){this.contentContainer().vote(void 0,this.segments[e].UUID,this.categoryOptionRef.current.value,this)}copyDownvote(e){const t=this.props.contentContainer().sponsorVideoID,i={segment:this.segments[e].segment,UUID:f.GenericUtils.generateUserID(),category:this.segments[e].category,actionType:this.segments[e].actionType,source:r.SponsorSourceType.Local},n=s.default.config.unsubmittedSegments[t]||[];n.push(i),s.default.config.unsubmittedSegments[t]=n,s.default.forceSyncUpdate("unsubmittedSegments"),this.props.contentContainer().sponsorTimesSubmitting.push(i),this.props.contentContainer().updatePreviewBar(),this.props.contentContainer().resetSponsorSubmissionNotice(),this.props.contentContainer().updateEditButtonsOnPlayer(),this.contentContainer().vote(0,this.segments[e].UUID,void 0,this);const o=this.state.copied;o[e]=m.SkipNoticeAction.CopyDownvote,this.setState({copied:o})}unskipAction(e,t,i){this.state.skipButtonCallbacks[e](e,t,i)}openEditingOptions(){this.resetStateToStart(void 0,!0)}getCategoryOptions(){const e=[],t=o.categoryList.filter((e=>o.categorySupport[e].includes(r.ActionType.Skip)));for(const i of t)e.push(n.createElement("option",{value:i,key:i,className:this.getCategoryNameClass(i)},chrome.i18n.getMessage("category_"+i)));return e}getCategoryNameClass(e){return this.props.contentContainer().lockedCategories.includes(e)?"sponsorBlockLockedColor":""}unskip(e,t,i){this.contentContainer().unskipSponsorTime(this.segments[t],this.props.unskipTime,i),this.unskippedMode(e,t,y.Redo)}reskip(e,t,i){this.contentContainer().reskipSponsorTime(this.segments[t],i);const n=this.state.skipButtonStates;n[e]=y.Undo;const o=this.state.skipButtonCallbacks;o[e]=this.unskip.bind(this);const r={skipButtonStates:n,skipButtonCallbacks:o,maxCountdownTime:()=>s.default.config.skipNoticeDuration,countdownTime:s.default.config.skipNoticeDuration};this.setState(r,(()=>{this.noticeRef.current.resetCountdown()}))}unskippedMode(e,t,i){this.setState(this.getUnskippedModeInfo(e,t,i),(()=>{this.noticeRef.current.resetCountdown()}))}getUnskippedModeInfo(e,t,i){const n=this.segments[t].actionType!==r.ActionType.Poi?this.getFullDurationCountdown(t):this.state.maxCountdownTime,o=this.state.skipButtonStates,s=this.state.skipButtonCallbacks;if(null===e)for(let e=0;e<this.segments.length;e++)o[e]=i,s[e]=this.reskip.bind(this);else o[e]=i,s[e]=this.reskip.bind(this),1===e&&(o[0]=y.Redo,s[0]=this.reskip.bind(this));return{skipButtonStates:o,skipButtonCallbacks:s,maxCountdownTime:n,countdownTime:n(),showSkipButton:1===e?[!0,!0]:this.state.showSkipButton}}getFullDurationCountdown(e){return()=>{const t=this.segments[e],i=Math.round((t.segment[1]-this.contentContainer().v.currentTime)*(1/this.contentContainer().v.playbackRate));return Math.max(i,s.default.config.skipNoticeDuration)}}afterVote(e,t,i){const n=c.getSponsorIndexFromUUID(this.segments,e.UUID),s=o.wikiLinks[e.category],r=this.state.voted;switch(t){case 0:this.clearConfigListener(),this.setNoticeInfoMessageWithOnClick((()=>window.open(s)),chrome.i18n.getMessage("OpenCategoryWikiPage")),r[n]=m.SkipNoticeAction.Downvote;break;case 1:r[n]=m.SkipNoticeAction.Upvote;break;case 20:r[n]=m.SkipNoticeAction.None}this.setState({voted:r}),this.addVoteButtonInfo(chrome.i18n.getMessage("voted")),e&&i&&(this.segments[n].category=i)}setNoticeInfoMessageWithOnClick(e,...t){this.setState({messages:t,messageOnClick:t=>e(t)})}setNoticeInfoMessage(...e){this.setState({messages:e})}addVoteButtonInfo(e){this.setState({thanksForVotingText:e})}resetVoteButtonInfo(){this.setState({thanksForVotingText:null})}closeListener(){this.clearConfigListener(),this.props.closeListener()}clearConfigListener(){this.configListener&&(s.default.configSyncListeners.splice(s.default.configSyncListeners.indexOf(this.configListener),1),this.configListener=null)}unmutedListener(e){1===this.props.segments.length&&this.props.segments[0].actionType===r.ActionType.Mute&&e>=this.props.segments[0].segment[1]&&this.setState({showSkipButton:[!1,!0]})}resetStateToStart(e=m.SkipNoticeAction.None,t=!1,i=!1){this.setState({actionState:e,editing:t,choosingCategory:i,thanksForVotingText:null,messages:[]})}getSkipButtonText(e,t){switch(this.state.skipButtonStates[e]){case y.Undo:return this.getUndoText(t);case y.Redo:return this.getRedoText(t);case y.Start:return this.getStartText(t)}}getUndoText(e){switch(e||this.segments[0].actionType){case r.ActionType.Mute:return chrome.i18n.getMessage("unmute");case r.ActionType.Skip:default:return chrome.i18n.getMessage("unskip")}}getRedoText(e){switch(e||this.segments[0].actionType){case r.ActionType.Mute:return chrome.i18n.getMessage("mute");case r.ActionType.Skip:default:return chrome.i18n.getMessage("reskip")}}getStartText(e){switch(e||this.segments[0].actionType){case r.ActionType.Mute:return chrome.i18n.getMessage("mute");case r.ActionType.Skip:default:return chrome.i18n.getMessage("skip")}}}t.default=v},1467:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=i(7294),s=i(1181),r=i(7542),a=i(7683),l=i(3147),c=i(3927),u=i(2899),p=i(142),d=i(4980),h=i(1369),g=new l.default,m=[].concat(...s.categoryList.filter((e=>"chapter"!==e)).map((e=>chrome.i18n.getMessage("category_"+e).split(/\/|\s|-/))));class f extends o.Component{constructor(e){super(e),this.timesBeforeChanging=[],this.fullVideoWarningShown=!1,this.categoryNameWarningShown=!1,this.categoryOptionRef=o.createRef(),this.actionTypeOptionRef=o.createRef(),this.descriptionOptionRef=o.createRef(),this.idSuffix=this.props.idSuffix,this.previousSkipType=a.ActionType.Skip;const t=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];this.state={editing:!1,sponsorTimeEdits:[null,null],selectedCategory:d.DEFAULT_CATEGORY,description:t.description||"",suggestedNames:[],chapterNameSelectorOpen:!1,chapterNameSelectorHovering:!1}}componentDidMount(){document.getElementById("sponsorTimeEditContainer"+this.idSuffix).addEventListener("keydown",(function(e){e.stopPropagation()})),document.getElementById("sponsorTimesContainer"+this.idSuffix).addEventListener("wheel",(function(e){e.preventDefault()}),{passive:!1}),this.configUpdateListener||(this.configUpdateListener=()=>this.configUpdate(),r.default.configSyncListeners.push(this.configUpdate.bind(this))),this.checkToShowFullVideoWarning()}componentWillUnmount(){this.configUpdateListener&&r.default.configSyncListeners.splice(r.default.configSyncListeners.indexOf(this.configUpdate.bind(this)),1)}render(){var e,t;this.checkToShowFullVideoWarning(),this.checkToShowChapterWarning();const i={textAlign:"center"};let n;0!=this.props.index&&(i.marginTop="15px");const r={},l=this.props.contentContainer().sponsorTimesSubmitting[this.props.index],c=l.segment;return(null==l?void 0:l.actionType)===a.ActionType.Full&&(r.display="none"),n=this.state.editing?o.createElement("div",{id:"sponsorTimesContainer"+this.idSuffix,style:r,className:"sponsorTimeDisplay"},o.createElement("span",{id:"nowButton0"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToNow(0)},chrome.i18n.getMessage("bracketNow")),o.createElement("input",{id:"submittingTime0"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput",type:"text",style:{color:"inherit",backgroundColor:"inherit"},value:this.state.sponsorTimeEdits[0],onChange:e=>this.handleOnChange(0,e,l,e.target.value),onWheel:e=>this.changeTimesWhenScrolling(0,e,l)}),l.actionType!==a.ActionType.Poi?o.createElement("span",null,o.createElement("span",null," "+chrome.i18n.getMessage("to")+" "),o.createElement("input",{id:"submittingTime1"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput",type:"text",style:{color:"inherit",backgroundColor:"inherit"},value:this.state.sponsorTimeEdits[1],onChange:e=>this.handleOnChange(1,e,l,e.target.value),onWheel:e=>this.changeTimesWhenScrolling(1,e,l)}),o.createElement("span",{id:"nowButton1"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToNow(1)},chrome.i18n.getMessage("bracketNow")),o.createElement("span",{id:"endButton"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToEnd()},chrome.i18n.getMessage("bracketEnd"))):""):o.createElement("div",{id:"sponsorTimesContainer"+this.idSuffix,style:r,className:"sponsorTimeDisplay",onClick:this.toggleEditTime.bind(this)},(0,h.getFormattedTime)(c[0],!0)+(isNaN(c[1])||l.actionType===a.ActionType.Poi?"":" "+chrome.i18n.getMessage("to")+" "+(0,h.getFormattedTime)(c[1],!0))),o.createElement("div",{id:"sponsorTimeEditContainer"+this.idSuffix,style:i},n,o.createElement("div",{style:{position:"relative"}},o.createElement("select",{id:"sponsorTimeCategories"+this.idSuffix,className:"sponsorTimeEditSelector sponsorTimeCategories",defaultValue:l.category,ref:this.categoryOptionRef,style:{color:"inherit",backgroundColor:"inherit"},onChange:e=>this.categorySelectionChange(e)},this.getCategoryOptions()),o.createElement("a",{href:s.wikiLinks[l.category]||"https://wiki.sponsor.ajay.app/index.php/Segment_Categories",target:"_blank",rel:"noreferrer"},o.createElement("img",{id:"sponsorTimeCategoriesHelpButton"+this.idSuffix,className:"helpButton",src:chrome.extension.getURL("icons/help.svg"),title:chrome.i18n.getMessage("categoryGuidelines")}))),s.categorySupport[l.category]&&((null===(e=s.categorySupport[l.category])||void 0===e?void 0:e.length)>1||(null===(t=s.categorySupport[l.category])||void 0===t?void 0:t[0])===a.ActionType.Full)?o.createElement("div",{style:{position:"relative"}},o.createElement("select",{id:"sponsorTimeActionTypes"+this.idSuffix,className:"sponsorTimeEditSelector sponsorTimeActionTypes",defaultValue:l.actionType,style:{color:"inherit",backgroundColor:"inherit"},ref:this.actionTypeOptionRef,onChange:e=>this.actionTypeSelectionChange(e)},this.getActionTypeOptions(l))):"",l.actionType===a.ActionType.Chapter?o.createElement("div",{onBlur:()=>this.setState({chapterNameSelectorOpen:!1})},o.createElement("input",{id:"chapterName"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput sponsorChapterNameInput",style:{color:"inherit",backgroundColor:"inherit"},ref:this.descriptionOptionRef,type:"text",value:this.state.description,onContextMenu:e=>e.stopPropagation(),onChange:e=>this.descriptionUpdate(e.target.value),onFocus:()=>this.setState({chapterNameSelectorOpen:!0})}),this.state.description&&(this.state.chapterNameSelectorOpen||this.state.chapterNameSelectorHovering)&&o.createElement(u.default,{id:"chapterNameSelector"+this.idSuffix,options:this.state.suggestedNames,onMouseEnter:()=>this.setState({chapterNameSelectorHovering:!0}),onMouseLeave:()=>this.setState({chapterNameSelectorHovering:!1}),onChange:e=>this.descriptionUpdate(e)})):"",o.createElement("br",null),o.createElement("span",{id:"sponsorTimeDeleteButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.deleteTime.bind(this)},chrome.i18n.getMessage("delete")),isNaN(c[1])||[a.ActionType.Poi,a.ActionType.Full].includes(l.actionType)||l.actionType===a.ActionType.Chapter?"":o.createElement("span",{id:"sponsorTimePreviewButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:e=>this.previewTime(e.ctrlKey,e.shiftKey)},chrome.i18n.getMessage("preview")),isNaN(c[1])||l.actionType==a.ActionType.Full?"":o.createElement("span",{id:"sponsorTimeInspectButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.inspectTime.bind(this)},chrome.i18n.getMessage("inspect")),isNaN(c[1])||[a.ActionType.Poi,a.ActionType.Full].includes(l.actionType)||l.actionType!==a.ActionType.Chapter?"":o.createElement("span",{id:"sponsorTimePreviewButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:e=>this.previewTime(e.ctrlKey,e.shiftKey)},chrome.i18n.getMessage("End")),isNaN(c[1])||l.actionType==a.ActionType.Full?"":o.createElement("span",{id:"sponsorTimeEditButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.toggleEditTime.bind(this)},this.state.editing?chrome.i18n.getMessage("save"):chrome.i18n.getMessage("edit")))}handleOnChange(e,t,i,n){const o=this.state.sponsorTimeEdits,s=(0,h.getFormattedTimeToSeconds)(o[e]),r=(0,h.getFormattedTimeToSeconds)(n),l=Math.abs(s-r);0<l&&l<.5&&this.showScrollToEditToolTip(),o[e]=n,0===e&&i.actionType===a.ActionType.Poi&&(o[1]=n),this.setState({sponsorTimeEdits:o},(()=>this.saveEditTimes()))}changeTimesWhenScrolling(e,t,i){if(!r.default.config.allowScrollingToEdit)return;let n=0;n=t.shiftKey?t.ctrlKey?1:.001:t.ctrlKey?.1:.01;const o=this.state.sponsorTimeEdits;let s=(0,h.getFormattedTimeToSeconds)(this.state.sponsorTimeEdits[e]);null!==s&&0!=t.deltaY&&(t.deltaY<0?s+=n:s>=n?s-=n:s=0,o[e]=(0,h.getFormattedTime)(s,!0),i.actionType===a.ActionType.Poi&&(o[1]=o[0]),this.setState({sponsorTimeEdits:o}),this.saveEditTimes())}showScrollToEditToolTip(){r.default.config.scrollToEditTimeUpdate||null!==document.getElementById("sponsorRectangleTooltipsponsorTimesContainer"+this.idSuffix)||this.showToolTip(chrome.i18n.getMessage("SponsorTimeEditScrollNewFeature"),"scrollToEdit",(()=>{r.default.config.scrollToEditTimeUpdate=!0}))}showToolTip(e,t,i){const n=document.getElementById("sponsorTimesContainer"+this.idSuffix);if(n){const o=`sponsorRectangleTooltip${t+this.idSuffix}`;return document.getElementById(o)||new c.RectangleTooltip({text:e,referenceNode:n.parentElement,prependElement:n,timeout:15,bottomOffset:"0px",leftOffset:"-318px",backgroundColor:"rgba(28, 28, 28, 1.0)",htmlId:o,buttonFunction:i,fontSize:"14px",maxHeight:"200px"}),!0}return!1}checkToShowFullVideoWarning(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];(e.segment[1]-e.segment[0])/this.props.contentContainer().v.duration>.6&&!this.fullVideoWarningShown&&("sponsor"===e.category||"selfpromo"===e.category||"chooseACategory"===e.category)&&this.showToolTip(chrome.i18n.getMessage("fullVideoTooltipWarning"),"fullVideoWarning")&&(this.fullVideoWarningShown=!0)}checkToShowChapterWarning(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];e.actionType===a.ActionType.Chapter&&e.description&&!this.categoryNameWarningShown&&m.some((t=>e.description.toLowerCase().includes(t.toLowerCase())))&&this.showToolTip(chrome.i18n.getMessage("chapterNameTooltipWarning"),"chapterWarning")&&(this.categoryNameWarningShown=!0)}getCategoryOptions(){var e;const t=[o.createElement("option",{value:d.DEFAULT_CATEGORY,key:d.DEFAULT_CATEGORY},chrome.i18n.getMessage(d.DEFAULT_CATEGORY))];for(const i of null!==(e=this.props.categoryList)&&void 0!==e?e:s.categoryList){const e=["chapter"],n=(r.default.config.showCategoryWithoutPermission||r.default.config.permissions[i])&&("chapter"!==i||(0,p.noRefreshFetchingChaptersAllowed)());(!e.includes(i)&&(void 0===n||r.default.config.showCategoryWithoutPermission)||n)&&t.push(o.createElement("option",{value:i,key:i,className:this.getCategoryLockedClass(i)},chrome.i18n.getMessage("category_"+i)))}return t}getCategoryLockedClass(e){return this.props.contentContainer().lockedCategories.includes(e)?"sponsorBlockLockedColor":""}categorySelectionChange(e){const t=e.target.value;if(t!==d.DEFAULT_CATEGORY&&!r.default.config.categorySelections.some((e=>e.name===t)))return e.target.value=d.DEFAULT_CATEGORY,void(confirm(chrome.i18n.getMessage("enableThisCategoryFirst").replace("{0}",chrome.i18n.getMessage("category_"+t)))&&chrome.runtime.sendMessage({message:"openConfig",hash:"behavior"}));const i=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];this.handleReplacingLostTimes(t,i.actionType,i),this.saveEditTimes(),this.props.categoryChangeListener&&this.props.categoryChangeListener(this.props.index,t)}actionTypeSelectionChange(e){const t=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];this.handleReplacingLostTimes(t.category,e.target.value,t),this.saveEditTimes()}handleReplacingLostTimes(e,t,i){var n,o,r,l,c;(null===(n=s.categorySupport[e])||void 0===n?void 0:n.includes(a.ActionType.Poi))?(this.previousSkipType!==a.ActionType.Poi&&(this.timesBeforeChanging=[null,i.segment[1]]),this.setTimeTo(1,null),this.props.contentContainer().updateEditButtonsOnPlayer(),this.props.contentContainer().sponsorTimesSubmitting.some(((t,i)=>t.category===e&&i!==this.props.index))&&alert(chrome.i18n.getMessage("poiOnlyOneSegment")),this.previousSkipType=a.ActionType.Poi):1===(null===(o=s.categorySupport[e])||void 0===o?void 0:o.length)&&(null===(r=s.categorySupport[e])||void 0===r?void 0:r[0])===a.ActionType.Full?(this.previousSkipType!==a.ActionType.Full&&(this.timesBeforeChanging=[...i.segment]),this.previousSkipType=a.ActionType.Full):"chooseACategory"!==e&&(!(null===(l=s.categorySupport[e])||void 0===l?void 0:l.includes(a.ActionType.Skip))&&!(null===(c=s.categorySupport[e])||void 0===c?void 0:c.includes(a.ActionType.Chapter))||[a.ActionType.Poi,a.ActionType.Full].includes(this.getNextActionType(e,t)))||this.previousSkipType===a.ActionType.Skip||(this.timesBeforeChanging[0]&&this.setTimeTo(0,this.timesBeforeChanging[0]),this.timesBeforeChanging[1]&&this.setTimeTo(1,this.timesBeforeChanging[1]),this.previousSkipType=a.ActionType.Skip)}getActionTypeOptions(e){const t=[];for(const i of s.categorySupport[e.category])t.push(o.createElement("option",{value:i,key:i},chrome.i18n.getMessage(i)));return t}setTimeToNow(e){this.setTimeTo(e,this.props.contentContainer().getRealCurrentTime())}setTimeToEnd(){this.setTimeTo(1,this.props.contentContainer().v.duration)}setTimeTo(e,t){const i=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];null===t&&(t=i.segment[0]);const n=1===i.segment.length;i.segment[e]=t,i.actionType===a.ActionType.Poi&&(i.segment[1]=t),n&&this.props.contentContainer().updateEditButtonsOnPlayer(),this.setState({sponsorTimeEdits:this.getFormattedSponsorTimesEdits(i)},(()=>this.saveEditTimes()))}toggleEditTime(){if(this.state.editing)this.setState({editing:!1}),this.saveEditTimes();else{const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];this.setState({editing:!0,sponsorTimeEdits:this.getFormattedSponsorTimesEdits(e)})}}getFormattedSponsorTimesEdits(e){return[(0,h.getFormattedTime)(e.segment[0],!0),(0,h.getFormattedTime)(e.segment[1],!0)]}saveEditTimes(){var e,t,i,n;const o=this.props.contentContainer().sponsorTimesSubmitting,s=this.categoryOptionRef.current.value;if(this.state.editing){const e=(0,h.getFormattedTimeToSeconds)(this.state.sponsorTimeEdits[0]),t=(0,h.getFormattedTimeToSeconds)(this.state.sponsorTimeEdits[1]);if(null!==e&&null!==t){const i=1===o[this.props.index].segment.length;o[this.props.index].segment=[e,t],i&&this.props.contentContainer().updateEditButtonsOnPlayer()}}else null!==this.state.sponsorTimeEdits[1]||"outro"!==s||o[this.props.index].segment[1]||(o[this.props.index].segment[1]=this.props.contentContainer().v.duration,this.props.contentContainer().updateEditButtonsOnPlayer());o[this.props.index].category=s;const l=this.getNextActionType(s,null===(t=null===(e=this.actionTypeOptionRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.value);o[this.props.index].actionType=l;const c=l===a.ActionType.Chapter?null===(n=null===(i=this.descriptionOptionRef)||void 0===i?void 0:i.current)||void 0===n?void 0:n.value:"";o[this.props.index].description=c,r.default.config.unsubmittedSegments[this.props.contentContainer().sponsorVideoID]=o,r.default.forceSyncUpdate("unsubmittedSegments"),this.props.contentContainer().updatePreviewBar(),o[this.props.index].actionType!==a.ActionType.Full||0===o[this.props.index].segment[0]&&0===o[this.props.index].segment[1]||(this.setTimeTo(0,0),this.setTimeTo(1,0))}getNextActionType(e,t){var i,n,o;return t&&(null===(i=s.categorySupport[e])||void 0===i?void 0:i.includes(t))?t:null!==(o=null===(n=s.categorySupport[e])||void 0===n?void 0:n[0])&&void 0!==o?o:a.ActionType.Skip}previewTime(e=!1,t=!1){const i=this.props.contentContainer().sponsorTimesSubmitting,n=this.props.index;let o=2;e&&(o=.5),t&&(o=.25);const s=i[n].segment[0],r=i[n].segment[1],l=i[n].actionType===a.ActionType.Chapter,c=0===s||l?r:s-o*this.props.contentContainer().v.playbackRate;this.props.contentContainer().previewTime(c,!l)}inspectTime(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index].segment[0];this.props.contentContainer().previewTime(e+1e-4,!1)}deleteTime(){const e=this.props.contentContainer().sponsorTimesSubmitting,t=this.props.index,i=e[t].segment.length<2;e.splice(t,1),e.length>0?r.default.config.unsubmittedSegments[this.props.contentContainer().sponsorVideoID]=e:delete r.default.config.unsubmittedSegments[this.props.contentContainer().sponsorVideoID],r.default.forceSyncUpdate("unsubmittedSegments"),this.props.contentContainer().updatePreviewBar(),0==e.length?this.props.submissionNotice.cancel():this.props.submissionNotice.forceUpdate(),(0===e.length||i)&&this.props.contentContainer().updateEditButtonsOnPlayer()}descriptionUpdate(e){this.setState({description:e}),this.fetchingSuggestions||this.fetchSuggestions(e),this.saveEditTimes()}fetchSuggestions(e){return n(this,void 0,void 0,(function*(){if(this.props.contentContainer().channelIDInfo.status!==a.ChannelIDStatus.Found)return;this.fetchingSuggestions=!0;const t=yield g.asyncRequestToServer("GET","/api/chapterNames",{description:e,channelID:this.props.contentContainer().channelIDInfo.id});if(t.ok)try{const e=JSON.parse(t.responseText);this.setState({suggestedNames:e.map((e=>({label:e.description})))})}catch(e){}this.fetchingSuggestions=!1}))}configUpdate(){this.forceUpdate()}}t.default=f},5595:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294),o=i(7542),s=i(8873),r=i(1181),a=i(4934),l=i(1373),c=i(1467),u=i(7984),p=i(2432);class d extends n.Component{constructor(e){super(e),this.noticeRef=n.createRef(),this.contentContainer=e.contentContainer,this.callback=e.callback;const t=chrome.i18n.getMessage("confirmNoticeTitle");this.state={noticeTitle:t,messages:[],idSuffix:"SubmissionNotice"}}componentDidMount(){this.videoObserver=new MutationObserver((()=>{this.forceUpdate()})),this.videoObserver.observe(this.contentContainer().v,{attributes:!0})}componentWillUnmount(){this.videoObserver&&this.videoObserver.disconnect()}render(){const e=n.createElement("img",{id:"sponsorSkipSortButton"+this.state.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipSmallButton",onClick:()=>this.sortSegments(),title:chrome.i18n.getMessage("sortSegments"),key:"sortButton",src:chrome.extension.getURL("icons/sort.svg")}),t=n.createElement("img",{id:"sponsorSkipExportButton"+this.state.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipSmallButton",onClick:()=>this.exportSegments(),title:chrome.i18n.getMessage("exportSegments"),key:"exportButton",src:chrome.extension.getURL("icons/export.svg")});return n.createElement(a.default,{noticeTitle:this.state.noticeTitle,idSuffix:this.state.idSuffix,ref:this.noticeRef,closeListener:this.cancel.bind(this),zIndex:5e3,firstColumn:[e,t]},this.getMessageBoxes(),n.createElement("tr",{id:"sponsorSkipNoticeMiddleRow"+this.state.idSuffix,className:"sponsorTimeMessagesRow",style:{maxHeight:this.contentContainer().v.offsetHeight-200+"px"}},n.createElement("td",{style:{width:"100%"}},this.getSponsorTimeMessages())),n.createElement("tr",{id:"sponsorSkipNoticeSecondRow"+this.state.idSuffix},n.createElement("td",{className:"sponsorSkipNoticeRightSection",style:{position:"relative"}},n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:()=>window.open("https://wiki.sponsor.ajay.app/w/Guidelines")},chrome.i18n.getMessage(o.default.config.submissionCountSinceCategories>3?"guidelines":"readTheGuidelines")),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:this.submit.bind(this)},chrome.i18n.getMessage("submit")))))}getSponsorTimeMessages(){const e=[];this.timeEditRefs=[];const t=this.props.contentContainer().sponsorTimesSubmitting;for(let i=0;i<t.length;i++){const o=n.createRef();e.push(n.createElement(c.default,{key:t[i].UUID,idSuffix:this.state.idSuffix+i,index:i,contentContainer:this.props.contentContainer,submissionNotice:this,categoryChangeListener:this.categoryChangeListener.bind(this),ref:o})),this.timeEditRefs.push(o)}return e}getMessageBoxes(){const e=[];for(let t=0;t<this.state.messages.length;t++)e.push(n.createElement(l.default,{idSuffix:this.state.idSuffix+t,text:this.state.messages[t],key:t}));return e}cancel(){var e;null===(e=this.guidelinesReminder)||void 0===e||e.close(),this.noticeRef.current.close(!0),this.contentContainer().resetSponsorSubmissionNotice(!1),this.props.closeListener()}submit(){var e,t,i;for(const e of this.timeEditRefs)e.current.saveEditTimes();const n=this.props.contentContainer().sponsorTimesSubmitting;for(const e of n)if("chooseACategory"===e.category)return void alert(chrome.i18n.getMessage("youMustSelectACategory"));if("Music"===(null===(i=null===(t=null===(e=this.contentContainer().videoInfo)||void 0===e?void 0:e.microformat)||void 0===t?void 0:t.playerMicroformatRenderer)||void 0===i?void 0:i.category))for(const e of n)if("sponsor"===e.category){if(!confirm(chrome.i18n.getMessage("nonMusicCategoryOnMusic")))return;break}this.props.callback(),this.cancel()}sortSegments(){let e=this.props.contentContainer().sponsorTimesSubmitting;e=e.sort(((e,t)=>e.segment[0]-t.segment[0])),o.default.config.unsubmittedSegments[this.props.contentContainer().sponsorVideoID]=e,o.default.forceSyncUpdate("unsubmittedSegments"),this.forceUpdate()}exportSegments(){const e=this.props.contentContainer().sponsorTimesSubmitting.sort(((e,t)=>e.segment[0]-t.segment[0]));window.navigator.clipboard.writeText((0,p.exportTimes)(e)),new s.default(null,"exportCopied",{title:chrome.i18n.getMessage("CopiedExclamation"),timed:!0,maxCountdownTime:()=>.6,referenceNode:document.querySelector(".noticeLeftIcon"),dontPauseCountdown:!0,style:{top:0,bottom:0,minWidth:0,right:"30px",margin:"auto"},hideLogo:!0,hideRightInfo:!0,extraClass:"exportCopiedNotice"})}categoryChangeListener(e,t){var i,n,a,l,c;const p=null===(l=null===(a=null===(n=null===(i=this.noticeRef)||void 0===i?void 0:i.current)||void 0===n?void 0:n.getElement())||void 0===a?void 0:a.current)||void 0===l?void 0:l.offsetWidth;if("chooseACategory"!==t&&o.default.config.showCategoryGuidelines&&this.contentContainer().v.offsetWidth>2*p){const e={title:chrome.i18n.getMessage(`category_${t}`),textBoxes:(0,u.getGuidelineInfo)(t),buttons:[{name:chrome.i18n.getMessage("FullDetails"),listener:()=>window.open(r.wikiLinks[t])},{name:chrome.i18n.getMessage("Hide"),listener:()=>{var e;o.default.config.showCategoryGuidelines=!1,null===(e=this.guidelinesReminder)||void 0===e||e.close(),this.guidelinesReminder=null}}],timed:!1,style:{right:`${p+10}px`},extraClass:"sb-guidelines-notice"};e.textBoxes?this.guidelinesReminder?this.guidelinesReminder.update(e):this.guidelinesReminder=new s.default(null,"GuidelinesReminder",e):(null===(c=this.guidelinesReminder)||void 0===c||c.close(),this.guidelinesReminder=null)}}}t.default=d},8290:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=i(7542),s=i(7683),r=i(3147),a=i(893),l=i(2972),c=i(3450),u=i(7052),p=i(3106),d=i(7707),h=i(7657),g=i(4735),m=i(8887),f=i(6465),y=i(41),v=i(2432),T=i(1621),S=i(9249),C=i(5712),k=i(142),b=i(8884),w=i(1369),x=new r.default;x.wait((()=>null!==o.default.config),5e3,10).then((function(){!x.isFirefox()&&o.default.config.invidiousInstances.includes(new URL(document.URL).host)&&window.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementsByTagName("head")[0];for(const t of x.css){const i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=chrome.extension.getURL(t),e.appendChild(i)}}))}));const E=.003;let M=!1,B=[],N=!1,A=null;const I=[];let D,U,L,P=null,O=null,R=!1,_=null,V=[];const F={videoTime:null,preciseTime:null,fromPause:!1,approximateDelay:null};let q=null;const j={time:0,date:0};let $,G=null,H=null,W=null,K=[],Y=!1,z=null,J=!1;const X=[],Z=[];let Q,ee,te,ie=null,ne=0,oe=-1,se=!1,re=!1,ae=null,le=null,ce=null,ue=null;const pe={};x.wait((()=>null!==o.default.config),1e3,1).then((()=>be(Fe(document)))),x.waitForElement(".ytp-inline-preview-ui").then((()=>De())),x.waitForElement("a.ytp-title-link[data-sessionlink='feature=player-title']").then((()=>be(Fe(document)))),function(){var e;const t=document.createElement("script");t.src=chrome.runtime.getURL("js/document.js"),null===(e=document.head||document.documentElement)||void 0===e||e.appendChild(t),document.addEventListener("yt-navigate-start",ke),document.addEventListener("yt-navigate-finish",(()=>{(0,d.isVisible)($)||De()})),window.addEventListener("playerInit",(()=>{document.querySelector('meta[property="og:title"][content="Piped"]')&&(ae=null,xe())})),window.addEventListener("message",yt)}(),document.addEventListener("keydown",Tt),document.addEventListener("DOMContentLoaded",(()=>{document.removeEventListener("keydown",Tt),document.body.addEventListener("keydown",Tt)}));let de,he=[],ge=!1,me=!1,fe=null,ye=!1,ve=0,Te=!1;const Se=()=>({vote:ut,dontShowNoticeAgain:dt,unskipSponsorTime:Xe,sponsorTimes:B,sponsorTimesSubmitting:he,skipNotices:I,v:$,sponsorVideoID:A,reskipSponsorTime:Ze,updatePreviewBar:$e,onMobileYouTube:ee,sponsorSubmissionNotice:fe,resetSponsorSubmissionNotice:ht,updateEditButtonsOnPlayer:nt,previewTime:Ke,videoInfo:_,getRealCurrentTime:ot,lockedCategories:V,channelIDInfo:L});function Ce(e){for(const t in e)switch(t){case"hideVideoPlayerControls":case"hideInfoButtonPlayerControls":case"hideDeleteButtonPlayerControls":it();break;case"categorySelections":Pe()}}function ke(){var e;ne=0,oe=-1,ve=0,B=[],N=!1,K=[],de=0,R=!1,A=null,_=null,D=null,se=!1,L={status:s.ChannelIDStatus.Fetching,id:null},V=[],U=!1,null!==ae&&ae.clear(),M=!1,null===ie?ie=!1:(ie=!0,(0,y.logDebug)("Setting switching videos to true (reset data)")),ye=!1,null==le||le.disable(),null==ce||ce.setVisibility(!1);for(let t=0;t<I.length;t++)null===(e=I.pop())||void 0===e||e.close()}function be(e){var t;return n(this,void 0,void 0,(function*(){if((e||!A||(null===(t=null===document||void 0===document?void 0:document.URL)||void 0===t?void 0:t.includes("youtube.com/clip/")))&&(A!==e||!(0,d.isVisible)($)&&$)&&(ke(),A=e,e)){if(yield x.wait((()=>null!==o.default.config),5e3,1),o.default.config.checkForUnlistedVideos){if(!confirm("SponsorBlock: You have the setting 'Ignore Unlisted/Private Videos' enabled. Due to a change in how segment fetching works, this setting is not needed anymore as it cannot leak your video ID to the server. It instead sends just the first 4 characters of a longer hash of the videoID to the server, and filters through a subset of the database. More info about this implementation can be found here: https://github.com/ajayyy/SponsorBlockServer/issues/25\n\nPlease click okay to confirm that you acknowledge this and continue using SponsorBlock."))return;o.default.config.checkForUnlistedVideos=!1}if(Ge(),null===ae)if(ee){const e=new MutationObserver(we);let t=null;x.wait((()=>(t=document.getElementById("player-control-container"),null!==t))).then((()=>{e.observe(document.getElementById("player-control-container"),{attributes:!0,childList:!0,subtree:!0})})).catch()}else x.wait(d.getControls).then(xe);chrome.runtime.sendMessage({message:"videoChanged",videoID:A,whitelisted:se}),Pe(),it(),he=[],lt()}}))}function we(){if(it(),null==le||le.updateMobileControls(),null!==ae){if(document.body.contains(ae.container)){const t=document.querySelector(".progress-bar-background");return void(null!==t&&(e=t,null===document.getElementById("previewbar")&&ae.createElement(e)))}ae.remove(),ae=null}var e;xe()}function xe(){if(null!==ae)return;const e=[{selector:".progress-bar-background",isVisibleCheck:!0},{selector:".progress-bar-line",isVisibleCheck:!0},{selector:".ytp-progress-bar",isVisibleCheck:!0},{selector:".no-model.cue-range-marker",isVisibleCheck:!0},{selector:".vjs-progress-holder",isVisibleCheck:!1},{selector:"#progress-bar>#sliderContainer>div>#sliderBar>#progressContainer"},{selector:".shaka-ad-markers",isVisibleCheck:!1}];for(const t of e){const e=document.querySelectorAll(t.selector),i=t.isVisibleCheck?(0,d.findValidElement)(e):e[0];if(i){const e=new T.ChapterVote(pt);ae=new a.default(i,ee,Q,e,(()=>Oe(!1))),$e();break}}}function Ee(){St(),$e()}function Me(){xe(),$e(),it()}function Be(){(0,y.logDebug)("Pausing skipping"),null!==G&&(clearTimeout(G),G=null),null!==H&&(clearInterval(H),H=null)}function Ne(e=!1,t,i=!0){var n;if(Be(),ye)return oe=-1,ne=0,void(0,y.logDebug)("[SB] Ad playing, pausing skipping");const r=Fe(document);if(r!==A)return void be(r);if((0,y.logDebug)(`Considering to start skipping: ${!$}, ${null==$?void 0:$.paused}`),!$)return;if(null==t&&(t=Ae()),Le(),q=null,vt(t),$.paused)return;const a=function(e,t,i){var n;const o=e=>{var t;const i=null===(t=x.getCategorySelection(e.category))||void 0===t?void 0:t.option;return i!==s.CategorySkipOption.AutoSkip&&!et(e)||e.actionType!==s.ActionType.Skip?i!==s.CategorySkipOption.ShowOverlay?1:2:0},{includedTimes:r,scheduledTimes:a}=We(B,t,i),{scheduledTimes:l}=We(B,t,i,e,!0),c=f.GenericUtils.indexesOf(a,Math.min(...l)),u=null!==(n=c.sort(((e,t)=>o(r[e])-o(r[t])||r[e].segment[1]-r[e].segment[0]-(r[t].segment[1]-r[t].segment[0])))[0])&&void 0!==n?n:-1,p=c.filter((e=>e!==u&&0!==o(r[e]))),d=He(r,u),{includedTimes:h,scheduledTimes:g}=We(he,t,i),{scheduledTimes:m}=We(he,t,i,e,!1),y=g.indexOf(Math.min(...m)),v=He(h,y);return-1===y&&-1!==u||a[u]<g[y]?{array:r,index:u,endIndex:d,extraIndexes:p,openNotice:!0}:{array:h,index:y,endIndex:v,extraIndexes:[],openNotice:!1}}(t,e,i),l=a.array[a.index],c=[null==l?void 0:l.scheduledTime,null===(n=a.array[a.endIndex])||void 0===n?void 0:n.segment[1]],u=(null==c?void 0:c[0])-t,p=A;if(Y&&!function(e,t){const i=i=>i.actionType===s.ActionType.Mute&&i.segment[0]<=e&&(i.segment[1]>e||t&&i.segment[1]+.02>e);return(null==B?void 0:B.some(i))||he.some(i)}(t,-1!==a.index&&u<E&&et(l))){$.muted=!1,Y=!1;for(const e of I)e.unmutedListener(t)}if((0,y.logDebug)(`Ready to start skipping: ${a.index} at ${t}`),-1===a.index)return;if(o.default.config.disableSkipping||se||L.status===s.ChannelIDStatus.Fetching&&o.default.config.forceChannelCheck)return;if(Ie())return;let d=[a.array[a.index]];if(a.index!==a.endIndex){d=[];for(const e of a.array)et(e)&&e.segment[0]>=c[0]&&e.segment[1]<=c[1]&&e.segment[0]===e.scheduledTime&&d.push(e)}(0,y.logDebug)(`Next step in starting skipping: ${!tt(l)}, ${!(null==he?void 0:he.some((e=>e.segment===l.segment)))}`);const h=e=>{var t;let i=null,n=!1,o=!0;if(!Ie(p,l)){if(e||(e=Math.max($.currentTime,Ae())),tt(l)||(null==he?void 0:he.some((e=>e.segment===l.segment))))if(e>=c[0]-E&&e<c[1]){ze({v:$,skipTime:c,skippingSegments:d,openNotice:a.openNotice});for(const e of a.extraIndexes){const t=a.array[e];tt(t)&&ze({v:$,skipTime:[t.scheduledTime,t.segment[1]],skippingSegments:[t],openNotice:a.openNotice})}(null===(t=x.getCategorySelection(l.category))||void 0===t?void 0:t.option)===s.CategorySkipOption.ManualSkip||l.actionType===s.ActionType.Mute?i=c[0]+.001:(i=c[1],n=!0,o=!1)}else i=e+.001;else i=e+.001;Ne(n,i,o)}};if(u<E)h(t);else{const e=1e3*u*(1/$.playbackRate);if(e<300){const i=performance.now(),n=Math.max(t,$.currentTime);let o=!0;const s=$.currentTime;(0,y.logDebug)(`Starting setInterval skipping ${$.currentTime} to skip at ${c[0]}`),H=setInterval((()=>{if(x.isFirefox()&&!F.fromPause&&o&&s!==$.currentTime){o=!1;const e=Ae()-$.currentTime;e>0&&(F.approximateDelay=e)}const t=performance.now()-i;(t+3>=e||$.currentTime>=c[0])&&(clearInterval(H),x.isFirefox()||$.muted||($.muted=!0,$.muted=!1),h(Math.max($.currentTime,n+$.playbackRate*Math.max(e,t)/1e3)))}),1)}else(0,y.logDebug)(`Starting timeout to skip ${$.currentTime} to skip at ${c[0]}`),G=setTimeout(h,Math.max(0,e-150))}}function Ae(){const e=null!=q?q:null!==F.videoTime?(performance.now()-F.preciseTime)*$.playbackRate/1e3+F.videoTime:null;return o.default.config.useVirtualTime&&!(0,h.isSafari)()&&e&&Math.abs(e-$.currentTime)<.2&&0!==$.currentTime?e:$.currentTime}function Ie(e,t){const i=Fe(document);return!(i===(e||A)&&(!t||B&&(null==B?void 0:B.some((e=>e.segment===t.segment)))||he.some((e=>e.segment===t.segment)))||(console.error("[SponsorBlock] The videoID recorded when trying to skip is different than what it should be."),console.error("[SponsorBlock] VideoID recorded: "+A+". Actual VideoID: "+i),be(i),0))}function De(){var e;return n(this,void 0,void 0,(function*(){if(J)return;J=!0;const t=yield x.waitForElement("video",!0);J=!1,$=t,X.includes($)||(X.push($),function(){if($.addEventListener("loadstart",Me),$.addEventListener("durationchange",Ee),!o.default.config.disableSkipping){ie=!1;let e=!1,t=!0;$.addEventListener("play",(()=>{$.readyState<=HTMLMediaElement.HAVE_CURRENT_DATA&&0===$.currentTime||(Ue(),(ie||t)&&(ie=!1,(0,y.logDebug)("Setting switching videos to false"),B&&Ve()),t=!1,St(),(Math.abs(oe-$.currentTime)>.3||oe!==$.currentTime&&Date.now()-ne>2e3)&&(ne=Date.now(),oe=$.currentTime,Ne()))})),$.addEventListener("playing",(()=>{Ue(),t=!1,e&&(e=!1,(0,y.logDebug)(`[SB] Playing event after buffering: ${Math.abs(oe-$.currentTime)>.3||oe!==$.currentTime&&Date.now()-ne>2e3}`)),ie&&(ie=!1,(0,y.logDebug)("Setting switching videos to false"),B&&Ve()),(Math.abs(oe-$.currentTime)>.3||oe!==$.currentTime&&Date.now()-ne>2e3)&&(ne=Date.now(),oe=$.currentTime,Ne())})),$.addEventListener("seeking",(()=>{F.fromPause=!1,$.paused?(vt($.currentTime),0===$.currentTime&&(t=!0)):(ne=Date.now(),oe=$.currentTime,Ue(),Le(),Ne())})),$.addEventListener("ratechange",(()=>{Ue(),Le(),Ne()})),$.addEventListener("videoSpeed_ratechange",(()=>{Ue(),Le(),Ne()}));const i=()=>{oe=-1,ne=0,F.videoTime=null,F.preciseTime=null,q=$.currentTime,Be()};$.addEventListener("pause",(()=>{F.fromPause=!0,i()})),$.addEventListener("waiting",(()=>{(0,y.logDebug)("[SB] Not skipping due to buffering"),e=!0,i()})),Ne()}}(),le||(le=new u.SkipButtonControlBar({skip:e=>ze({v:$,skipTime:e.segment,skippingSegments:[e],openNotice:!0,forceAutoSkip:!0}),onMobileYouTube:ee})),le.attachToPage(),ce||(ce=new g.CategoryPill),ce.attachToPage(ee,Q,pt)),ae&&!(null===(e=x.findReferenceNode())||void 0===e?void 0:e.contains(ae.container))&&(ae.remove(),ae=null,xe()),be(Fe(document))}))}function Ue(){if(W&&clearInterval(W),F.videoTime=$.currentTime,F.preciseTime=performance.now(),x.isFirefox()){let e=0,t=F.videoTime;W=setInterval((()=>{if(t!==$.currentTime&&(e++,t=$.currentTime),e>1){const e=F.fromPause&&F.approximateDelay?F.approximateDelay:0;F.videoTime=$.currentTime+e,F.preciseTime=performance.now(),clearInterval(W),W=null}}),1)}}function Le(){q=null}function Pe(e=!0){var t,i,r,a,l;return n(this,void 0,void 0,(function*(){if(Te)return;if($&&(0,d.isVisible)($)||De(),!$)return Te=!0,void setTimeout((()=>{Te=!1,Pe()}),100);!function(){const e=document.querySelector(".html5-video-container");e&&null===z&&!Q&&(z=new MutationObserver(De),z.observe(e,{attributes:!0,childList:!0,subtree:!0}))}();const c=o.default.config.showUpsells&&0!==o.default.config.payments.lastCheck&&!(0,k.noRefreshFetchingChaptersAllowed)()&&o.default.config.showChapterInfoMessage&&o.default.config.skipCount>200;if(!c&&o.default.config.showChapterInfoMessage&&o.default.config.payments.freeAccess&&(o.default.config.showChapterInfoMessage=!1,!x.getCategorySelection("chapter"))){const e=document.querySelector(".ytp-chrome-bottom");e&&(o.default.config.showChapterInfoMessage=!1,new C.Tooltip({text:chrome.i18n.getMessage("chapterNewFeature2"),linkOnClick:()=>{chrome.runtime.sendMessage({message:"openConfig"})},referenceNode:e.parentElement,prependElement:e,timeout:1500,leftOffset:"20px",positionRealtive:!1}))}const u=o.default.config.categorySelections.map((e=>e.name));c&&!u.includes("chapter")&&u.push("chapter");const p={},h=(0,d.getHashParams)();h.requiredSegment&&(p.requiredSegment=h.requiredSegment);const g=(yield x.getHash(A,1)).slice(0,4),m=yield x.asyncRequestToServer("GET","/api/skipSegments/"+g,Object.assign({categories:u,actionTypes:Re(c),userAgent:`${chrome.runtime.id}`},p));if(de=null==m?void 0:m.status,null==m?void 0:m.ok){let n=null===(l=null===(a=null===(r=null===(i=null===(t=JSON.parse(m.responseText))||void 0===t?void 0:t.filter((e=>e.videoID===A)))||void 0===i?void 0:i.map((e=>e.segments)))||void 0===r?void 0:r[0])||void 0===a?void 0:a.map((e=>Object.assign(Object.assign({},e),{source:s.SponsorSourceType.Server}))))||void 0===l?void 0:l.sort(((e,t)=>e.segment[0]-t.segment[0]));if(n&&n.length){if(c){const e=n.filter((e=>e.actionType===s.ActionType.Chapter));if(e.length>3){const t=document.querySelector(".ytp-chrome-bottom");t&&(o.default.config.showChapterInfoMessage=!1,new C.Tooltip({text:`🟨${chrome.i18n.getMessage("chapterNewFeature")}${e.slice(0,3).map((e=>e.description)).join(", ")}`,linkOnClick:()=>{chrome.runtime.sendMessage({message:"openUpsell"})},referenceNode:t.parentElement,prependElement:t,timeout:1500,leftOffset:"20px",positionRealtive:!1}))}n=n.filter((e=>e.actionType!==s.ActionType.Chapter))}if(M=!0,null!==B&&e)for(let e=0;e<B.length;e++)B[e].source===s.SponsorSourceType.Local&&n.push(B[e]);const t=B||[];if(B=n,N=!1,0!==o.default.config.minDuration)for(const e of B){const t=e.segment[1]-e.segment[0];t>0&&t<o.default.config.minDuration&&(e.hidden=s.SponsorHideType.MinimumDuration)}if(e)for(const e of t){const t=B.find((t=>e.UUID===t.UUID));t&&(t.hidden=e.hidden,t.category=e.category)}const i=o.default.local.downvotedSegments[g];if(i)for(const e of B){const t=yield x.getHash(e.UUID,1),n=i.segments.find((e=>e.uuid===t));n&&(e.hidden=n.hidden)}Ve(),(te==A||null==te&&!isNaN($.duration))&&$e()}else _e(404)}else _e(de);Oe(!0),chrome.runtime.sendMessage({message:"infoUpdated",found:M,status:de,sponsorTimes:B,time:$.currentTime,onMobileYouTube:ee}),o.default.config.isVip&&function(){var e;n(this,void 0,void 0,(function*(){const t=(yield x.getHash(A,1)).slice(0,4),i=yield x.asyncRequestToServer("GET","/api/lockCategories/"+t);if(i.ok)try{const t=null===(e=JSON.parse(i.responseText).filter((e=>e.videoID===A))[0])||void 0===e?void 0:e.categories;Array.isArray(t)&&(V=t)}catch(e){}}))}()}))}function Oe(e){N||(0,b.waitFor)((()=>(null==$?void 0:$.duration)&&(0,d.getExistingChapters)(A,$.duration)),e?15e3:0,400,(e=>(null==e?void 0:e.length)>0)).then((e=>{!N&&(null==e?void 0:e.length)>0&&(B=(null!=B?B:[]).concat(...e).sort(((e,t)=>e.segment[0]-t.segment[0])),N=!0,$e())})).catch((()=>{}))}function Re(e=!1){const t=[s.ActionType.Skip,s.ActionType.Poi,s.ActionType.Chapter];return o.default.config.muteSegments&&t.push(s.ActionType.Mute),(o.default.config.fullVideoSegments||e)&&t.push(s.ActionType.Full),t}function _e(e){if(M=!1,!o.default.config.refetchWhenNotFound)return;if(O&&clearTimeout(O),404!==e&&ve>1||404!==e&&ve>10)return;ve++;const t=404===e?3e4+3e4*Math.random():2e3+1e4*Math.random();O=setTimeout((()=>{A&&0===(null==B?void 0:B.length)||B.every((e=>e.source!==s.SponsorSourceType.Server))}),t)}function Ve(){var e;if((!ie||h.isSafari)&&B){let t=(0,p.getStartTimeFromUrl)(document.URL)||-1,i=!1;for(const e of B)if(e.segment[0]<=$.currentTime&&e.segment[0]>t&&e.segment[1]>$.currentTime&&e.actionType!==s.ActionType.Poi){t=e.segment[0],i=!0;break}if(!i)for(const e of he)if(e.segment[0]<=$.currentTime&&e.segment[0]>t&&e.segment[1]>$.currentTime&&e.actionType!==s.ActionType.Poi){t=e.segment[0],i=!0;break}const n=B.filter((e=>e.segment[1]>$.currentTime&&e.actionType===s.ActionType.Poi&&e.hidden===s.SponsorHideType.Visible)).sort(((e,t)=>t.segment[0]-e.segment[0]));for(const t of n){const i=null===(e=x.getCategorySelection(t.category))||void 0===e?void 0:e.option;if(i!==s.CategorySkipOption.ShowOverlay&&(ze({v:$,skipTime:t.segment,skippingSegments:[t],openNotice:!0,unskipTime:$.currentTime}),i===s.CategorySkipOption.AutoSkip))break}const o=B.filter((e=>e.actionType===s.ActionType.Full))[0];o&&(null==ce||ce.setSegment(o)),-1!==t?Ne(void 0,t):Ne()}}function Fe(e,t){return t||(t=e.URL),D===s.PageType.Channel?qe():t.includes("youtube.com/clip/")?null:t.includes("/embed/")&&t.includes("youtube.com")?qe(!1,s.PageType.Embed):!t.includes("youtube.com")||t.includes("/watch")||t.includes("/shorts/")||t.includes("playlist")?je(t):t.includes("/channel/")||t.includes("/user/")||t.includes("/c/")?qe(!0,s.PageType.Channel):je(t)||qe(!1)}function qe(e=!0,t=s.PageType.Watch){var i,n;const o="a.ytp-title-link[data-sessionlink='feature=player-title']",r=t===s.PageType.Embed?document.querySelector(o):null===(n=null===(i=null==$?void 0:$.parentElement)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.querySelector(o),a=null==r?void 0:r.getAttribute("href");return a?(Q=e,D=t,je(a)):null}function je(e){e.startsWith("https://www.youtube.com/tv#/")&&(e=e.replace("#",""));let t=null;try{t=new URL(e)}catch(t){return console.error("[SB] Unable to parse URL: "+e),null}if(o.default.config&&o.default.config.invidiousInstances.includes(t.host))Q=!0;else if("m.youtube.com"===t.host)ee=!0;else{if(!["m.youtube.com","www.youtube.com","www.youtube-nocookie.com","music.youtube.com"].includes(t.host))return o.default.config||x.wait((()=>null!==o.default.config)).then((()=>be(je(e)))),null;Q=!1}if(t.searchParams.has("v")&&["/watch","/watch/"].includes(t.pathname)||t.pathname.startsWith("/tv/watch")){const e=t.searchParams.get("v");return 11==e.length?e:null}if(t.pathname.startsWith("/embed/")||t.pathname.startsWith("/shorts/"))try{const e=t.pathname.split("/")[2];if((null==e?void 0:e.length)>=11)return e.slice(0,11)}catch(t){return console.error("[SB] Video ID not valid for "+e),null}return null}function $e(){if(null===ae)return;if(ye)return void ae.clear();if(null===$)return;const e=(0,d.getHashParams)(),t=(null==e?void 0:e.requiredSegment)||void 0,i=[];B&&B.forEach((e=>{e.hidden===s.SponsorHideType.Visible&&i.push({segment:e.segment,category:e.category,actionType:e.actionType,unsubmitted:!1,showLarger:e.actionType===s.ActionType.Poi,description:e.description,source:e.source,requiredSegment:t&&(e.UUID===t||e.UUID.startsWith(t))})})),he.forEach((e=>{i.push({segment:e.segment,category:e.category,actionType:e.actionType,unsubmitted:!0,showLarger:e.actionType===s.ActionType.Poi,description:e.description,source:e.source})})),ae.set(i.filter((e=>e.actionType!==s.ActionType.Full)),null==$?void 0:$.duration),$&&vt($.currentTime),o.default.config.showTimeWithSkips&&function(e){if(Q)return;(isNaN(e)||e<0)&&(e=0);const t=ee?"ytm-time-display":"ytp-time-display.notranslate",i=document.querySelector(`.${t}`);if(!i)return;const n="sponsorBlockDurationAfterSkips";let o=document.getElementById(n);null===o&&(o=document.createElement("span"),o.id=n,o.classList.add(t),i.appendChild(o));const s=(0,w.getFormattedTime)((null==$?void 0:$.duration)-e);o.innerText=null==s||e<=0?"":" ("+s+")"}(x.getTimestampsDuration(i.filter((({actionType:e})=>![s.ActionType.Mute,s.ActionType.Chapter].includes(e))).map((({segment:e})=>e)))),te=A}function Ge(){var e,t,i,r,a,l,c;return n(this,void 0,void 0,(function*(){const n=o.default.config.whitelistedChannels;try{re=!0,yield x.wait((()=>L.status===s.ChannelIDStatus.Found),6e3,20)}catch(n){const o=null===(c=null===(l=null===(a=null!==(r=null!==(t=null!==(e=document.querySelector("a.ytd-video-owner-renderer"))&&void 0!==e?e:document.querySelector("a.ytp-title-channel-logo"))&&void 0!==t?t:null===(i=document.querySelector(".channel-profile #channel-name"))||void 0===i?void 0:i.parentElement.parentElement)&&void 0!==r?r:document.querySelector("a.slim-owner-icon-and-title"))||void 0===a?void 0:a.getAttribute("href"))||void 0===l?void 0:l.match(/\/(?:channel|c|user)\/(UC[a-zA-Z0-9_-]{22}|[a-zA-Z0-9_-]+)/))||void 0===c?void 0:c[1];L=o?{status:s.ChannelIDStatus.Found,id:o}:{status:s.ChannelIDStatus.Failed,id:null}}re=!1,null!=n&&L.status===s.ChannelIDStatus.Found&&n.includes(L.id)&&(se=!0),o.default.config.forceChannelCheck&&(null==B?void 0:B.length)>0&&Ve()}))}function He(e,t,i=!0){if(-1==t||!et(e[t])||e[t].actionType!==s.ActionType.Skip)return t;let n=t;for(let t=0;t<(null==e?void 0:e.length);t++){const o=e[t].segment,r=e[n].segment[1];o[0]-E<=r&&o[1]>r&&(!i||e[t].hidden===s.SponsorHideType.Visible)&&et(e[t])&&e[t].actionType===s.ActionType.Skip&&(n=t)}return n!==t&&(n=He(e,n,i)),n}function We(e,t,i,n,o=!1){if(!e)return{includedTimes:[],scheduledTimes:[]};const r=[],a=[],l=e=>(void 0===n||i&&e.scheduledTime>=n||t&&e.scheduledTime<n&&e.segment[1]>n)&&(!o||e.hidden===s.SponsorHideType.Visible)&&2===e.segment.length&&e.actionType!==s.ActionType.Poi,c=e.map((e=>Object.assign(Object.assign({},e),{scheduledTime:e.segment[0]})));e.forEach((e=>{!c.some((t=>e.segment[1]===t.scheduledTime&&l(t)))&&(void 0===n||e.segment[1]>n)&&c.push(Object.assign(Object.assign({},e),{scheduledTime:e.segment[1]}))}));for(let e=0;e<c.length;e++)l(c[e])&&(a.push(c[e].scheduledTime),r.push(c[e]));return{includedTimes:r,scheduledTimes:a}}function Ke(e,t=!0){$.currentTime=e,t&&$.paused&&$.play()}function Ye(e,t,i){if(!o.default.config.trackViewCount||!o.default.config.trackViewCountInPrivate&&chrome.extension.inIncognitoContext)return;let n=!1;for(const r of e){const e=null==B?void 0:B.findIndex((e=>e.segment===r.segment));-1===e||K[e]||(K[e]=!0,n||(o.default.config.minutesSaved=o.default.config.minutesSaved+t/60,r.actionType!==s.ActionType.Chapter&&(o.default.config.skipCount=o.default.config.skipCount+1),n=!0),i&&x.asyncRequestToServer("POST","/api/viewedVideoSponsorTime?UUID="+r.UUID))}}function ze({v:e,skipTime:t,skippingSegments:i,openNotice:n,forceAutoSkip:r,unskipTime:a}){if(o.default.config.disableSkipping)return;const l=r||et(i[0]);if((l||he.some((e=>e.segment===i[0].segment)))&&e.currentTime!==t[1])switch(i[0].actionType){case s.ActionType.Poi:case s.ActionType.Skip:e.loop&&e.duration>1&&t[1]>=e.duration-1?e.currentTime=0:"Apple Computer, Inc."===navigator.vendor&&e.duration>1&&t[1]>=e.duration?e.currentTime=e.duration-.001:e.currentTime=t[1];break;case s.ActionType.Mute:e.muted||(e.muted=!0,Y=!0)}if(l&&o.default.config.audioNotificationOnSkip){const e=new Audio(chrome.runtime.getURL("icons/beep.ogg"));e.volume=.1*$.volume;const t=navigator.mediaSession.metadata;e.play(),e.addEventListener("ended",(()=>{navigator.mediaSession.metadata=null,setTimeout((()=>navigator.mediaSession.metadata=t))}))}l||1!==i.length||i[0].actionType!==s.ActionType.Poi?n&&(o.default.config.dontShowNotice&&l?l&&(null==P||P.setShowKeybindHint(!1),P={setShowKeybindHint:()=>{},toggleSkip:()=>{Xe(i[0],a),Je(i,l,a,!0)}}):Je(i,l,a,!1)):(le.enable(i[0]),(ee||null==o.default.config.skipKeybind)&&le.setShowKeybindHint(!1),null==P||P.setShowKeybindHint(!1),P=le),l&&Ye(i,t[1]-t[0],!0)}function Je(e,t,i,n){for(const t of I)if(e.length===t.segments.length&&e.every((e=>t.segments.some((t=>t.UUID===e.UUID)))))return;const s=new l.default(e,t,Se,i,n);(ee||null==o.default.config.skipKeybind)&&s.setShowKeybindHint(!1),I.push(s),null==P||P.setShowKeybindHint(!1),P=s}function Xe(e,t=null,i=!1){e.actionType===s.ActionType.Mute&&($.muted=!1,Y=!1),(i||e.actionType===s.ActionType.Skip)&&($.currentTime=null!=t?t:e.segment[0]+.001)}function Ze(e,t=!1){if(e.actionType!==s.ActionType.Mute||t){const t=Math.max(e.segment[1]-$.currentTime,0),i=t/(e.segment[1]-e.segment[0])>.5;$.currentTime=e.segment[1],Ye([e],e.actionType!==s.ActionType.Chapter?t:0,i),Ne(!0,e.segment[1],!1)}else $.muted=!0,Y=!0}function Qe(e,t,i,n,o=!1){const s=document.getElementById(e+"Button");if(null!==s)return s;const r=document.createElement("button");r.draggable=o,r.id=e+"Button",r.classList.add("playerButton"),r.classList.add("ytp-button"),r.setAttribute("title",chrome.i18n.getMessage(t)),r.addEventListener("click",(()=>{i()}));const a=document.createElement("img");return r.draggable=o,a.id=e+"Image",a.className="playerButtonImage",a.src=chrome.extension.getURL("icons/"+n),r.appendChild(a),ue&&ue.prepend(r),pe[e]={button:r,image:a,setupListener:!1},r}function et(e){var t;return(!o.default.config.manualSkipOnFullVideo||!(null==B?void 0:B.some((t=>t.category===e.category&&t.actionType===s.ActionType.Full))))&&((null===(t=x.getCategorySelection(e.category))||void 0===t?void 0:t.option)===s.CategorySkipOption.AutoSkip||o.default.config.autoSkipOnMusicVideos&&(null==B?void 0:B.some((e=>"music_offtopic"===e.category)))&&e.actionType!==s.ActionType.Poi)}function tt(e){var t;return e.actionType!==s.ActionType.Full&&e.source!==s.SponsorSourceType.YouTube&&(null===(t=x.getCategorySelection(e.category))||void 0===t?void 0:t.option)!==s.CategorySkipOption.ShowOverlay||o.default.config.autoSkipOnMusicVideos&&(null==B?void 0:B.some((e=>"music_offtopic"===e.category)))}function it(){return n(this,void 0,void 0,(function*(){A&&!ee&&(yield function(){var e;return n(this,void 0,void 0,(function*(){ue=yield x.wait(d.getControls).catch(),Qe("startSegment","sponsorStart",(()=>st()),"PlayerStartIconSponsorBlocker.svg"),Qe("cancelSegment","sponsorCancel",(()=>(at()&&(he.length>1?(he.pop(),o.default.config.unsubmittedSegments[A]=he):(ht(),he=[],delete o.default.config.unsubmittedSegments[A]),o.default.forceSyncUpdate("unsubmittedSegments")),nt(),void lt(!1))),"PlayerCancelSegmentIconSponsorBlocker.svg"),Qe("delete","clearTimes",(()=>function(){const e=A,t=o.default.config.unsubmittedSegments[e];if(null!=t&&t.length>0){const i=chrome.i18n.getMessage("clearThis")+ft(t)+"\n"+chrome.i18n.getMessage("confirmMSG");if(!confirm(i))return;ht(),delete o.default.config.unsubmittedSegments[e],o.default.forceSyncUpdate("unsubmittedSegments"),he=[],$e(),nt()}}()),"PlayerDeleteIconSponsorBlocker.svg"),Qe("submit","SubmitTimes",(()=>gt()),"PlayerUploadIconSponsorBlocker.svg"),Qe("info","openPopup",(()=>function(){if(null!=document.getElementById("sponsorBlockPopupContainer"))return;me=!1,pe.info&&(pe.info.button.style.display="none");const e=document.createElement("div");e.id="sponsorBlockPopupContainer";const t=document.createElement("iframe");t.width="374",t.height="500",t.addEventListener("load",(()=>t.contentWindow.postMessage("","*"))),t.src=chrome.extension.getURL("popup.html"),e.appendChild(t);const i=e=>{let t;for(const i of e)null!==i.firstElementChild&&(t=i);return t},n=[{selector:"#secondary-inner",hasChildCheck:!0},{selector:"#watch7-sidebar-contents"}];for(const t of n){const n=document.querySelectorAll(t.selector),o=t.hasChildCheck?i(n):n[0];if(o){t.hasChildCheck&&o.insertBefore(e,o.firstChild);break}}}()),"PlayerInfoIconSponsorBlocker.svg");const t=(0,d.getControls)();o.default.config.autoHideInfoButton&&!Q&&t&&(null===(e=pe.info)||void 0===e?void 0:e.button)&&!Z.includes(t)&&(Z.push(t),m.AnimationUtils.setupAutoHideAnimation(pe.info.button,t))}))}(),nt(),o.default.config.hideInfoButtonPlayerControls||document.URL.includes("/embed/")||Q||null!=document.getElementById("sponsorBlockPopupContainer")?pe.info.button.style.display="none":pe.info.button.style.removeProperty("display"))}))}function nt(){if(!A||ee)return;const e=!(o.default.config.hideVideoPlayerControls||Q);let t=!1,i=!1,n=!1;e&&(t=at(),i=he.length>0,n=he.length>1||he.length>0&&!t),pe.startSegment.button.style.display=e?"unset":"none",pe.cancelSegment.button.style.display=e&&t?"unset":"none",e&&(t?(pe.startSegment.image.src=chrome.extension.getURL("icons/PlayerStopIconSponsorBlocker.svg"),pe.startSegment.button.setAttribute("title",chrome.i18n.getMessage("sponsorEnd"))):(pe.startSegment.image.src=chrome.extension.getURL("icons/PlayerStartIconSponsorBlocker.svg"),pe.startSegment.button.setAttribute("title",chrome.i18n.getMessage("sponsorStart")))),pe.submit.button.style.display=i&&!o.default.config.hideUploadButtonPlayerControls?"unset":"none",pe.delete.button.style.display=n&&!o.default.config.hideDeleteButtonPlayerControls?"unset":"none"}function ot(){var e,t;return"M 18,11 V 7 l -5,5 5,5 v -4 c 3.3,0 6,2.7 6,6 0,3.3 -2.7,6 -6,6 -3.3,0 -6,-2.7 -6,-6 h -2 c 0,4.4 3.6,8 8,8 4.4,0 8,-3.6 8,-8 0,-4.4 -3.6,-8 -8,-8 z"===(null===(t=null===(e=document.querySelector(".ytp-play-button"))||void 0===e?void 0:e.querySelector(".ytp-svg-fill"))||void 0===t?void 0:t.getAttribute("d"))?null==$?void 0:$.duration:$.currentTime}function st(){const e=Math.round(1e3*(ot()+Number.EPSILON))/1e3;if(at()){const t=rt(),i=t.segment[0],n=e;t.segment=[Math.min(i,n),Math.max(i,n)]}else he.push({segment:[e],UUID:f.GenericUtils.generateUserID(),category:o.default.config.defaultCategory,actionType:s.ActionType.Skip,source:s.SponsorSourceType.Local});o.default.config.unsubmittedSegments[A]=he,o.default.forceSyncUpdate("unsubmittedSegments"),Pe(),nt(),lt(!1),Oe(!1),200!==de&&404!==de&&!R&&o.default.config.showSegmentFailedToFetchWarning&&(alert(chrome.i18n.getMessage("segmentFetchFailureWarning")),R=!0)}function rt(){return he[he.length-1]}function at(){var e;const t=rt();return t&&2!==(null===(e=null==t?void 0:t.segment)||void 0===e?void 0:e.length)}function lt(e=!0){const t=o.default.config.unsubmittedSegments[A];if(e&&null!=t){he=[];for(const e of t)he.push({segment:e.segment,UUID:e.UUID,category:e.category,actionType:e.actionType,description:e.description,source:e.source});he.length>0&&Oe(!0)}$e(),null!==$&&Ne(),null!==fe&&fe.update(),function(){var e;if(ge)return;ge=!0;let t=!1;const i=(0,d.getHashParams)().segments;if(Array.isArray(i))for(const n of i)Array.isArray(n.segment)&&(he.some((e=>e.segment[0]===n.segment[0]&&e.segment[1]==e.segment[1]))||(he.push({segment:n.segment,UUID:f.GenericUtils.generateUserID(),category:n.category?n.category:o.default.config.defaultCategory,actionType:n.actionType?n.actionType:s.ActionType.Skip,description:null!==(e=n.description)&&void 0!==e?e:"",source:s.SponsorSourceType.Local}),t=!0));t&&(o.default.config.unsubmittedSegments[A]=he,o.default.forceSyncUpdate("unsubmittedSegments"))}()}function ct(){const e=document.getElementById("sponsorBlockPopupContainer");null!==e&&(e.remove(),!document.URL.includes("/embed/")&&pe.info&&(pe.info.button.style.display="unset"))}function ut(e,t,i,o){return n(this,void 0,void 0,(function*(){null!=o&&(o.addVoteButtonInfo.bind(o)(chrome.i18n.getMessage("Loading")),o.setNoticeInfoMessage.bind(o)());const n=yield pt(e,t,i);return null!=n&&null!=o&&(1==n.successType||-1==n.successType&&429==n.statusCode?o.afterVote.bind(o)(x.getSponsorTimeFromUUID(B,t),e,i):-1==n.successType&&(403===n.statusCode&&n.responseText.startsWith("Vote rejected due to a warning from a moderator.")?(0,S.openWarningDialog)(Se):o.setNoticeInfoMessage.bind(o)(f.GenericUtils.getErrorMessage(n.statusCode,n.responseText)),o.resetVoteButtonInfo.bind(o)())),n}))}function pt(e,t,i){return n(this,void 0,void 0,(function*(){const n=x.getSponsorIndexFromUUID(B,t);if(-1==n||B[n].source!==s.SponsorSourceType.Server)return Promise.resolve(void 0);if(0===e&&K[n]||1===e&&!K[n]){let t=1;0==e&&(t=-1,K[n]=!1),o.default.config.minutesSaved=o.default.config.minutesSaved+t*(B[n].segment[1]-B[n].segment[0])/60,o.default.config.skipCount=o.default.config.skipCount+t}return new Promise((n=>{chrome.runtime.sendMessage({message:"submitVote",type:e,UUID:t,category:i},(r=>{if(1===r.successType){const n=x.getSponsorTimeFromUUID(B,t);n&&(0===e?n.hidden=s.SponsorHideType.Downvoted:i?n.category=i:1===e&&(n.hidden=s.SponsorHideType.Visible),i||o.default.config.isVip||x.addHiddenSegment(A,n.UUID,n.hidden),$e())}n(r)}))}))}))}function dt(){o.default.config.dontShowNotice=!0,function(){const e=document.getElementsByClassName("sponsorSkipNotice");for(let t=0;t<e.length;t++)e[t].remove()}()}function ht(e=!0){null==fe||fe.close(e),fe=null}function gt(){if(null!==fe)return fe.close(),void(fe=null);void 0!==he&&he.length>0&&(fe=new c.default(Se,mt))}function mt(){return n(this,void 0,void 0,(function*(){if(!he.every((e=>e.actionType===s.ActionType.Full))&&(U||(0,d.isVisible)(document.querySelector(".ytp-live-badge"))))return void alert(chrome.i18n.getMessage("liveOrPremiere"));pe.submit.image.src=chrome.extension.getURL("icons/PlayerUploadIconSponsorBlocker.svg");const e=m.AnimationUtils.applyLoadingAnimation(pe.submit.button,1,(()=>nt()));for(let e=0;e<he.length;e++)he[e].segment[1]>$.duration&&(he[e].segment[1]=$.duration);if(o.default.config.unsubmittedSegments[A]=he,o.default.forceSyncUpdate("unsubmittedSegments"),o.default.config.minDuration>0)for(let e=0;e<he.length;e++){const t=he[e].segment[1]-he[e].segment[0];if(t>0&&t<o.default.config.minDuration){const e=chrome.i18n.getMessage("shortCheck")+"\n\n"+ft(he);if(!confirm(e))return}}const t=yield x.asyncRequestToServer("POST","/api/skipSegments",{videoID:A,userID:o.default.config.userID,segments:he,videoDuration:null==$?void 0:$.duration,userAgent:`${chrome.runtime.id}/v${chrome.runtime.getManifest().version}`});if(200===t.status){e(),delete o.default.config.unsubmittedSegments[A],o.default.forceSyncUpdate("unsubmittedSegments");const i=he;try{const e=JSON.parse(t.responseText);if((null==e?void 0:e.length)===i.length)for(let t=0;t<e.length;t++)i[t].UUID=e[t].UUID,i[t].source=s.SponsorSourceType.Server}catch(e){}B=(B||[]).concat(i).sort(((e,t)=>e.segment[0]-t.segment[0])),o.default.config.sponsorTimesContributed=o.default.config.sponsorTimesContributed+he.length,o.default.config.submissionCountSinceCategories=o.default.config.submissionCountSinceCategories+1,he=[],$e();const n=B.filter((e=>e.actionType===s.ActionType.Full))[0];n&&(null==ce||ce.setSegment(n))}else pe.submit.button.style.animation="unset",pe.submit.image.src=chrome.extension.getURL("icons/PlayerUploadFailedIconSponsorBlocker.svg"),403===t.status&&t.responseText.startsWith("Submission rejected due to a warning from a moderator.")?(0,S.openWarningDialog)(Se):alert(f.GenericUtils.getErrorMessage(t.status,t.responseText))}))}function ft(e){let t="";for(let i=0;i<e.length;i++)for(let n=0;n<e[i].segment.length;n++){let o=(0,w.getFormattedTime)(e[i].segment[n]);1==n?o=" "+chrome.i18n.getMessage("to")+" "+o:i>0&&(o=", "+o),t+=o}return t}function yt(e){var t;const i=e.data,n=i.type;"sponsorblock"!==i.source||(null===(t=null===document||void 0===document?void 0:document.URL)||void 0===t?void 0:t.includes("youtube.com/clip/"))||("navigation"===n&&i.videoID?(D=i.pageType,i.channelID&&(L={id:i.channelID,status:s.ChannelIDStatus.Found},re||Ge()),be(i.videoID)):"ad"===n?ye!=i.playing&&(ye=i.playing,$e(),it()):"data"===n&&i.videoID&&(be(i.videoID),U=i.isLive||i.isPremiere))}function vt(e){const t=null==ae?void 0:ae.updateChapterText(B,he,e);chrome.runtime.sendMessage({message:"time",time:e});const i=null==t?void 0:t.filter((e=>e.actionType===s.ActionType.Chapter));(null==i?void 0:i.length)>0&&Ye(i,0,!0)}function Tt(e){var t,i,n,r,a;if(["textarea","input"].includes(null===(i=null===(t=document.activeElement)||void 0===t?void 0:t.tagName)||void 0===i?void 0:i.toLowerCase())||(null===(a=null===(r=null===(n=document.activeElement)||void 0===n?void 0:n.id)||void 0===r?void 0:r.toLowerCase())||void 0===a?void 0:a.includes("editable")))return;const l={key:e.key,code:e.code,alt:e.altKey,ctrl:e.ctrlKey,shift:e.shiftKey},c=o.default.config.skipKeybind,u=o.default.config.startSponsorKeybind,p=o.default.config.submitKeybind,d=o.default.config.nextChapterKeybind,g=o.default.config.previousChapterKeybind;if((0,h.keybindEquals)(l,c))P&&P.toggleSkip.call(P);else if((0,h.keybindEquals)(l,u))st();else{if(!(0,h.keybindEquals)(l,p))return(0,h.keybindEquals)(l,d)?(B.length>0&&e.stopPropagation(),void function(){var e;const t=null===(e=ae.unfilteredChapterGroups)||void 0===e?void 0:e.filter((e=>[s.ActionType.Chapter,null].includes(e.actionType)));if(!t||t.length<=0)return;j.time=$.currentTime,j.date=Date.now();const i=t.findIndex((e=>e.segment[0]>$.currentTime));$.currentTime=-1!==i?t[i].segment[0]:$.duration}()):(0,h.keybindEquals)(l,g)?(B.length>0&&e.stopPropagation(),void function(){var e;if(Date.now()-j.date<3e3)return $.currentTime=j.time,void(j.date=0);const t=null===(e=ae.unfilteredChapterGroups)||void 0===e?void 0:e.filter((e=>[s.ActionType.Chapter,null].includes(e.actionType)));if(!t||t.length<=0)return void($.currentTime=0);const i=t.findIndex((e=>e.segment[0]>$.currentTime-Math.min(5,e.segment[1]-e.segment[0]))),n=-1!==i?i-1:t.length-1;$.currentTime=-1!==n?t[n].segment[0]:0}()):void(l.key!=(null==c?void 0:c.key)||null!=c.code||(0,h.keybindEquals)(o.default.syncDefaults.skipKeybind,c)?l.key!=(null==u?void 0:u.key)||null!=u.code||(0,h.keybindEquals)(o.default.syncDefaults.startSponsorKeybind,u)?l.key!=(null==p?void 0:p.key)||null!=p.code||(0,h.keybindEquals)(o.default.syncDefaults.submitKeybind,p)||gt():st():P&&P.toggleSkip.call(P));gt()}}function St(){const e=ye;ye=document.getElementsByClassName("ad-showing").length>0,e!=ye&&($e(),it())}chrome.runtime.onMessage.addListener((function(e,t,i){switch(e.message){case"update":be(Fe(document));break;case"sponsorStart":st(),i({creatingSegment:at()});break;case"isInfoFound":i({found:M,status:de,sponsorTimes:B,time:$.currentTime,onMobileYouTube:ee}),!e.updating&&me&&null!=document.getElementById("sponsorBlockPopupContainer")&&ct(),me=!0;break;case"getVideoID":i({videoID:A});break;case"getChannelID":i({channelID:L.id});break;case"isChannelWhitelisted":i({value:se});break;case"whitelistChange":se=e.value,Pe();break;case"submitTimes":gt();break;case"refreshSegments":A||be(Fe(document)),Pe(!1);break;case"unskip":Xe(B.find((t=>t.UUID===e.UUID)),null,!0);break;case"reskip":Ze(B.find((t=>t.UUID===e.UUID)),!0);break;case"submitVote":return ut(e.type,e.UUID).then((e=>i(e))),!0;case"hideSegment":x.getSponsorTimeFromUUID(B,e.UUID).hidden=e.type,x.addHiddenSegment(A,e.UUID,e.type),$e(),(null==le?void 0:le.isEnabled())&&he.every((e=>e.hidden!==s.SponsorHideType.Visible||e.actionType!==s.ActionType.Poi))&&le.disable();break;case"closePopup":ct();break;case"copyToClipboard":navigator.clipboard.writeText(e.text);break;case"importSegments":{const t=(0,v.importTimes)(e.data,$.duration);let n=!1;for(const e of t)he.some((t=>Math.abs(t.segment[0]-e.segment[0])<1&&Math.abs(t.segment[1]-e.segment[1])<1))||("chapter"!==e.category||x.getCategorySelection("chapter")||(e.category="chooseACategory",e.actionType=s.ActionType.Skip,e.description=""),he.push(e),n=!0);n&&(o.default.config.unsubmittedSegments[A]=he,o.default.forceSyncUpdate("unsubmittedSegments"),nt(),lt(!1),gt()),i({importedSegments:t});break}case"keydown":(document.body||document).dispatchEvent(new KeyboardEvent("keydown",{key:e.key,keyCode:e.keyCode,code:e.code,which:e.which,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey}))}i({})})),o.default.configSyncListeners.includes(Ce)||o.default.configSyncListeners.push(Ce);const Ct="navigation"in window;Ct&&window.navigation.addEventListener("navigate",(e=>be(Fe(document,e.destination.url)))),x.wait((()=>null!==o.default.local)).then((()=>{o.default.local.navigationApiAvailable!==Ct&&(o.default.local.navigationApiAvailable=Ct,o.default.forceLocalUpdate("navigationApiAvailable"))}))},893:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7542),o=i(7683),s=i(2269),r=i(4980),a=i(2432),l=i(7707),c=i(1369),u="sponsorCategoryTooltipVisible";t.default=class{constructor(e,t,i,n,o,s=!1){this.lastSmallestSegment={},this.segments=[],this.existingChapters=[],this.videoDuration=0,this.lastChapterUpdate=0,s||(this.container=document.createElement("ul"),this.container.id="previewbar",this.parent=e,this.onMobileYouTube=t,this.onInvidious=i,this.chapterVote=n,this.updateExistingChapters=o,this.updatePageElements(),this.createElement(e),this.createChapterMutationObservers(),this.setupHoverText())}setupHoverText(){if(this.onMobileYouTube||this.onInvidious)return;document.querySelectorAll(".sponsorCategoryTooltip").forEach((e=>e.remove())),this.categoryTooltip=document.createElement("div"),this.categoryTooltip.className="ytp-tooltip-title sponsorCategoryTooltip",this.chapterTooltip=document.createElement("div"),this.chapterTooltip.className="ytp-tooltip-title sponsorCategoryTooltip";const e=document.querySelector(".ytp-tooltip-text-wrapper"),t=e.querySelector(".ytp-tooltip-title:not(.sponsorCategoryTooltip)");if(!e||!e.parentElement)return;this.categoryTooltipContainer=e.parentElement;const i=e.querySelector(".ytp-tooltip-title");if(!this.categoryTooltipContainer||!i)return;e.insertBefore(this.categoryTooltip,i.nextSibling),e.insertBefore(this.chapterTooltip,i.nextSibling);const n=document.querySelector(".ytp-progress-bar-container");if(!n)return;let r=!1;n.addEventListener("mouseenter",(()=>{r=!0})),n.addEventListener("mouseleave",(()=>{r=!1})),new MutationObserver((n=>{if(!r||!this.categoryTooltip||!this.categoryTooltipContainer)return;if(!n.some((e=>e.target.classList.contains("ytp-tooltip-text"))))return;const l=e.querySelectorAll(".ytp-tooltip-text");let p=null,d=!1;for(const e of l){e.classList.contains("ytp-tooltip-text-no-title")&&(d=!0);const t=e.textContent;if(null!==t&&0!==t.length&&(p=(0,c.getFormattedTimeToSeconds)(t),null!==p))break}if(null===p)return void t.style.removeProperty("display");const[h,g]=(0,s.partition)(this.segments.filter((e=>e.source!==o.SponsorSourceType.YouTube)),(e=>e.actionType!==o.ActionType.Chapter));let m=this.getSmallestSegment(p,h,"normal"),f=this.getSmallestSegment(p,g,"chapter");null===m&&null!==f&&(m=f,f=this.getSmallestSegment(p,g.filter((e=>e!==f)))),null===m&&null===f?(this.categoryTooltipContainer.classList.remove(u),t.style.removeProperty("display")):(this.categoryTooltipContainer.classList.add(u),null!==m&&null!==f?this.categoryTooltipContainer.classList.add("sponsorTwoTooltips"):this.categoryTooltipContainer.classList.remove("sponsorTwoTooltips"),this.setTooltipTitle(m,this.categoryTooltip),this.setTooltipTitle(f,this.chapterTooltip),(0,a.normalizeChapterName)(t.textContent)===(0,a.normalizeChapterName)(this.categoryTooltip.textContent)||(0,a.normalizeChapterName)(t.textContent)===(0,a.normalizeChapterName)(this.chapterTooltip.textContent)?("none"!==t.style.display&&(t.style.display="none"),d=!0):"none"===t.style.display&&t.style.removeProperty("display"),this.categoryTooltip.classList.toggle("ytp-tooltip-text-no-title",d),this.chapterTooltip.classList.toggle("ytp-tooltip-text-no-title",d),this.categoryTooltip.style.right=i.style.right,this.chapterTooltip.style.right=i.style.right,this.categoryTooltip.style.textAlign=i.style.textAlign,this.chapterTooltip.style.textAlign=i.style.textAlign)})).observe(e,{childList:!0,subtree:!0})}setTooltipTitle(e,t){if(e){const i=e.description||(0,r.shortCategoryName)(e.category);e.unsubmitted?t.textContent=chrome.i18n.getMessage("unsubmitted")+" "+i:t.textContent=i,t.style.removeProperty("display")}else t.style.display="none"}createElement(e){this.parent=e,this.onMobileYouTube?(e.classList.contains("progress-bar-background")&&(e.style.backgroundColor="rgba(255, 255, 255, 0.3)",e.style.opacity="1"),this.container.style.transform="none"):this.onInvidious||this.container.classList.add("sbNotInvidious"),this.parent.prepend(this.container)}clear(){for(var e,t,i;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.customChaptersBar&&(this.customChaptersBar.style.display="none"),null===(t=null===(e=this.originalChapterBar)||void 0===e?void 0:e.style)||void 0===t||t.removeProperty("display"),null===(i=this.chapterVote)||void 0===i||i.setVisibility(!1),document.querySelectorAll(".sponsorBlockChapterBar").forEach((e=>{e!==this.customChaptersBar&&e.remove()}))}set(e,t){var i,n;this.segments=null!=e?e:[],this.videoDuration=null!=t?t:0,this.updatePageElements();const o=null!==(n=parseInt(null===(i=this.progressBar)||void 0===i?void 0:i.getAttribute("aria-valuemax")))&&void 0!==n?n:0;o&&Math.abs(o-this.videoDuration)>3&&(this.videoDuration=o),this.update()}updatePageElements(){var e,t,i;const n=document.querySelectorAll(".ytp-progress-bar");if(this.progressBar=null!==(e=(0,l.findValidElement)(n))&&void 0!==e?e:null==n?void 0:n[0],this.progressBar){const e=this.progressBar.querySelector(".ytp-chapters-container:not(.sponsorBlockChapterBar)");this.originalChapterBar!==e&&(null===(i=null===(t=this.originalChapterBar)||void 0===t?void 0:t.style)||void 0===i||i.removeProperty("display"),this.originalChapterBar=e)}}update(){var e,t,i,n,s,r;this.clear();const a=this.getChapterChevron();if(this.segments||null===(e=null==a?void 0:a.style)||void 0===e||e.removeProperty("display"),this.chapterMargin=2,this.originalChapterBar&&(this.originalChapterBarBlocks=this.originalChapterBar.querySelectorAll(":scope > div"),this.existingChapters=this.segments.filter((e=>e.source===o.SponsorSourceType.YouTube)).sort(((e,t)=>e.segment[0]-t.segment[0])),(null===(t=this.existingChapters)||void 0===t?void 0:t.length)>0)){const e=parseFloat(null===(r=null===(s=null===(n=null===(i=this.originalChapterBarBlocks)||void 0===i?void 0:i[0])||void 0===n?void 0:n.style)||void 0===s?void 0:s.marginRight)||void 0===r?void 0:r.replace("px",""));e&&(this.chapterMargin=e)}const l=this.segments.sort((({segment:e},{segment:t})=>t[1]-t[0]-(e[1]-e[0])));for(const e of l){const t=this.createBar(e);this.container.appendChild(t)}this.createChaptersBar(this.segments.sort(((e,t)=>e.segment[0]-t.segment[0]))),a&&(this.segments.some((e=>e.source===o.SponsorSourceType.YouTube))?a.style.removeProperty("display"):this.segments&&(a.style.display="none"))}createBar(e){var t,i;const{category:o,unsubmitted:s,segment:r,showLarger:a}=e,l=document.createElement("li");l.classList.add("previewbar"),e.requiredSegment&&l.classList.add("requiredSegment"),l.innerHTML=a?"&nbsp;&nbsp;":"&nbsp;";const c=(s?"preview-":"")+o;l.setAttribute("sponsorblock-category",c),l.style.backgroundColor=null===(t=n.default.config.barTypes[c])||void 0===t?void 0:t.color,this.onMobileYouTube||(l.style.opacity=null===(i=n.default.config.barTypes[c])||void 0===i?void 0:i.opacity),l.style.position="absolute",Math.min(r[1],this.videoDuration)-r[0]>0&&(l.style.width=`calc(${this.intervalToPercentage(r[0],r[1])}${this.chapterFilter(e)&&r[1]<this.videoDuration?` - ${this.chapterMargin}px`:""})`);const u=r[1]?Math.min(this.videoDuration,r[0]):r[0];return l.style.left=this.timeToPercentage(u),l}createChaptersBar(e){var t;if(!this.progressBar||!this.originalChapterBar||this.originalChapterBar.childElementCount<=0)return this.originalChapterBar&&this.originalChapterBar.style.removeProperty("display"),document.querySelectorAll(".sponsorBlockChapterBar").forEach((e=>e.remove())),void(this.customChaptersBar=null);const i=e!==this.lastRenderedSegments;if(i&&(this.lastRenderedSegments=e,this.unfilteredChapterGroups=this.createChapterRenderGroups(e)),e.every((e=>e.source===o.SponsorSourceType.YouTube))||!n.default.config.renderSegmentsAsChapters&&e.every((e=>e.actionType!==o.ActionType.Chapter||e.source===o.SponsorSourceType.YouTube)))return this.customChaptersBar&&(this.customChaptersBar.style.display="none"),void this.originalChapterBar.style.removeProperty("display");const s=null==e?void 0:e.filter((e=>this.chapterFilter(e)));if(s){let t=this.unfilteredChapterGroups;if(s.length!==e.length&&(t=this.createChapterRenderGroups(s)),this.chapterGroups=t.filter((e=>this.chapterGroupFilter(e))),t.length!==this.chapterGroups.length)for(let e=1;e<this.chapterGroups.length;e++)this.chapterGroups[e].segment[0]!==this.chapterGroups[e-1].segment[1]&&(this.chapterGroups[e-1].segment[1]=this.chapterGroups[e].segment[0])}else this.chapterGroups=this.unfilteredChapterGroups;if(!this.chapterGroups||this.chapterGroups.length<=0)return this.customChaptersBar&&(this.customChaptersBar.style.display="none"),void this.originalChapterBar.style.removeProperty("display");let r=!1;this.customChaptersBar&&this.progressBar.contains(this.customChaptersBar)||(document.querySelectorAll(".sponsorBlockChapterBar").forEach((e=>e.remove())),r=!0,this.customChaptersBar=this.originalChapterBar.cloneNode(!0),this.customChaptersBar.classList.add("sponsorBlockChapterBar")),this.customChaptersBar.style.display="none";const a=this.customChaptersBar.querySelectorAll(".ytp-chapter-hover-container"),l=a[0];if(a.length>this.chapterGroups.length)for(let e=a.length-1;e>=this.chapterGroups.length;e--)this.customChaptersBar.removeChild(a[e]);for(let e=0;e<this.chapterGroups.length;e++){const t=this.chapterGroups[e].segment;let i=a[e];i?r&&this.firstTimeSetupChapterSection(i):(i=l.cloneNode(!0),this.firstTimeSetupChapterSection(i),this.customChaptersBar.appendChild(i)),this.setupChapterSection(i,t[0],t[1],e!==this.chapterGroups.length-1)}this.originalChapterBar.style.display="none",this.customChaptersBar.style.removeProperty("display"),r&&((null===(t=this.container)||void 0===t?void 0:t.parentElement)===this.progressBar?this.progressBar.insertBefore(this.customChaptersBar,this.container.nextSibling):this.progressBar.prepend(this.customChaptersBar)),i&&this.updateChapterAllMutation(this.originalChapterBar,this.progressBar,!0)}createChapterRenderGroups(e){const t=[];return null==e||e.forEach(((i,n)=>{var o;const s=t[t.length-1];if(s&&s.segment[1]>i.segment[0]){const e=i.segment[1]-i.segment[0];if(i.segment[0]<s.segment[0]||e<s.originalDuration){let n=s;const o=[];for(;(null==n?void 0:n.segment[0])>=i.segment[0];){const e=t.pop();e.segment[1]>i.segment[1]&&(e.segment[0]===i.segment[0]&&(e.segment[0]=i.segment[1]),o.push(e)),n=t[t.length-1]}const r=this.getActionTypePrioritized([i.actionType,null==s?void 0:s.actionType]);t.push({segment:[i.segment[0],i.segment[1]],originalDuration:e,actionType:r}),(null==n?void 0:n.segment[1])>i.segment[1]&&t.push({segment:[i.segment[1],n.segment[1]],originalDuration:n.originalDuration,actionType:n.actionType}),o.reverse();let a=i.segment;for(const e of o)e.segment[0]<a[1]&&(e.segment[0]=a[1]),a=e.segment;t.push(...o),n&&(n.segment[1]=i.segment[0])}else t.push({segment:[s.segment[1],i.segment[1]],originalDuration:e,actionType:i.actionType})}else{const e=(null==s?void 0:s.segment[1])||0;i.segment[0]>e&&t.push({segment:[e,i.segment[0]],originalDuration:0,actionType:null});const n=Math.min(i.segment[1],this.videoDuration);t.push({segment:[i.segment[0],n],originalDuration:n-i.segment[0],actionType:i.actionType})}if(n===e.length-1){const s=e[n+1],r=s?s.segment[0]:this.videoDuration,a=(null===(o=t[t.length-1])||void 0===o?void 0:o.segment[1])||i.segment[1];this.intervalToDecimal(a,r)>.003&&t.push({segment:[a,r],originalDuration:0,actionType:null})}})),t}getActionTypePrioritized(e){var t;return e.includes(o.ActionType.Skip)?o.ActionType.Skip:e.includes(o.ActionType.Mute)?o.ActionType.Mute:null!==(t=e.find((e=>e)))&&void 0!==t?t:e[0]}setupChapterSection(e,t,i,n){const o=this.intervalToPercentage(t,i);n?(e.style.marginRight=`${this.chapterMargin}px`,e.style.width=`calc(${o} - ${this.chapterMargin}px)`):(e.style.marginRight="0",e.style.width=o),e.setAttribute("decimal-width",String(this.intervalToDecimal(t,i)))}firstTimeSetupChapterSection(e){e.addEventListener("mouseenter",(()=>{var t;null===(t=this.hoveredSection)||void 0===t||t.classList.remove("ytp-exp-chapter-hover-effect"),e.classList.add("ytp-exp-chapter-hover-effect"),this.hoveredSection=e}))}createChapterMutationObservers(){this.progressBar&&this.originalChapterBar&&(new MutationObserver((e=>{var t;const i={};for(const n of e){const e=n.target;"attributes"===n.type&&(null===(t=e.parentElement)||void 0===t?void 0:t.classList.contains("ytp-progress-list"))&&(i[e.classList[0]]=n.target)}this.updateChapterMutation(i,this.progressBar)})).observe(this.originalChapterBar,{subtree:!0,attributes:!0,attributeFilter:["style","class"]}),new MutationObserver((e=>{for(const t of e)if("childList"===t.type){this.update();break}this.updateChapterMutation({},this.progressBar)})).observe(this.originalChapterBar,{childList:!0}))}updateChapterAllMutation(e,t,i=!1){const n=e.querySelectorAll(".ytp-progress-list > *"),o={};for(const e of n)o[e.classList[0]]=e;this.updateChapterMutation(o,t,i)}updateChapterMutation(e,t,i=!1){var n;if(this.customChaptersBar){let o=0;const s=this.customChaptersBar.querySelectorAll(".ytp-chapter-hover-container");for(let n=0;n<s.length;n++){const r=s[n],a=parseFloat(r.getAttribute("decimal-width")),l=a-this.chapterMargin/t.clientWidth;for(const c in e){const u=`.${c}`,p=r.querySelector(u);if(p){const r=n===s.length-1?a:l,d=e[c],h=this.findLeftAndScale(u,d,t),g=h.left/t.clientWidth,m=Math.max(0,Math.min(1,(g-o)/r));if(isNaN(g)||isNaN(m)||(p.style.left=100*m+"%",p.style.removeProperty("display")),null!==h.scale){const e=h.scale/t.clientWidth;p.style.transform=`scaleX(${Math.max(0,Math.min(1-m,(e-o)/r-m))}`,i&&(p.style.transition="none",setTimeout((()=>p.style.removeProperty("transition")),50))}p.className!==d.className&&(p.className=d.className)}}o+=a}0!==s.length&&s.length!==(null===(n=this.existingChapters)||void 0===n?void 0:n.length)&&Date.now()-this.lastChapterUpdate>3e3&&(this.lastChapterUpdate=Date.now(),this.updateExistingChapters())}}findLeftAndScale(e,t,i){var n;const o=t.parentElement.parentElement.parentElement.children;let s=0,r=0,a=0,l=0,c=null,u=0,p=0,d=0;for(let t=0;t<o.length;t++){const h=o[t],g=h.querySelector(e),m=null!==(n=this.getPartialChapterSectionStyle(h,"width"))&&void 0!==n?n:i.clientWidth,f=m+this.getPartialChapterSectionStyle(h,"marginRight"),y=parseFloat(g.style.left.replace("px",""));0!==y&&(a=y,l=s);const v=g.style.transform.match(/scaleX\(([0-9.]+?)\)/);if(v){const e=parseFloat(v[1]),i=e+y/m;if(d>.99999&&0===i){u=s-r;break}if(d=i,c=e,p=m,(t===o.length-1||i<.99999)&&i>0){u=s,0!==y&&(u+=a);break}}r=f,s+=r}return{left:a+l,scale:null!==c?c*p+u:null}}getPartialChapterSectionStyle(e,t){var i;const n=e.style[t];return(null==n?void 0:n.includes("%"))?this.customChaptersBar.clientWidth*(parseFloat(n.replace("%",""))/100):parseInt(null===(i=e.style[t].match(/\d+/g))||void 0===i?void 0:i[0])||0}updateChapterText(e,t,i){if(!n.default.config.showSegmentNameInChapterBar||(!e||e.length<=0)&&(null==t?void 0:t.length)<=0){const e=this.getChaptersContainer(),t=this.getChapterButton(e);return t&&t.classList.contains("ytp-chapter-container-disabled")&&(e.style.display="none"),[]}null!=e||(e=[]),(null==t?void 0:t.length)>0&&(e=e.concat(t));const s=e.filter((e=>e.hidden===o.SponsorHideType.Visible&&e.segment[0]<=i&&e.segment[1]>i&&e.category!==r.DEFAULT_CATEGORY));return this.setActiveSegments(s),s}setActiveSegments(e){var t;const i=this.getChaptersContainer();if(i)if(e.length>0){i.style.removeProperty("display");const t=e.sort(((e,t)=>e.actionType===o.ActionType.Chapter&&t.actionType!==o.ActionType.Chapter?-1:e.actionType!==o.ActionType.Chapter&&t.actionType===o.ActionType.Chapter?1:t.segment[0]-e.segment[0]))[0],n=this.getChapterButton(i);n.classList.remove("ytp-chapter-container-disabled"),n.disabled=!1;const s=i.querySelector(".ytp-chapter-title-content");if(s.innerText="",(s.querySelector(".sponsorChapterText")||(()=>{const e=document.createElement("div");return s.appendChild(e),e.classList.add("sponsorChapterText"),e})()).innerText=t.description||(0,r.shortCategoryName)(t.category),t.actionType!==o.ActionType.Chapter?s.classList.add("sponsorBlock-segment-title"):s.classList.remove("sponsorBlock-segment-title"),t.source===o.SponsorSourceType.Server){const e=this.chapterVote.getContainer();if(!n.contains(e)){const t=document.querySelectorAll("#chapterVote");t.length>0&&t.forEach((e=>e.remove())),n.insertBefore(e,this.getChapterChevron())}this.chapterVote.setVisibility(!0),this.chapterVote.setSegment(t)}else this.chapterVote.setVisibility(!1)}else null===(t=i.querySelector(".sponsorChapterText"))||void 0===t||t.remove(),""===i.querySelector(".ytp-chapter-title-content").innerText?i.style.display="none":i.style.removeProperty("display"),this.chapterVote.setVisibility(!1)}getChaptersContainer(){return document.querySelector(".ytp-chapter-container")}getChapterButton(e){var t;return null===(t=null!=e?e:this.getChaptersContainer())||void 0===t?void 0:t.querySelector("button.ytp-chapter-title")}remove(){this.container.remove(),this.categoryTooltip&&(this.categoryTooltip.remove(),this.categoryTooltip=void 0),this.categoryTooltipContainer&&(this.categoryTooltipContainer.classList.remove(u),this.categoryTooltipContainer=void 0)}chapterFilter(e){return(n.default.config.renderSegmentsAsChapters||e.actionType===o.ActionType.Chapter)&&e.actionType!==o.ActionType.Poi&&this.chapterGroupFilter(e)}chapterGroupFilter(e){return 2===e.segment.length&&this.intervalToDecimal(e.segment[0],e.segment[1])>.003}intervalToPercentage(e,t){return 100*this.intervalToDecimal(e,t)+"%"}intervalToDecimal(e,t){return this.timeToDecimal(t)-this.timeToDecimal(e)}timeToPercentage(e){return 100*this.timeToDecimal(e)+"%"}timeToDecimal(e){var t,i;if((null===(t=this.originalChapterBarBlocks)||void 0===t?void 0:t.length)>1&&this.existingChapters.length===(null===(i=this.originalChapterBarBlocks)||void 0===i?void 0:i.length)){const t=this.originalChapterBar.parentElement.clientWidth;let i=0,n=-1;for(let t=0;t<this.originalChapterBarBlocks.length;t++){const o=this.originalChapterBarBlocks[t],s=parseFloat(o.style.width.replace("px",""));if(!(e>=this.existingChapters[t].segment[1]))break;i+=s+(o.style.marginRight?parseFloat(o.style.marginRight.replace("px","")):0),n=t}const o=this.existingChapters[n+1];if(o){const s=parseFloat(this.originalChapterBarBlocks[n+1].style.width.replace("px","")),r=o.segment[1]-o.segment[0],a=(e-o.segment[0])/r,l=s/t;return Math.min(1,i/t+a*l)}}return Math.min(1,e/this.videoDuration)}getMinimumSize(e=!1){return this.videoDuration*(e?.006:.003)}getSmallestSegment(e,t,i){var n;const o=i?null===(n=this.lastSmallestSegment[i])||void 0===n?void 0:n.index:null,s=o&&t[o]===this.lastSmallestSegment[i].segment?o:0,r=s>0&&e<this.lastSmallestSegment[i].segment.segment[0]?-1:1;let a=null,l=-1,c=1/0;for(let i=s;i<t.length&&i>=0;i+=r){const n=t[i],o=n.segment[1]-n.segment[0],s=this.getMinimumSize(n.showLarger),u=0!==o?n.segment[0]:Math.floor(n.segment[0]),p=o>s?n.segment[1]:Math.ceil(n.segment[0]+s);if(u<=e&&p>=e&&o<c&&(c=o,a=n,l=i),1===r&&n.segment[0]>e)break}return a&&(this.lastSmallestSegment[i]={index:l,segment:a}),a}getChapterChevron(){return document.querySelector(".ytp-chapter-title-chevron")}}},7052:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SkipButtonControlBar=void 0;const n=i(7542),o=i(4980),s=i(7657),r=i(8887);t.SkipButtonControlBar=class{constructor(e){this.showKeybindHint=!0,this.enabled=!1,this.duration=0,this.left=0,this.swipeStart=0,this.skip=e.skip,this.onMobileYouTube=e.onMobileYouTube,this.container=document.createElement("div"),this.container.classList.add("skipButtonControlBarContainer"),this.container.classList.add("hidden"),this.onMobileYouTube&&this.container.classList.add("mobile"),this.skipIcon=document.createElement("img"),this.skipIcon.src=chrome.runtime.getURL("icons/skipIcon.svg"),this.skipIcon.classList.add("ytp-button"),this.skipIcon.id="sbSkipIconControlBarImage",this.textContainer=document.createElement("div"),this.container.appendChild(this.skipIcon),this.container.appendChild(this.textContainer),this.container.addEventListener("click",(()=>this.toggleSkip())),this.container.addEventListener("mouseenter",(()=>this.stopTimer())),this.container.addEventListener("mouseleave",(()=>this.startTimer())),this.onMobileYouTube&&(this.container.addEventListener("touchstart",(e=>this.handleTouchStart(e))),this.container.addEventListener("touchmove",(e=>this.handleTouchMove(e))),this.container.addEventListener("touchend",(()=>this.handleTouchEnd())))}getElement(){return this.container}attachToPage(){const e=this.getMountingContainer();if(this.chapterText=document.querySelector(".ytp-chapter-container"),e&&!e.contains(this.container))if(this.onMobileYouTube?e.appendChild(this.container):e.insertBefore(this.container,this.chapterText),this.onMobileYouTube){const{hide:t,show:i}=r.AnimationUtils.setupCustomHideAnimation(this.skipIcon,e,!1,!1);this.hideButton=t,this.showButton=i}else r.AnimationUtils.setupAutoHideAnimation(this.skipIcon,e,!1,!1)}getMountingContainer(){return this.onMobileYouTube?document.getElementById("player-container-id"):document.querySelector(".ytp-left-controls")}enable(e,t){var i,n,o,s;t&&(this.duration=t),this.segment=e,this.enabled=!0,this.refreshText(),null===(n=null===(i=this.container)||void 0===i?void 0:i.classList)||void 0===n||n.remove("textDisabled"),null===(s=null===(o=this.textContainer)||void 0===o?void 0:o.classList)||void 0===s||s.remove("hidden"),r.AnimationUtils.disableAutoHideAnimation(this.skipIcon),this.startTimer()}refreshText(){var e,t;this.segment&&(null===(t=null===(e=this.chapterText)||void 0===e?void 0:e.classList)||void 0===t||t.add("hidden"),this.container.classList.remove("hidden"),this.textContainer.innerText=this.getTitle(),this.skipIcon.setAttribute("title",this.getTitle()))}setShowKeybindHint(e){this.showKeybindHint=e,this.refreshText()}stopTimer(){this.timeout&&clearTimeout(this.timeout)}startTimer(){this.stopTimer(),this.timeout=setTimeout((()=>this.disableText()),1e3*Math.max(n.default.config.skipNoticeDuration,this.duration))}disable(){var e,t,i,n;this.container.classList.add("hidden"),null===(t=null===(e=this.chapterText)||void 0===e?void 0:e.classList)||void 0===t||t.remove("hidden"),null===(n=null===(i=this.getChapterPrefix())||void 0===i?void 0:i.classList)||void 0===n||n.remove("hidden"),this.enabled=!1}isEnabled(){return this.enabled}toggleSkip(){this.skip(this.segment),this.disableText()}disableText(){var e,t,i,o,s,a;n.default.config.hideSkipButtonPlayerControls?this.disable():(this.container.classList.add("textDisabled"),null===(t=null===(e=this.textContainer)||void 0===e?void 0:e.classList)||void 0===t||t.add("hidden"),null===(o=null===(i=this.chapterText)||void 0===i?void 0:i.classList)||void 0===o||o.remove("hidden"),null===(a=null===(s=this.getChapterPrefix())||void 0===s?void 0:s.classList)||void 0===a||a.add("hidden"),r.AnimationUtils.enableAutoHideAnimation(this.skipIcon),this.onMobileYouTube&&this.hideButton())}updateMobileControls(){var e;const t=document.getElementById("player-control-overlay");t&&this.enabled&&((null===(e=null==t?void 0:t.classList)||void 0===e?void 0:e.contains("fadein"))?this.showButton():this.hideButton())}getTitle(){return(0,o.getSkippingText)([this.segment],!1)+(this.showKeybindHint?" ("+(0,s.keybindToString)(n.default.config.skipKeybind)+")":"")}getChapterPrefix(){return document.querySelector(".ytp-chapter-title-prefix")}handleTouchStart(e){this.swipeStart=e.touches[0].clientX}handleTouchMove(e){const t=this.swipeStart-e.touches[0].clientX;this.left=Math.min(-t,0),this.updateLeftStyle()}handleTouchEnd(){this.left<-this.container.offsetWidth/2&&(this.disableText(),this.skipIcon.style.display="none",setTimeout((()=>this.skipIcon.style.removeProperty("display")),200)),this.left=0,this.updateLeftStyle()}updateLeftStyle(){this.container.style.left=this.left+"px"}}},4735:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryPill=void 0;const o=i(7294),s=i(745),r=i(5921),a=i(7542),l=i(5712),c=i(8884),u=i(25);t.CategoryPill=class{constructor(){this.ref=o.createRef()}attachToPage(e,t,i){return n(this,void 0,void 0,(function*(){const n=yield(0,c.waitFor)((()=>(0,u.getYouTubeTitleNode)()));n&&!n.contains(this.container)&&(this.container||(this.container=document.createElement("span"),this.container.id="categoryPill",this.container.style.display="relative",this.root=(0,s.createRoot)(this.container),this.root.render(o.createElement(r.default,{ref:this.ref,vote:i})),e&&(this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver((n=>{n.some((e=>e.removedNodes.length>0))&&this.attachToPage(e,t,i)})),this.mutationObserver.observe(n,{childList:!0,subtree:!0}))),this.unsavedState&&(0,c.waitFor)((()=>this.ref.current)).then((()=>{var e;null===(e=this.ref.current)||void 0===e||e.setState(this.unsavedState)})),n.prepend(this.container),n.style.display="flex")}))}close(){this.root.unmount(),this.container.remove()}setVisibility(e){var t,i;const n={show:e,open:!!e&&(null===(t=this.ref.current)||void 0===t?void 0:t.state.open)};this.ref.current?null===(i=this.ref.current)||void 0===i||i.setState(n):this.unsavedState=n}setSegment(e){var t,i,o;return n(this,void 0,void 0,(function*(){if((null===(i=null===(t=this.ref.current)||void 0===t?void 0:t.state)||void 0===i?void 0:i.segment)!==e){const t={segment:e,show:!0,open:!1};if(this.ref.current?null===(o=this.ref.current)||void 0===o||o.setState(t):this.unsavedState=t,!a.default.config.categoryPillUpdate){a.default.config.categoryPillUpdate=!0;const e=yield(0,c.waitFor)((()=>document.querySelector("#info.ytd-watch-flexy")));e&&new l.Tooltip({text:chrome.i18n.getMessage("categoryPillNewFeature"),link:"https://blog.ajay.app/full-video-sponsorblock",referenceNode:e,prependElement:e.firstChild,bottomOffset:"-10px",opacity:.95,timeout:5e4})}}}))}}},1621:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChapterVote=void 0;const o=i(7294),s=i(745),r=i(4954);t.ChapterVote=class{constructor(e){this.ref=o.createRef(),this.container=document.createElement("span"),this.container.id="chapterVote",this.container.style.height="100%",this.root=(0,s.createRoot)(this.container),this.root.render(o.createElement(r.default,{ref:this.ref,vote:e}))}getContainer(){return this.container}close(){this.root.unmount(),this.container.remove()}setVisibility(e){var t;const i=Object.assign({show:e},e?{}:{segment:null});this.ref.current?null===(t=this.ref.current)||void 0===t||t.setState(i):this.unsavedState=i}setSegment(e){var t,i,o;return n(this,void 0,void 0,(function*(){if((null===(i=null===(t=this.ref.current)||void 0===t?void 0:t.state)||void 0===i?void 0:i.segment)!==e){const t={segment:e,show:!0};this.ref.current?null===(o=this.ref.current)||void 0===o||o.setState(t):this.unsavedState=t}}))}}},3927:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleTooltip=void 0;const n=i(7294),o=i(745);t.RectangleTooltip=class{constructor(e){var t,i,s,r,a,l,c;null!==(t=e.bottomOffset)&&void 0!==t||(e.bottomOffset="0px"),null!==(i=e.leftOffset)&&void 0!==i||(e.leftOffset="0px"),null!==(s=e.maxHeight)&&void 0!==s||(e.maxHeight="100px"),null!==(r=e.maxWidth)&&void 0!==r||(e.maxWidth="300px"),null!==(a=e.backgroundColor)&&void 0!==a||(e.backgroundColor="rgba(28, 28, 28, 0.7)"),this.text=e.text,null!==(l=e.fontSize)&&void 0!==l||(e.fontSize="10px"),this.container=document.createElement("div"),null!==(c=e.htmlId)&&void 0!==c||(e.htmlId="sponsorRectangleTooltip"+e.text),this.container.id=e.htmlId,this.container.style.display="relative",e.prependElement?e.referenceNode.insertBefore(this.container,e.prependElement):e.referenceNode.appendChild(this.container),e.timeout&&(this.timer=setTimeout((()=>this.close()),1e3*e.timeout)),this.root=(0,o.createRoot)(this.container),this.root.render(n.createElement("div",{style:{bottom:e.bottomOffset,left:e.leftOffset,maxHeight:e.maxHeight,maxWidth:e.maxWidth,backgroundColor:e.backgroundColor,fontSize:e.fontSize},className:"sponsorBlockRectangleTooltip"},n.createElement("div",null,n.createElement("img",{className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),n.createElement("span",{className:"sponsorSkipObject"},this.text+(e.link?". ":""),e.link?n.createElement("a",{style:{textDecoration:"underline"},target:"_blank",rel:"noopener noreferrer",href:e.link},chrome.i18n.getMessage("LearnMore")):null)),n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",style:{float:"right"},onClick:()=>{e.buttonFunction&&e.buttonFunction(),this.close()}},chrome.i18n.getMessage("GotIt"))))}close(){this.root.unmount(),this.container.remove(),this.timer&&clearTimeout(this.timer)}}},2972:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294),o=i(745),s=new(i(3147).default),r=i(9461),a=i(7683),l=i(7542),c=i(5699);t.default=class{constructor(e,t=!1,i,c=null,u=!1){this.skipNoticeRef=n.createRef(),this.segments=e,this.autoSkip=t,this.contentContainer=i;const p=s.findReferenceNode(),d=document.getElementsByClassName("sponsorSkipNotice").length;let h="";for(const e of this.segments)h+=e.UUID;h+=d,this.noticeElement=document.createElement("div"),this.noticeElement.id="sponsorSkipNoticeContainer"+h,p.prepend(this.noticeElement),this.root=(0,o.createRoot)(this.noticeElement),this.root.render(n.createElement(r.default,{segments:e,autoSkip:t,startReskip:u,contentContainer:i,ref:this.skipNoticeRef,closeListener:()=>this.close(),smaller:l.default.config.noticeVisibilityMode>=a.NoticeVisbilityMode.MiniForAll||l.default.config.noticeVisibilityMode>=a.NoticeVisbilityMode.MiniForAutoSkip&&t,unskipTime:c}))}setShowKeybindHint(e){var t,i;null===(i=null===(t=this.skipNoticeRef)||void 0===t?void 0:t.current)||void 0===i||i.setState({showKeybindHint:e})}close(){this.root.unmount(),this.noticeElement.remove();const e=this.contentContainer().skipNotices;e.splice(e.indexOf(this),1)}toggleSkip(){var e,t;null===(t=null===(e=this.skipNoticeRef)||void 0===e?void 0:e.current)||void 0===t||t.prepAction(c.SkipNoticeAction.Unskip0)}unmutedListener(e){var t,i;null===(i=null===(t=this.skipNoticeRef)||void 0===t?void 0:t.current)||void 0===i||i.unmutedListener(e)}}},3450:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294),o=i(745),s=new(i(3147).default),r=i(5595);t.default=class{constructor(e,t){this.noticeRef=n.createRef(),this.contentContainer=e,this.callback=t;const i=s.findReferenceNode();this.noticeElement=document.createElement("div"),this.noticeElement.id="submissionNoticeContainer",i.prepend(this.noticeElement),this.root=(0,o.createRoot)(this.noticeElement),this.root.render(n.createElement(r.default,{contentContainer:e,callback:t,ref:this.noticeRef,closeListener:()=>this.close(!1)}))}update(){this.noticeRef.current.forceUpdate()}close(e=!0){e&&this.noticeRef.current.cancel(),this.root.unmount(),this.noticeElement.remove()}}},5712:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Tooltip=void 0;const n=i(7294),o=i(745);t.Tooltip=class{constructor(e){var t,i,s,r,a,l,c,u,p;null!==(t=e.bottomOffset)&&void 0!==t||(e.bottomOffset="70px"),null!==(i=e.leftOffset)&&void 0!==i||(e.leftOffset="inherit"),null!==(s=e.rightOffset)&&void 0!==s||(e.rightOffset="inherit"),null!==(r=e.opacity)&&void 0!==r||(e.opacity=.7),null!==(a=e.displayTriangle)&&void 0!==a||(e.displayTriangle=!0),null!==(l=e.extraClass)&&void 0!==l||(e.extraClass=""),null!==(c=e.showLogo)&&void 0!==c||(e.showLogo=!0),null!==(u=e.showGotIt)&&void 0!==u||(e.showGotIt=!0),null!==(p=e.positionRealtive)&&void 0!==p||(e.positionRealtive=!0),this.text=e.text,this.container=document.createElement("div"),this.container.id="sponsorTooltip"+e.text,e.positionRealtive&&(this.container.style.position="relative"),e.prependElement?e.referenceNode.insertBefore(this.container,e.prependElement):e.referenceNode.appendChild(this.container),e.timeout&&(this.timer=setTimeout((()=>this.close()),1e3*e.timeout));const d=`rgba(28, 28, 28, ${e.opacity})`;this.root=(0,o.createRoot)(this.container),this.root.render(n.createElement("div",{style:{bottom:e.bottomOffset,left:e.leftOffset,right:e.rightOffset,backgroundColor:d},className:"sponsorBlockTooltip"+(e.displayTriangle?" sbTriangle":"")+` ${e.extraClass}`},n.createElement("div",null,e.showLogo?n.createElement("img",{className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}):null,this.text?n.createElement("span",{className:"sponsorSkipObject"},this.text+(e.link?". ":""),e.link?n.createElement("a",{style:{textDecoration:"underline"},target:"_blank",rel:"noopener noreferrer",href:e.link},chrome.i18n.getMessage("LearnMore")):e.linkOnClick?n.createElement("a",{style:{textDecoration:"underline",marginLeft:"5px",cursor:"pointer"},onClick:e.linkOnClick},chrome.i18n.getMessage("LearnMore")):null):null,this.getButtons(e.buttons)),e.showGotIt?n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",style:{float:"right"},onClick:()=>this.close()},chrome.i18n.getMessage("GotIt")):null))}getButtons(e){if(e){const t=[];for(const i of e)t.push(n.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",key:i.name,onClick:e=>i.listener(e)},i.name));return t}return null}close(){this.root.unmount(),this.container.remove(),this.timer&&clearTimeout(this.timer)}}},3722:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294);t.default=({fill:e="#ffffff"})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:e},n.createElement("path",{d:"M14.1 7.1l2.9 2.9L6.1 20.7l-3.6.7.7-3.6L14.1 7.1zm0-2.8L1.4 16.9 0 24l7.1-1.4L19.8 9.9l-5.7-5.7zm7.1 4.3L24 5.7 18.3 0l-2.8 2.8 5.7 5.7z"}))},9566:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294);t.default=({fill:e="#ffffff",className:t="",width:i="18",height:o="18"})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:o,fill:e,className:t,viewBox:"0 0 24 24"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),n.createElement("path",{d:"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"}))},6388:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=i(7294);t.default=({fill:e="#ffffff",className:t="",width:i="18",height:o="18"})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:e,width:i,height:o,className:t,viewBox:"0 0 24 24"},n.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),n.createElement("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"}))},2269:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.partition=void 0,t.partition=function(e,t){const i=[],n=[];return e.forEach((e=>(t(e)?i:n).push(e))),[i,n]}},7984:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGuidelineInfo=void 0,t.getGuidelineInfo=function(e){switch(e){case"sponsor":return[{icon:"icons/money.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"selfpromo":return[{icon:"icons/money.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/campaign.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline3`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"exclusive_access":return[{icon:"icons/money.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)}];case"interaction":return[{icon:"icons/lightbulb.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/lightbulb.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline3`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"intro":return[{icon:"icons/check-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"outro":return[{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"preview":return[{icon:"icons/check-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/check-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline3`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"filler":return[{icon:"icons/stopwatch.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/stopwatch.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline3`)},{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"music_offtopic":return[{icon:"icons/music-note.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/music-note.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}];case"poi_highlight":return[{icon:"icons/star.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/bolt.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/bolt.svg",text:chrome.i18n.getMessage(`category_${e}_guideline3`)}];case"chapter":return[{icon:"icons/close-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline1`)},{icon:"icons/check-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline2`)},{icon:"icons/check-smaller.svg",text:chrome.i18n.getMessage(`category_${e}_guideline3`)}];default:return[{icon:"icons/segway.png",text:chrome.i18n.getMessage("generic_guideline1")},{icon:"icons/right-arrow.svg",text:chrome.i18n.getMessage("generic_guideline2")}]}}},41:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logWarn=t.logDebug=void 0,window.SBLogs={debug:[],warn:[]},t.logDebug=function(e){window.SBLogs.debug.push(`[${(new Date).toISOString()}] ${e}`)},t.logWarn=function(e){window.SBLogs.warn.push(`[${(new Date).toISOString()}] ${e}`)}},5699:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downvoteButtonColor=t.SkipNoticeAction=void 0;const n=i(7542);var o;(o=t.SkipNoticeAction||(t.SkipNoticeAction={}))[o.None=0]="None",o[o.Upvote=1]="Upvote",o[o.Downvote=2]="Downvote",o[o.CategoryVote=3]="CategoryVote",o[o.CopyDownvote=4]="CopyDownvote",o[o.Unskip0=5]="Unskip0",o[o.Unskip1=6]="Unskip1",t.downvoteButtonColor=function(e,t,i){return(null==e?void 0:e.length)>1?t===i?n.default.config.colorPalette.red:n.default.config.colorPalette.white:n.default.config.isVip&&1===(null==e?void 0:e[0].locked)?n.default.config.colorPalette.locked:n.default.config.colorPalette.white}},3106:(e,t)=>{function i(e){var t,i,n;if(!e)return 0;const o=/(?:(\d{1,3})h)?(?:(\d{1,2})m)?(\d+)s?/.exec(e);return o?3600*parseInt(null!==(t=o[1])&&void 0!==t?t:"0",10)+60*parseInt(null!==(i=o[2])&&void 0!==i?i:"0",10)+parseInt(null!==(n=o[3])&&void 0!==n?n:"0",10):/\d+/.test(e)?parseInt(e,10):0}Object.defineProperty(t,"__esModule",{value:!0}),t.urlTimeToSeconds=t.getStartTimeFromUrl=void 0,t.getStartTimeFromUrl=function(e){const t=new URLSearchParams(e);return i((null==t?void 0:t.get("t"))||(null==t?void 0:t.get("time_continue")))},t.urlTimeToSeconds=i},9249:function(e,t,i){var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.openChat=t.openWarningDialog=void 0;const o=i(7542),s=i(8873),r=i(3147),a=i(6465),l=new r.default;function c(e){window.open("https://chat.sponsor.ajay.app/#"+a.GenericUtils.objectToURI("",e,!1))}t.openWarningDialog=function(e){var t;return n(this,void 0,void 0,(function*(){const i=yield l.asyncRequestToServer("GET","/api/userInfo",{publicUserID:yield l.getHash(o.default.config.userID),values:["warningReason"]});if(i.ok){const r=null===(t=JSON.parse(i.responseText))||void 0===t?void 0:t.warningReason,a=yield l.asyncRequestToServer("GET","/api/getUsername?userID="+o.default.config.userID),u=a.ok?JSON.parse(a.responseText).userName:"",p=yield l.getHash(o.default.config.userID);let d=null;const h={title:chrome.i18n.getMessage("warningTitle"),textBoxes:[{text:chrome.i18n.getMessage("warningChatInfo"),icon:null},...r.split("\n").map((e=>({text:e,icon:null})))],buttons:[{name:chrome.i18n.getMessage("questionButton"),listener:()=>c({displayName:`${u||""}${u!==p?` | ${p}`:""}`})},{name:chrome.i18n.getMessage("warningConfirmButton"),listener:()=>n(this,void 0,void 0,(function*(){const e=yield l.asyncRequestToServer("POST","/api/warnUser",{userID:o.default.config.userID,enabled:!1});e.ok?null==d||d.close():alert(`${chrome.i18n.getMessage("warningError")} ${e.status}`)}))}],timed:!1};d=new s.default(e,"warningNotice",h)}}))},t.openChat=c}},i={};function n(e){var o=i[e];if(void 0!==o)return o.exports;var s=i[e]={exports:{}};return t[e].call(s.exports,s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,i,o,s)=>{if(!i){var r=1/0;for(u=0;u<e.length;u++){for(var[i,o,s]=e[u],a=!0,l=0;l<i.length;l++)(!1&s||r>=s)&&Object.keys(n.O).every((e=>n.O[e](i[l])))?i.splice(l--,1):(a=!1,s<r&&(r=s));if(a){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[i,o,s]},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={998:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var o,s,[r,a,l]=i,c=0;if(r.some((t=>0!==e[t]))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var u=l(n)}for(t&&t(i);c<r.length;c++)s=r[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},i=self.webpackChunksponsorblock=self.webpackChunksponsorblock||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var o=n.O(void 0,[736],(()=>n(8290)));o=n.O(o)})();