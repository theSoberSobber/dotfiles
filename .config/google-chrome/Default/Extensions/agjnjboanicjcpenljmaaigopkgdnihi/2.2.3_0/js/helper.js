var pmd;pmd=(()=>{"use strict";var e={897:(e,t,n)=>{n.r(t),n.d(t,{apiBase:()=>k,axios:()=>y,getStorage:()=>m,getString:()=>x,getStrings:()=>w});var a=n(9669),r=n.n(a);const o="https://api.premid.app/v3/",s="font-weight: 800; padding: 2px 5px; color: white;";let i;function l(e){i!==e&&(console.groupEnd(),console.group(e),i=e)}function c(e){for(const t in e)"object"==typeof e[t]&&c(e[t]),null!==e[t]&&void 0!==e[t]||delete e[t]}async function u(e){const t=await r()({url:o,method:"post",data:{query:e}});return c(t.data),t.data}const d="en",g=3e5;let p={};function f(e){return e.split("-")[0]}async function h(e){e||(e=d),e.includes("ja")||e.includes("zh")||e.includes("ko")||(e=f(e));let t=e,n=e,a=e;switch(e){case"ja":t="ja_JP",a="ja_JP";break;case"ja_JP":n="ja";break;case"ko":t="ko_KR",a="ko_KR";break;case"ko_KR":n="ko";break;case"zh-CN":t="zh_CN",a="zh_CN";break;case"zh_CN":n="zh-CN";break;case"zh-TW":t="zh_TW",a="zh_TW";break;case"zh_TW":n="zh-TW";break;default:const e=(await u('\n\t\t\tquery {\n\t\t\t\tlangFiles(project: "extension") {\n\t\t\t\t\tlang\n\t\t\t\t}\n\t\t\t}\n\t\t\t')).data.langFiles.map((e=>e.lang));if(!e.includes(n)){const r=e.findIndex((e=>e.includes(n+"_")));r>=0&&(t=e[r],n=e[r],a=e[r])}}try{const r=await u(`\n\t\t\tquery {\n\t\t\t\twebsite: langFiles(project: "website", lang: "${t}") {\n\t\t\t\t\ttranslations\n\t\t\t\t}\n\t\t\t\textension: langFiles(project: "extension", lang: "${n}") {\n\t\t\t\t\ttranslations\n\t\t\t\t}\n\t\t\t\tpresence: langFiles(project: "presence", lang: "${a}") {\n\t\t\t\t\ttranslations\n\t\t\t\t}\n\t\t\t}\n\t\t`);p[e]={name:r.data.website[0].translations["header.language"],loading:r.data.website[0].translations["header.loader.phrases"],extension:r.data.extension[0].translations,presence:r.data.presence[0].translations,updatedAt:Date.now()},function(e,t,n=!1){n&&(l("langManager.ts"),console.log("%cPreMiD%cSUCCESS%c "+t,s+"border-radius: 25px 0 0 25px; background: #596cae;",s+"border-radius: 0 25px 25px 0; background: #50ff50; color: black;","color: unset;"))}(0,`Updated ${e} translations`)}catch(t){return void function(e,t,n=!1){n&&(l(e),console.log("%cPreMiD%cERROR%c "+t,s+"border-radius: 25px 0 0 25px; background: #596cae;",s+"border-radius: 0 25px 25px 0; background: #ff5050;","color: unset;"))}("langManager.ts",`Error while fetching langFiles of ${e} language: ${t.message}`)}p[e]&&p[e].error?p[e]=void 0:await chrome.storage.local.set({languages:p})}const b=[];async function v(e,t){return e||(e=d),t||(t=!1),e=f(e),new Promise((n=>{if(void 0!==p[e]&&n(),b.includes(e)){let t=setInterval((()=>{void 0!==p&&void 0!==p[e]&&(clearInterval(t),n())}),5)}else b.push(e),chrome.storage.local.get("languages",(async a=>{a.languages||(a.languages={});const r=[];(t&&void 0!==a.languages.en&&Date.now()-a.languages.en.updatedAt>=g||e!==d&&void 0===a.languages.en)&&r.push(h(d)),(void 0===a.languages[e]||t&&Date.now()-a.languages[e].updatedAt>=g)&&r.push(h(e)),await Promise.all(r),p={...p,...a.languages},b.splice(b.indexOf(e),1),n()}))}))}let x=function e(t,n){return n||(n=chrome.i18n.getUILanguage()),n=f(n),new Promise((async a=>{if(await v(n),void 0!==p[n]){if(["name","header.language"].includes(t)&&void 0!==p[n].name)return a(p[n].name);if(["loading","header.loader.phrases"].includes(t)&&void 0!==p[n].loading)return a(p[n].loading);if(void 0!==p[n].extension&&void 0!==p[n].extension[t])return a(p[n].extension[t]);if(void 0!==p[n].presence&&void 0!==p[n].presence[t])return a(p[n].presence[t])}return a(n===d?t:await e(t,d))}))},w=function(e){return e||(e=d),e=f(e),new Promise((async t=>{await v(e),void 0===p[e]?(p.en||t({}),t({[d]:{...p.en.extension,...p.en.presence}})):t({[e]:{...p[e].extension,...p[e].presence},[d]:{...p.en.extension,...p.en.presence}})}))},m=function(e,t){return new Promise((n=>chrome.storage[e].get(t,(e=>n(e)))))},y=r(),k=o}},t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}return n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={591:0},t=[[897,999]],a=()=>{};function r(){for(var a,r=0;r<t.length;r++){for(var o=t[r],s=!0,i=1;i<o.length;i++){var l=o[i];0!==e[l]&&(s=!1)}s&&(t.splice(r--,1),a=n(n.s=o[0]))}return 0===t.length&&(n.x(),n.x=()=>{}),a}n.x=()=>{n.x=()=>{},s=s.slice();for(var e=0;e<s.length;e++)o(s[e]);return(a=r)()};var o=r=>{for(var o,s,[l,c,u,d]=r,g=0,p=[];g<l.length;g++)s=l[g],n.o(e,s)&&e[s]&&p.push(e[s][0]),e[s]=0;for(o in c)n.o(c,o)&&(n.m[o]=c[o]);for(u&&u(n),i(r);p.length;)p.shift()();return d&&t.push.apply(t,d),a()},s=self.webpackChunkpmd=self.webpackChunkpmd||[],i=s.push.bind(s);s.push=o})(),n.x()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wbWQvLi9zcmMvY29uZmlnLnRzIiwid2VicGFjazovL3BtZC8uL3NyYy91dGlsL2RlYnVnLnRzIiwid2VicGFjazovL3BtZC8uL3NyYy91dGlsL2Z1bmN0aW9ucy9jbGVhbk9iamVjdC50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvdXRpbC9mdW5jdGlvbnMvZ3JhcGhxbC50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvdXRpbC9sYW5nTWFuYWdlci50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvaGVscGVyLnRzIiwid2VicGFjazovL3BtZC8uL3NyYy91dGlsL2Z1bmN0aW9ucy9hc3luY1N0b3JhZ2UudHMiLCJ3ZWJwYWNrOi8vcG1kL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3BtZC93ZWJwYWNrL3N0YXJ0dXAiLCJ3ZWJwYWNrOi8vcG1kL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3BtZC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcG1kL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vcG1kL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcG1kL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vcG1kL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIl0sIm5hbWVzIjpbImFwaUJhc2UiLCJnZW5lcmljU3R5bGUiLCJsYXN0RmlsZSIsImdyb3VwRmlsZSIsImZpbGUiLCJjb25zb2xlIiwiZ3JvdXBFbmQiLCJncm91cCIsIm9iaiIsInByb3BOYW1lIiwidW5kZWZpbmVkIiwiYXN5bmMiLCJxdWVyeSIsInJlcyIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJERUZBVUxUX0xPQ0FMRSIsIk1JTl9VUERBVEVfVElNRSIsImxhbmd1YWdlcyIsIm5vcm1hbGl6ZUxhbmd1YWdlQ29kZSIsImxhbmd1YWdlQ29kZSIsInNwbGl0IiwidXBkYXRlU3RyaW5ncyIsImluY2x1ZGVzIiwid2Vic2l0ZUxhbmd1YWdlIiwiZXh0ZW5zaW9uTGFuZ3VhZ2UiLCJwcmVzZW5jZUxhbmd1YWdlIiwiYXZhaWxhYmxlTGFuZ3MiLCJsYW5nRmlsZXMiLCJtYXAiLCJsZiIsImxhbmciLCJpbmRleCIsImZpbmRJbmRleCIsImMiLCJncmFwaHFsUmVzdWx0IiwibmFtZSIsIndlYnNpdGUiLCJ0cmFuc2xhdGlvbnMiLCJsb2FkaW5nIiwiZXh0ZW5zaW9uIiwicHJlc2VuY2UiLCJ1cGRhdGVkQXQiLCJEYXRlIiwibm93IiwibWVzc2FnZSIsImZvcmNlIiwibG9nIiwic3VjY2VzcyIsImUiLCJlcnJvciIsImNocm9tZSIsInN0b3JhZ2UiLCJsb2NhbCIsInNldCIsImxvYWRpbmdMYW5ncyIsImxvYWRTdHJpbmdzIiwidXBkYXRlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJsb2FkU3RhdHVzIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwicHVzaCIsImdldCIsImxuZ3MiLCJ1cGRhdGVQcm9taXNlcyIsImFsbCIsInNwbGljZSIsImluZGV4T2YiLCJnZXRTdHJpbmciLCJzdHJpbmciLCJpMThuIiwiZ2V0VUlMYW5ndWFnZSIsInR5cGUiLCJpdGVtcyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm0iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnIiwiZ2xvYmFsVGhpcyIsInRoaXMiLCJGdW5jdGlvbiIsIndpbmRvdyIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiaW5zdGFsbGVkQ2h1bmtzIiwiNTkxIiwiZGVmZXJyZWRNb2R1bGVzIiwiY2hlY2tEZWZlcnJlZE1vZHVsZXMiLCJjaGVja0RlZmVycmVkTW9kdWxlc0ltcGwiLCJyZXN1bHQiLCJpIiwibGVuZ3RoIiwiZGVmZXJyZWRNb2R1bGUiLCJmdWxmaWxsZWQiLCJqIiwiZGVwSWQiLCJzIiwieCIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNsaWNlIiwid2VicGFja0pzb25wQ2FsbGJhY2siLCJjaHVua0lkIiwiY2h1bmtJZHMiLCJtb3JlTW9kdWxlcyIsInJ1bnRpbWUiLCJleGVjdXRlTW9kdWxlcyIsInJlc29sdmVzIiwicGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24iLCJzaGlmdCIsImFwcGx5Iiwic2VsZiIsImJpbmQiXSwibWFwcGluZ3MiOiJ1S0FBTyxNQUFNQSxFQUFVLDZCQ0VqQkMsRUFBZSxvREFFckIsSUFBSUMsRUEwQ0osU0FBU0MsRUFBVUMsR0FDZEYsSUFBYUUsSUFDaEJDLFFBQVFDLFdBQ1JELFFBQVFFLE1BQU1ILEdBQ2RGLEVBQVdFLEdDbERFLFNBQVMsRUFBWUksR0FDbkMsSUFBSyxNQUFNQyxLQUFZRCxFQUNNLGlCQUFqQkEsRUFBSUMsSUFDZCxFQUFZRCxFQUFJQyxJQUVLLE9BQWxCRCxFQUFJQyxTQUF3Q0MsSUFBbEJGLEVBQUlDLFdBQzFCRCxFQUFJQyxHQ0RDRSxlQUFlLEVBQWVDLEdBQzVDLE1BQU1DLFFBQVksSUFBTSxDQUN2QkMsSUFBS2QsRUFDTGUsT0FBUSxPQUNSQyxLQUFNLENBQ0xKLE1BQU9BLEtBS1QsT0FGQSxFQUFZQyxFQUFJRyxNQUVUSCxFQUFJRyxLQ1BMLE1BQU1DLEVBQWlCLEtBS3hCQyxFQUFrQixJQUV4QixJQUFJQyxFQUFvQixHQUV4QixTQUFTQyxFQUFzQkMsR0FDOUIsT0FBT0EsRUFBYUMsTUFBTSxLQUFLLEdBUXpCWCxlQUFlWSxFQUFjRixHQUM5QkEsSUFBY0EsRUFB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QUlRLEVBQW1CUCxPQUFRRCxJQUFLVSxFQUFxQkYsRUFBbUJSLElBQzNGLE9BQVFILEVBQXVCQyxNQUloQyxJQUFJWSxFQUF3QjVHLElBSzNCLElBSkEsSUFHSStELEVBQVU4QyxHQUhUQyxFQUFVQyxFQUFhQyxFQUFTQyxHQUFrQmpILEVBR2hDa0csRUFBSSxFQUFHZ0IsRUFBVyxHQUNwQ2hCLEVBQUlZLEVBQVNYLE9BQVFELElBQ3pCVyxFQUFVQyxFQUFTWixHQUNoQnBDLEVBQW9CYyxFQUFFZ0IsRUFBaUJpQixJQUFZakIsRUFBZ0JpQixJQUNyRUssRUFBU2xFLEtBQUs0QyxFQUFnQmlCLEdBQVMsSUFFeENqQixFQUFnQmlCLEdBQVcsRUFFNUIsSUFBSTlDLEtBQVlnRCxFQUNaakQsRUFBb0JjLEVBQUVtQyxFQUFhaEQsS0FDckNELEVBQW9CTSxFQUFFTCxHQUFZZ0QsRUFBWWhELElBS2hELElBRkdpRCxHQUFTQSxFQUFRbEQsR0FDcEJxRCxFQUEyQm5ILEdBQ3JCa0gsRUFBU2YsUUFDZGUsRUFBU0UsT0FBVEYsR0FPRCxPQUhHRCxHQUFnQm5CLEVBQWdCOUMsS0FBS3FFLE1BQU12QixFQUFpQm1CLEdBR3hEbEIsS0FHSlcsRUFBcUJZLEtBQXNCLGdCQUFJQSxLQUFzQixpQkFBSyxHQUMxRUgsRUFBNkJULEVBQW1CMUQsS0FBS3VFLEtBQUtiLEdBQzlEQSxFQUFtQjFELEtBQU80RCxHLEdOeEZuQjlDLEVBQW9CMkMsSyIsImZpbGUiOiJqcy9oZWxwZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgYXBpQmFzZSA9IFwiaHR0cHM6Ly9hcGkucHJlbWlkLmFwcC92My9cIjtcclxuZXhwb3J0IGNvbnN0IHJlbGVhc2VUeXBlOiBcIkJFVEFcIiB8IFwiQUxQSEFcIiB8IFwiUkVMRUFTRVwiIHwgXCJERVZcIiA9IFwiUkVMRUFTRVwiO1xyXG5leHBvcnQgY29uc3QgcmVxdWlyZWRBcHBWZXJzaW9uID0gMjE0O1xyXG4iLCJpbXBvcnQgeyByZWxlYXNlVHlwZSB9IGZyb20gXCIuLi9jb25maWdcIjtcclxuXHJcbmNvbnN0IGdlbmVyaWNTdHlsZSA9IFwiZm9udC13ZWlnaHQ6IDgwMDsgcGFkZGluZzogMnB4IDVweDsgY29sb3I6IHdoaXRlO1wiLFxyXG5cdGRlYnVnZ2luZyA9IHJlbGVhc2VUeXBlICE9PSBcIlJFTEVBU0VcIjtcclxubGV0IGxhc3RGaWxlOiBzdHJpbmc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5mbyhmaWxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgZm9yY2UgPSBmYWxzZSkge1xyXG5cdGlmICghZGVidWdnaW5nICYmICFmb3JjZSkgcmV0dXJuO1xyXG5cclxuXHQvLyogR3JvdXAgYnkgZmlsZVxyXG5cdGdyb3VwRmlsZShmaWxlKTtcclxuXHRjb25zb2xlLmxvZyhcclxuXHRcdFwiJWNQcmVNaUQlY0lORk8lYyBcIiArIG1lc3NhZ2UsXHJcblx0XHRnZW5lcmljU3R5bGUgKyBcImJvcmRlci1yYWRpdXM6IDI1cHggMCAwIDI1cHg7IGJhY2tncm91bmQ6ICM1OTZjYWU7XCIsXHJcblx0XHRnZW5lcmljU3R5bGUgKyBcImJvcmRlci1yYWRpdXM6IDAgMjVweCAyNXB4IDA7IGJhY2tncm91bmQ6ICM1MDUwZmY7XCIsXHJcblx0XHRcImNvbG9yOiB1bnNldDtcIlxyXG5cdCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzdWNjZXNzKGZpbGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBmb3JjZSA9IGZhbHNlKSB7XHJcblx0aWYgKCFkZWJ1Z2dpbmcgJiYgIWZvcmNlKSByZXR1cm47XHJcblxyXG5cdC8vKiBHcm91cCBieSBmaWxlXHJcblx0Z3JvdXBGaWxlKGZpbGUpO1xyXG5cdGNvbnNvbGUubG9nKFxyXG5cdFx0XCIlY1ByZU1pRCVjU1VDQ0VTUyVjIFwiICsgbWVzc2FnZSxcclxuXHRcdGdlbmVyaWNTdHlsZSArIFwiYm9yZGVyLXJhZGl1czogMjVweCAwIDAgMjVweDsgYmFja2dyb3VuZDogIzU5NmNhZTtcIixcclxuXHRcdGdlbmVyaWNTdHlsZSArXHJcblx0XHRcdFwiYm9yZGVyLXJhZGl1czogMCAyNXB4IDI1cHggMDsgYmFja2dyb3VuZDogIzUwZmY1MDsgY29sb3I6IGJsYWNrO1wiLFxyXG5cdFx0XCJjb2xvcjogdW5zZXQ7XCJcclxuXHQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXJyb3IoZmlsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIGZvcmNlID0gZmFsc2UpIHtcclxuXHRpZiAoIWRlYnVnZ2luZyAmJiAhZm9yY2UpIHJldHVybjtcclxuXHJcblx0Ly8qIEdyb3VwIGJ5IGZpbGVcclxuXHRncm91cEZpbGUoZmlsZSk7XHJcblx0Y29uc29sZS5sb2coXHJcblx0XHRcIiVjUHJlTWlEJWNFUlJPUiVjIFwiICsgbWVzc2FnZSxcclxuXHRcdGdlbmVyaWNTdHlsZSArIFwiYm9yZGVyLXJhZGl1czogMjVweCAwIDAgMjVweDsgYmFja2dyb3VuZDogIzU5NmNhZTtcIixcclxuXHRcdGdlbmVyaWNTdHlsZSArIFwiYm9yZGVyLXJhZGl1czogMCAyNXB4IDI1cHggMDsgYmFja2dyb3VuZDogI2ZmNTA1MDtcIixcclxuXHRcdFwiY29sb3I6IHVuc2V0O1wiXHJcblx0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ3JvdXBGaWxlKGZpbGU6IHN0cmluZykge1xyXG5cdGlmIChsYXN0RmlsZSAhPT0gZmlsZSkge1xyXG5cdFx0Y29uc29sZS5ncm91cEVuZCgpO1xyXG5cdFx0Y29uc29sZS5ncm91cChmaWxlKTtcclxuXHRcdGxhc3RGaWxlID0gZmlsZTtcclxuXHR9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2xlYW5PYmplY3Qob2JqOiBvYmplY3QpOiB2b2lkIHtcclxuXHRmb3IgKGNvbnN0IHByb3BOYW1lIGluIG9iaikge1xyXG5cdFx0aWYgKHR5cGVvZiBvYmpbcHJvcE5hbWVdID09IFwib2JqZWN0XCIpIHtcclxuXHRcdFx0Y2xlYW5PYmplY3Qob2JqW3Byb3BOYW1lXSk7XHJcblx0XHR9XHJcblx0XHRpZiAob2JqW3Byb3BOYW1lXSA9PT0gbnVsbCB8fCBvYmpbcHJvcE5hbWVdID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0ZGVsZXRlIG9ialtwcm9wTmFtZV07XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCBheGlvcyBmcm9tIFwiYXhpb3NcIjtcclxuXHJcbmltcG9ydCB7IGFwaUJhc2UgfSBmcm9tIFwiLi4vLi4vY29uZmlnXCI7XHJcbmltcG9ydCBjbGVhbk9iamVjdCBmcm9tIFwiLi9jbGVhbk9iamVjdFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gZ3JhcGhxbFJlcXVlc3QocXVlcnk6IHN0cmluZykge1xyXG5cdGNvbnN0IHJlcyA9IGF3YWl0IGF4aW9zKHtcclxuXHRcdHVybDogYXBpQmFzZSxcclxuXHRcdG1ldGhvZDogXCJwb3N0XCIsXHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdHF1ZXJ5OiBxdWVyeVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGNsZWFuT2JqZWN0KHJlcy5kYXRhKTtcclxuXHJcblx0cmV0dXJuIHJlcy5kYXRhO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJlc2VuY2VNZXRhZGF0YShwcmVzZW5jZTogc3RyaW5nKSB7XHJcblx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgZ3JhcGhxbFJlcXVlc3QoYFxyXG4gICAgcXVlcnkge1xyXG4gICAgICBwcmVzZW5jZXMoc2VydmljZTogXCIke3ByZXNlbmNlfVwiKSB7XHJcbiAgICAgICAgdXJsXHJcbiAgICAgICAgbWV0YWRhdGEge1xyXG4gICAgICAgICAgYXV0aG9yIHtcclxuICAgICAgICAgICAgaWRcclxuICAgICAgICAgICAgbmFtZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29udHJpYnV0b3JzIHtcclxuICAgICAgICAgICAgaWRcclxuICAgICAgICAgICAgbmFtZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYWx0bmFtZXNcclxuICAgICAgICAgIHdhcm5pbmdcclxuICAgICAgICAgIHJlYWRMb2dzXHJcbiAgICAgICAgICBidXR0b25cclxuICAgICAgICAgIHNlcnZpY2VcclxuICAgICAgICAgIGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICB1cmxcclxuICAgICAgICAgIHZlcnNpb25cclxuICAgICAgICAgIGxvZ29cclxuICAgICAgICAgIHRodW1ibmFpbFxyXG4gICAgICAgICAgY29sb3JcclxuICAgICAgICAgIHRhZ3NcclxuICAgICAgICAgIGNhdGVnb3J5XHJcbiAgICAgICAgICBpZnJhbWVcclxuICAgICAgICAgIHJlZ0V4cFxyXG4gICAgICAgICAgaWZyYW1lUmVnRXhwXHJcbiAgICAgICAgICBzZXR0aW5ncyB7XHJcbiAgICAgICAgICAgIGlkXHJcbiAgICAgICAgICAgIHRpdGxlXHJcbiAgICAgICAgICAgIGljb25cclxuICAgICAgICAgICAgaWYge1xyXG4gICAgICAgICAgICAgIHByb3ByZXR5TmFtZXNcclxuICAgICAgICAgICAgICBwYXR0ZXJuUHJvcHJ0aWVzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGxhY2Vob2xkZXJcclxuICAgICAgICAgICAgdmFsdWVcclxuICAgICAgICAgICAgdmFsdWVzXHJcbiAgICAgICAgICAgIG11bHRpTGFuZ3VhZ2VcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1gKTtcclxuXHRjbGVhbk9iamVjdChyZXN1bHQuZGF0YSk7XHJcblx0Y29uc3QgZmluYWwgPSB7XHJcblx0XHRkYXRhOiB7XHJcblx0XHRcdG5hbWU6IHJlc3VsdC5kYXRhLnByZXNlbmNlc1swXS5tZXRhZGF0YS5zZXJ2aWNlLFxyXG5cdFx0XHR1cmw6IHJlc3VsdC5kYXRhLnByZXNlbmNlc1swXS51cmwsXHJcblx0XHRcdG1ldGFkYXRhOiByZXN1bHQuZGF0YS5wcmVzZW5jZXNbMF0ubWV0YWRhdGFcclxuXHRcdH1cclxuXHR9O1xyXG5cdHJldHVybiBmaW5hbDtcclxufVxyXG4iLCJpbXBvcnQgeyBlcnJvciwgc3VjY2VzcyB9IGZyb20gXCIuL2RlYnVnXCI7XHJcblxyXG5pbXBvcnQgeyBnZXRTdG9yYWdlIH0gZnJvbSBcIi4vZnVuY3Rpb25zL2FzeW5jU3RvcmFnZVwiO1xyXG5pbXBvcnQgZ3JhcGhxbFJlcXVlc3QgZnJvbSBcIi4vZnVuY3Rpb25zL2dyYXBocWxcIjtcclxuXHJcbi8qKlxyXG4gKiBEZWZhdWx0IGxhbmd1YWdlIGNvZGVcclxuICovXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX0xPQ0FMRSA9IFwiZW5cIjtcclxuXHJcbi8qKlxyXG4gKiBNaW5pbXVtIHRpbWUgYmV0d2VlbiBzdHJpbmdzIHVwZGF0ZVxyXG4gKi9cclxuY29uc3QgTUlOX1VQREFURV9USU1FID0gMTAwMCAqIDYwICogNTtcclxuXHJcbmxldCBsYW5ndWFnZXM6IG9iamVjdCA9IHt9O1xyXG5cclxuZnVuY3Rpb24gbm9ybWFsaXplTGFuZ3VhZ2VDb2RlKGxhbmd1YWdlQ29kZTogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRyZXR1cm4gbGFuZ3VhZ2VDb2RlLnNwbGl0KFwiLVwiKVswXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBzdHJpbmdzIHZhbHVlcyAoZXh0ZW5zaW9uIGFuZCBwcmVzZW5jZSBlbmRwb2ludHMpIGZyb20gdGhlIEFQSSB3ZWJzaXRlXHJcbiAqXHJcbiAqIEBwYXJhbSBsYW5ndWFnZUNvZGUgbGFuZ3VhZ2UgY29kZSBmb2xsb3dpbmcgSVNPNjM5LTEgc3BlY1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN0cmluZ3MobGFuZ3VhZ2VDb2RlPzogc3RyaW5nKSB7XHJcblx0aWYgKCFsYW5ndWFnZUNvZGUpIGxhbmd1YWdlQ29kZSA9IERFRkFVTFRfTE9DQUxFO1xyXG5cdGlmIChcclxuXHRcdCFsYW5ndWFnZUNvZGUuaW5jbHVkZXMoXCJqYVwiKSAmJlxyXG5cdFx0IWxhbmd1YWdlQ29kZS5pbmNsdWRlcyhcInpoXCIpICYmXHJcblx0XHQhbGFuZ3VhZ2VDb2RlLmluY2x1ZGVzKFwia29cIilcclxuXHQpXHJcblx0XHRsYW5ndWFnZUNvZGUgPSBub3JtYWxpemVMYW5ndWFnZUNvZGUobGFuZ3VhZ2VDb2RlKTtcclxuXHJcblx0bGV0IHdlYnNpdGVMYW5ndWFnZTogc3RyaW5nID0gbGFuZ3VhZ2VDb2RlLFxyXG5cdFx0ZXh0ZW5zaW9uTGFuZ3VhZ2U6IHN0cmluZyA9IGxhbmd1YWdlQ29kZSxcclxuXHRcdHByZXNlbmNlTGFuZ3VhZ2U6IHN0cmluZyA9IGxhbmd1YWdlQ29kZTtcclxuXHJcblx0c3dpdGNoIChsYW5ndWFnZUNvZGUpIHtcclxuXHRcdGNhc2UgXCJqYVwiOlxyXG5cdFx0XHR3ZWJzaXRlTGFuZ3VhZ2UgPSBcImphX0pQXCI7XHJcblx0XHRcdHByZXNlbmNlTGFuZ3VhZ2UgPSBcImphX0pQXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImphX0pQXCI6XHJcblx0XHRcdGV4dGVuc2lvbkxhbmd1YWdlID0gXCJqYVwiO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJrb1wiOlxyXG5cdFx0XHR3ZWJzaXRlTGFuZ3VhZ2UgPSBcImtvX0tSXCI7XHJcblx0XHRcdHByZXNlbmNlTGFuZ3VhZ2UgPSBcImtvX0tSXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImtvX0tSXCI6XHJcblx0XHRcdGV4dGVuc2lvbkxhbmd1YWdlID0gXCJrb1wiO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJ6aC1DTlwiOlxyXG5cdFx0XHR3ZWJzaXRlTGFuZ3VhZ2UgPSBcInpoX0NOXCI7XHJcblx0XHRcdHByZXNlbmNlTGFuZ3VhZ2UgPSBcInpoX0NOXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInpoX0NOXCI6XHJcblx0XHRcdGV4dGVuc2lvbkxhbmd1YWdlID0gXCJ6aC1DTlwiO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJ6aC1UV1wiOlxyXG5cdFx0XHR3ZWJzaXRlTGFuZ3VhZ2UgPSBcInpoX1RXXCI7XHJcblx0XHRcdHByZXNlbmNlTGFuZ3VhZ2UgPSBcInpoX1RXXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInpoX1RXXCI6XHJcblx0XHRcdGV4dGVuc2lvbkxhbmd1YWdlID0gXCJ6aC1UV1wiO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGRlZmF1bHQ6XHJcblx0XHRcdGNvbnN0IHJlc3BvbnNlTGFuZ3MgPSBhd2FpdCBncmFwaHFsUmVxdWVzdChgXHJcblx0XHRcdHF1ZXJ5IHtcclxuXHRcdFx0XHRsYW5nRmlsZXMocHJvamVjdDogXCJleHRlbnNpb25cIikge1xyXG5cdFx0XHRcdFx0bGFuZ1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRgKSxcclxuXHRcdFx0XHRhdmFpbGFibGVMYW5nczogc3RyaW5nW10gPSByZXNwb25zZUxhbmdzLmRhdGEubGFuZ0ZpbGVzLm1hcChcclxuXHRcdFx0XHRcdGxmID0+IGxmLmxhbmdcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0aWYgKCFhdmFpbGFibGVMYW5ncy5pbmNsdWRlcyhleHRlbnNpb25MYW5ndWFnZSkpIHtcclxuXHRcdFx0XHRjb25zdCBpbmRleCA9IGF2YWlsYWJsZUxhbmdzLmZpbmRJbmRleChjID0+XHJcblx0XHRcdFx0XHRjLmluY2x1ZGVzKGV4dGVuc2lvbkxhbmd1YWdlICsgXCJfXCIpXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0XHRpZiAoaW5kZXggPj0gMCkge1xyXG5cdFx0XHRcdFx0d2Vic2l0ZUxhbmd1YWdlID0gYXZhaWxhYmxlTGFuZ3NbaW5kZXhdO1xyXG5cdFx0XHRcdFx0ZXh0ZW5zaW9uTGFuZ3VhZ2UgPSBhdmFpbGFibGVMYW5nc1tpbmRleF07XHJcblx0XHRcdFx0XHRwcmVzZW5jZUxhbmd1YWdlID0gYXZhaWxhYmxlTGFuZ3NbaW5kZXhdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcblxyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBncmFwaHFsUmVzdWx0ID0gYXdhaXQgZ3JhcGhxbFJlcXVlc3QoYFxyXG5cdFx0XHRxdWVyeSB7XHJcblx0XHRcdFx0d2Vic2l0ZTogbGFuZ0ZpbGVzKHByb2plY3Q6IFwid2Vic2l0ZVwiLCBsYW5nOiBcIiR7d2Vic2l0ZUxhbmd1YWdlfVwiKSB7XHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnNcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZXh0ZW5zaW9uOiBsYW5nRmlsZXMocHJvamVjdDogXCJleHRlbnNpb25cIiwgbGFuZzogXCIke2V4dGVuc2lvbkxhbmd1YWdlfVwiKSB7XHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnNcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cHJlc2VuY2U6IGxhbmdGaWxlcyhwcm9qZWN0OiBcInByZXNlbmNlXCIsIGxhbmc6IFwiJHtwcmVzZW5jZUxhbmd1YWdlfVwiKSB7XHJcblx0XHRcdFx0XHR0cmFuc2xhdGlvbnNcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdGApO1xyXG5cclxuXHRcdGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdID0ge1xyXG5cdFx0XHRuYW1lOiBncmFwaHFsUmVzdWx0LmRhdGEud2Vic2l0ZVswXS50cmFuc2xhdGlvbnNbXCJoZWFkZXIubGFuZ3VhZ2VcIl0sXHJcblx0XHRcdGxvYWRpbmc6XHJcblx0XHRcdFx0Z3JhcGhxbFJlc3VsdC5kYXRhLndlYnNpdGVbMF0udHJhbnNsYXRpb25zW1wiaGVhZGVyLmxvYWRlci5waHJhc2VzXCJdLFxyXG5cdFx0XHRleHRlbnNpb246IGdyYXBocWxSZXN1bHQuZGF0YS5leHRlbnNpb25bMF0udHJhbnNsYXRpb25zLFxyXG5cdFx0XHRwcmVzZW5jZTogZ3JhcGhxbFJlc3VsdC5kYXRhLnByZXNlbmNlWzBdLnRyYW5zbGF0aW9ucyxcclxuXHRcdFx0dXBkYXRlZEF0OiBEYXRlLm5vdygpXHJcblx0XHR9O1xyXG5cclxuXHRcdHN1Y2Nlc3MoXCJsYW5nTWFuYWdlci50c1wiLCBgVXBkYXRlZCAke2xhbmd1YWdlQ29kZX0gdHJhbnNsYXRpb25zYCk7XHJcblx0fSBjYXRjaCAoZSkge1xyXG5cdFx0ZXJyb3IoXHJcblx0XHRcdFwibGFuZ01hbmFnZXIudHNcIixcclxuXHRcdFx0YEVycm9yIHdoaWxlIGZldGNoaW5nIGxhbmdGaWxlcyBvZiAke2xhbmd1YWdlQ29kZX0gbGFuZ3VhZ2U6ICR7ZS5tZXNzYWdlfWBcclxuXHRcdCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRpZiAobGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gJiYgbGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0uZXJyb3IpIHtcclxuXHRcdGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdID0gdW5kZWZpbmVkO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0YXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgbGFuZ3VhZ2VzIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQWxsU3RyaW5ncygpIHtcclxuXHRjb25zdCBsYW5ndWFnZXMgPSBPYmplY3Qua2V5cygoYXdhaXQgZ2V0U3RvcmFnZShcImxvY2FsXCIsIFwibGFuZ3VhZ2VzXCIpKS5sYW5ndWFnZXMpO1xyXG5cdGF3YWl0IFByb21pc2UuYWxsKFxyXG5cdFx0bGFuZ3VhZ2VzLm1hcChsbmcgPT4gbG9hZFN0cmluZ3MobG5nLCB0cnVlKSlcclxuXHQpO1xyXG59XHJcblxyXG4vKipcclxuICogU3RyaW5ncyB0aGF0IGFyZSBiZWluZyBsb2FkZWQgYnkgbG9hZFN0cmluZ3MgZnVuY3Rpb25cclxuICovXHJcbmNvbnN0IGxvYWRpbmdMYW5ncyA9IFtdO1xyXG5cclxuLyoqXHJcbiAqIExvYWQgdGhlIHN0cmluZ3MgZnJvbSB0aGUgYnJvd3NlciBsb2NhbCBzdG9yYWdlLCBpZiB0aGV5IGFyZSBub3QgZm91bmQgaW4gdGhlIHN0b3JhZ2UgdGhleSB3aWxsIGJlXHJcbiAqIGZldGNoIGZyb20gdGhlIEFQSS5cclxuICpcclxuICogQHBhcmFtIGxhbmd1YWdlQ29kZSBsYW5ndWFnZSBjb2RlIElTTzYzOS0xIGlmIG5vdCBzcGVjaWZpZWQgREVGQVVMVF9MT0NBTEUgaXMgdXNlZFxyXG4gKiBAcGFyYW0gdXBkYXRlIGJvb2xlYW4gdG8gZm9yY2UgYW4gdXBkYXRlIG9mIHRoZSBzdHJpbmdzIGluIHRoZSBnaXZlbiBsb2NhbGVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkU3RyaW5ncyhsYW5ndWFnZUNvZGU/OiBzdHJpbmcsIHVwZGF0ZT86IGJvb2xlYW4pIHtcclxuXHRpZiAoIWxhbmd1YWdlQ29kZSkgbGFuZ3VhZ2VDb2RlID0gREVGQVVMVF9MT0NBTEU7XHJcblx0aWYgKCF1cGRhdGUpIHVwZGF0ZSA9IGZhbHNlO1xyXG5cdGxhbmd1YWdlQ29kZSA9IG5vcm1hbGl6ZUxhbmd1YWdlQ29kZShsYW5ndWFnZUNvZGUpO1xyXG5cclxuXHRyZXR1cm4gbmV3IFByb21pc2U8dm9pZD4ocmVzb2x2ZSA9PiB7XHJcblx0XHRpZiAodHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdICE9PSBcInVuZGVmaW5lZFwiKSByZXNvbHZlKCk7XHJcblxyXG5cdFx0aWYgKCFsb2FkaW5nTGFuZ3MuaW5jbHVkZXMobGFuZ3VhZ2VDb2RlKSkge1xyXG5cdFx0XHRsb2FkaW5nTGFuZ3MucHVzaChsYW5ndWFnZUNvZGUpO1xyXG5cclxuXHRcdFx0Y2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFwibGFuZ3VhZ2VzXCIsIGFzeW5jIGxuZ3MgPT4ge1xyXG5cdFx0XHRcdGlmICghbG5ncy5sYW5ndWFnZXMpIHtcclxuXHRcdFx0XHRcdGxuZ3MubGFuZ3VhZ2VzID0ge307XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCB1cGRhdGVQcm9taXNlcyA9IFtdO1xyXG5cdFx0XHRcdGlmIChcclxuXHRcdFx0XHRcdChcclxuXHRcdFx0XHRcdFx0dXBkYXRlICYmXHJcblx0XHRcdFx0XHRcdHR5cGVvZiBsbmdzLmxhbmd1YWdlc1tERUZBVUxUX0xPQ0FMRV0gIT09IFwidW5kZWZpbmVkXCIgJiZcclxuXHRcdFx0XHRcdFx0RGF0ZS5ub3coKSAtIGxuZ3MubGFuZ3VhZ2VzW0RFRkFVTFRfTE9DQUxFXS51cGRhdGVkQXQgPj0gTUlOX1VQREFURV9USU1FXHJcblx0XHRcdFx0XHQpIHx8XHJcblx0XHRcdFx0XHQoXHJcblx0XHRcdFx0XHRcdGxhbmd1YWdlQ29kZSAhPT0gREVGQVVMVF9MT0NBTEUgJiZcclxuXHRcdFx0XHRcdFx0dHlwZW9mIGxuZ3MubGFuZ3VhZ2VzW0RFRkFVTFRfTE9DQUxFXSA9PT0gXCJ1bmRlZmluZWRcIlxyXG5cdFx0XHRcdFx0KVxyXG5cdFx0XHRcdCkge1xyXG5cdFx0XHRcdFx0dXBkYXRlUHJvbWlzZXMucHVzaCh1cGRhdGVTdHJpbmdzKERFRkFVTFRfTE9DQUxFKSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoXHJcblx0XHRcdFx0XHR0eXBlb2YgbG5ncy5sYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXSA9PT0gXCJ1bmRlZmluZWRcIiB8fFxyXG5cdFx0XHRcdFx0KFxyXG5cdFx0XHRcdFx0XHR1cGRhdGUgJiZcclxuXHRcdFx0XHRcdFx0Ly8gYWxyZWFkeSBjaGVja2VkIGlmIGxuZ3MubGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gaXMgdW5kZWZpbmVkXHJcblx0XHRcdFx0XHRcdERhdGUubm93KCkgLSBsbmdzLmxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLnVwZGF0ZWRBdCA+PSBNSU5fVVBEQVRFX1RJTUVcclxuXHRcdFx0XHRcdClcclxuXHJcblx0XHRcdFx0KSB7XHJcblx0XHRcdFx0XHR1cGRhdGVQcm9taXNlcy5wdXNoKHVwZGF0ZVN0cmluZ3MobGFuZ3VhZ2VDb2RlKSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRhd2FpdCBQcm9taXNlLmFsbCh1cGRhdGVQcm9taXNlcyk7XHJcblxyXG5cdFx0XHRcdC8vIG1lcmdlIGFsbCBsYW5ndWFnZXNcclxuXHRcdFx0XHRsYW5ndWFnZXMgPSB7IC4uLmxhbmd1YWdlcywgLi4ubG5ncy5sYW5ndWFnZXMgfTtcclxuXHJcblx0XHRcdFx0bG9hZGluZ0xhbmdzLnNwbGljZShsb2FkaW5nTGFuZ3MuaW5kZXhPZihsYW5ndWFnZUNvZGUpLCAxKTtcclxuXHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0bGV0IGxvYWRTdGF0dXMgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdFx0aWYgKFxyXG5cdFx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlcyAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG5cdFx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdICE9PSBcInVuZGVmaW5lZFwiXHJcblx0XHRcdFx0KSB7XHJcblx0XHRcdFx0XHRjbGVhckludGVydmFsKGxvYWRTdGF0dXMpO1xyXG5cdFx0XHRcdFx0cmVzb2x2ZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgNSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYWxsIHRoZSB0cmFuc2xhdGlvbnMgaW4gdGhlIGdpdmVuIGxhbmd1YWdlIGFuZCBERUZBVUxUX0xPQ0FMRVxyXG4gKlxyXG4gKiBAcGFyYW0gbGFuZ3VhZ2VDb2RlIGxhbmd1YWdlIGNvZGUgSVNPNjM5LTEgaWYgbm90IHNwZWNpZmllZCBERUZBVUxUX0xPQ0FMRSBpcyB1c2VkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RyaW5ncyhsYW5ndWFnZUNvZGU/OiBzdHJpbmcpIHtcclxuXHRpZiAoIWxhbmd1YWdlQ29kZSkgbGFuZ3VhZ2VDb2RlID0gREVGQVVMVF9MT0NBTEU7XHJcblx0bGFuZ3VhZ2VDb2RlID0gbm9ybWFsaXplTGFuZ3VhZ2VDb2RlKGxhbmd1YWdlQ29kZSk7XHJcblxyXG5cdHJldHVybiBuZXcgUHJvbWlzZShhc3luYyByZXNvbHZlID0+IHtcclxuXHRcdGF3YWl0IGxvYWRTdHJpbmdzKGxhbmd1YWdlQ29kZSk7XHJcblxyXG5cdFx0aWYgKHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXSA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0XHRpZiAoIWxhbmd1YWdlc1tERUZBVUxUX0xPQ0FMRV0pIHtcclxuXHRcdFx0XHRyZXNvbHZlKHt9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmVzb2x2ZSh7XHJcblx0XHRcdFx0W0RFRkFVTFRfTE9DQUxFXToge1xyXG5cdFx0XHRcdFx0Li4ubGFuZ3VhZ2VzW0RFRkFVTFRfTE9DQUxFXS5leHRlbnNpb24sXHJcblx0XHRcdFx0XHQuLi5sYW5ndWFnZXNbREVGQVVMVF9MT0NBTEVdLnByZXNlbmNlXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJlc29sdmUoe1xyXG5cdFx0XHRcdFtsYW5ndWFnZUNvZGVdOiB7XHJcblx0XHRcdFx0XHQuLi5sYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5leHRlbnNpb24sXHJcblx0XHRcdFx0XHQuLi5sYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5wcmVzZW5jZVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0W0RFRkFVTFRfTE9DQUxFXToge1xyXG5cdFx0XHRcdFx0Li4ubGFuZ3VhZ2VzW0RFRkFVTFRfTE9DQUxFXS5leHRlbnNpb24sXHJcblx0XHRcdFx0XHQuLi5sYW5ndWFnZXNbREVGQVVMVF9MT0NBTEVdLnByZXNlbmNlXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCB0cmFuc2xhdGlvbiBvZiBhIHNwZWNpZmljIGtleVxyXG4gKlxyXG4gKiBAcGFyYW0gc3RyaW5nIG5hbWUgb2YgdGhlIHN0cmluZywgdG8gZ2V0IHRoZSBuYW1lIG9mIHRoZSBsYW5ndWFnZSB1c2UgXCJuYW1lXCIgb3IgXCJoZWFkZXIubGFuZ3VhZ2VcIlxyXG4gKiBAcGFyYW0gbGFuZ3VhZ2VDb2RlIGxhbmd1YWdlIGNvZGUgSVNPNjM5LTEgaWYgbm90IHNwZWNpZmllZCBERUZBVUxUX0xPQ0FMRSBpcyB1c2VkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RyaW5nKHN0cmluZzogc3RyaW5nLCBsYW5ndWFnZUNvZGU/OiBzdHJpbmcpIHtcclxuXHRpZiAoIWxhbmd1YWdlQ29kZSkgbGFuZ3VhZ2VDb2RlID0gY2hyb21lLmkxOG4uZ2V0VUlMYW5ndWFnZSgpO1xyXG5cdGxhbmd1YWdlQ29kZSA9IG5vcm1hbGl6ZUxhbmd1YWdlQ29kZShsYW5ndWFnZUNvZGUpO1xyXG5cclxuXHRyZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgcmVzb2x2ZSA9PiB7XHJcblx0XHRhd2FpdCBsb2FkU3RyaW5ncyhsYW5ndWFnZUNvZGUpO1xyXG5cclxuXHRcdGlmICh0eXBlb2YgbGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gIT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdFx0aWYgKFxyXG5cdFx0XHRcdFtcIm5hbWVcIiwgXCJoZWFkZXIubGFuZ3VhZ2VcIl0uaW5jbHVkZXMoc3RyaW5nKSAmJlxyXG5cdFx0XHRcdHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5uYW1lICE9PSBcInVuZGVmaW5lZFwiXHJcblx0XHRcdCkge1xyXG5cdFx0XHRcdHJldHVybiByZXNvbHZlKGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLm5hbWUpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKFxyXG5cdFx0XHRcdFtcImxvYWRpbmdcIiwgXCJoZWFkZXIubG9hZGVyLnBocmFzZXNcIl0uaW5jbHVkZXMoc3RyaW5nKSAmJlxyXG5cdFx0XHRcdHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5sb2FkaW5nICE9PSBcInVuZGVmaW5lZFwiXHJcblx0XHRcdCkge1xyXG5cdFx0XHRcdHJldHVybiByZXNvbHZlKGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLmxvYWRpbmcpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKFxyXG5cdFx0XHRcdHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5leHRlbnNpb24gIT09IFwidW5kZWZpbmVkXCIgJiZcclxuXHRcdFx0XHR0eXBlb2YgbGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0uZXh0ZW5zaW9uW3N0cmluZ10gIT09IFwidW5kZWZpbmVkXCJcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0cmV0dXJuIHJlc29sdmUobGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0uZXh0ZW5zaW9uW3N0cmluZ10pO1xyXG5cdFx0XHR9IGVsc2UgaWYgKFxyXG5cdFx0XHRcdHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5wcmVzZW5jZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG5cdFx0XHRcdHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5wcmVzZW5jZVtzdHJpbmddICE9PSBcInVuZGVmaW5lZFwiXHJcblx0XHRcdCkge1xyXG5cdFx0XHRcdHJldHVybiByZXNvbHZlKGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLnByZXNlbmNlW3N0cmluZ10pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gcHJldmVudCBpbmZpbml0ZSBsb29wc1xyXG5cdFx0aWYgKGxhbmd1YWdlQ29kZSA9PT0gREVGQVVMVF9MT0NBTEUpIHtcclxuXHRcdFx0cmV0dXJuIHJlc29sdmUoc3RyaW5nKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gcmVzb2x2ZShhd2FpdCBnZXRTdHJpbmcoc3RyaW5nLCBERUZBVUxUX0xPQ0FMRSkpO1xyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0YWluIGFsbCBsYW5ndWFnZXMgdGhhdCBhcmUgMTAwJSB0cmFuc2xhdGVkIGZvciBhIHByZXNlbmNlIGFuZCB0aGF0IGFsc28gaGF2ZSB0aGUgZ2VuZXJhbCBmaWxlIDEwMCUgdHJhbnNsYXRlZFxyXG4gKlxyXG4gKiBAcGFyYW0gcHJlc2VuY2VOYW1lIG5hbWUgb2YgdGhlIHByZXNlbmNlIGFzIHNwZWNpZmllZCBpbiB0aGUgXCJzZXJ2aWNlXCIga2V5IG9mIHRoZSBtZXRhZGF0YS5qc29uIGZpbGVcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcmVzZW5jZUxhbmd1YWdlcyhwcmVzZW5jZU5hbWU6IHN0cmluZykge1xyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBsYW5ncyA9IGF3YWl0IGdyYXBocWxSZXF1ZXN0KGBcclxuXHRcdFx0cXVlcnkge1xyXG5cdFx0XHRcdGxhbmdGaWxlcyhwcmVzZW5jZTogXCIke3ByZXNlbmNlTmFtZS50b0xvd2VyQ2FzZSgpfVwiKSB7XHJcblx0XHRcdFx0XHRsYW5nXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGdlbmVyYWxMYW5nRmlsZXM6IGxhbmdGaWxlcyhwcmVzZW5jZTogXCJnZW5lcmFsXCIpIHtcclxuXHRcdFx0XHRcdGxhbmdcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdGApO1xyXG5cclxuXHRcdGNvbnN0IGZpbmFsQXJyYXkgPSBbXTtcclxuXHRcdGlmIChcclxuXHRcdFx0bGFuZ3MuZGF0YS5sYW5nRmlsZXMubGVuZ3RoID4gMCAmJlxyXG5cdFx0XHRsYW5ncy5kYXRhLmdlbmVyYWxMYW5nRmlsZXMubGVuZ3RoID4gMFxyXG5cdFx0KSB7XHJcblx0XHRcdGxhbmdzLmRhdGEuZ2VuZXJhbExhbmdGaWxlcy5mb3JFYWNoKGxhbmcgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGZvdW5kID0gbGFuZ3MuZGF0YS5sYW5nRmlsZXMuZmluZChwID0+IHAubGFuZyA9PT0gbGFuZy5sYW5nKTtcclxuXHRcdFx0XHRpZiAoZm91bmQpIGZpbmFsQXJyYXkucHVzaChsYW5nLmxhbmcpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSBpZiAobGFuZ3MuZGF0YS5nZW5lcmFsTGFuZ0ZpbGVzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0bGFuZ3MuZGF0YS5nZW5lcmFsTGFuZ0ZpbGVzLmZvckVhY2gobGFuZyA9PiB7XHJcblx0XHRcdFx0ZmluYWxBcnJheS5wdXNoKGxhbmcubGFuZyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZpbmFsQXJyYXk7XHJcblx0fSBjYXRjaCAoZSkge1xyXG5cdFx0cmV0dXJuIFtdO1xyXG5cdH1cclxufVxyXG4iLCJpbXBvcnQgQXhpb3MgZnJvbSBcImF4aW9zXCI7XHJcblxyXG5pbXBvcnQgeyBhcGlCYXNlIGFzIGFwaWJhc2UgfSBmcm9tIFwiLi9jb25maWdcIjtcclxuaW1wb3J0IHsgZ2V0U3RvcmFnZSBhcyBnZXRzdG9yYWdlIH0gZnJvbSBcIi4vdXRpbC9mdW5jdGlvbnMvYXN5bmNTdG9yYWdlXCI7XHJcbmltcG9ydCB7IGdldFN0cmluZyBhcyBnZXRzdHJpbmcsIGdldFN0cmluZ3MgYXMgZ2V0c3RyaW5ncyB9IGZyb20gXCIuL3V0aWwvbGFuZ01hbmFnZXJcIjtcclxuXHJcbmV4cG9ydCBsZXQgZ2V0U3RyaW5nID0gZ2V0c3RyaW5nO1xyXG5leHBvcnQgbGV0IGdldFN0cmluZ3MgPSBnZXRzdHJpbmdzO1xyXG5leHBvcnQgbGV0IGdldFN0b3JhZ2UgPSBnZXRzdG9yYWdlO1xyXG5leHBvcnQgbGV0IGF4aW9zID0gQXhpb3M7XHJcbmV4cG9ydCBsZXQgYXBpQmFzZSA9IGFwaWJhc2U7XHJcbiIsImV4cG9ydCBmdW5jdGlvbiBnZXRTdG9yYWdlKFxyXG5cdHR5cGU6IFwibG9jYWxcIiB8IFwic3luY1wiLFxyXG5cdG5hbWU6IHN0cmluZyB8IEFycmF5PHN0cmluZz5cclxuKSB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlPGFueT4ocmVzb2x2ZSA9PlxyXG5cdFx0Y2hyb21lLnN0b3JhZ2VbdHlwZV0uZ2V0KG5hbWUsIGl0ZW1zID0+IHJlc29sdmUoaXRlbXMpKVxyXG5cdCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRTdG9yYWdlKFxyXG5cdHR5cGU6IFwibG9jYWxcIiB8IFwic3luY1wiLFxyXG5cdGl0ZW1zOiBPYmplY3RcclxuKSB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KHJlc29sdmUgPT5cclxuXHRcdGNocm9tZS5zdG9yYWdlW3R5cGVdLnNldChpdGVtcywgcmVzb2x2ZSlcclxuXHQpO1xyXG59XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIG1vZHVsZSBleHBvcnRzIG11c3QgYmUgcmV0dXJuZWQgZnJvbSBydW50aW1lIHNvIGVudHJ5IGlubGluaW5nIGlzIGRpc2FibGVkXG4vLyBydW4gc3RhcnR1cFxucmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18ueCgpO1xuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gbW9kdWxlWydkZWZhdWx0J10gOlxuXHRcdCgpID0+IG1vZHVsZTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFByb21pc2UgPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQ1OTE6IDBcbn07XG5cbnZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXG5cdFs4OTcsOTk5XVxuXTtcbi8vIG5vIGNodW5rIG9uIGRlbWFuZCBsb2FkaW5nXG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbnZhciBjaGVja0RlZmVycmVkTW9kdWxlcyA9ICgpID0+IHtcblxufTtcbmZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzSW1wbCgpIHtcblx0dmFyIHJlc3VsdDtcblx0Zm9yKHZhciBpID0gMDsgaSA8IGRlZmVycmVkTW9kdWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBkZWZlcnJlZE1vZHVsZSA9IGRlZmVycmVkTW9kdWxlc1tpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IodmFyIGogPSAxOyBqIDwgZGVmZXJyZWRNb2R1bGUubGVuZ3RoOyBqKyspIHtcblx0XHRcdHZhciBkZXBJZCA9IGRlZmVycmVkTW9kdWxlW2pdO1xuXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2RlcElkXSAhPT0gMCkgZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0fVxuXHRcdGlmKGZ1bGZpbGxlZCkge1xuXHRcdFx0ZGVmZXJyZWRNb2R1bGVzLnNwbGljZShpLS0sIDEpO1xuXHRcdFx0cmVzdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBkZWZlcnJlZE1vZHVsZVswXSk7XG5cdFx0fVxuXHR9XG5cdGlmKGRlZmVycmVkTW9kdWxlcy5sZW5ndGggPT09IDApIHtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLngoKTtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnggPSAoKSA9PiB7XG5cblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn1cbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0Ly8gcmVzZXQgc3RhcnR1cCBmdW5jdGlvbiBzbyBpdCBjYW4gYmUgY2FsbGVkIGFnYWluIHdoZW4gbW9yZSBzdGFydHVwIGNvZGUgaXMgYWRkZWRcblx0X193ZWJwYWNrX3JlcXVpcmVfXy54ID0gKCkgPT4ge1xuXG5cdH1cblx0Y2h1bmtMb2FkaW5nR2xvYmFsID0gY2h1bmtMb2FkaW5nR2xvYmFsLnNsaWNlKCk7XG5cdGZvcih2YXIgaSA9IDA7IGkgPCBjaHVua0xvYWRpbmdHbG9iYWwubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGNodW5rTG9hZGluZ0dsb2JhbFtpXSk7XG5cdHJldHVybiAoY2hlY2tEZWZlcnJlZE1vZHVsZXMgPSBjaGVja0RlZmVycmVkTW9kdWxlc0ltcGwpKCk7XG59O1xuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IChkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lLCBleGVjdXRlTW9kdWxlc10gPSBkYXRhO1xuXHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcblx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG5cdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDAsIHJlc29sdmVzID0gW107XG5cdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdFx0cmVzb2x2ZXMucHVzaChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0pO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdH1cblx0fVxuXHRpZihydW50aW1lKSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHRwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG5cdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuXHR9XG5cblx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuXHRpZihleGVjdXRlTW9kdWxlcykgZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyk7XG5cblx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG5cdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3BtZFwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtwbWRcIl0gfHwgW107XG52YXIgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24gPSBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrOyJdLCJzb3VyY2VSb290IjoiIn0=