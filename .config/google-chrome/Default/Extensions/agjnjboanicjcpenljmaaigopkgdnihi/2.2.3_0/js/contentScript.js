var pmd;pmd=(()=>{"use strict";var e={4184:(e,t,n)=>{n.r(t);var a=n(8826);const r="font-weight: 800; padding: 2px 5px; color: white;";let o;function i(e,t,n=!1){n&&(c(e),console.log("%cPreMiD%cINFO%c "+t,r+"border-radius: 25px 0 0 25px; background: #596cae;",r+"border-radius: 0 25px 25px 0; background: #5050ff;","color: unset;"))}function s(e,t,n=!1){n&&(c(e),console.log("%cPreMiD%cERROR%c "+t,r+"border-radius: 25px 0 0 25px; background: #596cae;",r+"border-radius: 0 25px 25px 0; background: #ff5050;","color: unset;"))}function c(e){o!==e&&(console.groupEnd(),console.group(e),o=e)}function l(e){for(const t in e)"object"==typeof e[t]&&l(e[t]),null!==e[t]&&void 0!==e[t]||delete e[t]}var d=n(9669),u=n.n(d);async function g(e){const t=await u()({url:"https://api.premid.app/v3/",method:"post",data:{query:e}});return l(t.data),t.data}const p="en",f=3e5;let h={};function b(e){return e.split("-")[0]}async function w(e){e||(e=p),e.includes("ja")||e.includes("zh")||e.includes("ko")||(e=b(e));let t=e,n=e,a=e;switch(e){case"ja":t="ja_JP",a="ja_JP";break;case"ja_JP":n="ja";break;case"ko":t="ko_KR",a="ko_KR";break;case"ko_KR":n="ko";break;case"zh-CN":t="zh_CN",a="zh_CN";break;case"zh_CN":n="zh-CN";break;case"zh-TW":t="zh_TW",a="zh_TW";break;case"zh_TW":n="zh-TW";break;default:const e=(await g('\n\t\t\tquery {\n\t\t\t\tlangFiles(project: "extension") {\n\t\t\t\t\tlang\n\t\t\t\t}\n\t\t\t}\n\t\t\t')).data.langFiles.map((e=>e.lang));if(!e.includes(n)){const r=e.findIndex((e=>e.includes(n+"_")));r>=0&&(t=e[r],n=e[r],a=e[r])}}try{const o=await g(`\n\t\t\tquery {\n\t\t\t\twebsite: langFiles(project: "website", lang: "${t}") {\n\t\t\t\t\ttranslations\n\t\t\t\t}\n\t\t\t\textension: langFiles(project: "extension", lang: "${n}") {\n\t\t\t\t\ttranslations\n\t\t\t\t}\n\t\t\t\tpresence: langFiles(project: "presence", lang: "${a}") {\n\t\t\t\t\ttranslations\n\t\t\t\t}\n\t\t\t}\n\t\t`);h[e]={name:o.data.website[0].translations["header.language"],loading:o.data.website[0].translations["header.loader.phrases"],extension:o.data.extension[0].translations,presence:o.data.presence[0].translations,updatedAt:Date.now()},function(e,t,n=!1){n&&(c("langManager.ts"),console.log("%cPreMiD%cSUCCESS%c "+t,r+"border-radius: 25px 0 0 25px; background: #596cae;",r+"border-radius: 0 25px 25px 0; background: #50ff50; color: black;","color: unset;"))}(0,`Updated ${e} translations`)}catch(t){return void s("langManager.ts",`Error while fetching langFiles of ${e} language: ${t.message}`)}h[e]&&h[e].error?h[e]=void 0:await chrome.storage.local.set({languages:h})}const v=[];function m(e,t){return t||(t=chrome.i18n.getUILanguage()),t=b(t),new Promise((async n=>{if(await async function(e,t){return e||(e=p),t||(t=!1),e=b(e),new Promise((n=>{if(void 0!==h[e]&&n(),v.includes(e)){let t=setInterval((()=>{void 0!==h&&void 0!==h[e]&&(clearInterval(t),n())}),5)}else v.push(e),chrome.storage.local.get("languages",(async a=>{a.languages||(a.languages={});const r=[];(t&&void 0!==a.languages.en&&Date.now()-a.languages.en.updatedAt>=f||e!==p&&void 0===a.languages.en)&&r.push(w(p)),(void 0===a.languages[e]||t&&Date.now()-a.languages[e].updatedAt>=f)&&r.push(w(e)),await Promise.all(r),h={...h,...a.languages},v.splice(v.indexOf(e),1),n()}))}))}(t),void 0!==h[t]){if(["name","header.language"].includes(e)&&void 0!==h[t].name)return n(h[t].name);if(["loading","header.loader.phrases"].includes(e)&&void 0!==h[t].loading)return n(h[t].loading);if(void 0!==h[t].extension&&void 0!==h[t].extension[e])return n(h[t].extension[e]);if(void 0!==h[t].presence&&void 0!==h[t].presence[e])return n(h[t].presence[e])}return n(t===p?e:await m(e,p))}))}let y,x=null;const k=chrome.runtime.connect({name:"contentScript"});window.addEventListener("PreMiD_UpdatePresence",(async e=>{try{const t=JSON.parse(decodeURIComponent(await async function(e){const t=await async function(){if(y)return y;const e=(await("local","identifier",new Promise((e=>chrome.storage.local.get("identifier",(t=>e(t))))))).identifier;let t;if(e.length>=32)t=32;else if(e.length>=24)t=24;else{if(!(e.length>=16))return s("contentScript.ts","String is not long enough to create decryption key."),new Uint8Array;t=16}return y=a.utils.utf8.toBytes(e.substring(0,t)),y}();if(t.length>0){const n=new a.ModeOfOperation.ctr(t),r=a.utils.hex.toBytes(e),o=n.decrypt(r);return a.utils.utf8.fromBytes(o)}return""}(e.detail)));l(t),k.postMessage({action:"updatePresence",presence:t})}catch(e){if(!(e instanceof SyntaxError))throw e;s("contentScript.ts","Data could not be decrypted into JSON object.")}})),chrome.runtime.onMessage.addListener((function(e){null!==k&&(void 0!==e.iFrameData&&window.dispatchEvent(new CustomEvent("PreMiD_iFrameData",{detail:e.iFrameData})),void 0!==e.tabPriority&&(e.tabPriority?null===x&&(i("contentScript.ts","Tab Priority: "+e.tabPriority),x=window.setInterval((()=>{chrome.runtime.sendMessage({iFrameUpdateData:!0}),document.dispatchEvent(new CustomEvent("PreMiD_UpdateData")),i("contentScript.ts","updateData")}),100)):(clearInterval(x),x=null)))})),window.addEventListener("PreMiD_RequestExtensionData",(async function(e){let t=e.detail.strings;const n=e.detail.language;(await Promise.all(Object.keys(t).map((e=>m(t[e],n))))).map(((e,n)=>t[Object.keys(t)[n]]=e)),window.dispatchEvent(new CustomEvent("PreMiD_ReceiveExtensionData",{detail:{strings:t}}))}))}},t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}return n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={300:0},t=[[4184,999]],a=()=>{};function r(){for(var a,r=0;r<t.length;r++){for(var o=t[r],i=!0,s=1;s<o.length;s++){var c=o[s];0!==e[c]&&(i=!1)}i&&(t.splice(r--,1),a=n(n.s=o[0]))}return 0===t.length&&(n.x(),n.x=()=>{}),a}n.x=()=>{n.x=()=>{},i=i.slice();for(var e=0;e<i.length;e++)o(i[e]);return(a=r)()};var o=r=>{for(var o,i,[c,l,d,u]=r,g=0,p=[];g<c.length;g++)i=c[g],n.o(e,i)&&e[i]&&p.push(e[i][0]),e[i]=0;for(o in l)n.o(l,o)&&(n.m[o]=l[o]);for(d&&d(n),s(r);p.length;)p.shift()();return u&&t.push.apply(t,u),a()},i=self.webpackChunkpmd=self.webpackChunkpmd||[],s=i.push.bind(i);i.push=o})(),n.x()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wbWQvLi9zcmMvY29uZmlnLnRzIiwid2VicGFjazovL3BtZC8uL3NyYy91dGlsL2RlYnVnLnRzIiwid2VicGFjazovL3BtZC8uL3NyYy91dGlsL2Z1bmN0aW9ucy9jbGVhbk9iamVjdC50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvdXRpbC9mdW5jdGlvbnMvZ3JhcGhxbC50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvdXRpbC9sYW5nTWFuYWdlci50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvY29udGVudFNjcmlwdC50cyIsIndlYnBhY2s6Ly9wbWQvLi9zcmMvdXRpbC9mdW5jdGlvbnMvYXN5bmNTdG9yYWdlLnRzIiwid2VicGFjazovL3BtZC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wbWQvd2VicGFjay9zdGFydHVwIiwid2VicGFjazovL3BtZC93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9wbWQvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3BtZC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3BtZC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3BtZC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL3BtZC93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyJdLCJuYW1lcyI6WyJnZW5lcmljU3R5bGUiLCJsYXN0RmlsZSIsImluZm8iLCJmaWxlIiwibWVzc2FnZSIsImZvcmNlIiwiZ3JvdXBGaWxlIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwiZ3JvdXBFbmQiLCJncm91cCIsIm9iaiIsInByb3BOYW1lIiwidW5kZWZpbmVkIiwiYXN5bmMiLCJxdWVyeSIsInJlcyIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJERUZBVUxUX0xPQ0FMRSIsIk1JTl9VUERBVEVfVElNRSIsImxhbmd1YWdlcyIsIm5vcm1hbGl6ZUxhbmd1YWdlQ29kZSIsImxhbmd1YWdlQ29kZSIsInNwbGl0IiwidXBkYXRlU3RyaW5ncyIsImluY2x1ZGVzIiwid2Vic2l0ZUxhbmd1YWdlIiwiZXh0ZW5zaW9uTGFuZ3VhZ2UiLCJwcmVzZW5jZUxhbmd1YWdlIiwiYXZhaWxhYmxlTGFuZ3MiLCJsYW5nRmlsZXMiLCJtYXAiLCJsZiIsImxhbmciLCJpbmRleCIsImZpbmRJbmRleCIsImMiLCJncmFwaHFsUmVzdWx0IiwibmFtZSIsIndlYnNpdGUiLCJ0cmFuc2xhdGlvbnMiLCJsb2FkaW5nIiwiZXh0ZW5zaW9uIiwicHJlc2VuY2UiLCJ1cGRhdGVkQXQiLCJEYXRlIiwibm93Iiwic3VjY2VzcyIsImUiLCJjaHJvbWUiLCJzdG9yYWdlIiwibG9jYWwiLCJzZXQiLCJsb2FkaW5nTGFuZ3MiLCJnZXRTdHJpbmciLCJzdHJpbmciLCJpMThuIiwiZ2V0VUlMYW5ndWFnZSIsIlByb21pc2UiLCJyZXNvbHZlIiwidXBkYXRlIiwibG9hZFN0YXR1cyIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInB1c2giLCJnZXQiLCJsbmdzIiwidXBkYXRlUHJvbWlzZXMiLCJhbGwiLCJzcGxpY2UiLCJpbmRleE9mIiwibG9hZFN0cmluZ3MiLCJkZWNyeXB0aW9uS2V5IiwidGFiUHJpb3JpdHkiLCJwb3J0IiwicnVudGltZSIsImNvbm5lY3QiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiZGVjcnlwdGVkRGF0YSIsIkpTT04iLCJwYXJzZSIsImRlY29kZVVSSUNvbXBvbmVudCIsImVuY3J5cHRpb25LZXkiLCJrZXkiLCJpdGVtcyIsImlkZW50aWZpZXIiLCJrZXlTaXplIiwibGVuZ3RoIiwiVWludDhBcnJheSIsInN1YnN0cmluZyIsImdldERlY3J5cHRpb25LZXkiLCJhZXNDdHIiLCJlbmNyeXB0ZWRCeXRlcyIsImRlY3J5cHRlZEJ5dGVzIiwiZGVjcnlwdCIsImRlY3J5cHREYXRhIiwiZGV0YWlsIiwicG9zdE1lc3NhZ2UiLCJhY3Rpb24iLCJTeW50YXhFcnJvciIsIm9uTWVzc2FnZSIsImFkZExpc3RlbmVyIiwiaUZyYW1lRGF0YSIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsInNlbmRNZXNzYWdlIiwiaUZyYW1lVXBkYXRlRGF0YSIsImRvY3VtZW50Iiwic3RyaW5ncyIsImxhbmd1YWdlIiwiT2JqZWN0Iiwia2V5cyIsInNUIiwiaSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm0iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnIiwiZ2xvYmFsVGhpcyIsInRoaXMiLCJGdW5jdGlvbiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiaW5zdGFsbGVkQ2h1bmtzIiwiMzAwIiwiZGVmZXJyZWRNb2R1bGVzIiwiY2hlY2tEZWZlcnJlZE1vZHVsZXMiLCJjaGVja0RlZmVycmVkTW9kdWxlc0ltcGwiLCJyZXN1bHQiLCJkZWZlcnJlZE1vZHVsZSIsImZ1bGZpbGxlZCIsImoiLCJkZXBJZCIsInMiLCJ4IiwiY2h1bmtMb2FkaW5nR2xvYmFsIiwic2xpY2UiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsImNodW5rSWQiLCJjaHVua0lkcyIsIm1vcmVNb2R1bGVzIiwiZXhlY3V0ZU1vZHVsZXMiLCJyZXNvbHZlcyIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwic2hpZnQiLCJhcHBseSIsInNlbGYiLCJiaW5kIl0sIm1hcHBpbmdzIjoiMEVBQU8sTUNFREEsRUFBZSxvREFFckIsSUFBSUMsRUFFRyxT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LEVBQWdCZSxJQUNyRUksRUFBU2xHLEtBQUsrRSxFQUFnQmUsR0FBUyxJQUV4Q2YsRUFBZ0JlLEdBQVcsRUFFNUIsSUFBSXpDLEtBQVkyQyxFQUNaNUMsRUFBb0JhLEVBQUUrQixFQUFhM0MsS0FDckNELEVBQW9CTSxFQUFFTCxHQUFZMkMsRUFBWTNDLElBS2hELElBRkcxQyxHQUFTQSxFQUFReUMsR0FDcEIrQyxFQUEyQmxKLEdBQ3JCaUosRUFBUzFFLFFBQ2QwRSxFQUFTRSxPQUFURixHQU9ELE9BSEdELEdBQWdCaEIsRUFBZ0JqRixLQUFLcUcsTUFBTXBCLEVBQWlCZ0IsR0FHeERmLEtBR0pTLEVBQXFCVyxLQUFzQixnQkFBSUEsS0FBc0IsaUJBQUssR0FDMUVILEVBQTZCUixFQUFtQjNGLEtBQUt1RyxLQUFLWixHQUM5REEsRUFBbUIzRixLQUFPNkYsRyxHTnhGbkJ6QyxFQUFvQnNDLEsiLCJmaWxlIjoianMvY29udGVudFNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBhcGlCYXNlID0gXCJodHRwczovL2FwaS5wcmVtaWQuYXBwL3YzL1wiO1xyXG5leHBvcnQgY29uc3QgcmVsZWFzZVR5cGU6IFwiQkVUQVwiIHwgXCJBTFBIQVwiIHwgXCJSRUxFQVNFXCIgfCBcIkRFVlwiID0gXCJSRUxFQVNFXCI7XHJcbmV4cG9ydCBjb25zdCByZXF1aXJlZEFwcFZlcnNpb24gPSAyMTQ7XHJcbiIsImltcG9ydCB7IHJlbGVhc2VUeXBlIH0gZnJvbSBcIi4uL2NvbmZpZ1wiO1xyXG5cclxuY29uc3QgZ2VuZXJpY1N0eWxlID0gXCJmb250LXdlaWdodDogODAwOyBwYWRkaW5nOiAycHggNXB4OyBjb2xvcjogd2hpdGU7XCIsXHJcblx0ZGVidWdnaW5nID0gcmVsZWFzZVR5cGUgIT09IFwiUkVMRUFTRVwiO1xyXG5sZXQgbGFzdEZpbGU6IHN0cmluZztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbmZvKGZpbGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBmb3JjZSA9IGZhbHNlKSB7XHJcblx0aWYgKCFkZWJ1Z2dpbmcgJiYgIWZvcmNlKSByZXR1cm47XHJcblxyXG5cdC8vKiBHcm91cCBieSBmaWxlXHJcblx0Z3JvdXBGaWxlKGZpbGUpO1xyXG5cdGNvbnNvbGUubG9nKFxyXG5cdFx0XCIlY1ByZU1pRCVjSU5GTyVjIFwiICsgbWVzc2FnZSxcclxuXHRcdGdlbmVyaWNTdHlsZSArIFwiYm9yZGVyLXJhZGl1czogMjVweCAwIDAgMjVweDsgYmFja2dyb3VuZDogIzU5NmNhZTtcIixcclxuXHRcdGdlbmVyaWNTdHlsZSArIFwiYm9yZGVyLXJhZGl1czogMCAyNXB4IDI1cHggMDsgYmFja2dyb3VuZDogIzUwNTBmZjtcIixcclxuXHRcdFwiY29sb3I6IHVuc2V0O1wiXHJcblx0KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHN1Y2Nlc3MoZmlsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcsIGZvcmNlID0gZmFsc2UpIHtcclxuXHRpZiAoIWRlYnVnZ2luZyAmJiAhZm9yY2UpIHJldHVybjtcclxuXHJcblx0Ly8qIEdyb3VwIGJ5IGZpbGVcclxuXHRncm91cEZpbGUoZmlsZSk7XHJcblx0Y29uc29sZS5sb2coXHJcblx0XHRcIiVjUHJlTWlEJWNTVUNDRVNTJWMgXCIgKyBtZXNzYWdlLFxyXG5cdFx0Z2VuZXJpY1N0eWxlICsgXCJib3JkZXItcmFkaXVzOiAyNXB4IDAgMCAyNXB4OyBiYWNrZ3JvdW5kOiAjNTk2Y2FlO1wiLFxyXG5cdFx0Z2VuZXJpY1N0eWxlICtcclxuXHRcdFx0XCJib3JkZXItcmFkaXVzOiAwIDI1cHggMjVweCAwOyBiYWNrZ3JvdW5kOiAjNTBmZjUwOyBjb2xvcjogYmxhY2s7XCIsXHJcblx0XHRcImNvbG9yOiB1bnNldDtcIlxyXG5cdCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBlcnJvcihmaWxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgZm9yY2UgPSBmYWxzZSkge1xyXG5cdGlmICghZGVidWdnaW5nICYmICFmb3JjZSkgcmV0dXJuO1xyXG5cclxuXHQvLyogR3JvdXAgYnkgZmlsZVxyXG5cdGdyb3VwRmlsZShmaWxlKTtcclxuXHRjb25zb2xlLmxvZyhcclxuXHRcdFwiJWNQcmVNaUQlY0VSUk9SJWMgXCIgKyBtZXNzYWdlLFxyXG5cdFx0Z2VuZXJpY1N0eWxlICsgXCJib3JkZXItcmFkaXVzOiAyNXB4IDAgMCAyNXB4OyBiYWNrZ3JvdW5kOiAjNTk2Y2FlO1wiLFxyXG5cdFx0Z2VuZXJpY1N0eWxlICsgXCJib3JkZXItcmFkaXVzOiAwIDI1cHggMjVweCAwOyBiYWNrZ3JvdW5kOiAjZmY1MDUwO1wiLFxyXG5cdFx0XCJjb2xvcjogdW5zZXQ7XCJcclxuXHQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBncm91cEZpbGUoZmlsZTogc3RyaW5nKSB7XHJcblx0aWYgKGxhc3RGaWxlICE9PSBmaWxlKSB7XHJcblx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XHJcblx0XHRjb25zb2xlLmdyb3VwKGZpbGUpO1xyXG5cdFx0bGFzdEZpbGUgPSBmaWxlO1xyXG5cdH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjbGVhbk9iamVjdChvYmo6IG9iamVjdCk6IHZvaWQge1xyXG5cdGZvciAoY29uc3QgcHJvcE5hbWUgaW4gb2JqKSB7XHJcblx0XHRpZiAodHlwZW9mIG9ialtwcm9wTmFtZV0gPT0gXCJvYmplY3RcIikge1xyXG5cdFx0XHRjbGVhbk9iamVjdChvYmpbcHJvcE5hbWVdKTtcclxuXHRcdH1cclxuXHRcdGlmIChvYmpbcHJvcE5hbWVdID09PSBudWxsIHx8IG9ialtwcm9wTmFtZV0gPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRkZWxldGUgb2JqW3Byb3BOYW1lXTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IGF4aW9zIGZyb20gXCJheGlvc1wiO1xyXG5cclxuaW1wb3J0IHsgYXBpQmFzZSB9IGZyb20gXCIuLi8uLi9jb25maWdcIjtcclxuaW1wb3J0IGNsZWFuT2JqZWN0IGZyb20gXCIuL2NsZWFuT2JqZWN0XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBncmFwaHFsUmVxdWVzdChxdWVyeTogc3RyaW5nKSB7XHJcblx0Y29uc3QgcmVzID0gYXdhaXQgYXhpb3Moe1xyXG5cdFx0dXJsOiBhcGlCYXNlLFxyXG5cdFx0bWV0aG9kOiBcInBvc3RcIixcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0cXVlcnk6IHF1ZXJ5XHJcblx0XHR9XHJcblx0fSk7XHJcblx0Y2xlYW5PYmplY3QocmVzLmRhdGEpO1xyXG5cclxuXHRyZXR1cm4gcmVzLmRhdGE7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcmVzZW5jZU1ldGFkYXRhKHByZXNlbmNlOiBzdHJpbmcpIHtcclxuXHRjb25zdCByZXN1bHQgPSBhd2FpdCBncmFwaHFsUmVxdWVzdChgXHJcbiAgICBxdWVyeSB7XHJcbiAgICAgIHByZXNlbmNlcyhzZXJ2aWNlOiBcIiR7cHJlc2VuY2V9XCIpIHtcclxuICAgICAgICB1cmxcclxuICAgICAgICBtZXRhZGF0YSB7XHJcbiAgICAgICAgICBhdXRob3Ige1xyXG4gICAgICAgICAgICBpZFxyXG4gICAgICAgICAgICBuYW1lXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb250cmlidXRvcnMge1xyXG4gICAgICAgICAgICBpZFxyXG4gICAgICAgICAgICBuYW1lXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBhbHRuYW1lc1xyXG4gICAgICAgICAgd2FybmluZ1xyXG4gICAgICAgICAgcmVhZExvZ3NcclxuICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgc2VydmljZVxyXG4gICAgICAgICAgZGVzY3JpcHRpb25cclxuICAgICAgICAgIHVybFxyXG4gICAgICAgICAgdmVyc2lvblxyXG4gICAgICAgICAgbG9nb1xyXG4gICAgICAgICAgdGh1bWJuYWlsXHJcbiAgICAgICAgICBjb2xvclxyXG4gICAgICAgICAgdGFnc1xyXG4gICAgICAgICAgY2F0ZWdvcnlcclxuICAgICAgICAgIGlmcmFtZVxyXG4gICAgICAgICAgcmVnRXhwXHJcbiAgICAgICAgICBpZnJhbWVSZWdFeHBcclxuICAgICAgICAgIHNldHRpbmdzIHtcclxuICAgICAgICAgICAgaWRcclxuICAgICAgICAgICAgdGl0bGVcclxuICAgICAgICAgICAgaWNvblxyXG4gICAgICAgICAgICBpZiB7XHJcbiAgICAgICAgICAgICAgcHJvcHJldHlOYW1lc1xyXG4gICAgICAgICAgICAgIHBhdHRlcm5Qcm9wcnRpZXNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlclxyXG4gICAgICAgICAgICB2YWx1ZVxyXG4gICAgICAgICAgICB2YWx1ZXNcclxuICAgICAgICAgICAgbXVsdGlMYW5ndWFnZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfWApO1xyXG5cdGNsZWFuT2JqZWN0KHJlc3VsdC5kYXRhKTtcclxuXHRjb25zdCBmaW5hbCA9IHtcclxuXHRcdGRhdGE6IHtcclxuXHRcdFx0bmFtZTogcmVzdWx0LmRhdGEucHJlc2VuY2VzWzBdLm1ldGFkYXRhLnNlcnZpY2UsXHJcblx0XHRcdHVybDogcmVzdWx0LmRhdGEucHJlc2VuY2VzWzBdLnVybCxcclxuXHRcdFx0bWV0YWRhdGE6IHJlc3VsdC5kYXRhLnByZXNlbmNlc1swXS5tZXRhZGF0YVxyXG5cdFx0fVxyXG5cdH07XHJcblx0cmV0dXJuIGZpbmFsO1xyXG59XHJcbiIsImltcG9ydCB7IGVycm9yLCBzdWNjZXNzIH0gZnJvbSBcIi4vZGVidWdcIjtcclxuXHJcbmltcG9ydCB7IGdldFN0b3JhZ2UgfSBmcm9tIFwiLi9mdW5jdGlvbnMvYXN5bmNTdG9yYWdlXCI7XHJcbmltcG9ydCBncmFwaHFsUmVxdWVzdCBmcm9tIFwiLi9mdW5jdGlvbnMvZ3JhcGhxbFwiO1xyXG5cclxuLyoqXHJcbiAqIERlZmF1bHQgbGFuZ3VhZ2UgY29kZVxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfTE9DQUxFID0gXCJlblwiO1xyXG5cclxuLyoqXHJcbiAqIE1pbmltdW0gdGltZSBiZXR3ZWVuIHN0cmluZ3MgdXBkYXRlXHJcbiAqL1xyXG5jb25zdCBNSU5fVVBEQVRFX1RJTUUgPSAxMDAwICogNjAgKiA1O1xyXG5cclxubGV0IGxhbmd1YWdlczogb2JqZWN0ID0ge307XHJcblxyXG5mdW5jdGlvbiBub3JtYWxpemVMYW5ndWFnZUNvZGUobGFuZ3VhZ2VDb2RlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdHJldHVybiBsYW5ndWFnZUNvZGUuc3BsaXQoXCItXCIpWzBdO1xyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlIHN0cmluZ3MgdmFsdWVzIChleHRlbnNpb24gYW5kIHByZXNlbmNlIGVuZHBvaW50cykgZnJvbSB0aGUgQVBJIHdlYnNpdGVcclxuICpcclxuICogQHBhcmFtIGxhbmd1YWdlQ29kZSBsYW5ndWFnZSBjb2RlIGZvbGxvd2luZyBJU082MzktMSBzcGVjXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlU3RyaW5ncyhsYW5ndWFnZUNvZGU/OiBzdHJpbmcpIHtcclxuXHRpZiAoIWxhbmd1YWdlQ29kZSkgbGFuZ3VhZ2VDb2RlID0gREVGQVVMVF9MT0NBTEU7XHJcblx0aWYgKFxyXG5cdFx0IWxhbmd1YWdlQ29kZS5pbmNsdWRlcyhcImphXCIpICYmXHJcblx0XHQhbGFuZ3VhZ2VDb2RlLmluY2x1ZGVzKFwiemhcIikgJiZcclxuXHRcdCFsYW5ndWFnZUNvZGUuaW5jbHVkZXMoXCJrb1wiKVxyXG5cdClcclxuXHRcdGxhbmd1YWdlQ29kZSA9IG5vcm1hbGl6ZUxhbmd1YWdlQ29kZShsYW5ndWFnZUNvZGUpO1xyXG5cclxuXHRsZXQgd2Vic2l0ZUxhbmd1YWdlOiBzdHJpbmcgPSBsYW5ndWFnZUNvZGUsXHJcblx0XHRleHRlbnNpb25MYW5ndWFnZTogc3RyaW5nID0gbGFuZ3VhZ2VDb2RlLFxyXG5cdFx0cHJlc2VuY2VMYW5ndWFnZTogc3RyaW5nID0gbGFuZ3VhZ2VDb2RlO1xyXG5cclxuXHRzd2l0Y2ggKGxhbmd1YWdlQ29kZSkge1xyXG5cdFx0Y2FzZSBcImphXCI6XHJcblx0XHRcdHdlYnNpdGVMYW5ndWFnZSA9IFwiamFfSlBcIjtcclxuXHRcdFx0cHJlc2VuY2VMYW5ndWFnZSA9IFwiamFfSlBcIjtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiamFfSlBcIjpcclxuXHRcdFx0ZXh0ZW5zaW9uTGFuZ3VhZ2UgPSBcImphXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImtvXCI6XHJcblx0XHRcdHdlYnNpdGVMYW5ndWFnZSA9IFwia29fS1JcIjtcclxuXHRcdFx0cHJlc2VuY2VMYW5ndWFnZSA9IFwia29fS1JcIjtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwia29fS1JcIjpcclxuXHRcdFx0ZXh0ZW5zaW9uTGFuZ3VhZ2UgPSBcImtvXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInpoLUNOXCI6XHJcblx0XHRcdHdlYnNpdGVMYW5ndWFnZSA9IFwiemhfQ05cIjtcclxuXHRcdFx0cHJlc2VuY2VMYW5ndWFnZSA9IFwiemhfQ05cIjtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiemhfQ05cIjpcclxuXHRcdFx0ZXh0ZW5zaW9uTGFuZ3VhZ2UgPSBcInpoLUNOXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcInpoLVRXXCI6XHJcblx0XHRcdHdlYnNpdGVMYW5ndWFnZSA9IFwiemhfVFdcIjtcclxuXHRcdFx0cHJlc2VuY2VMYW5ndWFnZSA9IFwiemhfVFdcIjtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiemhfVFdcIjpcclxuXHRcdFx0ZXh0ZW5zaW9uTGFuZ3VhZ2UgPSBcInpoLVRXXCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0ZGVmYXVsdDpcclxuXHRcdFx0Y29uc3QgcmVzcG9uc2VMYW5ncyA9IGF3YWl0IGdyYXBocWxSZXF1ZXN0KGBcclxuXHRcdFx0cXVlcnkge1xyXG5cdFx0XHRcdGxhbmdGaWxlcyhwcm9qZWN0OiBcImV4dGVuc2lvblwiKSB7XHJcblx0XHRcdFx0XHRsYW5nXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGApLFxyXG5cdFx0XHRcdGF2YWlsYWJsZUxhbmdzOiBzdHJpbmdbXSA9IHJlc3BvbnNlTGFuZ3MuZGF0YS5sYW5nRmlsZXMubWFwKFxyXG5cdFx0XHRcdFx0bGYgPT4gbGYubGFuZ1xyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHRpZiAoIWF2YWlsYWJsZUxhbmdzLmluY2x1ZGVzKGV4dGVuc2lvbkxhbmd1YWdlKSkge1xyXG5cdFx0XHRcdGNvbnN0IGluZGV4ID0gYXZhaWxhYmxlTGFuZ3MuZmluZEluZGV4KGMgPT5cclxuXHRcdFx0XHRcdGMuaW5jbHVkZXMoZXh0ZW5zaW9uTGFuZ3VhZ2UgKyBcIl9cIilcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGlmIChpbmRleCA+PSAwKSB7XHJcblx0XHRcdFx0XHR3ZWJzaXRlTGFuZ3VhZ2UgPSBhdmFpbGFibGVMYW5nc1tpbmRleF07XHJcblx0XHRcdFx0XHRleHRlbnNpb25MYW5ndWFnZSA9IGF2YWlsYWJsZUxhbmdzW2luZGV4XTtcclxuXHRcdFx0XHRcdHByZXNlbmNlTGFuZ3VhZ2UgPSBhdmFpbGFibGVMYW5nc1tpbmRleF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGJyZWFrO1xyXG5cdH1cclxuXHJcblx0dHJ5IHtcclxuXHRcdGNvbnN0IGdyYXBocWxSZXN1bHQgPSBhd2FpdCBncmFwaHFsUmVxdWVzdChgXHJcblx0XHRcdHF1ZXJ5IHtcclxuXHRcdFx0XHR3ZWJzaXRlOiBsYW5nRmlsZXMocHJvamVjdDogXCJ3ZWJzaXRlXCIsIGxhbmc6IFwiJHt3ZWJzaXRlTGFuZ3VhZ2V9XCIpIHtcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9uc1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRleHRlbnNpb246IGxhbmdGaWxlcyhwcm9qZWN0OiBcImV4dGVuc2lvblwiLCBsYW5nOiBcIiR7ZXh0ZW5zaW9uTGFuZ3VhZ2V9XCIpIHtcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9uc1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRwcmVzZW5jZTogbGFuZ0ZpbGVzKHByb2plY3Q6IFwicHJlc2VuY2VcIiwgbGFuZzogXCIke3ByZXNlbmNlTGFuZ3VhZ2V9XCIpIHtcclxuXHRcdFx0XHRcdHRyYW5zbGF0aW9uc1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0YCk7XHJcblxyXG5cdFx0bGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gPSB7XHJcblx0XHRcdG5hbWU6IGdyYXBocWxSZXN1bHQuZGF0YS53ZWJzaXRlWzBdLnRyYW5zbGF0aW9uc1tcImhlYWRlci5sYW5ndWFnZVwiXSxcclxuXHRcdFx0bG9hZGluZzpcclxuXHRcdFx0XHRncmFwaHFsUmVzdWx0LmRhdGEud2Vic2l0ZVswXS50cmFuc2xhdGlvbnNbXCJoZWFkZXIubG9hZGVyLnBocmFzZXNcIl0sXHJcblx0XHRcdGV4dGVuc2lvbjogZ3JhcGhxbFJlc3VsdC5kYXRhLmV4dGVuc2lvblswXS50cmFuc2xhdGlvbnMsXHJcblx0XHRcdHByZXNlbmNlOiBncmFwaHFsUmVzdWx0LmRhdGEucHJlc2VuY2VbMF0udHJhbnNsYXRpb25zLFxyXG5cdFx0XHR1cGRhdGVkQXQ6IERhdGUubm93KClcclxuXHRcdH07XHJcblxyXG5cdFx0c3VjY2VzcyhcImxhbmdNYW5hZ2VyLnRzXCIsIGBVcGRhdGVkICR7bGFuZ3VhZ2VDb2RlfSB0cmFuc2xhdGlvbnNgKTtcclxuXHR9IGNhdGNoIChlKSB7XHJcblx0XHRlcnJvcihcclxuXHRcdFx0XCJsYW5nTWFuYWdlci50c1wiLFxyXG5cdFx0XHRgRXJyb3Igd2hpbGUgZmV0Y2hpbmcgbGFuZ0ZpbGVzIG9mICR7bGFuZ3VhZ2VDb2RlfSBsYW5ndWFnZTogJHtlLm1lc3NhZ2V9YFxyXG5cdFx0KTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGlmIChsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXSAmJiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5lcnJvcikge1xyXG5cdFx0bGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gPSB1bmRlZmluZWQ7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBsYW5ndWFnZXMgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBbGxTdHJpbmdzKCkge1xyXG5cdGNvbnN0IGxhbmd1YWdlcyA9IE9iamVjdC5rZXlzKChhd2FpdCBnZXRTdG9yYWdlKFwibG9jYWxcIiwgXCJsYW5ndWFnZXNcIikpLmxhbmd1YWdlcyk7XHJcblx0YXdhaXQgUHJvbWlzZS5hbGwoXHJcblx0XHRsYW5ndWFnZXMubWFwKGxuZyA9PiBsb2FkU3RyaW5ncyhsbmcsIHRydWUpKVxyXG5cdCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdHJpbmdzIHRoYXQgYXJlIGJlaW5nIGxvYWRlZCBieSBsb2FkU3RyaW5ncyBmdW5jdGlvblxyXG4gKi9cclxuY29uc3QgbG9hZGluZ0xhbmdzID0gW107XHJcblxyXG4vKipcclxuICogTG9hZCB0aGUgc3RyaW5ncyBmcm9tIHRoZSBicm93c2VyIGxvY2FsIHN0b3JhZ2UsIGlmIHRoZXkgYXJlIG5vdCBmb3VuZCBpbiB0aGUgc3RvcmFnZSB0aGV5IHdpbGwgYmVcclxuICogZmV0Y2ggZnJvbSB0aGUgQVBJLlxyXG4gKlxyXG4gKiBAcGFyYW0gbGFuZ3VhZ2VDb2RlIGxhbmd1YWdlIGNvZGUgSVNPNjM5LTEgaWYgbm90IHNwZWNpZmllZCBERUZBVUxUX0xPQ0FMRSBpcyB1c2VkXHJcbiAqIEBwYXJhbSB1cGRhdGUgYm9vbGVhbiB0byBmb3JjZSBhbiB1cGRhdGUgb2YgdGhlIHN0cmluZ3MgaW4gdGhlIGdpdmVuIGxvY2FsZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRTdHJpbmdzKGxhbmd1YWdlQ29kZT86IHN0cmluZywgdXBkYXRlPzogYm9vbGVhbikge1xyXG5cdGlmICghbGFuZ3VhZ2VDb2RlKSBsYW5ndWFnZUNvZGUgPSBERUZBVUxUX0xPQ0FMRTtcclxuXHRpZiAoIXVwZGF0ZSkgdXBkYXRlID0gZmFsc2U7XHJcblx0bGFuZ3VhZ2VDb2RlID0gbm9ybWFsaXplTGFuZ3VhZ2VDb2RlKGxhbmd1YWdlQ29kZSk7XHJcblxyXG5cdHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPihyZXNvbHZlID0+IHtcclxuXHRcdGlmICh0eXBlb2YgbGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gIT09IFwidW5kZWZpbmVkXCIpIHJlc29sdmUoKTtcclxuXHJcblx0XHRpZiAoIWxvYWRpbmdMYW5ncy5pbmNsdWRlcyhsYW5ndWFnZUNvZGUpKSB7XHJcblx0XHRcdGxvYWRpbmdMYW5ncy5wdXNoKGxhbmd1YWdlQ29kZSk7XHJcblxyXG5cdFx0XHRjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoXCJsYW5ndWFnZXNcIiwgYXN5bmMgbG5ncyA9PiB7XHJcblx0XHRcdFx0aWYgKCFsbmdzLmxhbmd1YWdlcykge1xyXG5cdFx0XHRcdFx0bG5ncy5sYW5ndWFnZXMgPSB7fTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGNvbnN0IHVwZGF0ZVByb21pc2VzID0gW107XHJcblx0XHRcdFx0aWYgKFxyXG5cdFx0XHRcdFx0KFxyXG5cdFx0XHRcdFx0XHR1cGRhdGUgJiZcclxuXHRcdFx0XHRcdFx0dHlwZW9mIGxuZ3MubGFuZ3VhZ2VzW0RFRkFVTFRfTE9DQUxFXSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG5cdFx0XHRcdFx0XHREYXRlLm5vdygpIC0gbG5ncy5sYW5ndWFnZXNbREVGQVVMVF9MT0NBTEVdLnVwZGF0ZWRBdCA+PSBNSU5fVVBEQVRFX1RJTUVcclxuXHRcdFx0XHRcdCkgfHxcclxuXHRcdFx0XHRcdChcclxuXHRcdFx0XHRcdFx0bGFuZ3VhZ2VDb2RlICE9PSBERUZBVUxUX0xPQ0FMRSAmJlxyXG5cdFx0XHRcdFx0XHR0eXBlb2YgbG5ncy5sYW5ndWFnZXNbREVGQVVMVF9MT0NBTEVdID09PSBcInVuZGVmaW5lZFwiXHJcblx0XHRcdFx0XHQpXHJcblx0XHRcdFx0KSB7XHJcblx0XHRcdFx0XHR1cGRhdGVQcm9taXNlcy5wdXNoKHVwZGF0ZVN0cmluZ3MoREVGQVVMVF9MT0NBTEUpKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChcclxuXHRcdFx0XHRcdHR5cGVvZiBsbmdzLmxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdID09PSBcInVuZGVmaW5lZFwiIHx8XHJcblx0XHRcdFx0XHQoXHJcblx0XHRcdFx0XHRcdHVwZGF0ZSAmJlxyXG5cdFx0XHRcdFx0XHQvLyBhbHJlYWR5IGNoZWNrZWQgaWYgbG5ncy5sYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXSBpcyB1bmRlZmluZWRcclxuXHRcdFx0XHRcdFx0RGF0ZS5ub3coKSAtIGxuZ3MubGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0udXBkYXRlZEF0ID49IE1JTl9VUERBVEVfVElNRVxyXG5cdFx0XHRcdFx0KVxyXG5cclxuXHRcdFx0XHQpIHtcclxuXHRcdFx0XHRcdHVwZGF0ZVByb21pc2VzLnB1c2godXBkYXRlU3RyaW5ncyhsYW5ndWFnZUNvZGUpKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGF3YWl0IFByb21pc2UuYWxsKHVwZGF0ZVByb21pc2VzKTtcclxuXHJcblx0XHRcdFx0Ly8gbWVyZ2UgYWxsIGxhbmd1YWdlc1xyXG5cdFx0XHRcdGxhbmd1YWdlcyA9IHsgLi4ubGFuZ3VhZ2VzLCAuLi5sbmdzLmxhbmd1YWdlcyB9O1xyXG5cclxuXHRcdFx0XHRsb2FkaW5nTGFuZ3Muc3BsaWNlKGxvYWRpbmdMYW5ncy5pbmRleE9mKGxhbmd1YWdlQ29kZSksIDEpO1xyXG5cdFx0XHRcdHJlc29sdmUoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRsZXQgbG9hZFN0YXR1cyA9IHNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0XHRpZiAoXHJcblx0XHRcdFx0XHR0eXBlb2YgbGFuZ3VhZ2VzICE9PSBcInVuZGVmaW5lZFwiICYmXHJcblx0XHRcdFx0XHR0eXBlb2YgbGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0gIT09IFwidW5kZWZpbmVkXCJcclxuXHRcdFx0XHQpIHtcclxuXHRcdFx0XHRcdGNsZWFySW50ZXJ2YWwobG9hZFN0YXR1cyk7XHJcblx0XHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCA1KTtcclxuXHRcdH1cclxuXHR9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBhbGwgdGhlIHRyYW5zbGF0aW9ucyBpbiB0aGUgZ2l2ZW4gbGFuZ3VhZ2UgYW5kIERFRkFVTFRfTE9DQUxFXHJcbiAqXHJcbiAqIEBwYXJhbSBsYW5ndWFnZUNvZGUgbGFuZ3VhZ2UgY29kZSBJU082MzktMSBpZiBub3Qgc3BlY2lmaWVkIERFRkFVTFRfTE9DQUxFIGlzIHVzZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHJpbmdzKGxhbmd1YWdlQ29kZT86IHN0cmluZykge1xyXG5cdGlmICghbGFuZ3VhZ2VDb2RlKSBsYW5ndWFnZUNvZGUgPSBERUZBVUxUX0xPQ0FMRTtcclxuXHRsYW5ndWFnZUNvZGUgPSBub3JtYWxpemVMYW5ndWFnZUNvZGUobGFuZ3VhZ2VDb2RlKTtcclxuXHJcblx0cmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIHJlc29sdmUgPT4ge1xyXG5cdFx0YXdhaXQgbG9hZFN0cmluZ3MobGFuZ3VhZ2VDb2RlKTtcclxuXHJcblx0XHRpZiAodHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdID09PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHRcdGlmICghbGFuZ3VhZ2VzW0RFRkFVTFRfTE9DQUxFXSkge1xyXG5cdFx0XHRcdHJlc29sdmUoe30pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXNvbHZlKHtcclxuXHRcdFx0XHRbREVGQVVMVF9MT0NBTEVdOiB7XHJcblx0XHRcdFx0XHQuLi5sYW5ndWFnZXNbREVGQVVMVF9MT0NBTEVdLmV4dGVuc2lvbixcclxuXHRcdFx0XHRcdC4uLmxhbmd1YWdlc1tERUZBVUxUX0xPQ0FMRV0ucHJlc2VuY2VcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmVzb2x2ZSh7XHJcblx0XHRcdFx0W2xhbmd1YWdlQ29kZV06IHtcclxuXHRcdFx0XHRcdC4uLmxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLmV4dGVuc2lvbixcclxuXHRcdFx0XHRcdC4uLmxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLnByZXNlbmNlXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRbREVGQVVMVF9MT0NBTEVdOiB7XHJcblx0XHRcdFx0XHQuLi5sYW5ndWFnZXNbREVGQVVMVF9MT0NBTEVdLmV4dGVuc2lvbixcclxuXHRcdFx0XHRcdC4uLmxhbmd1YWdlc1tERUZBVUxUX0xPQ0FMRV0ucHJlc2VuY2VcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IHRyYW5zbGF0aW9uIG9mIGEgc3BlY2lmaWMga2V5XHJcbiAqXHJcbiAqIEBwYXJhbSBzdHJpbmcgbmFtZSBvZiB0aGUgc3RyaW5nLCB0byBnZXQgdGhlIG5hbWUgb2YgdGhlIGxhbmd1YWdlIHVzZSBcIm5hbWVcIiBvciBcImhlYWRlci5sYW5ndWFnZVwiXHJcbiAqIEBwYXJhbSBsYW5ndWFnZUNvZGUgbGFuZ3VhZ2UgY29kZSBJU082MzktMSBpZiBub3Qgc3BlY2lmaWVkIERFRkFVTFRfTE9DQUxFIGlzIHVzZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHJpbmcoc3RyaW5nOiBzdHJpbmcsIGxhbmd1YWdlQ29kZT86IHN0cmluZykge1xyXG5cdGlmICghbGFuZ3VhZ2VDb2RlKSBsYW5ndWFnZUNvZGUgPSBjaHJvbWUuaTE4bi5nZXRVSUxhbmd1YWdlKCk7XHJcblx0bGFuZ3VhZ2VDb2RlID0gbm9ybWFsaXplTGFuZ3VhZ2VDb2RlKGxhbmd1YWdlQ29kZSk7XHJcblxyXG5cdHJldHVybiBuZXcgUHJvbWlzZShhc3luYyByZXNvbHZlID0+IHtcclxuXHRcdGF3YWl0IGxvYWRTdHJpbmdzKGxhbmd1YWdlQ29kZSk7XHJcblxyXG5cdFx0aWYgKHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXSAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0XHRpZiAoXHJcblx0XHRcdFx0W1wibmFtZVwiLCBcImhlYWRlci5sYW5ndWFnZVwiXS5pbmNsdWRlcyhzdHJpbmcpICYmXHJcblx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLm5hbWUgIT09IFwidW5kZWZpbmVkXCJcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0cmV0dXJuIHJlc29sdmUobGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0ubmFtZSk7XHJcblx0XHRcdH0gZWxzZSBpZiAoXHJcblx0XHRcdFx0W1wibG9hZGluZ1wiLCBcImhlYWRlci5sb2FkZXIucGhyYXNlc1wiXS5pbmNsdWRlcyhzdHJpbmcpICYmXHJcblx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLmxvYWRpbmcgIT09IFwidW5kZWZpbmVkXCJcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0cmV0dXJuIHJlc29sdmUobGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0ubG9hZGluZyk7XHJcblx0XHRcdH0gZWxzZSBpZiAoXHJcblx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLmV4dGVuc2lvbiAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG5cdFx0XHRcdHR5cGVvZiBsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5leHRlbnNpb25bc3RyaW5nXSAhPT0gXCJ1bmRlZmluZWRcIlxyXG5cdFx0XHQpIHtcclxuXHRcdFx0XHRyZXR1cm4gcmVzb2x2ZShsYW5ndWFnZXNbbGFuZ3VhZ2VDb2RlXS5leHRlbnNpb25bc3RyaW5nXSk7XHJcblx0XHRcdH0gZWxzZSBpZiAoXHJcblx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLnByZXNlbmNlICE9PSBcInVuZGVmaW5lZFwiICYmXHJcblx0XHRcdFx0dHlwZW9mIGxhbmd1YWdlc1tsYW5ndWFnZUNvZGVdLnByZXNlbmNlW3N0cmluZ10gIT09IFwidW5kZWZpbmVkXCJcclxuXHRcdFx0KSB7XHJcblx0XHRcdFx0cmV0dXJuIHJlc29sdmUobGFuZ3VhZ2VzW2xhbmd1YWdlQ29kZV0ucHJlc2VuY2Vbc3RyaW5nXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBwcmV2ZW50IGluZmluaXRlIGxvb3BzXHJcblx0XHRpZiAobGFuZ3VhZ2VDb2RlID09PSBERUZBVUxUX0xPQ0FMRSkge1xyXG5cdFx0XHRyZXR1cm4gcmVzb2x2ZShzdHJpbmcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiByZXNvbHZlKGF3YWl0IGdldFN0cmluZyhzdHJpbmcsIERFRkFVTFRfTE9DQUxFKSk7XHJcblx0fSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPYnRhaW4gYWxsIGxhbmd1YWdlcyB0aGF0IGFyZSAxMDAlIHRyYW5zbGF0ZWQgZm9yIGEgcHJlc2VuY2UgYW5kIHRoYXQgYWxzbyBoYXZlIHRoZSBnZW5lcmFsIGZpbGUgMTAwJSB0cmFuc2xhdGVkXHJcbiAqXHJcbiAqIEBwYXJhbSBwcmVzZW5jZU5hbWUgbmFtZSBvZiB0aGUgcHJlc2VuY2UgYXMgc3BlY2lmaWVkIGluIHRoZSBcInNlcnZpY2VcIiBrZXkgb2YgdGhlIG1ldGFkYXRhLmpzb24gZmlsZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByZXNlbmNlTGFuZ3VhZ2VzKHByZXNlbmNlTmFtZTogc3RyaW5nKSB7XHJcblx0dHJ5IHtcclxuXHRcdGNvbnN0IGxhbmdzID0gYXdhaXQgZ3JhcGhxbFJlcXVlc3QoYFxyXG5cdFx0XHRxdWVyeSB7XHJcblx0XHRcdFx0bGFuZ0ZpbGVzKHByZXNlbmNlOiBcIiR7cHJlc2VuY2VOYW1lLnRvTG93ZXJDYXNlKCl9XCIpIHtcclxuXHRcdFx0XHRcdGxhbmdcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Z2VuZXJhbExhbmdGaWxlczogbGFuZ0ZpbGVzKHByZXNlbmNlOiBcImdlbmVyYWxcIikge1xyXG5cdFx0XHRcdFx0bGFuZ1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0YCk7XHJcblxyXG5cdFx0Y29uc3QgZmluYWxBcnJheSA9IFtdO1xyXG5cdFx0aWYgKFxyXG5cdFx0XHRsYW5ncy5kYXRhLmxhbmdGaWxlcy5sZW5ndGggPiAwICYmXHJcblx0XHRcdGxhbmdzLmRhdGEuZ2VuZXJhbExhbmdGaWxlcy5sZW5ndGggPiAwXHJcblx0XHQpIHtcclxuXHRcdFx0bGFuZ3MuZGF0YS5nZW5lcmFsTGFuZ0ZpbGVzLmZvckVhY2gobGFuZyA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZm91bmQgPSBsYW5ncy5kYXRhLmxhbmdGaWxlcy5maW5kKHAgPT4gcC5sYW5nID09PSBsYW5nLmxhbmcpO1xyXG5cdFx0XHRcdGlmIChmb3VuZCkgZmluYWxBcnJheS5wdXNoKGxhbmcubGFuZyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIGlmIChsYW5ncy5kYXRhLmdlbmVyYWxMYW5nRmlsZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRsYW5ncy5kYXRhLmdlbmVyYWxMYW5nRmlsZXMuZm9yRWFjaChsYW5nID0+IHtcclxuXHRcdFx0XHRmaW5hbEFycmF5LnB1c2gobGFuZy5sYW5nKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZmluYWxBcnJheTtcclxuXHR9IGNhdGNoIChlKSB7XHJcblx0XHRyZXR1cm4gW107XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCAqIGFzIGFlc2pzIGZyb20gXCJhZXMtanNcIjtcclxuXHJcbmltcG9ydCB7IGVycm9yLCBpbmZvIH0gZnJvbSBcIi4vdXRpbC9kZWJ1Z1wiO1xyXG5pbXBvcnQgeyBnZXRTdG9yYWdlIH0gZnJvbSBcIi4vdXRpbC9mdW5jdGlvbnMvYXN5bmNTdG9yYWdlXCI7XHJcbmltcG9ydCBjbGVhbk9iamVjdCBmcm9tIFwiLi91dGlsL2Z1bmN0aW9ucy9jbGVhbk9iamVjdFwiO1xyXG5pbXBvcnQgeyBnZXRTdHJpbmcgfSBmcm9tIFwiLi91dGlsL2xhbmdNYW5hZ2VyXCI7XHJcblxyXG5sZXQgdGFiUHJpb3JpdHk6IG51bWJlciA9IG51bGwsXHJcblx0ZGVjcnlwdGlvbktleTogVWludDhBcnJheTtcclxuY29uc3QgcG9ydCA9IGNocm9tZS5ydW50aW1lLmNvbm5lY3QoeyBuYW1lOiBcImNvbnRlbnRTY3JpcHRcIiB9KTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiUHJlTWlEX1VwZGF0ZVByZXNlbmNlXCIsIGFzeW5jIChkYXRhOiBDdXN0b21FdmVudCkgPT4ge1xyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBkZWNyeXB0ZWREYXRhID0gSlNPTi5wYXJzZShcclxuXHRcdFx0ZGVjb2RlVVJJQ29tcG9uZW50KGF3YWl0IGRlY3J5cHREYXRhKGRhdGEuZGV0YWlsKSlcclxuXHRcdCk7XHJcblx0XHRjbGVhbk9iamVjdChkZWNyeXB0ZWREYXRhKTtcclxuXHRcdHBvcnQucG9zdE1lc3NhZ2UoeyBhY3Rpb246IFwidXBkYXRlUHJlc2VuY2VcIiwgcHJlc2VuY2U6IGRlY3J5cHRlZERhdGEgfSk7XHJcblx0fSBjYXRjaCAoZSkge1xyXG5cdFx0aWYgKGUgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikge1xyXG5cdFx0XHRlcnJvcihcclxuXHRcdFx0XHRcImNvbnRlbnRTY3JpcHQudHNcIixcclxuXHRcdFx0XHRcIkRhdGEgY291bGQgbm90IGJlIGRlY3J5cHRlZCBpbnRvIEpTT04gb2JqZWN0LlwiXHJcblx0XHRcdCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aHJvdyBlO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcblxyXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoZnVuY3Rpb24oZGF0YSkge1xyXG5cdGlmIChwb3J0ID09PSBudWxsKSByZXR1cm47XHJcblxyXG5cdGlmICh0eXBlb2YgZGF0YS5pRnJhbWVEYXRhICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHR3aW5kb3cuZGlzcGF0Y2hFdmVudChcclxuXHRcdFx0bmV3IEN1c3RvbUV2ZW50KFwiUHJlTWlEX2lGcmFtZURhdGFcIiwge1xyXG5cdFx0XHRcdGRldGFpbDogZGF0YS5pRnJhbWVEYXRhXHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0aWYgKHR5cGVvZiBkYXRhLnRhYlByaW9yaXR5ICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHRpZiAoZGF0YS50YWJQcmlvcml0eSkge1xyXG5cdFx0XHQvLyogUHJldmVudCBtdWx0aXBsZSBpbnRlcnZhbHNcclxuXHRcdFx0aWYgKHRhYlByaW9yaXR5ID09PSBudWxsKSB7XHJcblx0XHRcdFx0aW5mbyhcImNvbnRlbnRTY3JpcHQudHNcIiwgYFRhYiBQcmlvcml0eTogJHtkYXRhLnRhYlByaW9yaXR5fWApO1xyXG5cdFx0XHRcdHRhYlByaW9yaXR5ID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcclxuXHRcdFx0XHRcdGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHsgaUZyYW1lVXBkYXRlRGF0YTogdHJ1ZSB9KTtcclxuXHJcblx0XHRcdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcIlByZU1pRF9VcGRhdGVEYXRhXCIpKTtcclxuXHJcblx0XHRcdFx0XHRpbmZvKFwiY29udGVudFNjcmlwdC50c1wiLCBcInVwZGF0ZURhdGFcIik7XHJcblx0XHRcdFx0fSwgMTAwKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Y2xlYXJJbnRlcnZhbCh0YWJQcmlvcml0eSk7XHJcblx0XHRcdHRhYlByaW9yaXR5ID0gbnVsbDtcclxuXHRcdH1cclxuXHR9XHJcbn0pO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJQcmVNaURfUmVxdWVzdEV4dGVuc2lvbkRhdGFcIiwgYXN5bmMgZnVuY3Rpb24oXHJcblx0ZGF0YTogQ3VzdG9tRXZlbnRcclxuKSB7XHJcblx0bGV0IHN0cmluZ3MgPSBkYXRhLmRldGFpbC5zdHJpbmdzO1xyXG5cdGNvbnN0IGxhbmd1YWdlID0gZGF0YS5kZXRhaWwubGFuZ3VhZ2U7XHJcblxyXG5cdChcclxuXHRcdGF3YWl0IFByb21pc2UuYWxsKFxyXG5cdFx0XHRPYmplY3Qua2V5cyhzdHJpbmdzKS5tYXAoc3RyaW5nID0+IGdldFN0cmluZyhzdHJpbmdzW3N0cmluZ10sIGxhbmd1YWdlKSlcclxuXHRcdClcclxuXHQpLm1hcCgoc1QsIGkpID0+IChzdHJpbmdzW09iamVjdC5rZXlzKHN0cmluZ3MpW2ldXSA9IHNUKSk7XHJcblxyXG5cdHdpbmRvdy5kaXNwYXRjaEV2ZW50KFxyXG5cdFx0bmV3IEN1c3RvbUV2ZW50KFwiUHJlTWlEX1JlY2VpdmVFeHRlbnNpb25EYXRhXCIsIHtcclxuXHRcdFx0ZGV0YWlsOiB7XHJcblx0XHRcdFx0c3RyaW5nczogc3RyaW5nc1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlcyBhIEFFUyBrZXkgZnJvbSB0aGUgYXBwIGlkZW50aWZpZXJcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGdldERlY3J5cHRpb25LZXkoKTogUHJvbWlzZTxVaW50OEFycmF5PiB7XHJcblx0aWYgKGRlY3J5cHRpb25LZXkpIHtcclxuXHRcdHJldHVybiBkZWNyeXB0aW9uS2V5O1xyXG5cdH1cclxuXHJcblx0Y29uc3Qga2V5OiBzdHJpbmcgPSAoYXdhaXQgZ2V0U3RvcmFnZShcImxvY2FsXCIsIFwiaWRlbnRpZmllclwiKSkuaWRlbnRpZmllcjtcclxuXHRsZXQga2V5U2l6ZTogbnVtYmVyO1xyXG5cclxuXHRpZiAoa2V5Lmxlbmd0aCA+PSAzMikge1xyXG5cdFx0a2V5U2l6ZSA9IDMyO1xyXG5cdH0gZWxzZSBpZiAoa2V5Lmxlbmd0aCA+PSAyNCkge1xyXG5cdFx0a2V5U2l6ZSA9IDI0O1xyXG5cdH0gZWxzZSBpZiAoa2V5Lmxlbmd0aCA+PSAxNikge1xyXG5cdFx0a2V5U2l6ZSA9IDE2O1xyXG5cdH0gZWxzZSB7XHJcblx0XHRlcnJvcihcclxuXHRcdFx0XCJjb250ZW50U2NyaXB0LnRzXCIsXHJcblx0XHRcdFwiU3RyaW5nIGlzIG5vdCBsb25nIGVub3VnaCB0byBjcmVhdGUgZGVjcnlwdGlvbiBrZXkuXCJcclxuXHRcdCk7XHJcblx0XHRyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoKTtcclxuXHR9XHJcblxyXG5cdGRlY3J5cHRpb25LZXkgPSBhZXNqcy51dGlscy51dGY4LnRvQnl0ZXMoa2V5LnN1YnN0cmluZygwLCBrZXlTaXplKSk7XHJcblxyXG5cdHJldHVybiBkZWNyeXB0aW9uS2V5O1xyXG59XHJcblxyXG4vKipcclxuICogRGVjcnlwdHMgaGV4IGludG8gYSBzdHJpbmcgdXNpbmcgdGhlIGFwcCBpZGVudGlmaWVyIGFzIHRoZSBrZXlcclxuICogQHBhcmFtIGRhdGEgRW5jcnlwdGVkIGhleCBzdHJpbmdcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGRlY3J5cHREYXRhKGRhdGE6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcblx0Y29uc3QgZW5jcnlwdGlvbktleSA9IGF3YWl0IGdldERlY3J5cHRpb25LZXkoKTtcclxuXHJcblx0aWYgKGVuY3J5cHRpb25LZXkubGVuZ3RoID4gMCkge1xyXG5cdFx0Y29uc3QgYWVzQ3RyID0gbmV3IGFlc2pzLk1vZGVPZk9wZXJhdGlvbi5jdHIoZW5jcnlwdGlvbktleSksXHJcblx0XHRcdGVuY3J5cHRlZEJ5dGVzID0gYWVzanMudXRpbHMuaGV4LnRvQnl0ZXMoZGF0YSksXHJcblx0XHRcdGRlY3J5cHRlZEJ5dGVzID0gYWVzQ3RyLmRlY3J5cHQoZW5jcnlwdGVkQnl0ZXMpLFxyXG5cdFx0XHRkZWNyeXB0ZWRUZXh0ID0gYWVzanMudXRpbHMudXRmOC5mcm9tQnl0ZXMoZGVjcnlwdGVkQnl0ZXMpO1xyXG5cclxuXHRcdHJldHVybiBkZWNyeXB0ZWRUZXh0O1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIFwiXCI7XHJcbn1cclxuIiwiZXhwb3J0IGZ1bmN0aW9uIGdldFN0b3JhZ2UoXHJcblx0dHlwZTogXCJsb2NhbFwiIHwgXCJzeW5jXCIsXHJcblx0bmFtZTogc3RyaW5nIHwgQXJyYXk8c3RyaW5nPlxyXG4pIHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2U8YW55PihyZXNvbHZlID0+XHJcblx0XHRjaHJvbWUuc3RvcmFnZVt0eXBlXS5nZXQobmFtZSwgaXRlbXMgPT4gcmVzb2x2ZShpdGVtcykpXHJcblx0KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldFN0b3JhZ2UoXHJcblx0dHlwZTogXCJsb2NhbFwiIHwgXCJzeW5jXCIsXHJcblx0aXRlbXM6IE9iamVjdFxyXG4pIHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2U8dm9pZD4ocmVzb2x2ZSA9PlxyXG5cdFx0Y2hyb21lLnN0b3JhZ2VbdHlwZV0uc2V0KGl0ZW1zLCByZXNvbHZlKVxyXG5cdCk7XHJcbn1cclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiLy8gbW9kdWxlIGV4cG9ydHMgbXVzdCBiZSByZXR1cm5lZCBmcm9tIHJ1bnRpbWUgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHJ1biBzdGFydHVwXG5yZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy54KCk7XG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiBtb2R1bGVbJ2RlZmF1bHQnXSA6XG5cdFx0KCkgPT4gbW9kdWxlO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gUHJvbWlzZSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDMwMDogMFxufTtcblxudmFyIGRlZmVycmVkTW9kdWxlcyA9IFtcblx0WzQxODQsOTk5XVxuXTtcbi8vIG5vIGNodW5rIG9uIGRlbWFuZCBsb2FkaW5nXG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbnZhciBjaGVja0RlZmVycmVkTW9kdWxlcyA9ICgpID0+IHtcblxufTtcbmZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzSW1wbCgpIHtcblx0dmFyIHJlc3VsdDtcblx0Zm9yKHZhciBpID0gMDsgaSA8IGRlZmVycmVkTW9kdWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBkZWZlcnJlZE1vZHVsZSA9IGRlZmVycmVkTW9kdWxlc1tpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IodmFyIGogPSAxOyBqIDwgZGVmZXJyZWRNb2R1bGUubGVuZ3RoOyBqKyspIHtcblx0XHRcdHZhciBkZXBJZCA9IGRlZmVycmVkTW9kdWxlW2pdO1xuXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2RlcElkXSAhPT0gMCkgZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0fVxuXHRcdGlmKGZ1bGZpbGxlZCkge1xuXHRcdFx0ZGVmZXJyZWRNb2R1bGVzLnNwbGljZShpLS0sIDEpO1xuXHRcdFx0cmVzdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBkZWZlcnJlZE1vZHVsZVswXSk7XG5cdFx0fVxuXHR9XG5cdGlmKGRlZmVycmVkTW9kdWxlcy5sZW5ndGggPT09IDApIHtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLngoKTtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnggPSAoKSA9PiB7XG5cblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn1cbl9fd2VicGFja19yZXF1aXJlX18ueCA9ICgpID0+IHtcblx0Ly8gcmVzZXQgc3RhcnR1cCBmdW5jdGlvbiBzbyBpdCBjYW4gYmUgY2FsbGVkIGFnYWluIHdoZW4gbW9yZSBzdGFydHVwIGNvZGUgaXMgYWRkZWRcblx0X193ZWJwYWNrX3JlcXVpcmVfXy54ID0gKCkgPT4ge1xuXG5cdH1cblx0Y2h1bmtMb2FkaW5nR2xvYmFsID0gY2h1bmtMb2FkaW5nR2xvYmFsLnNsaWNlKCk7XG5cdGZvcih2YXIgaSA9IDA7IGkgPCBjaHVua0xvYWRpbmdHbG9iYWwubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGNodW5rTG9hZGluZ0dsb2JhbFtpXSk7XG5cdHJldHVybiAoY2hlY2tEZWZlcnJlZE1vZHVsZXMgPSBjaGVja0RlZmVycmVkTW9kdWxlc0ltcGwpKCk7XG59O1xuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IChkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lLCBleGVjdXRlTW9kdWxlc10gPSBkYXRhO1xuXHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcblx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG5cdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDAsIHJlc29sdmVzID0gW107XG5cdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhpbnN0YWxsZWRDaHVua3MsIGNodW5rSWQpICYmIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuXHRcdFx0cmVzb2x2ZXMucHVzaChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0pO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdH1cblx0fVxuXHRpZihydW50aW1lKSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHRwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG5cdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuXHR9XG5cblx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuXHRpZihleGVjdXRlTW9kdWxlcykgZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyk7XG5cblx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG5cdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3BtZFwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtwbWRcIl0gfHwgW107XG52YXIgcGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24gPSBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrOyJdLCJzb3VyY2VSb290IjoiIn0=