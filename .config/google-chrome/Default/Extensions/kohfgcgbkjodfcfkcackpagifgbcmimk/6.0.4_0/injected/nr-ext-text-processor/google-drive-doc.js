var doc=doc&&"googleDriveDoc"===doc.type?doc:new function(){this.type="googleDriveDoc";let e=[],t=0,r=$(".drive-viewer-paginated-scrollable").get(0),n=$(".drive-viewer-paginated-page");function o(t,o="all"){return new Promise((i=>{let c=n.get(t);if(c)return r.scrollTop=$(c).position().top,tryGetTexts(l.bind(c),3e3).then((t=>{"all"===o&&(t=processSentencesByLength(t)),e=e.concat(t),i()}));i()})).catch((e=>{}))}function l(){let e=$("p",this).get().map(getInnerText).filter(isNotEmpty);return fixParagraphs(e)}this.getCurrentIndex=function(){for(let e=0;e<n.length&&!(n.eq(e).position().top>r.scrollTop+$(r).height()/2);e++);return i-1},this.getTexts=function(l="all"){return new Promise((async r=>{await Promise.resolve().then((()=>{e=[],t=0})).catch((e=>{})),r()})).then((async()=>{let e=[];return e.push(await function(e="all"){if("all"===e){let e=r.scrollTop;return o(getCurrentIndex()).then((()=>(r.scrollTop=e,Promise.resolve())))}return new Promise((async e=>{let t=r.scrollTop;for(let e=0;e<n.length;e++)await o(e);r.scrollTop=t,e()})).catch((e=>{}))}(l)),Promise.all(e)})).then((()=>new Promise((t=>{t(e)})))).catch((e=>{}))}};