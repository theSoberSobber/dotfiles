var googleDocsUtil=googleDocsUtil||function(){var e=".kix-paragraphrenderer",t=".kix-lineview",n=".kix-selection-overlay",r=".kix-wordhtmlgenerator-word-node",l=".kix-cursor",o=".kix-cursor-name",i=".kix-cursor-caret";function c(e){var t=e.replace(/\u200B\u200c/g,""),n=String.fromCharCode(160),r=new RegExp(n,"g");return t=t.replace(r," ")}function d(e){return null==e.match("[\\wæøåÆØÅéáÉÁöÖ]")}function a(e){if(!e.getAttribute("transform"))return null;const t=e.getAttribute("transform").split(",");return parseFloat(parseFloat(t[t.length-1].split(")")[0]).toFixed(3))}function s(d=!1,a=!1,s=!1){var g,h,m=0,y=0,S=0,O=[],F=[],A=0,b=0,T="",C=void 0,R=document.querySelectorAll(e);let N=[],w=[],E=0,I=0,k=!1;(function(){for(var e=document.querySelectorAll(l),t=0;t<e.length;t++){if(!e[t].querySelectorAll(o)[0].innerText)return!0}return!1})()&&(g=function(){for(var e=document.querySelectorAll(l),t=0;t<e.length;t++){if(!e[t].querySelectorAll(o)[0].innerText)return e[t].querySelectorAll(i)[0]}throw"Could not find the users cursor"}(),h=g.getBoundingClientRect());for(var D=0;D<R.length;D++){var B=R[D].querySelectorAll(t);let e=!1;for(var q=0;q<B.length;q++){for(var L="",P=B[q].querySelectorAll(n),_=B[q].querySelectorAll(r),W=0;W<_.length;W++){var V=_[W].getBoundingClientRect();if(h&&p(V,h)){var M=v(h.left-V.left,_[W],B[q]);m=b+M,y=L.length+M,S=A}var U=c(_[W].textContent);F.push({index:b,line:A,lineIndex:L.length,node:_[W],lineElement:B[q],text:U});for(var G=0;G<P.length;G++){var H=P[G],X=H.getBoundingClientRect();if(X&&(C=X),p(V,H.getBoundingClientRect())){e||(w.push(R[D]),e=!0);let t=x(_[W]);var j=v(X.left-V.left,_[W],B[q]),z=v(X.left+X.width-V.left,_[W],B[q]);if(t.length>0){let e=f(j,t),n=e.nodeIndex,r=e.splitAt,l=f(z,t),o=l.nodeIndex,i=l.splitAt;if(d){let e=!1;for(;!e;)try{t[n]=t[n].splitText(r),e=!0}catch(e){r++}}if(a){let e=!1;for(;!e;)try{t[o].splitText(i),e=!0}catch(e){i--}}t=u(t,t[n],t[o])}k||(k=!0,E=j),I=z,T+=U.substring(j,z),N=N.concat(t)}}b+=U.length,L+=U}O.push(L),A++}}if(N.length>0&&s){let e=document.createElement("nr-selection-start"),t=document.createTextNode("nr selection start");e.appendChild(t),$(e).addClass("nr-selected"),$(e).insertBefore(N[0]),e.style.display="none"}return{nodes:F,text:O,selectedText:T,caret:{index:m,lineIndex:y,line:S},selectionRect:C,selectedNodes:{textNodes:N,pNodes:w}}}function u(e,t,n){return e=(e=e.filter((e=>""!==c(e.nodeValue).trim()&&g(e.nodeValue)))).filter((e=>e.isSameNode(t)||e.isSameNode(n)||t.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING&&n.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_PRECEDING))}function f(e,t){let n=0;for(let r=0;r<t.length;r++){let l=c(t[r].nodeValue);if(n+=l.length,n>e){return{nodeIndex:r,splitAt:l.length-(n-e)}}}return{nodeIndex:t.length-1,splitAt:c(t[t.length-1].nodeValue).length-(n-e)}}function x(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),r=null;for(;r=n.nextNode();)t.push(r);return t}function g(e){return e&&e.replace(/\u200c/g,"")}function h(e,t,n,r){return e<=r&&n<=t}function p(e,t){return e.left<=t.right&&e.right>=t.left&&e.top<=t.bottom&&e.bottom>=t.top}function v(e,t,n){for(var r=c(t.innerText),l=document.createElement("div"),o=[],i=0;i<r.length;i++){var d=document.createElement("span");d.innerText=r[i],d.style.cssText=t.style.cssText,d.style.whiteSpace="pre",o.push(d),l.appendChild(d)}l.style.whiteSpace="nowrap",n.appendChild(l);var a=0,s=-1,u=l.getBoundingClientRect();for(i=0;i<o.length;i++){var f=o[i].getBoundingClientRect(),x=f.left-u.left,g=x+f.width;-1==s&&(s=Math.abs(e-x));var h=Math.abs(e-x),p=Math.abs(e-g);h<=s&&(a=i,s=h),p<=s&&(a=i+1,s=p)}return l.remove(),a}function m(e,t,n){var r=0,l=n.text.length;return e>n.index&&(r=e-n.index),t<n.index+n.text.length&&(l=t-n.index),n.text.substring(r,l)}function y(e,t,n,r,l){var o=document.createElement("div");o.setAttribute("class","dictus_highlight_node"),o.style.position="absolute",o.style.left=e+"px",o.style.top=t+"px",o.style.width=n+"px",o.style.height=r+"px",o.style.backgroundColor="#D1E3FF",o.style.color="#D1E3FF",o.style.boxShadow="0px 0px 1px 1px #D1E3FF",l.appendChild(o)}function S(e,t,n){if(0==e)return 0;for(var r=c(t.innerText),l=document.createElement("div"),o=[],i=0;i<e;i++){var d=document.createElement("span");d.innerText=r[i],d.style.cssText=t.style.cssText,d.style.whiteSpace="pre",o.push(d),l.appendChild(d)}n.appendChild(l);var a=l.getBoundingClientRect(),s=o[e-1].getBoundingClientRect(),u=s.left+s.width-a.left;return l.remove(),u}return{getGoogleDocument:function(e=!1,t=!1,n=!1){return s(e,t,n)},findWordAtCaret:function(e){return function(e){var t=e.text[e.caret.line];if(0==t.length)return{word:"",startIndex:e.caret.index,endIndex:e.caret.index};var n=e.caret.lineIndex,r=e.caret.lineIndex;e.caret.lineIndex>=t.length&&(n=t.length-1,r=t.length-1);var l=t[n];for(d(l)&&n>0&&(l=t[--n]);!d(l)&&n>0;)l=t[--n];for(l=t[r];!d(l)&&r<t.length-1;)l=t[++r];var o=e.caret.index-e.caret.lineIndex+n,i=e.caret.index-e.caret.lineIndex+r;return{word:t.substring(n,r).trim(),startIndex:o,endIndex:i}}(e)},getText:function(e,t,n){return function(e,t,n){for(var r="",l=0;l<n.nodes.length;l++)h(e,t,n.nodes[l].index,n.nodes[l].index+n.nodes[l].text.length)&&(r+=m(e,t,n.nodes[l]));return r}(e,t,n)},highlight:function(e,t,n){!function(e,t,n){for(var r=0;r<n.nodes.length;r++)if(h(e,t,n.nodes[r].index,n.nodes[r].index+n.nodes[r].text.length)){if(!m(e,t,n.nodes[r]).trim())continue;var l=n.nodes[r].lineElement.getBoundingClientRect(),o=n.nodes[r].node.getBoundingClientRect(),i=0,c=o.width;e>n.nodes[r].index&&(i=S(e-n.nodes[r].index,n.nodes[r].node,n.nodes[r].lineElement)),t<n.nodes[r].index+n.nodes[r].text.length&&(c=S(t-n.nodes[r].index,n.nodes[r].node,n.nodes[r].lineElement)),y(o.left-l.left+i,o.top-l.top,c-i,o.height,n.nodes[r].lineElement)}}(e,t,n)},removeHighlight:function(){!function(){for(var e=document.querySelectorAll(".dictus_highlight_node");e.length>0;)e[0].remove()}()},cleanDocumentText:function(e){return c(e)},removeSelectionOverlay:function(){return function(){let e=document.querySelectorAll(n);Array.from(e,(e=>{e.remove()}))}()},getTextNodes:function(e){return x(e)},removeDumbChars:function(e){return g(e)},getTextNodesWithoutEmptyNodes:function(e){return function(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),r=null;for(;r=n.nextNode();)""!==c(r.nodeValue).trim()&&g(r.nodeValue)&&t.push(r);return t}(e)},getSelectedRects:function(e){return function(e="page"){const t=Array.from($("div.kix-canvas-tile-selection"));let n={};for(let e=0;e<t.length;e++){const r=Array.from($("svg rect",t[e]));r.length>0&&(n[e]=r)}const r=$(".kix-page-paginated"),l=[],o={};for(const t in n){const i=Array.from($("div.kix-canvas-tile-content svg g rect",r[t])),c=n[t][0],d=n[t][n[t].length-1],s=parseFloat(d.getAttribute("width"));let u=!1;for(let n=0;n<i.length;n++){const r=parseFloat(parseFloat(i[n].getAttribute("x")).toFixed(3)),f=a(i[n]);let x=null,g=null;i[n+1]&&(xOfNextRect=parseFloat(parseFloat(i[n+1].getAttribute("x")).toFixed(3))),i[n-1]&&(x=parseFloat(parseFloat(i[n-1].getAttribute("x")).toFixed(3)),g=a(i[n-1]));const h=parseFloat(parseFloat(c.getAttribute("x")).toFixed(3)),p=a(c),v=parseFloat(parseFloat(d.getAttribute("x")).toFixed(3)),m=a(d);if(console.log("selection values",{xOfFirstSelected:h,xOfLastSelected:v,yOfFirstSelected:p,yOfLastSelected:m,xOfPrevRect:x,yOfPrevRect:g,widthOfLastSelectedRect:s,x:r,y:f,text:i[n].getAttribute("aria-label")}),p===f&&h>=r&&(h==r||h>=x&&g==p)&&(console.log("found first",{xOfFirstSelected:h,xOfLastSelected:v,yOfFirstSelected:p,yOfLastSelected:m,xOfPrevRect:x,yOfPrevRect:g,widthOfLastSelectedRect:s,x:r,y:f,text:i[n].getAttribute("aria-label")}),u=!0),u&&("page"==e?(t in o||(o[t]=[]),o[t].push(i[n])):l.push(i[n])),m===f&&(r>0&&null!=xOfNextRect&&v<xOfNextRect||0===r&&s==r)){console.log("last rect in last line",{xOfFirstSelected:h,xOfLastSelected:v,yOfFirstSelected:p,yOfLastSelected:m,xOfPrevRect:x,yOfPrevRect:g,widthOfLastSelectedRect:s,x:r,y:f,text:i[n].getAttribute("aria-label")});break}}}return"page"===e?o:l}(e)}}}();