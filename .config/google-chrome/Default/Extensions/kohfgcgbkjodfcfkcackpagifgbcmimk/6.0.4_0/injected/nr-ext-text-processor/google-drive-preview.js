var doc=doc&&"googleDrivePreview"===doc.type?doc:new function(){let e=this;e.type="googleDrivePreview";let t,n,r=[],o=0;function l(){let e=$("[role=document]:visible").eq(0);t=e.parent().get(0),n=e.children().slice(e.children().first().is("[role=button]")?2:1);let r=0;for(let e=0;e<n.length;e++)if(n.eq(e).position().top>t.scrollTop+$(t).height()/2){r=e;break}return 0===r?n.length-1:r-1}function i(e=0){return new Promise((r=>{let o=n.get(e);if(o){t.scrollTop=$(o).position().top;let e=setInterval((async function(){n.get(l())===o&&(clearInterval(e),r($("p",o).get()))}),500)}else r()})).catch((e=>{}))}function c(e,o="all"){let i=n.get(e);return new Promise((e=>{if(i){t.scrollTop=$(i).position().top;let c=setInterval((async function(){if(n.get(l())===i)return clearInterval(c),tryGetTexts(s.bind(i),3e3).then((function(t){"all"===o&&(t=processSentencesByLength(t)),r=r.concat(t),e()}))}),500)}})).catch((e=>{}))}function s(){let e=$("p",this).get().map(getInnerText).filter(isNotEmpty);return fixParagraphs(e)}function a(){if(!n){let e=$("[role=document]:visible").eq(0);t=e.parent().get(0),n=e.children().slice(e.children().first().is("[role=button]")?2:1)}return n.length}e.getPageIndex=function(){return-1==o?a()-1:o},e.getPages=function(){if(!n){let e=$("[role=document]:visible").eq(0);t=e.parent().get(0),n=e.children().slice(e.children().first().is("[role=button]")?2:1)}return n},e.getNumPages=a,e.getCurrentIndex=l,e.isSameText=function(){return!n||n.get(o).innerText===e.docInnerText},e.paragraphToSentenceIndexMapping={},e.docInnerText="",e.scrollToAdjacentPage=function(e){return new Promise((r=>{let l=null;"next"===e?o<n.length-1&&-1!==o?l=n[o+1]:r("ERR"):o>0?l=n[o-1]:-1===o?l=n[n.length-2]:r("ERR"),t.scrollTop=$(l).position().top,r()})).catch((e=>{}))},e.scrollToPage=function(e){return new Promise((r=>{let o=null;e>=0&&e<n.length?o=n[e]:r("ERR"),t.scrollTop=$(o).position().top,r()})).catch((e=>{}))},e.getTexts=function(i="all"){return o=l(),new Promise((async e=>{await Promise.resolve().then((()=>{r=[]})).catch((e=>{})),e()})).then((async()=>{let r=[];return r.push(await function(r="all"){if("all"===r){let o=t.scrollTop,i=n.get(l()).innerText;return e.docInnerText===i&&"convert"!==r?Promise.reject("ERR_ALREADY_PARSED"):("convert"!==r&&(e.docInnerText=i),c(l()).then((()=>(t.scrollTop=o,Promise.resolve()))))}return new Promise((async e=>{let r=t.scrollTop;for(let e=0;e<n.length;e++)await c(e);t.scrollTop=r,e()})).catch((e=>{}))}(i)),Promise.all(r)})).then((()=>new Promise((e=>{e(r)}))))},this.parseForConvertToPdf=function(){return new Promise((async e=>{l();let r=[],o=t.scrollTop;for(let e=0;e<n.length;e++)r=r.concat(await i(e));t.scrollTop=o,e(r)})).then((e=>e)).catch((e=>{}))},this.parsePageForImmersiveReader=function(){return new Promise((async e=>{l(),e(await i(l()))})).then((e=>e)).catch((e=>{}))}};