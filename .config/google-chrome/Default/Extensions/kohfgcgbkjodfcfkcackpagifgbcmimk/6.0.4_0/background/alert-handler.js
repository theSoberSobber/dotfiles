function AlertHandler(){let e=this;function t(t,s={}){return new Promise((r=>{if(t.message&&(t=t.message),"ERR_NOT_READABLE"===t||"ERR_NO_TEXT"===t)"selection-context-menu"===reader.readOption||e.pwTabId||chrome.tabs.create({url:"https://www.naturalreaders.com/online/"},(async t=>{e.pwTabId=t.id}));else if("ERR_INVALID_PAGE"===t)n("showAlertInvalidPage",512,552);else if("ERR_TTS_LIMIT"===t||1005==t){let e=readingBar.settings.voiceType,t=readingBar.settings.userInfo.pwLicNum,s=readingBar.settings.userInfo.pwLicType;"prem"===e?n("showAlertPremTtsLimit",512,568,{tabId:extension.beingReadTabId}):n("showAlertPlusTtsLimit",512,568,{tabId:extension.beingReadTabId,license:t,licType:s})}else"ERR_NO_TABID"===t||("ERR_PDF"===t?n("showAlertPdf",512,478):"CONVERT_MP3"===t?n("showAlertMp3",512,316):"ERR_NO_FREE_VOICES"===t?n("showAlertNoFreeVoices",512,472):"UPDATE_AVAILABLE"===t?n("showAlertUpdateAvailable",512,472):"UPGRADE_DIALOG"===t?n("showUpgradeDialog",512,588,s):"UPGRADE_UNSUPPORTED_DIALOG"===t?n("showUpgradeUnsupportedDialog",512,478,s):n("ERR_GOOGLE_DRIVE_PREVIEW"===t?"showGoogleDrivePreviewWarning":"ERR_DOCS_NO_ANNOTATED"===t?"showGoogleDocsNoAnnotated":"showAlertGeneric",512,472));r()})).catch((e=>{}))}function n(t,n=512,s=512,r={}){let i=n,o=s,a=0,d=0;chrome.tabs.sendMessage(extension.activeTabId,{fn:"calculateScreenCenter",width:i,height:o},(n=>{n&&(n.top&&(d=n.top),n.left&&(a=n.left)),chrome.tabs.create({url:"https://www.naturalreaders.com/ext",active:!1},(function(n){e.tabId=n.id,chrome.windows.create({tabId:n.id,type:"popup",focused:!0,width:i,height:o,left:a,top:d},(function(n){e.windowId=n.id,e.tabId=n.tabs.length>0?n.tabs[0].id:null,function(e,t,n,s={}){chrome.scripting.executeScript({target:{tabId:n},files:["assets/js/plugins/sweetalert2.js"]},(function(){chrome.scripting.insertCSS({target:{tabId:n},css:"libs/alert.css"},(function(){chrome.scripting.executeScript({target:{tabId:n},files:["libs/alert.js"]},(function(){chrome.tabs.sendMessage(n,{fn:e,windowId:t,data:s},(()=>{chrome.runtime.lastError}))}))}))}))}(t,n.id,e.tabId,r),chrome.windows.onFocusChanged.addListener((function e(){chrome.tabs.query({active:!0,lastFocusedWindow:!0},(async function(t){const s=t.length>0?t[0].windowId:null;n.id!==s&&(chrome.windows.remove(n.id,(()=>{chrome.runtime.lastError})),chrome.windows.onFocusChanged.removeListener(e))}))}))}))}))}))}e.windowId=null,e.tabId=null,e.displayAlertMessage=t,e.closeAlertWindow=function(e,t,n){chrome.windows.remove(e.windowId,(()=>{chrome.runtime.lastError}))},e.showAlert=n,e.pwTabId=null,chrome.runtime.onMessage.addListener((function(n,s,r){if("displayAlertMessage"===n.fn)return t(n.message);e[n.fn]&&e[n.fn](n,s,r)}))}const alertHandler=new AlertHandler;