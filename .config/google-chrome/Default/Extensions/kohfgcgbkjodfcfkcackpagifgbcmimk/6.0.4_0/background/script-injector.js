function ScriptInjector(){let e=this;function t(e,t){return e?new Promise((e=>{let r=null;r="html"===t?["injected/nr-ext-text-processor/html-doc.js"]:"googleDriveDoc"===t?["injected/nr-ext-text-processor/google-drive-doc.js"]:"googleDoc"===t?["injected/nr-ext-text-processor/google-doc-utils.js","injected/nr-ext-text-processor/google-doc.js"]:"googleDrivePreview"===t?["injected/nr-ext-text-processor/google-drive-preview.js"]:"kindle"===t?["injected/nr-ext-text-processor/kindle.js"]:"gmail"===t?["injected/nr-ext-text-processor/gmail-doc.js"]:"outlookMail"===t?["injected/nr-ext-text-processor/outlook-mail.js"]:null===t?null:["injected/nr-ext-text-processor/html-doc.js"],e(r)})).catch((e=>{})):Promise.reject(new Error("ERR_NO_TABID"))}function r(e,t,n="script",s=null){return new Promise((function(c,i){"script"===n?browser.scripting.executeScript({target:{tabId:e},files:t},(()=>{chrome.runtime.lastError?s?(r(e,t,n,s--),c()):i(new Error("ERR_NOT_READABLE")):c(e)})):browser.scripting.insertCSS({target:{tabId:e},css:t},(()=>{chrome.runtime.lastError&&(s?(r(e,t,n,s--),c()):i(new Error("ERR_NOT_READABLE"))),c(e)}))}))}e.getTextProcessorFilePathForDoc=t,e.executeScriptsForReader=function(e,n){return r(e,["assets/js/jquery-3.6.0.min.js"]).then((()=>r(e,["injected/nr-ext-reader/tts-text.js"]))).then((()=>r(e,["injected/nr-ext-reader/voices.js"]))).then((()=>r(e,["injected/nr-ext-reader/tts.js"]))).then((()=>r(e,["injected/nr-ext-reader/reader.js"]))).then((()=>r(e,["injected/nr-ext-reader/pe.js"]))).then((()=>r(e,["libs/compromise.min.js"]))).then((()=>r(e,["injected/nr-ext-dom/nr-ext-dom-controller.js"]))).then((()=>r(e,["injected/nr-ext-text-processor/nr-ext-text-processor.js"]))).then((()=>t(e,n))).then((t=>{let n=[];if(t)for(let s=0;s<t.length;s++)n.push(r(e,[t[s]]));return Promise.all(n)})).catch((e=>{alertHandler.displayAlertMessage(e.message)}))},e.executeScriptsForReadingBar=function(e){return r(e,["assets/js/displace.js"]).then((()=>r(e,["injected/amplify-config.js"]))).then((()=>r(e,["assets/js/plugins/uuidv4.min.js"]))).then((()=>r(e,["injected/nr-ext-reading-bar/nr-ext-reading-bar.js"]))).catch((e=>{alertHandler.displayAlertMessage(e.message)}))},e.executeScriptsForReadingBarSliders=function(e){return r(e,["injected/nr-ext-reading-bar/slider-init.js"]).catch((e=>{alertHandler.displayAlertMessage(e.message)}))},e.executeScriptsForQuickStart=function(e,t){return r(e,["assets/js/displace.js"]).then((()=>r(e,["injected/nr-ext-quick-start/nr-ext-quick-start.js"]))).catch((e=>{alertHandler.displayAlertMessage(e.message)}))},e.executeScriptsForPdfBar=function(e){return r(e,["injected/nr-ext-pdf/nr-ext-pdf.js"]).catch((e=>{alertHandler.displayAlertMessage(e.message)}))},e.canExecuteScript=function(){return r(extension.activeTabId,["injected/ok.js"]).then((e=>Promise.resolve(!0))).catch((e=>(alertHandler.displayAlertMessage("ERR_NOT_READABLE"),Promise.reject(!1))))},e.executeScriptsForEmailIcon=function(e,t){return r(e,["assets/js/jquery-3.6.0.min.js"]).then((()=>{let n="injected/nr-ext-dom/nr-ext-outlook-icon.js";return"gmail"===t&&(n="injected/nr-ext-dom/nr-ext-gmail-icon.js"),r(e,[n])})).catch((e=>{}))},e.executeScriptOnTab=r}const scriptInjector=new ScriptInjector;