function Storage(){this.set=function(o,t="local"){"local"===t?chrome.storage.local.set(o,(()=>{chrome.runtime.lastError})):chrome.storage.sync.set(o,(()=>{chrome.runtime.lastError?(r=!0,chrome.storage.local.set(o,(()=>{chrome.runtime.lastError})),chrome.storage.sync.get(null,(r=>{chrome.runtime.lastError}))):r&&(r=!1,e())}))};let r=!1;function e(){chrome.storage.local.get(null,(r=>{chrome.runtime.lastError,chrome.storage.sync.set(r,(()=>{chrome.runtime.lastError||chrome.storage.local.clear((()=>{chrome.runtime.lastError}))}))}))}chrome.storage.local.get(null,(r=>{Object.keys(r).length>0&&e()}))}const storage=new Storage;