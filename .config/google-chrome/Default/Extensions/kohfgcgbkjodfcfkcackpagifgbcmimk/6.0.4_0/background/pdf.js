function Pdf(){let e=this;function t(){return utils.getActiveTab().then((e=>{let t=function(e){let t={origin:"no origin",href:"no href"};if(e.url){let n=new URL(e.url);t={origin:n.origin,href:n.href}}return t}(e);return e&&e.url&&e.url.match(/\.pdf$/)?e.url.match(/file(.)+.pdf$/)?Promise.resolve({pdf:!0,type:"local",tabId:e.id,urlInfo:t}):Promise.resolve({pdf:!0,type:"online",tabId:e.id,urlInfo:t}):Promise.resolve({pdf:!1,urlInfo:t})}))}function n(){if(readingBar.settings.isQuickStartPdf)return t().then((e=>{var t;e.pdf&&"online"===e.type&&e.urlInfo&&!e.urlInfo.href.includes("naturalreaders.com/online/")&&(t=e.tabId,chrome.tabs.sendMessage(t,{fn:"getHasPdfBar"},(function(e){return chrome.runtime.lastError?scriptInjector.executeScriptsForPdfBar(t):e?void 0:scriptInjector.executeScriptsForPdfBar(t)})))})).catch((e=>{}))}e.checkPDF=function(){return t().then((e=>e.pdf?Promise.resolve({isPdf:!0,tabId:e.tabId,urlInfo:e.urlInfo}):Promise.resolve({isPdf:!1,tabId:e.tabId,urlInfo:e.urlInfo})))},e.isOnlinePdf=function(){return t().then((e=>e.pdf&&"online"===e.type?Promise.resolve(!0):Promise.resolve(!1))).catch((e=>{}))},e.localInstructions='<p>Warning: We noticed you want to read a pdf, to read pdf\'s please upload the file <a class="pdf-instr" target="_blank" href="https://www.naturalreaders.com/online/?action=upload">here</a> </p>',e.downloadPdf=function(t,n,r){const o=t.url;return fetch(o).then((e=>{if(e.ok)return e.blob()})).then((t=>{chrome.tabs.create({url:"https://www.naturalreaders.com/online/?action=openRemotePdf&source=ext-remote-pdf"},(n=>{e.tabId=n.id,e.remotePdf=t;const r=o.split("/");e.pdfName=r[r.length-1]}))})).catch((e=>{}))},e.tabId=null,e.remotePdf=null,e.getRemotePdf=function(t){e.tabId&&e.remotePdf&&scriptInjector.executeScriptOnTab(e.tabId,["injected/nr-ext-pdf/nr-ext-remote-pdf.js"]).then((()=>{chrome.tabs.sendMessage(e.tabId,{fn:"sendRemotePdfToPW",url:e.remotePdf,pdfName:e.pdfName},(function(n){chrome.runtime.lastError,t(n),e.remotePdf=null,e.tabId=null}))})).catch((e=>{}))},e.setFile=function(t,n,r){const o=t.url;let a="ext-remote-pdf";t.source&&(a=t.source);chrome.tabs.create({url:"https://www.naturalreaders.com/online/?action=openRemotePdf&source="+a},(n=>{e.tabId=n.id,e.remotePdf=o,e.pdfName=t.fileName}))},e.pdfName="NR.pdf",chrome.tabs.onCreated.addListener((function(e){n()})),chrome.tabs.onActivated.addListener((async function(e){n()})),chrome.windows.onFocusChanged.addListener((function(e){chrome.tabs.query({active:!0,lastFocusedWindow:!0},(async function(e){e[0]&&n()}))})),browser.webNavigation.onCommitted.addListener((async function(e){"auto_subframe"!==e.transitionType&&"manual_subframe"!==e.transitionType&&n()})),chrome.runtime.onMessage.addListener((function(t,n,r){e[t.fn]&&e[t.fn](t,n,r)}))}const pdfDoc=new Pdf;